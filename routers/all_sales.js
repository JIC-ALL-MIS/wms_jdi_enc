var a0_0x3ba484=a0_0x4833;(function(_0x42284e,_0x27f10c){var _0x224840=a0_0x4833,_0x115763=_0x42284e();while(!![]){try{var _0x4484ad=-parseInt(_0x224840(0x1a3))/0x1+-parseInt(_0x224840(0x1db))/0x2+-parseInt(_0x224840(0x1f8))/0x3*(-parseInt(_0x224840(0x1f3))/0x4)+-parseInt(_0x224840(0x1b4))/0x5+parseInt(_0x224840(0x14e))/0x6+parseInt(_0x224840(0x155))/0x7*(-parseInt(_0x224840(0x19b))/0x8)+parseInt(_0x224840(0x128))/0x9*(parseInt(_0x224840(0x159))/0xa);if(_0x4484ad===_0x27f10c)break;else _0x115763['push'](_0x115763['shift']());}catch(_0x42e347){_0x115763['push'](_0x115763['shift']());}}}(a0_0x44ee,0x82f87));const express=require(a0_0x3ba484(0x1ff)),app=express(),router=express[a0_0x3ba484(0x1df)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings}=require(a0_0x3ba484(0x18d)),auth=require(a0_0x3ba484(0x1b2)),nodemailer=require(a0_0x3ba484(0x151)),users=require(a0_0x3ba484(0x1fe));router[a0_0x3ba484(0x1e9)](a0_0x3ba484(0x1b8),auth,async(_0x1bd711,_0x1134bd)=>{var _0x3b1646=a0_0x3ba484;try{const {username:_0x2229b7,email:_0x131da6,role:_0x44bba8}=_0x1bd711[_0x3b1646(0x121)],_0x1b0b10=_0x1bd711[_0x3b1646(0x121)],_0x254075=await profile[_0x3b1646(0x1ac)]({'email':_0x1b0b10[_0x3b1646(0x141)]}),_0x46b641=await master_shop[_0x3b1646(0x1d7)]();let _0x5bb3f0;if(_0x1b0b10[_0x3b1646(0x1b1)]==_0x3b1646(0x169)){const _0x27b42b=await staff[_0x3b1646(0x1ac)]({'email':_0x1b0b10['email']});_0x5bb3f0=await sales[_0x3b1646(0x1f5)]([{'$lookup':{'from':'customers','localField':_0x3b1646(0x17b),'foreignField':_0x3b1646(0x152),'as':_0x3b1646(0x158)}},{'$unwind':'$customers_docs'},{'$unwind':_0x3b1646(0x179)},{'$group':{'_id':_0x3b1646(0x1c7),'invoice':{'$first':_0x3b1646(0x1de)},'customers':{'$first':'$customer'},'date':{'$first':_0x3b1646(0x145)},'warehouse_name':{'$first':_0x3b1646(0x13d)},'sale_product':{'$push':_0x3b1646(0x179)},'note':{'$first':_0x3b1646(0x1c9)},'return_data':{'$first':_0x3b1646(0x1e6)},'customers_docs':{'$first':_0x3b1646(0x16d)},'total_saleproduct_quantity':{'$sum':_0x3b1646(0x119)},'level':{'$addToSet':_0x3b1646(0x1a4)},'isle':{'$addToSet':_0x3b1646(0x171)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x3b1646(0x17e)},'finalize':{'$first':_0x3b1646(0x1da)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x5bb3f0=await sales[_0x3b1646(0x1f5)]([{'$lookup':{'from':'customers','localField':_0x3b1646(0x17b),'foreignField':_0x3b1646(0x152),'as':_0x3b1646(0x158)}},{'$unwind':_0x3b1646(0x16d)},{'$unwind':_0x3b1646(0x179)},{'$group':{'_id':'$_id','invoice':{'$first':_0x3b1646(0x1de)},'customers':{'$first':_0x3b1646(0x1dd)},'date':{'$first':_0x3b1646(0x145)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x3b1646(0x1c9)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x3b1646(0x16d)},'total_saleproduct_quantity':{'$sum':_0x3b1646(0x119)},'level':{'$addToSet':_0x3b1646(0x1a4)},'isle':{'$addToSet':_0x3b1646(0x171)},'type':{'$addToSet':_0x3b1646(0x1d6)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);console['log']('sales\x20all_data',_0x5bb3f0);if(_0x46b641[0x0][_0x3b1646(0x162)]==_0x3b1646(0x1b7)){var _0x57cc2b=users[_0x3b1646(0x1e5)];console[_0x3b1646(0x136)](_0x57cc2b);}else{if(_0x46b641[0x0]['language']==_0x3b1646(0x1d3))var _0x57cc2b=users[_0x3b1646(0x1d3)];else{if(_0x46b641[0x0][_0x3b1646(0x162)]==_0x3b1646(0x1aa))var _0x57cc2b=users[_0x3b1646(0x1aa)];else{if(_0x46b641[0x0][_0x3b1646(0x162)]==_0x3b1646(0x1f7))var _0x57cc2b=users[_0x3b1646(0x1f7)];else{if(_0x46b641[0x0][_0x3b1646(0x162)]=='French')var _0x57cc2b=users['French'];else{if(_0x46b641[0x0][_0x3b1646(0x162)]==_0x3b1646(0x122))var _0x57cc2b=users[_0x3b1646(0x203)];else{if(_0x46b641[0x0][_0x3b1646(0x162)]==_0x3b1646(0x188))var _0x57cc2b=users[_0x3b1646(0x188)];else{if(_0x46b641[0x0][_0x3b1646(0x162)]==_0x3b1646(0x147))var _0x57cc2b=users[_0x3b1646(0x1e7)];}}}}}}}_0x1134bd[_0x3b1646(0x1b3)](_0x3b1646(0x146),{'success':_0x1bd711[_0x3b1646(0x13c)](_0x3b1646(0x18f)),'errors':_0x1bd711['flash'](_0x3b1646(0x1c2)),'sales':_0x5bb3f0,'profile':_0x254075,'role':_0x1b0b10,'master_shop':_0x46b641,'language':_0x57cc2b});}catch(_0x4227e0){console[_0x3b1646(0x136)](_0x4227e0);}}),router[a0_0x3ba484(0x1e9)]('/view/add_sales',auth,async(_0x263b78,_0x42d16f)=>{var _0x38f386=a0_0x3ba484;try{const {username:_0x2af2ef,email:_0x2194e1,role:_0x2de4ca}=_0x263b78[_0x38f386(0x121)],_0x1b12ec=_0x263b78[_0x38f386(0x121)],_0x4d4f7d=await profile[_0x38f386(0x1ac)]({'email':_0x1b12ec[_0x38f386(0x141)]}),_0x53cad5=await master_shop['find'](),_0x2034a1=await customer['find']({});let _0x2d5797;if(_0x1b12ec[_0x38f386(0x1b1)]=='staff'){const _0x15f139=await staff[_0x38f386(0x1ac)]({'email':_0x1b12ec[_0x38f386(0x141)]});_0x2d5797=await warehouse[_0x38f386(0x1f5)]([{'$match':{'status':_0x38f386(0x10f),'name':_0x15f139['warehouse'],'warehouse_category':_0x38f386(0x1c1),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x38f386(0x18c),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);}else _0x2d5797=await warehouse[_0x38f386(0x1f5)]([{'$match':{'status':_0x38f386(0x10f),'warehouse_category':_0x38f386(0x1c1),'name':{'$ne':_0x38f386(0x1fa)}}},{'$group':{'_id':'$name','name':{'$first':_0x38f386(0x18c)}}},{'$sort':{'name':0x1}}]);const _0x288fa2=await product['find']({});var _0x36336c=[_0x38f386(0x19e),'Enclosed'];const _0x3295d5=await sales[_0x38f386(0x1d7)]({}),_0x250138=_0x3295d5[_0x38f386(0x13f)]+0x1,_0x1f7ce1=_0x38f386(0x115)+_0x250138[_0x38f386(0x1ec)]()[_0x38f386(0x191)](0x5,'0');if(_0x53cad5[0x0][_0x38f386(0x162)]==_0x38f386(0x1b7)){var _0x3f5aca=users[_0x38f386(0x1e5)];console[_0x38f386(0x136)](_0x3f5aca);}else{if(_0x53cad5[0x0]['language']=='Hindi')var _0x3f5aca=users['Hindi'];else{if(_0x53cad5[0x0][_0x38f386(0x162)]==_0x38f386(0x1aa))var _0x3f5aca=users[_0x38f386(0x1aa)];else{if(_0x53cad5[0x0][_0x38f386(0x162)]==_0x38f386(0x1f7))var _0x3f5aca=users[_0x38f386(0x1f7)];else{if(_0x53cad5[0x0][_0x38f386(0x162)]==_0x38f386(0x12f))var _0x3f5aca=users[_0x38f386(0x12f)];else{if(_0x53cad5[0x0][_0x38f386(0x162)]==_0x38f386(0x122))var _0x3f5aca=users[_0x38f386(0x203)];else{if(_0x53cad5[0x0][_0x38f386(0x162)]=='Chinese')var _0x3f5aca=users[_0x38f386(0x188)];else{if(_0x53cad5[0x0]['language']==_0x38f386(0x147))var _0x3f5aca=users[_0x38f386(0x1e7)];}}}}}}}_0x42d16f['render'](_0x38f386(0x19d),{'success':_0x263b78[_0x38f386(0x13c)](_0x38f386(0x18f)),'errors':_0x263b78['flash'](_0x38f386(0x1c2)),'role':_0x1b12ec,'profile':_0x4d4f7d,'customer':_0x2034a1,'warehouse':_0x2d5797,'product':_0x288fa2,'invoice':_0x1f7ce1,'master_shop':_0x53cad5,'language':_0x3f5aca,'rooms_data':_0x36336c});}catch(_0x54c603){console[_0x38f386(0x136)](_0x54c603);}}),router[a0_0x3ba484(0x1e9)](a0_0x3ba484(0x1b9),auth,async(_0xdd0d6c,_0x549d5b)=>{var _0x2270b0=a0_0x3ba484;try{const _0x3dd397=_0xdd0d6c[_0x2270b0(0x1e0)]['id'];console[_0x2270b0(0x136)](_0x3dd397);const _0xa3feb=await product[_0x2270b0(0x1d7)](),_0x165f9c=await purchases['aggregate']([{'$match':{'warehouse_name':_0x3dd397}},{'$unwind':'$product'},{'$group':{'_id':_0x2270b0(0x1d9)}}]);console[_0x2270b0(0x136)](_0x2270b0(0x1ae),_0x165f9c),_0x549d5b['status'](0xc8)[_0x2270b0(0x1cd)]({'purchases_data':_0x165f9c,'product_data':_0xa3feb});}catch(_0x2f5800){console[_0x2270b0(0x136)](_0x2f5800);}}),router[a0_0x3ba484(0x202)]('/view/add_sale/product',auth,async(_0x278375,_0xcba485)=>{var _0x4202c5=a0_0x3ba484;try{const {warehouse_data:_0x2958bc,product_data:_0x485edf}=_0x278375[_0x4202c5(0x192)];console[_0x4202c5(0x136)](_0x278375['body'][_0x4202c5(0x1ed)]);;const _0x4cbc6d=await master_shop[_0x4202c5(0x1d7)]();console['log']('master',_0x4cbc6d);const _0x353153=await product[_0x4202c5(0x1ac)]({'name':_0x485edf});console['log'](_0x4202c5(0x138),_0x353153);const _0x3b7411=await warehouse[_0x4202c5(0x1f5)]([{'$match':{'name':_0x2958bc}},{'$unwind':_0x4202c5(0x17d)},{'$match':{'product_details.product_name':_0x485edf}},{'$group':{'_id':_0x4202c5(0x1bf),'product_stock':{'$first':_0x4202c5(0x12a)}}}]);console[_0x4202c5(0x136)](_0x4202c5(0x15b),_0x3b7411),_0xcba485['status'](0xc8)[_0x4202c5(0x1cd)]({'master':_0x4cbc6d,'new_product':_0x353153,'stock_data':_0x3b7411});}catch(_0x3a39cf){console[_0x4202c5(0x136)](_0x3a39cf);}}),router[a0_0x3ba484(0x202)]('/view/add_sales',auth,async(_0x144451,_0x350738)=>{var _0x2db50a=a0_0x3ba484;try{const {invoice:_0xe9e2f4,date:_0x457057,warehouse_name:_0x348ade,product_name:_0x178e8b,stock:_0x2ca320,quantity:_0x2aeb8d,note:_0x30817c,room:_0x42adc4,primary_code:_0x3dda4a,secondary_code:_0x33e2f2,prod_code:_0xee135a,level:_0x11a02b,isle:_0x40ef3b,pallet:_0x391898,batch_code:_0x506638,SCRN:_0xb0a9ef,expiry_date:_0x23c2eb}=_0x144451['body'];if(typeof _0x178e8b=='string')var _0x3c9242=[_0x144451[_0x2db50a(0x192)]['product_name']],_0x3df228=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x1fb)]],_0x3bb658=[_0x144451['body'][_0x2db50a(0x12d)]],_0x3572d4=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x1c4)]],_0x27d8c6=[_0x144451[_0x2db50a(0x192)]['secondary_code']],_0x2ae476=[_0x144451[_0x2db50a(0x192)]['prod_code']],_0x1539d4=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x1f9)]],_0x3420cb=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x1ce)]],_0x489bbb=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x149)]],_0x4a3ba3=[_0x144451['body']['batch_code']],_0x4a8139=[_0x144451[_0x2db50a(0x192)]['expiry_date']],_0x2b2ddc=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x180)]],_0x3e5782=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x1a8)]],_0x2c3ea3=[_0x144451['body'][_0x2db50a(0x16b)]],_0x41a8fb=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x16a)]],_0x2fe5ea=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x11f)]],_0x5211a9=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x1d1)]],_0xabb78a=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x174)]],_0x4ba340=[_0x144451[_0x2db50a(0x192)][_0x2db50a(0x12e)]];else var _0x3c9242=[..._0x144451[_0x2db50a(0x192)]['product_name']],_0x3df228=[..._0x144451[_0x2db50a(0x192)]['stock']],_0x3bb658=[..._0x144451['body'][_0x2db50a(0x12d)]],_0x3572d4=[..._0x144451[_0x2db50a(0x192)][_0x2db50a(0x1c4)]],_0x27d8c6=[..._0x144451[_0x2db50a(0x192)]['secondary_code']],_0x2ae476=[..._0x144451[_0x2db50a(0x192)]['prod_code']],_0x1539d4=[..._0x144451['body'][_0x2db50a(0x1f9)]],_0x3420cb=[..._0x144451[_0x2db50a(0x192)][_0x2db50a(0x1ce)]],_0x489bbb=[..._0x144451[_0x2db50a(0x192)]['secondary_unit']],_0x4a3ba3=[..._0x144451[_0x2db50a(0x192)][_0x2db50a(0x1fd)]],_0x4a8139=[..._0x144451['body']['expiry_date']],_0x2b2ddc=[..._0x144451['body'][_0x2db50a(0x180)]],_0x3e5782=[..._0x144451[_0x2db50a(0x192)][_0x2db50a(0x1a8)]],_0x2c3ea3=[..._0x144451[_0x2db50a(0x192)][_0x2db50a(0x16b)]],_0x41a8fb=[..._0x144451[_0x2db50a(0x192)][_0x2db50a(0x16a)]],_0x2fe5ea=[..._0x144451[_0x2db50a(0x192)][_0x2db50a(0x11f)]],_0x5211a9=[..._0x144451['body']['prod_cat']],_0xabb78a=[..._0x144451['body'][_0x2db50a(0x174)]],_0x4ba340=[..._0x144451['body'][_0x2db50a(0x12e)]];const _0x26c78c=_0x3c9242[_0x2db50a(0x1d5)](_0x1c6434=>{return _0x1c6434={'product_name':_0x1c6434};});_0x3df228[_0x2db50a(0x118)]((_0x3345a1,_0x177b32)=>{var _0x3d5f45=_0x2db50a;_0x26c78c[_0x177b32][_0x3d5f45(0x1fb)]=_0x3345a1;}),_0x3bb658['forEach']((_0x52ac0e,_0xa49565)=>{_0x26c78c[_0xa49565]['quantity']=_0x52ac0e;}),_0x3572d4[_0x2db50a(0x118)]((_0x299c01,_0x522e71)=>{var _0x48a696=_0x2db50a;_0x26c78c[_0x522e71][_0x48a696(0x1c4)]=_0x299c01;}),_0x27d8c6[_0x2db50a(0x118)]((_0x2a3a41,_0x1db2db)=>{var _0x1cc65e=_0x2db50a;_0x26c78c[_0x1db2db][_0x1cc65e(0x1f6)]=_0x2a3a41;}),_0x2ae476[_0x2db50a(0x118)]((_0xaa9e77,_0xaeaecc)=>{var _0x28bc3a=_0x2db50a;_0x26c78c[_0xaeaecc][_0x28bc3a(0x16e)]=_0xaa9e77;}),_0x1539d4[_0x2db50a(0x118)]((_0x6d3e14,_0x12d48a)=>{var _0x4a2284=_0x2db50a;_0x4ba340[_0x4a2284(0x118)]((_0x2b69cd,_0x79e8c3)=>{var _0x41222a=_0x4a2284;if(_0x2b69cd==_0x41222a(0x153)&&_0x12d48a==_0x79e8c3){var _0x283348=_0x6d3e14[_0x41222a(0x190)](0x3);_0x26c78c[_0x12d48a][_0x41222a(0x15a)]=_0x6d3e14[0x0],_0x26c78c[_0x12d48a]['rack']=_0x6d3e14[0x1],_0x26c78c[_0x12d48a][_0x41222a(0x10c)]=0x0,_0x26c78c[_0x12d48a][_0x41222a(0x10e)]=0x0,_0x26c78c[_0x12d48a]['type']=_0x41222a(0x137),_0x26c78c[_0x12d48a]['floorlevel']=_0x283348;}else{if(_0x2b69cd==_0x41222a(0x185)&&_0x12d48a==_0x79e8c3){var _0x283348=_0x6d3e14[_0x41222a(0x190)](0x3);_0x26c78c[_0x12d48a][_0x41222a(0x15a)]=_0x6d3e14[0x0],_0x26c78c[_0x12d48a][_0x41222a(0x1a7)]=_0x6d3e14[0x1],_0x26c78c[_0x12d48a][_0x41222a(0x10c)]=0x0,_0x26c78c[_0x12d48a]['bin']=0x0,_0x26c78c[_0x12d48a][_0x41222a(0x15f)]=_0x41222a(0x137),_0x26c78c[_0x12d48a][_0x41222a(0x12b)]=_0x6d3e14[0x5];}else{if(_0x12d48a==_0x79e8c3){var _0x4ca169;if(_0x6d3e14[0x4]=='L')_0x4ca169='Level';else _0x6d3e14[0x4]=='F'&&(_0x4ca169=_0x41222a(0x137));_0x26c78c[_0x12d48a][_0x41222a(0x15a)]=_0x6d3e14[0x0],_0x26c78c[_0x12d48a][_0x41222a(0x1a7)]=_0x6d3e14[0x1],_0x26c78c[_0x12d48a][_0x41222a(0x10c)]=_0x6d3e14[0x2],_0x26c78c[_0x12d48a][_0x41222a(0x10e)]=_0x6d3e14[0x3],_0x26c78c[_0x12d48a][_0x41222a(0x15f)]=_0x4ca169,_0x26c78c[_0x12d48a][_0x41222a(0x12b)]=_0x6d3e14[0x5];}}}});}),_0x3420cb[_0x2db50a(0x118)]((_0x21cd74,_0x2c62b5)=>{var _0x516f7f=_0x2db50a;_0x26c78c[_0x2c62b5][_0x516f7f(0x1a1)]=_0x21cd74;}),_0x489bbb[_0x2db50a(0x118)]((_0x1a5465,_0x585e99)=>{var _0x558177=_0x2db50a;_0x26c78c[_0x585e99][_0x558177(0x149)]=_0x1a5465;}),_0x4a3ba3[_0x2db50a(0x118)]((_0x3ae5e8,_0xf14862)=>{var _0x21e88b=_0x2db50a;_0x26c78c[_0xf14862][_0x21e88b(0x1fd)]=_0x3ae5e8;}),_0x4a8139[_0x2db50a(0x118)]((_0x5c11a5,_0x2a7746)=>{var _0x872d3c=_0x2db50a;_0x26c78c[_0x2a7746][_0x872d3c(0x1ab)]=_0x5c11a5;}),_0x2b2ddc[_0x2db50a(0x118)]((_0x5f04a1,_0x1fccd5)=>{var _0x231dde=_0x2db50a;_0x26c78c[_0x1fccd5][_0x231dde(0x15c)]=_0x5f04a1;}),_0x3e5782['forEach']((_0x44e9c5,_0xae7900)=>{var _0xaae19b=_0x2db50a;_0x26c78c[_0xae7900][_0xaae19b(0x1a8)]=_0x44e9c5;}),_0x2c3ea3[_0x2db50a(0x118)]((_0x5b3fea,_0x1345e1)=>{var _0x6b2d8b=_0x2db50a;_0x26c78c[_0x1345e1][_0x6b2d8b(0x16b)]=_0x5b3fea;}),_0x41a8fb[_0x2db50a(0x118)]((_0x153596,_0x258614)=>{var _0x3c9c82=_0x2db50a;_0x26c78c[_0x258614][_0x3c9c82(0x16a)]=_0x153596;}),_0x2fe5ea['forEach']((_0x1f278b,_0x191e55)=>{var _0x3d7803=_0x2db50a;_0x26c78c[_0x191e55][_0x3d7803(0x11f)]=_0x1f278b;}),_0x5211a9['forEach']((_0x5633bf,_0x18e3db)=>{var _0x3c52cd=_0x2db50a;_0x26c78c[_0x18e3db][_0x3c52cd(0x1d1)]=_0x5633bf;}),_0xabb78a[_0x2db50a(0x118)]((_0x5a3e9f,_0x32ecdd)=>{var _0x21c5b7=_0x2db50a;_0x26c78c[_0x32ecdd][_0x21c5b7(0x17a)]=_0x5a3e9f;}),_0x4ba340['forEach']((_0x3d3793,_0x562814)=>{var _0x451038=_0x2db50a;_0x26c78c[_0x562814][_0x451038(0x132)]=_0x3d3793;});var _0x1f62fd=0x0;_0x26c78c[_0x2db50a(0x118)](_0x36204a=>{var _0x56b939=_0x2db50a;(_0x36204a[_0x56b939(0x1fb)]<_0x36204a[_0x56b939(0x17a)]||_0x36204a[_0x56b939(0x17a)]==0x0)&&(console['log']('foreach\x20newproduct',_0x36204a),_0x1f62fd++);});const _0x13847f=_0x26c78c[_0x2db50a(0x14f)](_0x5cf155=>_0x5cf155[_0x2db50a(0x174)]!=='0'&&_0x5cf155[_0x2db50a(0x174)]!==''),_0x203f6a=new sales({'invoice':_0xe9e2f4,'customer':_0x144451[_0x2db50a(0x192)][_0x2db50a(0x17b)],'date':_0x457057,'warehouse_name':_0x348ade,'sale_product':_0x13847f,'note':_0x30817c,'room':_0x42adc4,'primary_code':_0x3dda4a,'secondary_code':_0x33e2f2,'prod_code':_0xee135a,'SCRN':_0xb0a9ef}),_0x64c599=await _0x203f6a[_0x2db50a(0x1ba)]();_0x144451[_0x2db50a(0x13c)](_0x2db50a(0x18f),'Sales\x20Add\x20successfully'),_0x350738[_0x2db50a(0x154)]('/all_sales/preview/'+_0x64c599['_id']);}catch(_0x25d120){console['log'](_0x25d120);}}),router['get'](a0_0x3ba484(0x19c),auth,async(_0x1965ac,_0x3f6ac2)=>{var _0x15f0d3=a0_0x3ba484;try{const {username:_0x40f46d,email:_0x1d5b31,role:_0x244f27}=_0x1965ac[_0x15f0d3(0x121)],_0x17c0b9=_0x1965ac[_0x15f0d3(0x121)],_0xea6aef=await profile[_0x15f0d3(0x1ac)]({'email':_0x17c0b9[_0x15f0d3(0x141)]}),_0x424d52=await master_shop[_0x15f0d3(0x1d7)](),_0x290a79=_0x1965ac[_0x15f0d3(0x1e0)]['id'],_0x4b98e5=await sales[_0x15f0d3(0x15e)](_0x290a79),_0x686920=await warehouse[_0x15f0d3(0x1f5)]([{'$match':{'name':_0x4b98e5[_0x15f0d3(0x16f)]}},{'$unwind':_0x15f0d3(0x17d)},{'$group':{'_id':_0x15f0d3(0x1ee),'name':{'$first':_0x15f0d3(0x1bf)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x15f0d3(0x135)},'bin':{'$first':_0x15f0d3(0x1f2)},'type':{'$first':_0x15f0d3(0x175)},'floorlevel':{'$first':_0x15f0d3(0x1e4)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x15f0d3(0x1af)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x15f0d3(0x1bc)},'rack':{'$first':_0x15f0d3(0x131)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'}}}]),_0x4edb16=await customer['find']({});let _0xf9b45e;if(_0x17c0b9[_0x15f0d3(0x1b1)]==_0x15f0d3(0x169)){const _0x1425bb=await staff[_0x15f0d3(0x1ac)]({'email':_0x17c0b9[_0x15f0d3(0x141)]});_0xf9b45e=await warehouse[_0x15f0d3(0x1f5)]([{'$match':{'status':_0x15f0d3(0x10f),'name':_0x1425bb[_0x15f0d3(0x1cc)]}},{'$group':{'_id':'$name','name':{'$first':_0x15f0d3(0x18c)}}}]);}else _0xf9b45e=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':'$name','name':{'$first':_0x15f0d3(0x18c)}}}]);const _0x111712=await product[_0x15f0d3(0x1d7)]({}),_0x226e88=await suppliers[_0x15f0d3(0x1d7)]({});if(_0x424d52[0x0][_0x15f0d3(0x162)]==_0x15f0d3(0x1b7)){var _0x2984ed=users[_0x15f0d3(0x1e5)];console[_0x15f0d3(0x136)](_0x2984ed);}else{if(_0x424d52[0x0][_0x15f0d3(0x162)]==_0x15f0d3(0x1d3))var _0x2984ed=users[_0x15f0d3(0x1d3)];else{if(_0x424d52[0x0][_0x15f0d3(0x162)]==_0x15f0d3(0x1aa))var _0x2984ed=users[_0x15f0d3(0x1aa)];else{if(_0x424d52[0x0]['language']==_0x15f0d3(0x1f7))var _0x2984ed=users['Spanish'];else{if(_0x424d52[0x0]['language']==_0x15f0d3(0x12f))var _0x2984ed=users[_0x15f0d3(0x12f)];else{if(_0x424d52[0x0][_0x15f0d3(0x162)]==_0x15f0d3(0x122))var _0x2984ed=users[_0x15f0d3(0x203)];else{if(_0x424d52[0x0][_0x15f0d3(0x162)]==_0x15f0d3(0x188))var _0x2984ed=users[_0x15f0d3(0x188)];else{if(_0x424d52[0x0][_0x15f0d3(0x162)]==_0x15f0d3(0x147))var _0x2984ed=users[_0x15f0d3(0x1e7)];}}}}}}}_0x3f6ac2['render']('edit_sales_view',{'success':_0x1965ac[_0x15f0d3(0x13c)]('success'),'errors':_0x1965ac[_0x15f0d3(0x13c)](_0x15f0d3(0x1c2)),'role':_0x17c0b9,'profile':_0xea6aef,'customer':_0x4edb16,'warehouse':_0xf9b45e,'product':_0x686920,'user':_0x4b98e5,'master_shop':_0x424d52,'unit':_0x111712,'language':_0x2984ed,'suppliers':_0x226e88});}catch(_0x231f30){console[_0x15f0d3(0x136)](_0x231f30);}}),router[a0_0x3ba484(0x202)](a0_0x3ba484(0x19c),auth,async(_0x567395,_0x4e34d5)=>{var _0x4c94aa=a0_0x3ba484;try{const _0x1555fb=_0x567395[_0x4c94aa(0x1e0)]['id'],{invoice:_0x402afe,warehouse_name:_0x5e762f,room:_0x4a46a8}=_0x567395['body'],_0x3630e1=await sales[_0x4c94aa(0x1ac)]({'invoice':_0x402afe}),_0x10c0e1=_0x3630e1[_0x4c94aa(0x1cb)]['map'](async _0x1af69f=>{var _0x582a5b=_0x4c94aa,_0x3c8c67=await warehouse[_0x582a5b(0x1ac)]({'name':_0x5e762f,'room':_0x1af69f['room_name'],'warehouse_category':_0x582a5b(0x1c1)});const _0x1ab078=_0x3c8c67['product_details'][_0x582a5b(0x1d5)](_0x54b6b2=>{var _0xf2b4ce=_0x582a5b;_0x54b6b2['product_name']==_0x1af69f[_0xf2b4ce(0x110)]&&_0x54b6b2['floorlevel']==_0x1af69f['floorlevel']&&_0x54b6b2['type']==_0x1af69f['type']&&_0x54b6b2[_0xf2b4ce(0x10e)]==_0x1af69f[_0xf2b4ce(0x10e)]&&_0x54b6b2['bay']==_0x1af69f['bay']&&_0x54b6b2[_0xf2b4ce(0x1a7)]==_0x1af69f['rack']&&_0x54b6b2[_0xf2b4ce(0x15a)]==_0x1af69f[_0xf2b4ce(0x15a)]&&_0x54b6b2[_0xf2b4ce(0x1ab)]==_0x1af69f[_0xf2b4ce(0x1ab)]&&_0x54b6b2[_0xf2b4ce(0x1fd)]==_0x1af69f[_0xf2b4ce(0x1fd)]&&(_0x54b6b2[_0xf2b4ce(0x182)]=_0x54b6b2[_0xf2b4ce(0x182)]-_0x1af69f[_0xf2b4ce(0x174)]);});return _0x3c8c67;});Promise[_0x4c94aa(0x168)](_0x10c0e1)['then'](async _0x10e343=>{var _0x4cbbea=_0x4c94aa;try{for(const _0x1e0d91 of _0x10e343){await _0x1e0d91['save']();}_0x3630e1[_0x4cbbea(0x130)]=_0x4cbbea(0x12c);const _0x3120d8=await _0x3630e1[_0x4cbbea(0x1ba)]();_0x567395[_0x4cbbea(0x13c)](_0x4cbbea(0x18f),_0x4cbbea(0x163)),_0x4e34d5[_0x4cbbea(0x154)](_0x4cbbea(0x18b)+_0x1555fb);}catch(_0x9e1fa1){console[_0x4cbbea(0x1ad)](_0x9e1fa1),_0x4e34d5[_0x4cbbea(0x126)](0x1f4)[_0x4cbbea(0x1cd)]({'error':_0x4cbbea(0x17c)});}})[_0x4c94aa(0x18a)](_0x2bf30b=>{var _0x35b012=_0x4c94aa;console[_0x35b012(0x1ad)](_0x2bf30b),_0x4e34d5['status'](0x1f4)[_0x35b012(0x1cd)]({'error':'An\x20error\x20occurred.'});});}catch(_0x1b4455){console[_0x4c94aa(0x136)](_0x1b4455);}}),router['get'](a0_0x3ba484(0x166),auth,async(_0x29b71e,_0x113e5e)=>{var _0x235964=a0_0x3ba484;try{const {username:_0x28c8fc,email:_0x4e5b97,role:_0x21fef5}=_0x29b71e[_0x235964(0x121)],_0x398d23=_0x29b71e[_0x235964(0x121)],_0x2d439f=await profile[_0x235964(0x1ac)]({'email':_0x398d23['email']}),_0x59daae=await master_shop[_0x235964(0x1d7)](),_0x403e15=_0x29b71e[_0x235964(0x1e0)]['id'],_0x3e1464=await sales[_0x235964(0x15e)](_0x403e15);let _0x35f435=new Date(_0x3e1464[_0x235964(0x1ab)]),_0x1a27b8=('0'+_0x35f435[_0x235964(0x197)]())[_0x235964(0x190)](-0x2),_0x2e5c1e=('0'+(_0x35f435[_0x235964(0x124)]()+0x1))[_0x235964(0x190)](-0x2),_0x387a60=_0x35f435[_0x235964(0x1f4)](),_0x59df70=_0x387a60+'-'+_0x2e5c1e+'-'+_0x1a27b8;var _0x122cdb=[_0x235964(0x19e),_0x235964(0x201)];const _0x315dfb=await warehouse[_0x235964(0x1f5)]([{'$match':{'name':_0x3e1464[_0x235964(0x16f)],'room':_0x3e1464[_0x235964(0x134)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':_0x235964(0x17d)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x235964(0x12a)},'bay':{'$first':_0x235964(0x135)},'bin':{'$first':_0x235964(0x1f2)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x235964(0x131)}}}]),_0x102bf2=await customer[_0x235964(0x1d7)]({});let _0x12cecb;if(_0x398d23[_0x235964(0x1b1)]==_0x235964(0x169)){const _0x55423a=await staff[_0x235964(0x1ac)]({'email':_0x398d23['email']});_0x12cecb=await warehouse[_0x235964(0x1f5)]([{'$match':{'status':_0x235964(0x10f),'name':_0x55423a[_0x235964(0x1cc)],'warehouse_category':_0x235964(0x1c1)}},{'$group':{'_id':_0x235964(0x18c),'name':{'$first':_0x235964(0x18c)}}}]);}else _0x12cecb=await warehouse[_0x235964(0x1f5)]([{'$match':{'status':_0x235964(0x10f),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);const _0xe32538=await product[_0x235964(0x1d7)]({});if(_0x59daae[0x0]['language']==_0x235964(0x1b7)){var _0x5e62fd=users[_0x235964(0x1e5)];console[_0x235964(0x136)](_0x5e62fd);}else{if(_0x59daae[0x0][_0x235964(0x162)]==_0x235964(0x1d3))var _0x5e62fd=users[_0x235964(0x1d3)];else{if(_0x59daae[0x0][_0x235964(0x162)]=='German')var _0x5e62fd=users[_0x235964(0x1aa)];else{if(_0x59daae[0x0][_0x235964(0x162)]==_0x235964(0x1f7))var _0x5e62fd=users[_0x235964(0x1f7)];else{if(_0x59daae[0x0][_0x235964(0x162)]=='French')var _0x5e62fd=users['French'];else{if(_0x59daae[0x0]['language']==_0x235964(0x122))var _0x5e62fd=users['Portuguese'];else{if(_0x59daae[0x0][_0x235964(0x162)]==_0x235964(0x188))var _0x5e62fd=users[_0x235964(0x188)];else{if(_0x59daae[0x0][_0x235964(0x162)]==_0x235964(0x147))var _0x5e62fd=users['Arabic'];}}}}}}}_0x113e5e[_0x235964(0x1b3)]('edit_sales',{'success':_0x29b71e[_0x235964(0x13c)](_0x235964(0x18f)),'errors':_0x29b71e[_0x235964(0x13c)](_0x235964(0x1c2)),'role':_0x398d23,'profile':_0x2d439f,'customer':_0x102bf2,'warehouse':_0x12cecb,'product':_0x315dfb,'user':_0x3e1464,'master_shop':_0x59daae,'unit':_0xe32538,'language':_0x5e62fd,'rooms_data':_0x122cdb,'ed_fullDate':_0x59df70});}catch(_0x543a7d){console['log'](_0x543a7d);}}),router['post'](a0_0x3ba484(0x166),auth,async(_0x35f269,_0x49e3d8)=>{var _0x54bb20=a0_0x3ba484;try{const _0x215edb=_0x35f269[_0x54bb20(0x1e0)]['id'],_0x212930=await sales[_0x54bb20(0x1ac)]({'_id':_0x35f269[_0x54bb20(0x1e0)]['id']}),_0x448961=await warehouse['findOne']({'name':_0x212930[_0x54bb20(0x16f)],'room':_0x35f269['body'][_0x54bb20(0x134)]}),{invoice:_0x5a01f0,customer:_0x236828,date:_0x1abd8c,warehouse_name:_0x208c57,product_name:_0x7fc373,stock:_0x6eab54,adjust_qty:_0x91c458,note:_0x464285,room:_0x274ed8,primary_code:_0x2bb008,secondary_code:_0x60bc59,prod_code:_0x235377,level:_0x28f633,isle:_0x52e796,pallet:_0x58c2b4,expiry_date:_0x315ab8}=_0x35f269['body'];if(typeof _0x7fc373==_0x54bb20(0x1ea))var _0x2d953b=[_0x35f269[_0x54bb20(0x192)][_0x54bb20(0x110)]],_0x42800d=[_0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1fb)]],_0x22593f=[_0x35f269['body'][_0x54bb20(0x1bb)]],_0x4c1fae=[_0x35f269['body'][_0x54bb20(0x1c4)]],_0x1ce650=[_0x35f269[_0x54bb20(0x192)]['secondary_code']],_0x1e8111=[_0x35f269['body'][_0x54bb20(0x1d0)]],_0x182228=[_0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1f9)]],_0x1412e5=[_0x35f269[_0x54bb20(0x192)][_0x54bb20(0x193)]],_0x1386fc=[_0x35f269[_0x54bb20(0x192)]['pallet']],_0x35d796=[_0x35f269['body']['expiry_date']],_0x4aaa51=[_0x35f269['body']['storage']],_0x4f5eea=[_0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1a6)]],_0x33214d=[_0x35f269['body'][_0x54bb20(0x15f)]];else var _0x2d953b=[..._0x35f269[_0x54bb20(0x192)][_0x54bb20(0x110)]],_0x42800d=[..._0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1fb)]],_0x22593f=[..._0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1bb)]],_0x4c1fae=[..._0x35f269['body'][_0x54bb20(0x1c4)]],_0x1ce650=[..._0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1f6)]],_0x1e8111=[..._0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1d0)]],_0x182228=[..._0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1f9)]],_0x1412e5=[..._0x35f269['body'][_0x54bb20(0x193)]],_0x1386fc=[..._0x35f269['body'][_0x54bb20(0x195)]],_0x35d796=[..._0x35f269[_0x54bb20(0x192)]['expiry_date']],_0x4aaa51=[..._0x35f269['body'][_0x54bb20(0x15a)]],_0x4f5eea=[..._0x35f269[_0x54bb20(0x192)][_0x54bb20(0x1a6)]],_0x33214d=[..._0x35f269[_0x54bb20(0x192)]['type']];const _0x259869=_0x2d953b[_0x54bb20(0x1d5)](_0x1030b1=>{return _0x1030b1={'product_name':_0x1030b1};});_0x42800d[_0x54bb20(0x118)]((_0x2d9511,_0x4dc0a8)=>{var _0x29c95e=_0x54bb20;_0x259869[_0x4dc0a8][_0x29c95e(0x1fb)]=_0x2d9511;}),_0x22593f[_0x54bb20(0x118)]((_0x4c5426,_0x493894)=>{var _0x56e9cc=_0x54bb20;_0x259869[_0x493894][_0x56e9cc(0x174)]=_0x4c5426;}),_0x4c1fae[_0x54bb20(0x118)]((_0x3868ed,_0x1cb107)=>{var _0x3c257a=_0x54bb20;_0x259869[_0x1cb107][_0x3c257a(0x1c4)]=_0x3868ed;}),_0x1ce650[_0x54bb20(0x118)]((_0x3e4e6e,_0x18d901)=>{var _0x2ea09a=_0x54bb20;_0x259869[_0x18d901][_0x2ea09a(0x1f6)]=_0x3e4e6e;}),_0x1e8111[_0x54bb20(0x118)]((_0x169ce0,_0x5845a9)=>{var _0x55599b=_0x54bb20;_0x259869[_0x5845a9][_0x55599b(0x16e)]=_0x169ce0;}),_0x182228[_0x54bb20(0x118)]((_0x1244e8,_0x525d68)=>{_0x259869[_0x525d68]['bay']=_0x1244e8;}),_0x1412e5['forEach']((_0x1b0852,_0x48bc73)=>{var _0x49506f=_0x54bb20;_0x259869[_0x48bc73][_0x49506f(0x10e)]=_0x1b0852;}),_0x1386fc['forEach']((_0x4030ce,_0x27df92)=>{_0x259869[_0x27df92]['floorlevel']=_0x4030ce;}),_0x35d796[_0x54bb20(0x118)]((_0x4edcad,_0x38e51a)=>{_0x259869[_0x38e51a]['expiry_date']=_0x4edcad;}),_0x33214d[_0x54bb20(0x118)]((_0x584ddb,_0x2a4729)=>{var _0x10aef1=_0x54bb20;_0x259869[_0x2a4729][_0x10aef1(0x15f)]=_0x584ddb;}),_0x4aaa51[_0x54bb20(0x118)]((_0x577055,_0x477af2)=>{var _0x4ded5a=_0x54bb20;_0x259869[_0x477af2][_0x4ded5a(0x15a)]=_0x577055;}),_0x4f5eea['forEach']((_0x56699f,_0x2e7276)=>{var _0x364341=_0x54bb20;_0x259869[_0x2e7276][_0x364341(0x1a7)]=_0x56699f;});var _0x504407=0x0;_0x259869[_0x54bb20(0x118)](_0x3dc1cb=>{var _0xba7b16=_0x54bb20;console[_0xba7b16(0x136)](_0xba7b16(0x11a),_0x3dc1cb),(parseInt(_0x3dc1cb[_0xba7b16(0x1fb)])<parseInt(_0x3dc1cb[_0xba7b16(0x174)])||parseInt(_0x3dc1cb[_0xba7b16(0x174)])==0x0)&&_0x504407++;});if(_0x504407!=0x0)return _0x35f269[_0x54bb20(0x13c)]('errors',_0x54bb20(0x143)),_0x49e3d8[_0x54bb20(0x154)](_0x54bb20(0x1ef));_0x212930[_0x54bb20(0x1cb)]['forEach'](_0x4bb4c7=>{var _0x29239c=_0x54bb20;const _0xdf8d32=_0x448961[_0x29239c(0x14c)][_0x29239c(0x1d5)](_0xe62903=>{var _0x45b351=_0x29239c;_0xe62903[_0x45b351(0x110)]==_0x4bb4c7['product_name']&&_0xe62903[_0x45b351(0x12b)]==_0x4bb4c7['floorlevel']&&_0xe62903[_0x45b351(0x15f)]==_0x4bb4c7['type']&&_0xe62903[_0x45b351(0x10e)]==_0x4bb4c7[_0x45b351(0x10e)]&&_0xe62903['bay']==_0x4bb4c7[_0x45b351(0x10c)]&&(_0xe62903[_0x45b351(0x182)]=parseInt(_0xe62903[_0x45b351(0x182)])+parseInt(_0x4bb4c7[_0x45b351(0x174)]));});}),console[_0x54bb20(0x136)](_0x54bb20(0x1bd),_0x448961),await _0x448961['save']();const _0x35f05d=_0x259869[_0x54bb20(0x14f)](_0x3a1929=>_0x3a1929[_0x54bb20(0x174)]!=='0'&&_0x3a1929['quantity']!=='');_0x212930[_0x54bb20(0x18e)]=_0x5a01f0,_0x212930[_0x54bb20(0x17b)]=_0x236828,_0x212930[_0x54bb20(0x19a)]=_0x1abd8c,_0x212930[_0x54bb20(0x16f)]=_0x208c57,_0x212930[_0x54bb20(0x1cb)]=_0x35f05d,_0x212930[_0x54bb20(0x177)]=_0x464285,_0x212930[_0x54bb20(0x134)]=_0x274ed8;const _0x52f9c3=await _0x212930[_0x54bb20(0x1ba)](),_0x3234c3=await sales[_0x54bb20(0x1ac)]({'_id':_0x35f269[_0x54bb20(0x1e0)]['id']}),_0x1c80b8=await warehouse[_0x54bb20(0x1ac)]({'name':_0x208c57,'room':_0x274ed8});_0x3234c3[_0x54bb20(0x1cb)]['forEach'](_0x14c906=>{var _0x10bbf3=_0x54bb20;const _0x4cb007=_0x1c80b8[_0x10bbf3(0x14c)][_0x10bbf3(0x1d5)](_0x18d182=>{var _0x29ef27=_0x10bbf3;_0x18d182['product_name']==_0x14c906[_0x29ef27(0x110)]&&_0x18d182[_0x29ef27(0x12b)]==_0x14c906[_0x29ef27(0x12b)]&&_0x18d182[_0x29ef27(0x15f)]==_0x14c906[_0x29ef27(0x15f)]&&_0x18d182[_0x29ef27(0x10e)]==_0x14c906[_0x29ef27(0x10e)]&&_0x18d182['bay']==_0x14c906[_0x29ef27(0x10c)]&&(_0x18d182['product_stock']=parseInt(_0x18d182[_0x29ef27(0x182)])-parseInt(_0x14c906[_0x29ef27(0x174)]));});}),console[_0x54bb20(0x136)]('final',_0x1c80b8),await _0x1c80b8[_0x54bb20(0x1ba)]();const _0x53fc45=await c_payment_data[_0x54bb20(0x1ac)]({'invoice':_0x35f269['body'][_0x54bb20(0x18e)]});_0x53fc45[_0x54bb20(0x1d2)]=_0x35f269['body'][_0x54bb20(0x1d2)],await _0x53fc45[_0x54bb20(0x1ba)](),_0x35f269[_0x54bb20(0x13c)](_0x54bb20(0x18f),_0x54bb20(0x163)),_0x49e3d8[_0x54bb20(0x154)](_0x54bb20(0x189));}catch(_0x14a453){console['log'](_0x14a453);}}),router[a0_0x3ba484(0x202)](a0_0x3ba484(0x160),auth,async(_0x3ab674,_0x7f7527)=>{var _0x16319b=a0_0x3ba484;try{const _0x530df8=_0x3ab674[_0x16319b(0x1e0)]['id'],{invoice:_0x5987bb,customer:_0x20ea27,receivable_amount:_0x5bd4cd,received_amount:_0x4a89cf}=_0x3ab674['body'],_0x13d08e=await sales[_0x16319b(0x15e)](_0x530df8);console[_0x16319b(0x136)](_0x13d08e);var _0x3ec009=_0x5bd4cd-_0x4a89cf;console[_0x16319b(0x136)](_0x4a89cf),_0x13d08e[_0x16319b(0x1a9)]=parseFloat(_0x4a89cf)+parseFloat(_0x13d08e['received_amount']),_0x13d08e[_0x16319b(0x1e3)]=_0x3ec009,console[_0x16319b(0x136)](_0x13d08e);const _0x195b1e=await _0x13d08e[_0x16319b(0x1ba)](),_0x5b8c77=await c_payment_data[_0x16319b(0x1ac)]({'invoice':_0x5987bb});_0x5b8c77[_0x16319b(0x113)]=_0x3ec009,await _0x5b8c77[_0x16319b(0x1ba)]();let _0x3efa8f=new Date(),_0x374807=('0'+_0x3efa8f['getDate']())[_0x16319b(0x190)](-0x2),_0x467872=('0'+(_0x3efa8f[_0x16319b(0x124)]()+0x1))[_0x16319b(0x190)](-0x2),_0x471845=_0x3efa8f[_0x16319b(0x1f4)](),_0x31c2d1=_0x471845+'-'+_0x467872+'-'+_0x374807;const _0x110b5f=new customer_payment({'invoice':_0x5987bb,'date':_0x471845+'-'+_0x467872+'-'+_0x374807,'customer':_0x20ea27,'reason':'Received\x20Payment\x20For\x20Sale','amount':_0x4a89cf}),_0x1cc558=await _0x110b5f[_0x16319b(0x1ba)]();_0x3ab674[_0x16319b(0x13c)](_0x16319b(0x18f),'payment\x20successfull'),_0x7f7527[_0x16319b(0x154)](_0x16319b(0x189));}catch(_0x476f51){console[_0x16319b(0x136)](_0x476f51);}}),router[a0_0x3ba484(0x1e9)]('/invoice/:id',auth,async(_0x4cc986,_0x36158e)=>{var _0x2370dc=a0_0x3ba484;try{const {username:_0x2fb1f8,email:_0x1db6e9,role:_0x4922c8}=_0x4cc986['user'],_0x527178=_0x4cc986[_0x2370dc(0x121)],_0x567cc4=await profile[_0x2370dc(0x1ac)]({'email':_0x527178[_0x2370dc(0x141)]}),_0x462a5f=await master_shop[_0x2370dc(0x1d7)]();console['log'](_0x2370dc(0x183),_0x462a5f);const _0x20b0eb=_0x4cc986[_0x2370dc(0x1e0)]['id'],_0x209a9a=await sales['findById'](_0x20b0eb);console[_0x2370dc(0x136)](_0x209a9a);const _0x3c6079=await customer[_0x2370dc(0x1ac)]({'name':_0x209a9a['customer']});console[_0x2370dc(0x136)](_0x3c6079);if(_0x462a5f[0x0][_0x2370dc(0x162)]==_0x2370dc(0x1b7)){var _0x587b25=users[_0x2370dc(0x1e5)];console[_0x2370dc(0x136)](_0x587b25);}else{if(_0x462a5f[0x0][_0x2370dc(0x162)]==_0x2370dc(0x1d3))var _0x587b25=users['Hindi'];else{if(_0x462a5f[0x0]['language']==_0x2370dc(0x1aa))var _0x587b25=users[_0x2370dc(0x1aa)];else{if(_0x462a5f[0x0]['language']==_0x2370dc(0x1f7))var _0x587b25=users[_0x2370dc(0x1f7)];else{if(_0x462a5f[0x0][_0x2370dc(0x162)]==_0x2370dc(0x12f))var _0x587b25=users[_0x2370dc(0x12f)];else{if(_0x462a5f[0x0][_0x2370dc(0x162)]==_0x2370dc(0x122))var _0x587b25=users[_0x2370dc(0x203)];else{if(_0x462a5f[0x0][_0x2370dc(0x162)]==_0x2370dc(0x188))var _0x587b25=users['Chinese'];else{if(_0x462a5f[0x0][_0x2370dc(0x162)]==_0x2370dc(0x147))var _0x587b25=users[_0x2370dc(0x1e7)];}}}}}}}_0x36158e[_0x2370dc(0x1b3)]('sales_invoice',{'success':_0x4cc986[_0x2370dc(0x13c)](_0x2370dc(0x18f)),'errors':_0x4cc986[_0x2370dc(0x13c)](_0x2370dc(0x1c2)),'role':_0x527178,'profile':_0x567cc4,'master_shop':_0x462a5f,'customers':_0x3c6079,'sales':_0x209a9a,'language':_0x587b25});}catch(_0xca2e2c){console[_0x2370dc(0x136)](_0xca2e2c);}}),router['get'](a0_0x3ba484(0x111),auth,async(_0x341412,_0x4d583a)=>{var _0x3a82f5=a0_0x3ba484;try{const {username:_0x154d1c,email:_0x5d0487,role:_0x29dcc8}=_0x341412['user'],_0x13d483=_0x341412['user'],_0xc889d0=await profile['findOne']({'email':_0x13d483[_0x3a82f5(0x141)]}),_0x1f9efb=await master_shop[_0x3a82f5(0x1d7)]();console[_0x3a82f5(0x136)](_0x3a82f5(0x183),_0x1f9efb);const _0xda36bf=_0x341412[_0x3a82f5(0x1e0)]['id'];console[_0x3a82f5(0x136)](_0xda36bf);const _0x519bd5=await sales[_0x3a82f5(0x15e)](_0xda36bf);console[_0x3a82f5(0x136)](_0x3a82f5(0x156),_0x519bd5);const _0xac9731=await warehouse[_0x3a82f5(0x1f5)]([{'$match':{'name':_0x3a82f5(0x1fa),'room':'Return\x20Rooms'}},{'$unwind':_0x3a82f5(0x17d)},{'$group':{'_id':_0x3a82f5(0x1ee),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x3a82f5(0x1a0)},'isle':{'$first':_0x3a82f5(0x117)},'pallet':{'$first':'$product_details.pallet'},'primary_code':{'$first':_0x3a82f5(0x112)},'secondary_code':{'$first':_0x3a82f5(0x1af)},'product_code':{'$first':'$product_details.product_code'}}}]);console[_0x3a82f5(0x136)](_0x3a82f5(0x15b),_0xac9731);const _0x2aa88b=await product[_0x3a82f5(0x1d7)]({});warehouse_data=await warehouse['aggregate']([{'$match':{'status':_0x3a82f5(0x10f),'name':_0x3a82f5(0x1fa),'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3a82f5(0x18c),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);var _0x179972=[_0x3a82f5(0x1c3)];if(_0x1f9efb[0x0][_0x3a82f5(0x162)]==_0x3a82f5(0x1b7)){var _0x18b15b=users[_0x3a82f5(0x1e5)];console[_0x3a82f5(0x136)](_0x18b15b);}else{if(_0x1f9efb[0x0][_0x3a82f5(0x162)]=='Hindi')var _0x18b15b=users[_0x3a82f5(0x1d3)];else{if(_0x1f9efb[0x0][_0x3a82f5(0x162)]=='German')var _0x18b15b=users['German'];else{if(_0x1f9efb[0x0][_0x3a82f5(0x162)]==_0x3a82f5(0x1f7))var _0x18b15b=users[_0x3a82f5(0x1f7)];else{if(_0x1f9efb[0x0][_0x3a82f5(0x162)]==_0x3a82f5(0x12f))var _0x18b15b=users[_0x3a82f5(0x12f)];else{if(_0x1f9efb[0x0][_0x3a82f5(0x162)]==_0x3a82f5(0x122))var _0x18b15b=users[_0x3a82f5(0x203)];else{if(_0x1f9efb[0x0][_0x3a82f5(0x162)]=='Chinese')var _0x18b15b=users[_0x3a82f5(0x188)];else{if(_0x1f9efb[0x0][_0x3a82f5(0x162)]=='Arabic\x20(ae)')var _0x18b15b=users[_0x3a82f5(0x1e7)];}}}}}}}_0x4d583a[_0x3a82f5(0x1b3)]('return_sale',{'success':_0x341412['flash']('success'),'errors':_0x341412[_0x3a82f5(0x13c)](_0x3a82f5(0x1c2)),'role':_0x13d483,'profile':_0xc889d0,'user':_0x519bd5,'stock':_0xac9731,'master_shop':_0x1f9efb,'unit':_0x2aa88b,'language':_0x18b15b,'warehouses':warehouse_data,'rooms':_0x179972});}catch(_0x1b0f35){console['log'](_0x1b0f35),_0x4d583a[_0x3a82f5(0x126)](0xc8)[_0x3a82f5(0x1cd)]({'message':_0x1b0f35[_0x3a82f5(0x194)]});}}),router['post'](a0_0x3ba484(0x111),auth,async(_0x69456a,_0x50a43b)=>{var _0x1a5552=a0_0x3ba484;try{const {invoice:_0x5584c8,date:_0x4e1247,warehouse_name:_0x1432cd,product_name:_0xf84c2b,primary_code:_0x37ac05,secondary_code:_0x29cd6f,product_code:_0x223296,sales_quantity:_0x3c3daa,stocks:_0x2eb73b,return_qty:_0x11145b,Room_name:_0xf41eaf,to_warehouse_name:_0x4f9708,to_Roomname:_0x2e77eb,to_Room_name:_0x2594ab,note:_0x57f756,level:_0x3d7f5d,isle:_0x41abaf,pallet:_0x5c44c0}=_0x69456a['body'];if(typeof _0xf84c2b==_0x1a5552(0x1ea))var _0x3a8070=[_0x69456a['body'][_0x1a5552(0x110)]],_0x356f80=[_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x1c4)]],_0x464d41=[_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x1f6)]],_0x187e52=[_0x69456a[_0x1a5552(0x192)]['product_code']],_0x53aad9=[_0x69456a[_0x1a5552(0x192)]['sales_quantity']],_0x59d92a=[_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x150)]],_0x46beed=[_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x1c5)]],_0x3d3033=[_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x10c)]],_0x211caa=[_0x69456a['body']['bin']],_0x2cd7af=[_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x173)]],_0xf6af76=[_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x12b)]];else var _0x3a8070=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x110)]],_0x356f80=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x1c4)]],_0x464d41=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x1f6)]],_0x187e52=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x16e)]],_0x53aad9=[..._0x69456a['body']['sales_quantity']],_0x59d92a=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x150)]],_0x46beed=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x1c5)]],_0x3d3033=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x10c)]],_0x211caa=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x10e)]],_0x2cd7af=[..._0x69456a[_0x1a5552(0x192)][_0x1a5552(0x173)]],_0xf6af76=[..._0x69456a[_0x1a5552(0x192)]['floorlevel']];const _0x22295c=_0x3a8070[_0x1a5552(0x1d5)](_0x1b633a=>{return _0x1b633a={'product_name':_0x1b633a};});_0x356f80[_0x1a5552(0x118)]((_0x1863e9,_0x3123db)=>{var _0x2b2159=_0x1a5552;_0x22295c[_0x3123db][_0x2b2159(0x1c4)]=_0x1863e9;}),_0x464d41[_0x1a5552(0x118)]((_0x3b3620,_0x1b853d)=>{var _0xb88e48=_0x1a5552;_0x22295c[_0x1b853d][_0xb88e48(0x1f6)]=_0x3b3620;}),_0x187e52[_0x1a5552(0x118)]((_0x2803af,_0x170629)=>{var _0x1655c1=_0x1a5552;_0x22295c[_0x170629][_0x1655c1(0x16e)]=_0x2803af;}),_0x53aad9[_0x1a5552(0x118)]((_0x215c7d,_0xce984c)=>{var _0x2db02f=_0x1a5552;_0x22295c[_0xce984c][_0x2db02f(0x164)]=_0x215c7d;}),_0x59d92a['forEach']((_0x47e6d,_0x117dc4)=>{var _0x20d16e=_0x1a5552;_0x22295c[_0x117dc4][_0x20d16e(0x1fb)]=_0x47e6d;}),_0x46beed[_0x1a5552(0x118)]((_0x531f1d,_0x23710d)=>{var _0x45d0e7=_0x1a5552;_0x22295c[_0x23710d][_0x45d0e7(0x1c5)]=_0x531f1d;}),_0x3d3033[_0x1a5552(0x118)]((_0x5313a7,_0xcfd3eb)=>{var _0x1d05d5=_0x1a5552;_0x22295c[_0xcfd3eb][_0x1d05d5(0x10c)]=_0x5313a7;}),_0x211caa['forEach']((_0x3089a7,_0x54abb8)=>{_0x22295c[_0x54abb8]['bin']=_0x3089a7;}),_0x2cd7af[_0x1a5552(0x118)]((_0x59c4a7,_0x401bd7)=>{_0x22295c[_0x401bd7]['type']=_0x59c4a7;}),_0xf6af76[_0x1a5552(0x118)]((_0x230038,_0x431546)=>{var _0x263246=_0x1a5552;_0x22295c[_0x431546][_0x263246(0x12b)]=_0x230038;});var _0x1df02e=0x0;_0x22295c['forEach'](_0x3034ed=>{var _0x465b06=_0x1a5552;console[_0x465b06(0x136)](_0x465b06(0x11a),_0x3034ed),(parseInt(_0x3034ed[_0x465b06(0x164)])<parseInt(_0x3034ed[_0x465b06(0x1c5)])||parseInt(_0x3034ed['stock'])<parseInt(_0x3034ed[_0x465b06(0x1c5)])&&parseInt(_0x3034ed[_0x465b06(0x164)])>parseInt(_0x3034ed[_0x465b06(0x1c5)])||parseInt(_0x3034ed[_0x465b06(0x1c5)])==0x0)&&_0x1df02e++;});if(_0x1df02e!=0x0)return _0x69456a[_0x1a5552(0x13c)](_0x1a5552(0x1c2),_0x1a5552(0x13e)),_0x50a43b[_0x1a5552(0x154)]('back');const _0x246c21=await sales['findOne']({'invoice':_0x5584c8});console[_0x1a5552(0x136)](_0x246c21),_0x246c21[_0x1a5552(0x161)]=_0x1a5552(0x12c);const _0x469c65=await _0x246c21[_0x1a5552(0x1ba)](),_0x5d1e63=new sales_return({'invoice':_0x5584c8,'customer':_0x69456a['body']['customer'],'date':_0x4e1247,'warehouse_name':_0x1432cd,'room':_0xf41eaf,'ToWarehouse':_0x4f9708,'ToRoom':_0x2594ab,'return_sale':_0x22295c,'note':_0x57f756}),_0x178eb9=await _0x5d1e63['save']();console[_0x1a5552(0x136)](_0x5d1e63);const _0x8960b1=await sales_return[_0x1a5552(0x1ac)]({'invoice':_0x5584c8}),_0x1637a4=await warehouse['findOne']({'name':_0x4f9708,'room':_0x2594ab});_0x8960b1[_0x1a5552(0x1f0)][_0x1a5552(0x118)](_0x21224b=>{var _0x5600d0=_0x1a5552,_0x1a2964=0x0;const _0x1b13c9=_0x1637a4[_0x5600d0(0x14c)][_0x5600d0(0x1d5)](_0x157322=>{var _0x3b4e00=_0x5600d0;_0x157322[_0x3b4e00(0x110)]==_0x21224b[_0x3b4e00(0x110)]&&_0x157322['floorlevel']==_0x21224b[_0x3b4e00(0x12b)]&&_0x157322[_0x3b4e00(0x15f)]==_0x21224b[_0x3b4e00(0x15f)]&&_0x157322['bin']==_0x21224b[_0x3b4e00(0x10e)]&&_0x157322[_0x3b4e00(0x10c)]==_0x21224b[_0x3b4e00(0x10c)]&&(_0x157322['product_stock']=parseInt(_0x157322['product_stock'])+parseInt(_0x21224b[_0x3b4e00(0x1c5)]),_0x1a2964++);});_0x1a2964=='0'&&(_0x1637a4['product_details']=_0x1637a4[_0x5600d0(0x14c)][_0x5600d0(0x19f)]({'product_name':_0x21224b[_0x5600d0(0x110)],'product_stock':_0x21224b[_0x5600d0(0x1c5)],'primary_code':_0x21224b[_0x5600d0(0x1c4)],'secondary_code':_0x21224b[_0x5600d0(0x1f6)],'product_code':_0x21224b['product_code'],'bay':_0x21224b['bay'],'bin':_0x21224b[_0x5600d0(0x10e)],'type':_0x21224b[_0x5600d0(0x15f)],'floorlevel':_0x21224b['floorlevel']})),console[_0x5600d0(0x136)](_0x5600d0(0x16c),_0x1637a4);}),await _0x1637a4[_0x1a5552(0x1ba)](),console[_0x1a5552(0x136)](_0x69456a['body']);const _0x4f4687=new c_payment_data({'invoice':_0x5584c8,'customer':_0x69456a['body']['customer'],'reason':_0x1a5552(0x1c8)});await _0x4f4687['save']();const _0x516668=await master_shop[_0x1a5552(0x1d7)]();console['log'](_0x1a5552(0x196),_0x516668[0x0][_0x1a5552(0x181)]);const _0x15729b=await email_settings[_0x1a5552(0x1ac)](),_0x10dede=await customer['findOne']({'name':_0x69456a[_0x1a5552(0x192)][_0x1a5552(0x17b)]});console[_0x1a5552(0x136)](_0x1a5552(0x123),_0x10dede);_0x516668[0x0][_0x1a5552(0x187)]==0x1?(right_currency=_0x516668[0x0][_0x1a5552(0x1c0)],left_currency=''):(right_currency='',left_currency=_0x516668[0x0][_0x1a5552(0x1c0)]);var _0x483684=_0x3a8070,_0x3a2a15=_0x46beed,_0x519169='',_0x4e02bc;for(_0x4e02bc in _0x483684){_0x519169+=_0x1a5552(0x1ca)+_0x1a5552(0x14d)+_0x483684[_0x4e02bc]+'</td>'+_0x1a5552(0x14d)+_0x3a2a15[_0x4e02bc]+_0x1a5552(0x1a2)+_0x1a5552(0x139);}console[_0x1a5552(0x136)]('product_list',_0x519169);let _0x377d3b=nodemailer[_0x1a5552(0x165)]({'service':_0x1a5552(0x184),'auth':{'user':_0x15729b[_0x1a5552(0x141)],'pass':_0x15729b['password']}}),_0x2abe1a={'from':_0x15729b[_0x1a5552(0x141)],'to':_0x10dede[_0x1a5552(0x141)],'subject':_0x1a5552(0x200),'attachments':[{'filename':_0x1a5552(0x14b),'path':__dirname+_0x1a5552(0x198)+_0x1a5552(0x148)+_0x516668[0x0]['image'],'cid':_0x1a5552(0x172)}],'html':_0x1a5552(0x10d)+_0x1a5552(0x17f)+_0x1a5552(0x199)+_0x1a5552(0x176)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x1a5552(0x176)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+'</div>'+_0x1a5552(0x176)+_0x1a5552(0x186)+_0x516668[0x0]['site_title']+_0x1a5552(0x170)+_0x1a5552(0x127)+_0x1a5552(0x127)+_0x1a5552(0x1eb)+'<div>'+_0x1a5552(0x125)+'\x20Order\x20Number\x20:\x20'+_0x5584c8+'\x20'+_0x1a5552(0x1fc)+_0x1a5552(0x144)+_0x4e1247+'\x20'+_0x1a5552(0x11d)+_0x1a5552(0x1b6)+_0x1a5552(0x127)+_0x1a5552(0x11e)+_0x1a5552(0x15d)+_0x1a5552(0x1ca)+_0x1a5552(0x11b)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x1a5552(0x178)+_0x1a5552(0x116)+_0x1a5552(0x139)+_0x1a5552(0x1d4)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x519169+'\x20'+_0x1a5552(0x1e1)+_0x1a5552(0x1c6)+_0x1a5552(0x176)+_0x1a5552(0x120)+_0x1a5552(0x1dc)+_0x516668[0x0][_0x1a5552(0x133)]+'</h5>'+_0x1a5552(0x127)+_0x1a5552(0x127)+_0x1a5552(0x1e8)};_0x377d3b[_0x1a5552(0x13a)](_0x2abe1a,function(_0xb6b8c3,_0x115ddd){var _0x3d44b9=_0x1a5552;_0xb6b8c3?(console[_0x3d44b9(0x136)](_0xb6b8c3),console['log'](_0x3d44b9(0x1d8))):console[_0x3d44b9(0x136)](_0x3d44b9(0x142));}),_0x69456a[_0x1a5552(0x13c)](_0x1a5552(0x18f),_0x1a5552(0x14a)),_0x50a43b[_0x1a5552(0x154)](_0x1a5552(0x189));}catch(_0x232c0d){console[_0x1a5552(0x136)](_0x232c0d),_0x50a43b['status'](0xc8)[_0x1a5552(0x1cd)]({'message1':_0x232c0d[_0x1a5552(0x194)]});}}),router[a0_0x3ba484(0x1e9)]('/barcode/:id',auth,async(_0x383440,_0x42c733)=>{var _0x3e1b4e=a0_0x3ba484;try{const {username:_0x1ba1e1,email:_0x526183,role:_0x28cac9}=_0x383440['user'],_0x477506=_0x383440[_0x3e1b4e(0x121)],_0x598188=await profile[_0x3e1b4e(0x1ac)]({'email':_0x477506[_0x3e1b4e(0x141)]}),_0x1f116d=await master_shop['find']();console[_0x3e1b4e(0x136)](_0x3e1b4e(0x11c),_0x1f116d);const _0x9a5624=_0x383440['params']['id'],_0x41c830=await sales[_0x3e1b4e(0x15e)](_0x9a5624);console['log']('barcode\x20user_id',_0x41c830);if(_0x1f116d[0x0]['language']=='English\x20(US)')var _0x354d1b=users[_0x3e1b4e(0x1e5)];else{if(_0x1f116d[0x0][_0x3e1b4e(0x162)]==_0x3e1b4e(0x1d3))var _0x354d1b=users[_0x3e1b4e(0x1d3)];else{if(_0x1f116d[0x0][_0x3e1b4e(0x162)]==_0x3e1b4e(0x1aa))var _0x354d1b=users[_0x3e1b4e(0x1aa)];else{if(_0x1f116d[0x0][_0x3e1b4e(0x162)]==_0x3e1b4e(0x1f7))var _0x354d1b=users[_0x3e1b4e(0x1f7)];else{if(_0x1f116d[0x0][_0x3e1b4e(0x162)]=='French')var _0x354d1b=users[_0x3e1b4e(0x12f)];else{if(_0x1f116d[0x0][_0x3e1b4e(0x162)]=='Portuguese\x20(BR)')var _0x354d1b=users[_0x3e1b4e(0x203)];else{if(_0x1f116d[0x0][_0x3e1b4e(0x162)]==_0x3e1b4e(0x188))var _0x354d1b=users[_0x3e1b4e(0x188)];else{if(_0x1f116d[0x0]['language']==_0x3e1b4e(0x147))var _0x354d1b=users[_0x3e1b4e(0x1e7)];}}}}}}}_0x42c733['render'](_0x3e1b4e(0x1f1),{'success':_0x383440[_0x3e1b4e(0x13c)](_0x3e1b4e(0x18f)),'errors':_0x383440[_0x3e1b4e(0x13c)](_0x3e1b4e(0x1c2)),'role':_0x477506,'profile':_0x598188,'alldata':_0x41c830,'master_shop':_0x1f116d,'language':_0x354d1b});}catch(_0x415f2b){console[_0x3e1b4e(0x136)](_0x415f2b);}}),router[a0_0x3ba484(0x202)](a0_0x3ba484(0x13b),async(_0x2a7857,_0x2513f4)=>{var _0x1e4d06=a0_0x3ba484;const {product_code:_0x1c041a,warehouse_name:_0x69245e,rooms_data:_0x2808e7,Roomslist:_0x735f37}=_0x2a7857[_0x1e4d06(0x192)],_0x7e59c0=_0x735f37[_0x1e4d06(0x1cf)](','),_0x53c21b=[];async function _0x37b6ad(_0x64bac5){var _0x53d4ca=_0x1e4d06;const _0x1be41d=await warehouse[_0x53d4ca(0x1f5)]([{'$match':{'name':_0x69245e,'room':_0x64bac5}},{'$unwind':_0x53d4ca(0x17d)},{'$match':{'product_details.primary_code':_0x1c041a}},{'$group':{'_id':_0x53d4ca(0x1ee),'name':{'$first':_0x53d4ca(0x1bf)},'product_stock':{'$first':_0x53d4ca(0x12a)},'primary_code':{'$first':_0x53d4ca(0x112)},'secondary_code':{'$first':_0x53d4ca(0x1af)},'product_code':{'$first':_0x53d4ca(0x157)},'level':{'$first':_0x53d4ca(0x135)},'isle':{'$first':_0x53d4ca(0x1f2)},'type':{'$first':_0x53d4ca(0x175)},'pallet':{'$first':_0x53d4ca(0x1e4)},'unit':{'$first':_0x53d4ca(0x1be)},'secondary_unit':{'$first':_0x53d4ca(0x1b0)},'storage':{'$first':_0x53d4ca(0x1bc)},'rack':{'$first':_0x53d4ca(0x131)},'expiry_date':{'$first':_0x53d4ca(0x114)},'production_date':{'$first':_0x53d4ca(0x167)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x53d4ca(0x129)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x53d4ca(0x140)}}}]),_0xd2f314=await warehouse[_0x53d4ca(0x1f5)]([{'$match':{'name':_0x69245e,'room':_0x64bac5}},{'$unwind':_0x53d4ca(0x17d)},{'$match':{'product_details.secondary_code':_0x1c041a}},{'$group':{'_id':_0x53d4ca(0x1ee),'name':{'$first':_0x53d4ca(0x1bf)},'product_stock':{'$first':_0x53d4ca(0x12a)},'primary_code':{'$first':_0x53d4ca(0x112)},'secondary_code':{'$first':_0x53d4ca(0x1af)},'product_code':{'$first':_0x53d4ca(0x157)},'level':{'$first':_0x53d4ca(0x135)},'isle':{'$first':_0x53d4ca(0x1f2)},'type':{'$first':_0x53d4ca(0x175)},'pallet':{'$first':_0x53d4ca(0x1e4)},'unit':{'$first':_0x53d4ca(0x1be)},'secondary_unit':{'$first':_0x53d4ca(0x1b0)},'storage':{'$first':_0x53d4ca(0x1bc)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x53d4ca(0x167)},'maxPerUnit':{'$first':_0x53d4ca(0x1a5)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x53d4ca(0x1e2)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x53d4ca(0x140)}}}]);if(_0x1be41d[_0x53d4ca(0x13f)]>0x0)_0x53c21b[_0x53d4ca(0x1b5)](_0x1be41d);else _0xd2f314[_0x53d4ca(0x13f)]>0x0&&_0x53c21b['push'](_0xd2f314);}const _0x29e679=_0x7e59c0[_0x1e4d06(0x1d5)](_0x57521e=>_0x37b6ad(_0x57521e));await Promise[_0x1e4d06(0x168)](_0x29e679),_0x2513f4[_0x1e4d06(0x1cd)](_0x53c21b);}),module['exports']=router;function a0_0x4833(_0x56c779,_0x1bcfa2){var _0x44eed3=a0_0x44ee();return a0_0x4833=function(_0x483321,_0x21561b){_0x483321=_0x483321-0x10c;var _0x116bf6=_0x44eed3[_0x483321];return _0x116bf6;},a0_0x4833(_0x56c779,_0x1bcfa2);}function a0_0x44ee(){var _0x2c5b18=['quantity','$product_details.type','<div>','note','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','$sale_product','quantity_notConverted','customer','An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details','$sale_product.floorlevel','<html><head><title></title>','max_per_unit','image','product_stock','master','gmail','Shelves','<h2>\x20','currency_placement','Chinese','/all_sales/view','catch','/all_sales/preview/','$name','../models/all_models','invoice','success','slice','padStart','body','isle','message','pallet','add\x20post','getDate','/../public','</head><body>','date','8WiWfju','/preview/:id','add_sales','Ambient','concat','$product_details.level','unit','</td>','299558kFnVqX','$sale_product.bay','$product_details.maxPerUnit','rak','rack','production_date','received_amount','German','expiry_date','findOne','error','purchases_data','$product_details.secondary_code','$product_details.secondary_unit','role','../middleware/auth','render','1872290upzUaa','push','</h5>','English\x20(US)','/view','/view/add_sales/:id','save','adjust_qty','$product_details.storage','old_warehouse_data','$product_details.unit','$product_details.product_name','currency','Raw\x20Materials','errors','Return\x20Rooms','primary_code','return_qty','</table>','$_id','Sale\x20Return','$note','<tr>','sale_product','warehouse','json','primary_unit','split','prod_code','prod_cat','suppliers','Hindi','</thead>','map','$sale_product.type','find','Error\x20Occurs','$product.product_name','$finalize','273730sDHfys','<h5>','$customer','$invoice','Router','params','</tbody>','$product_details.product_cat','due_amount','$product_details.floorlevel','English','$return_data','Arabic','</body></html>','get','string','<hr\x20class=\x22my-3\x22>','toString','product_data','$product_details._id','back','return_sale','all_sales_barcode','$product_details.bin','553188zGuLWA','getFullYear','aggregate','secondary_code','Spanish','3rTgdOY','level','Return\x20Goods','stock','<span\x20style=\x22float:\x20right;\x22>','batch_code','../public/language/languages.json','express','Sale\x20Return\x20Mail','Enclosed','post','Portuguese','bay','<!DOCTYPE\x20html>','bin','Enabled','product_name','/view/return_sales/:id','$product_details.primary_code','amount','$product_details.expiry_date','OUT-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$product_details.isle','forEach','$sale_product.quantity','foreach\x20newproduct','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','barcode\x20Product\x20master','</span>','<table\x20style=\x22width:\x20100%\x20!important;\x22>','delivery_code','<strong>\x20Regards\x20</strong>','user','Portuguese\x20(BR)','customer_data','getMonth','<h5\x20style=\x22text-align:\x20left;\x22>','status','</div>','10859319tAlFNX','$product_details.batch_code','$product_details.product_stock','floorlevel','True','carton','RoomAssigned','French','finalize','$product_details.rack','room_name','site_title','room','$product_details.bay','log','Floor','product','</tr>','sendMail','/barcode_scanner','flash','$warehouse_name','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','length','$room','email','Email\x20sent\x20successfully','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','\x20Order\x20Date\x20:\x20','$date','all_sales','Arabic\x20(ae)','/upload/','secondary_unit','sales\x20item\x20return\x20successfull','Logo.png','product_details','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','861168QMcGOG','filter','stocks','nodemailer','name','Receiving\x20Area','redirect','987560RmHZBD','user_id','$product_details.product_code','customers_docs','10mvpUMK','storage','stock_data','maxperunit','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','findById','type','/give_payment/:id','return_data','language','Sales\x20Update\x20successfully','sale_qty','createTransport','/view/:id','$product_details.production_date','all','staff','delivery_date','requested_qty','final','$customers_docs','product_code','warehouse_name','\x20</h2>','$sale_product.bin','logo','types'];a0_0x44ee=function(){return _0x2c5b18;};return a0_0x44ee();}