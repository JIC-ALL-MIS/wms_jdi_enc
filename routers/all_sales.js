function a0_0x5580(){var _0x39f863=['email','$note','/all_sales/view','Arabic\x20(ae)','errors','product_data','33206800sDPqgd','Hindi','suppliers','log','exports','return_qty','French','type','$customer','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','length','$product_details.floorlevel','RoomAssigned','secondary_unit','sale_qty','Sale\x20Return\x20Mail','<hr\x20class=\x22my-3\x22>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','user_id','$product.product_name','push','requested_qty','440JHKZkS','then','product_details','586236irfhSR','Arabic','adjust_qty','$name','$room','error','\x20Order\x20Date\x20:\x20','barcode\x20Product\x20master','$product_details.bay','/view/add_sales','English\x20(US)','currency','Portuguese\x20(BR)','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','$_id','quantity_notConverted','$product_details.expiry_date','$date','$product_details.rack','/view/:id','flash','/barcode_scanner','$warehouse_name','add_sales','floorlevel','product','/view/add_sale/product','\x20Order\x20Number\x20:\x20','/give_payment/:id','An\x20error\x20occurred\x20while\x20saving\x20data.','string','$sale_product.bay','Receiving\x20Area','password','primary_unit','$product_details.product_name','$product_details.bin','$product_details.secondary_code','level','note','amount','$product_details.unit','customer_data','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','stock_data','save','role','stock','$customers_docs','sales_invoice','</span>','date','warehouse_name','Floor','getFullYear','Logo.png','product_stock','slice','stocks','sales\x20item\x20return\x20successfull','99459tZcLWE','back','gmail','Spanish','params','Received\x20Payment\x20For\x20Sale','received_amount','../middleware/auth','expiry_date','logo','246NzPxRq','findOne','old_warehouse_data','$sale_product','Portuguese','/upload/','/view/return_sales/:id','delivery_date','master','$product_details.product_stock','prod_code','sale_product','$invoice','status','all_sales','foreach\x20newproduct','message','language','Raw\x20Materials','$finalize','</tr>','delivery_code','toString','get','$product_details.type','$sale_product.bin','carton','$sale_product.floorlevel','4799179vEaMTh','padStart','</table>','user','production_date','success','</thead>','types','An\x20error\x20occurred.','quantity','customers_docs','Router','json','15wEYsXL','pallet','$product_details.storage','final','bin','Return\x20Goods','/preview/:id','403312pzOebG','rak','storage','Sale\x20Return','Shelves','$product_details.product_cat','batch_code','isle','$product_details.production_date','$product_details.pallet','$product_details.level','<tr>','$product_details.isle','product_name','forEach','split','Level','find','due_amount','image','concat','/view','express','body','room_name','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','createTransport','$return_data','sales_quantity','$product_details.batch_code','secondary_code','$sale_product.type','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','</h5>','customer','$sale_product.quantity','return_sale','$product_details','Sales\x20Update\x20successfully','$product_details.product_code','$product_details.primary_code','redirect','getDate','primary_code','/all_sales/preview/','<div>','prod_cat','/barcode/:id','\x20</h2>','English','warehouse','Email\x20sent\x20successfully','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Error\x20Occurs','staff','../public/language/languages.json','Ambient','43221JNoKjr','True','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','room','site_title','payment\x20successfull','findById','product_code','bay','$product_details.maxPerUnit','German','$product_details._id','getMonth','all_sales_barcode','Enclosed','/invoice/:id','Chinese','2187908Btttyy','post','render','map','customers','finalize','Enabled','/../public','catch','<!DOCTYPE\x20html>','</div>','<h2>\x20','max_per_unit','filter','../models/all_models','aggregate','rack','<h5\x20style=\x22text-align:\x20left;\x22>','name','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'];a0_0x5580=function(){return _0x39f863;};return a0_0x5580();}var a0_0x38a7d7=a0_0x5f18;(function(_0x20c21a,_0x1d8579){var _0x86c90a=a0_0x5f18,_0x4ca619=_0x20c21a();while(!![]){try{var _0xbd49e1=-parseInt(_0x86c90a(0x244))/0x1+-parseInt(_0x86c90a(0x214))/0x2*(parseInt(_0x86c90a(0x18a))/0x3)+-parseInt(_0x86c90a(0x19b))/0x4+-parseInt(_0x86c90a(0x23d))/0x5*(-parseInt(_0x86c90a(0x1ce))/0x6)+parseInt(_0x86c90a(0x230))/0x7+parseInt(_0x86c90a(0x1cb))/0x8*(-parseInt(_0x86c90a(0x20a))/0x9)+parseInt(_0x86c90a(0x1b5))/0xa;if(_0xbd49e1===_0x1d8579)break;else _0x4ca619['push'](_0x4ca619['shift']());}catch(_0x58eb9b){_0x4ca619['push'](_0x4ca619['shift']());}}}(a0_0x5580,0xeca18));function a0_0x5f18(_0x2993e7,_0x15a3a3){var _0x558084=a0_0x5580();return a0_0x5f18=function(_0x5f18d2,_0x331529){_0x5f18d2=_0x5f18d2-0x16b;var _0x14eda2=_0x558084[_0x5f18d2];return _0x14eda2;},a0_0x5f18(_0x2993e7,_0x15a3a3);}const express=require(a0_0x38a7d7(0x25a)),app=express(),router=express[a0_0x38a7d7(0x23b)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings}=require(a0_0x38a7d7(0x1a9)),auth=require(a0_0x38a7d7(0x211)),nodemailer=require('nodemailer'),users=require(a0_0x38a7d7(0x188));router[a0_0x38a7d7(0x22b)](a0_0x38a7d7(0x259),auth,async(_0x1f7de6,_0x3dd8b4)=>{var _0x3fb6c8=a0_0x38a7d7;try{const {username:_0x2fe4f4,email:_0x1c9a95,role:_0x53c04d}=_0x1f7de6[_0x3fb6c8(0x233)],_0x51018d=_0x1f7de6['user'],_0x47a0a9=await profile['findOne']({'email':_0x51018d[_0x3fb6c8(0x1af)]}),_0x556158=await master_shop[_0x3fb6c8(0x255)]();let _0x423c1d;if(_0x51018d[_0x3fb6c8(0x1fc)]=='staff'){const _0x1d64f8=await staff['findOne']({'email':_0x51018d['email']});_0x423c1d=await sales['aggregate']([{'$lookup':{'from':_0x3fb6c8(0x19f),'localField':'customer','foreignField':_0x3fb6c8(0x1ad),'as':_0x3fb6c8(0x23a)}},{'$unwind':'$customers_docs'},{'$unwind':_0x3fb6c8(0x217)},{'$group':{'_id':_0x3fb6c8(0x1dc),'invoice':{'$first':_0x3fb6c8(0x220)},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x3fb6c8(0x1e4)},'sale_product':{'$push':_0x3fb6c8(0x217)},'note':{'$first':'$note'},'return_data':{'$first':_0x3fb6c8(0x16c)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':'$sale_product.quantity'},'level':{'$addToSet':_0x3fb6c8(0x1ed)},'isle':{'$addToSet':_0x3fb6c8(0x22d)},'type':{'$addToSet':'$sale_product.type'},'pallet':{'$addToSet':_0x3fb6c8(0x22f)},'finalize':{'$first':_0x3fb6c8(0x227)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x423c1d=await sales[_0x3fb6c8(0x1aa)]([{'$lookup':{'from':_0x3fb6c8(0x19f),'localField':'customer','foreignField':_0x3fb6c8(0x1ad),'as':_0x3fb6c8(0x23a)}},{'$unwind':_0x3fb6c8(0x1fe)},{'$unwind':'$sale_product'},{'$group':{'_id':'$_id','invoice':{'$first':_0x3fb6c8(0x220)},'customers':{'$first':_0x3fb6c8(0x1bd)},'date':{'$first':_0x3fb6c8(0x1df)},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':_0x3fb6c8(0x217)},'note':{'$first':_0x3fb6c8(0x1b0)},'return_data':{'$first':_0x3fb6c8(0x16c)},'customers_docs':{'$first':_0x3fb6c8(0x1fe)},'total_saleproduct_quantity':{'$sum':_0x3fb6c8(0x174)},'level':{'$addToSet':'$sale_product.bay'},'isle':{'$addToSet':_0x3fb6c8(0x22d)},'type':{'$addToSet':_0x3fb6c8(0x170)},'pallet':{'$addToSet':'$sale_product.floorlevel'},'finalize':{'$first':_0x3fb6c8(0x227)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);console[_0x3fb6c8(0x1b8)]('sales\x20all_data',_0x423c1d);if(_0x556158[0x0][_0x3fb6c8(0x225)]=='English\x20(US)'){var _0x4f52f1=users['English'];console[_0x3fb6c8(0x1b8)](_0x4f52f1);}else{if(_0x556158[0x0][_0x3fb6c8(0x225)]==_0x3fb6c8(0x1b6))var _0x4f52f1=users[_0x3fb6c8(0x1b6)];else{if(_0x556158[0x0][_0x3fb6c8(0x225)]==_0x3fb6c8(0x194))var _0x4f52f1=users[_0x3fb6c8(0x194)];else{if(_0x556158[0x0]['language']=='Spanish')var _0x4f52f1=users[_0x3fb6c8(0x20d)];else{if(_0x556158[0x0]['language']=='French')var _0x4f52f1=users['French'];else{if(_0x556158[0x0][_0x3fb6c8(0x225)]=='Portuguese\x20(BR)')var _0x4f52f1=users[_0x3fb6c8(0x218)];else{if(_0x556158[0x0]['language']==_0x3fb6c8(0x19a))var _0x4f52f1=users['Chinese'];else{if(_0x556158[0x0][_0x3fb6c8(0x225)]==_0x3fb6c8(0x1b2))var _0x4f52f1=users[_0x3fb6c8(0x1cf)];}}}}}}}_0x3dd8b4['render'](_0x3fb6c8(0x222),{'success':_0x1f7de6['flash'](_0x3fb6c8(0x235)),'errors':_0x1f7de6[_0x3fb6c8(0x1e2)](_0x3fb6c8(0x1b3)),'sales':_0x423c1d,'profile':_0x47a0a9,'role':_0x51018d,'master_shop':_0x556158,'language':_0x4f52f1});}catch(_0x3109a5){console[_0x3fb6c8(0x1b8)](_0x3109a5);}}),router[a0_0x38a7d7(0x22b)](a0_0x38a7d7(0x1d7),auth,async(_0xb57817,_0x4eb5a0)=>{var _0xc36f77=a0_0x38a7d7;try{const {username:_0xfe813,email:_0x1b9fe7,role:_0x4b1b17}=_0xb57817[_0xc36f77(0x233)],_0x4d9700=_0xb57817[_0xc36f77(0x233)],_0x5d8952=await profile[_0xc36f77(0x215)]({'email':_0x4d9700[_0xc36f77(0x1af)]}),_0x5746d7=await master_shop[_0xc36f77(0x255)](),_0x4b3510=await customer['find']({});let _0x5b6039;if(_0x4d9700['role']==_0xc36f77(0x187)){const _0x646e56=await staff[_0xc36f77(0x215)]({'email':_0x4d9700[_0xc36f77(0x1af)]});_0x5b6039=await warehouse[_0xc36f77(0x1aa)]([{'$match':{'status':_0xc36f77(0x1a1),'name':_0x646e56[_0xc36f77(0x183)],'warehouse_category':_0xc36f77(0x226),'name':{'$ne':_0xc36f77(0x242)}}},{'$group':{'_id':_0xc36f77(0x1d1),'name':{'$first':_0xc36f77(0x1d1)}}},{'$sort':{'name':0x1}}]);}else _0x5b6039=await warehouse[_0xc36f77(0x1aa)]([{'$match':{'status':_0xc36f77(0x1a1),'warehouse_category':'Raw\x20Materials','name':{'$ne':_0xc36f77(0x242)}}},{'$group':{'_id':_0xc36f77(0x1d1),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x46072b=await product[_0xc36f77(0x255)]({});var _0x3c6a06=[_0xc36f77(0x189),_0xc36f77(0x198)];const _0x21b9f5=await sales[_0xc36f77(0x255)]({}),_0x4a1217=_0x21b9f5[_0xc36f77(0x1bf)]+0x1,_0x1d0621='OUT-'+_0x4a1217[_0xc36f77(0x22a)]()[_0xc36f77(0x231)](0x5,'0');if(_0x5746d7[0x0]['language']=='English\x20(US)'){var _0x3c9668=users[_0xc36f77(0x182)];console[_0xc36f77(0x1b8)](_0x3c9668);}else{if(_0x5746d7[0x0]['language']=='Hindi')var _0x3c9668=users[_0xc36f77(0x1b6)];else{if(_0x5746d7[0x0]['language']==_0xc36f77(0x194))var _0x3c9668=users[_0xc36f77(0x194)];else{if(_0x5746d7[0x0][_0xc36f77(0x225)]==_0xc36f77(0x20d))var _0x3c9668=users[_0xc36f77(0x20d)];else{if(_0x5746d7[0x0]['language']=='French')var _0x3c9668=users['French'];else{if(_0x5746d7[0x0][_0xc36f77(0x225)]==_0xc36f77(0x1da))var _0x3c9668=users[_0xc36f77(0x218)];else{if(_0x5746d7[0x0]['language']==_0xc36f77(0x19a))var _0x3c9668=users[_0xc36f77(0x19a)];else{if(_0x5746d7[0x0][_0xc36f77(0x225)]=='Arabic\x20(ae)')var _0x3c9668=users[_0xc36f77(0x1cf)];}}}}}}}_0x4eb5a0[_0xc36f77(0x19d)](_0xc36f77(0x1e5),{'success':_0xb57817[_0xc36f77(0x1e2)]('success'),'errors':_0xb57817[_0xc36f77(0x1e2)](_0xc36f77(0x1b3)),'role':_0x4d9700,'profile':_0x5d8952,'customer':_0x4b3510,'warehouse':_0x5b6039,'product':_0x46072b,'invoice':_0x1d0621,'master_shop':_0x5746d7,'language':_0x3c9668,'rooms_data':_0x3c6a06});}catch(_0x450afe){console['log'](_0x450afe);}}),router[a0_0x38a7d7(0x22b)]('/view/add_sales/:id',auth,async(_0x22ab0f,_0x20b746)=>{var _0xfbdbd6=a0_0x38a7d7;try{const _0x39444d=_0x22ab0f['params']['id'];console[_0xfbdbd6(0x1b8)](_0x39444d);const _0x380f0e=await product[_0xfbdbd6(0x255)](),_0x4ed516=await purchases['aggregate']([{'$match':{'warehouse_name':_0x39444d}},{'$unwind':'$product'},{'$group':{'_id':_0xfbdbd6(0x1c8)}}]);console[_0xfbdbd6(0x1b8)]('purchases_data',_0x4ed516),_0x20b746[_0xfbdbd6(0x221)](0xc8)[_0xfbdbd6(0x23c)]({'purchases_data':_0x4ed516,'product_data':_0x380f0e});}catch(_0x1df520){console[_0xfbdbd6(0x1b8)](_0x1df520);}}),router[a0_0x38a7d7(0x19c)](a0_0x38a7d7(0x1e8),auth,async(_0x54c3b0,_0x2e0eca)=>{var _0x6a3e4b=a0_0x38a7d7;try{const {warehouse_data:_0x1b44c0,product_data:_0x213a09}=_0x54c3b0[_0x6a3e4b(0x25b)];console[_0x6a3e4b(0x1b8)](_0x54c3b0[_0x6a3e4b(0x25b)][_0x6a3e4b(0x1b4)]);;const _0x4f316a=await master_shop[_0x6a3e4b(0x255)]();console[_0x6a3e4b(0x1b8)]('master',_0x4f316a);const _0x3174c5=await product[_0x6a3e4b(0x215)]({'name':_0x213a09});console[_0x6a3e4b(0x1b8)](_0x6a3e4b(0x1e7),_0x3174c5);const _0x1141c4=await warehouse[_0x6a3e4b(0x1aa)]([{'$match':{'name':_0x1b44c0}},{'$unwind':_0x6a3e4b(0x176)},{'$match':{'product_details.product_name':_0x213a09}},{'$group':{'_id':_0x6a3e4b(0x1f1),'product_stock':{'$first':_0x6a3e4b(0x21d)}}}]);console[_0x6a3e4b(0x1b8)](_0x6a3e4b(0x1fa),_0x1141c4),_0x2e0eca[_0x6a3e4b(0x221)](0xc8)[_0x6a3e4b(0x23c)]({'master':_0x4f316a,'new_product':_0x3174c5,'stock_data':_0x1141c4});}catch(_0x5a3f69){console[_0x6a3e4b(0x1b8)](_0x5a3f69);}}),router[a0_0x38a7d7(0x19c)](a0_0x38a7d7(0x1d7),auth,async(_0xb41a0f,_0x5b26a9)=>{var _0x51c6c3=a0_0x38a7d7;try{const {invoice:_0x39d6ec,date:_0x2f0f3a,warehouse_name:_0x2a2bf6,product_name:_0x47c953,stock:_0x1ecfc3,quantity:_0x1fe91d,note:_0x11e074,room:_0x2ffbc0,primary_code:_0xda9a01,secondary_code:_0x13d786,prod_code:_0x467400,level:_0x3d7b1e,isle:_0x33714e,pallet:_0x56e988,batch_code:_0x314dc1,SCRN:_0x415656,expiry_date:_0x1a5c06}=_0xb41a0f['body'];if(typeof _0x47c953=='string')var _0x5853ff=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x251)]],_0x1faa46=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1fd)]],_0x127c69=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x22e)]],_0x4f91f6=[_0xb41a0f['body']['primary_code']],_0x2f0049=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x16f)]],_0x5d6fa8=[_0xb41a0f['body']['prod_code']],_0x4b38a5=[_0xb41a0f['body'][_0x51c6c3(0x1f4)]],_0x224e4b=[_0xb41a0f['body'][_0x51c6c3(0x1f0)]],_0x44b5f3=[_0xb41a0f['body'][_0x51c6c3(0x1c2)]],_0x3517cb=[_0xb41a0f[_0x51c6c3(0x25b)]['batch_code']],_0x5d3aaa=[_0xb41a0f[_0x51c6c3(0x25b)]['expiry_date']],_0xb25c94=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1a7)]],_0xcf1ee6=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x234)]],_0x1f9a5d=[_0xb41a0f['body'][_0x51c6c3(0x1ca)]],_0x5a3300=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x21b)]],_0x178445=[_0xb41a0f[_0x51c6c3(0x25b)]['delivery_code']],_0x25bb3b=[_0xb41a0f['body']['prod_cat']],_0x1d3ba5=[_0xb41a0f[_0x51c6c3(0x25b)]['quantity']],_0x376bb1=[_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1c1)]];else var _0x5853ff=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x251)]],_0x1faa46=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1fd)]],_0x127c69=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x22e)]],_0x4f91f6=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x17c)]],_0x2f0049=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x16f)]],_0x5d6fa8=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x21e)]],_0x4b38a5=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1f4)]],_0x224e4b=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1f0)]],_0x44b5f3=[..._0xb41a0f[_0x51c6c3(0x25b)]['secondary_unit']],_0x3517cb=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x24a)]],_0x5d3aaa=[..._0xb41a0f['body'][_0x51c6c3(0x212)]],_0xb25c94=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1a7)]],_0xcf1ee6=[..._0xb41a0f['body'][_0x51c6c3(0x234)]],_0x1f9a5d=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x1ca)]],_0x5a3300=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x21b)]],_0x178445=[..._0xb41a0f[_0x51c6c3(0x25b)]['delivery_code']],_0x25bb3b=[..._0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x17f)]],_0x1d3ba5=[..._0xb41a0f[_0x51c6c3(0x25b)]['quantity']],_0x376bb1=[..._0xb41a0f['body'][_0x51c6c3(0x1c1)]];const _0x5b9a5f=_0x5853ff['map'](_0x269902=>{return _0x269902={'product_name':_0x269902};});_0x1faa46[_0x51c6c3(0x252)]((_0x118b00,_0x4c0f5d)=>{var _0x1852d5=_0x51c6c3;_0x5b9a5f[_0x4c0f5d][_0x1852d5(0x1fd)]=_0x118b00;}),_0x127c69[_0x51c6c3(0x252)]((_0x564163,_0x3e2bbe)=>{var _0x5a86a6=_0x51c6c3;_0x5b9a5f[_0x3e2bbe][_0x5a86a6(0x239)]=_0x564163;}),_0x4f91f6[_0x51c6c3(0x252)]((_0x5c6e2c,_0x134708)=>{var _0x334079=_0x51c6c3;_0x5b9a5f[_0x134708][_0x334079(0x17c)]=_0x5c6e2c;}),_0x2f0049['forEach']((_0xa2c357,_0x5861af)=>{var _0x1bfc32=_0x51c6c3;_0x5b9a5f[_0x5861af][_0x1bfc32(0x16f)]=_0xa2c357;}),_0x5d6fa8[_0x51c6c3(0x252)]((_0x2b77e5,_0x25caed)=>{_0x5b9a5f[_0x25caed]['product_code']=_0x2b77e5;}),_0x4b38a5['forEach']((_0x157487,_0x1fd936)=>{var _0x430e72=_0x51c6c3;_0x376bb1[_0x430e72(0x252)]((_0x2c1370,_0x1c38d9)=>{var _0x15a4b6=_0x430e72;if(_0x2c1370==_0x15a4b6(0x1ee)&&_0x1fd936==_0x1c38d9){var _0x5adb65=_0x157487[_0x15a4b6(0x207)](0x3);_0x5b9a5f[_0x1fd936][_0x15a4b6(0x246)]=_0x157487[0x0],_0x5b9a5f[_0x1fd936]['rack']=_0x157487[0x1],_0x5b9a5f[_0x1fd936][_0x15a4b6(0x192)]=0x0,_0x5b9a5f[_0x1fd936][_0x15a4b6(0x241)]=0x0,_0x5b9a5f[_0x1fd936][_0x15a4b6(0x1bc)]=_0x15a4b6(0x203),_0x5b9a5f[_0x1fd936][_0x15a4b6(0x1e6)]=_0x5adb65;}else{if(_0x2c1370==_0x15a4b6(0x248)&&_0x1fd936==_0x1c38d9){var _0x5adb65=_0x157487[_0x15a4b6(0x207)](0x3);_0x5b9a5f[_0x1fd936][_0x15a4b6(0x246)]=_0x157487[0x0],_0x5b9a5f[_0x1fd936][_0x15a4b6(0x1ab)]=_0x157487[0x1],_0x5b9a5f[_0x1fd936][_0x15a4b6(0x192)]=0x0,_0x5b9a5f[_0x1fd936][_0x15a4b6(0x241)]=0x0,_0x5b9a5f[_0x1fd936][_0x15a4b6(0x1bc)]=_0x15a4b6(0x203),_0x5b9a5f[_0x1fd936]['floorlevel']=_0x157487[0x5];}else{if(_0x1fd936==_0x1c38d9){var _0x1a3d06;if(_0x157487[0x4]=='L')_0x1a3d06=_0x15a4b6(0x254);else _0x157487[0x4]=='F'&&(_0x1a3d06=_0x15a4b6(0x203));_0x5b9a5f[_0x1fd936]['storage']=_0x157487[0x0],_0x5b9a5f[_0x1fd936][_0x15a4b6(0x1ab)]=_0x157487[0x1],_0x5b9a5f[_0x1fd936][_0x15a4b6(0x192)]=_0x157487[0x2],_0x5b9a5f[_0x1fd936]['bin']=_0x157487[0x3],_0x5b9a5f[_0x1fd936]['type']=_0x1a3d06,_0x5b9a5f[_0x1fd936]['floorlevel']=_0x157487[0x5];}}}});}),_0x224e4b[_0x51c6c3(0x252)]((_0x840002,_0x9ee9f2)=>{_0x5b9a5f[_0x9ee9f2]['unit']=_0x840002;}),_0x44b5f3[_0x51c6c3(0x252)]((_0x553abf,_0x444562)=>{var _0x4954f6=_0x51c6c3;_0x5b9a5f[_0x444562][_0x4954f6(0x1c2)]=_0x553abf;}),_0x3517cb[_0x51c6c3(0x252)]((_0x421fbd,_0x48cf43)=>{var _0x111023=_0x51c6c3;_0x5b9a5f[_0x48cf43][_0x111023(0x24a)]=_0x421fbd;}),_0x5d3aaa[_0x51c6c3(0x252)]((_0x597309,_0x23c714)=>{_0x5b9a5f[_0x23c714]['expiry_date']=_0x597309;}),_0xb25c94[_0x51c6c3(0x252)]((_0x5354bf,_0xe0671e)=>{_0x5b9a5f[_0xe0671e]['maxperunit']=_0x5354bf;}),_0xcf1ee6[_0x51c6c3(0x252)]((_0x2dfba7,_0x1651bb)=>{_0x5b9a5f[_0x1651bb]['production_date']=_0x2dfba7;}),_0x1f9a5d[_0x51c6c3(0x252)]((_0x32b371,_0x5f088e)=>{var _0x445d98=_0x51c6c3;_0x5b9a5f[_0x5f088e][_0x445d98(0x1ca)]=_0x32b371;}),_0x5a3300[_0x51c6c3(0x252)]((_0x26f80f,_0x3ec87e)=>{_0x5b9a5f[_0x3ec87e]['delivery_date']=_0x26f80f;}),_0x178445['forEach']((_0x1d5900,_0x106853)=>{var _0x41a192=_0x51c6c3;_0x5b9a5f[_0x106853][_0x41a192(0x229)]=_0x1d5900;}),_0x25bb3b[_0x51c6c3(0x252)]((_0x15e991,_0x4f17c6)=>{_0x5b9a5f[_0x4f17c6]['prod_cat']=_0x15e991;}),_0x1d3ba5['forEach']((_0x3fc069,_0x204764)=>{var _0x534c6a=_0x51c6c3;_0x5b9a5f[_0x204764][_0x534c6a(0x1dd)]=_0x3fc069;}),_0x376bb1['forEach']((_0x1f2a70,_0x3344bb)=>{_0x5b9a5f[_0x3344bb]['room_name']=_0x1f2a70;});var _0x4f09f0=0x0;_0x5b9a5f[_0x51c6c3(0x252)](_0x20f3da=>{var _0xc11013=_0x51c6c3;(_0x20f3da[_0xc11013(0x1fd)]<_0x20f3da[_0xc11013(0x1dd)]||_0x20f3da['quantity_notConverted']==0x0)&&(console['log']('foreach\x20newproduct',_0x20f3da),_0x4f09f0++);});const _0x432e49=_0x5b9a5f[_0x51c6c3(0x1a8)](_0x541513=>_0x541513[_0x51c6c3(0x239)]!=='0'&&_0x541513['quantity']!==''),_0xa8674e=new sales({'invoice':_0x39d6ec,'customer':_0xb41a0f[_0x51c6c3(0x25b)][_0x51c6c3(0x173)],'date':_0x2f0f3a,'warehouse_name':_0x2a2bf6,'sale_product':_0x432e49,'note':_0x11e074,'room':_0x2ffbc0,'primary_code':_0xda9a01,'secondary_code':_0x13d786,'prod_code':_0x467400,'SCRN':_0x415656}),_0x3d9925=await _0xa8674e[_0x51c6c3(0x1fb)]();_0xb41a0f[_0x51c6c3(0x1e2)](_0x51c6c3(0x235),'Sales\x20Add\x20successfully'),_0x5b26a9[_0x51c6c3(0x17a)]('/all_sales/preview/'+_0x3d9925['_id']);}catch(_0x1df719){console[_0x51c6c3(0x1b8)](_0x1df719);}}),router[a0_0x38a7d7(0x22b)](a0_0x38a7d7(0x243),auth,async(_0x5be99e,_0x399905)=>{var _0x3f49b7=a0_0x38a7d7;try{const {username:_0x2250da,email:_0x23e474,role:_0x25f7c9}=_0x5be99e['user'],_0x32c888=_0x5be99e[_0x3f49b7(0x233)],_0x5e31e8=await profile[_0x3f49b7(0x215)]({'email':_0x32c888[_0x3f49b7(0x1af)]}),_0x256aad=await master_shop[_0x3f49b7(0x255)](),_0x2b68e1=_0x5be99e[_0x3f49b7(0x20e)]['id'],_0x48a943=await sales['findById'](_0x2b68e1),_0x315937=await warehouse['aggregate']([{'$match':{'name':_0x48a943[_0x3f49b7(0x202)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3f49b7(0x195),'name':{'$first':_0x3f49b7(0x1f1)},'product_stock':{'$first':_0x3f49b7(0x21d)},'bay':{'$first':_0x3f49b7(0x1d6)},'bin':{'$first':_0x3f49b7(0x1f2)},'type':{'$first':_0x3f49b7(0x22c)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3f49b7(0x1f3)},'product_code':{'$first':_0x3f49b7(0x178)},'storage':{'$first':_0x3f49b7(0x23f)},'rack':{'$first':_0x3f49b7(0x1e0)},'expiry_date':{'$first':_0x3f49b7(0x1de)},'production_date':{'$first':_0x3f49b7(0x24c)}}}]),_0x8d1dfb=await customer['find']({});let _0x3b3cd1;if(_0x32c888[_0x3f49b7(0x1fc)]=='staff'){const _0x526f91=await staff[_0x3f49b7(0x215)]({'email':_0x32c888[_0x3f49b7(0x1af)]});_0x3b3cd1=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x526f91[_0x3f49b7(0x183)]}},{'$group':{'_id':_0x3f49b7(0x1d1),'name':{'$first':_0x3f49b7(0x1d1)}}}]);}else _0x3b3cd1=await warehouse['aggregate']([{'$match':{'status':'Enabled'}},{'$group':{'_id':_0x3f49b7(0x1d1),'name':{'$first':'$name'}}}]);const _0x379410=await product[_0x3f49b7(0x255)]({}),_0x216a69=await suppliers[_0x3f49b7(0x255)]({});if(_0x256aad[0x0][_0x3f49b7(0x225)]=='English\x20(US)'){var _0x1feb6c=users[_0x3f49b7(0x182)];console[_0x3f49b7(0x1b8)](_0x1feb6c);}else{if(_0x256aad[0x0][_0x3f49b7(0x225)]=='Hindi')var _0x1feb6c=users[_0x3f49b7(0x1b6)];else{if(_0x256aad[0x0][_0x3f49b7(0x225)]==_0x3f49b7(0x194))var _0x1feb6c=users[_0x3f49b7(0x194)];else{if(_0x256aad[0x0][_0x3f49b7(0x225)]=='Spanish')var _0x1feb6c=users['Spanish'];else{if(_0x256aad[0x0][_0x3f49b7(0x225)]=='French')var _0x1feb6c=users[_0x3f49b7(0x1bb)];else{if(_0x256aad[0x0][_0x3f49b7(0x225)]==_0x3f49b7(0x1da))var _0x1feb6c=users[_0x3f49b7(0x218)];else{if(_0x256aad[0x0]['language']==_0x3f49b7(0x19a))var _0x1feb6c=users[_0x3f49b7(0x19a)];else{if(_0x256aad[0x0]['language']=='Arabic\x20(ae)')var _0x1feb6c=users['Arabic'];}}}}}}}_0x399905[_0x3f49b7(0x19d)]('edit_sales_view',{'success':_0x5be99e[_0x3f49b7(0x1e2)]('success'),'errors':_0x5be99e['flash']('errors'),'role':_0x32c888,'profile':_0x5e31e8,'customer':_0x8d1dfb,'warehouse':_0x3b3cd1,'product':_0x315937,'user':_0x48a943,'master_shop':_0x256aad,'unit':_0x379410,'language':_0x1feb6c,'suppliers':_0x216a69});}catch(_0x2f4e36){console[_0x3f49b7(0x1b8)](_0x2f4e36);}}),router['post']('/preview/:id',auth,async(_0x5d252c,_0xef72b1)=>{var _0x6b04ff=a0_0x38a7d7;try{const _0x114cab=_0x5d252c['params']['id'],{invoice:_0x239c05,warehouse_name:_0xb788fd,room:_0x34f132}=_0x5d252c[_0x6b04ff(0x25b)],_0x3abec3=await sales['findOne']({'invoice':_0x239c05}),_0x3d9817=_0x3abec3[_0x6b04ff(0x21f)][_0x6b04ff(0x19e)](async _0x3ecf76=>{var _0x43a39f=_0x6b04ff,_0x5b0123=await warehouse[_0x43a39f(0x215)]({'name':_0xb788fd,'room':_0x3ecf76[_0x43a39f(0x25c)],'warehouse_category':'Raw\x20Materials'});const _0x1188a3=_0x5b0123[_0x43a39f(0x1cd)][_0x43a39f(0x19e)](_0x3c4c44=>{var _0x16f1a1=_0x43a39f;_0x3c4c44[_0x16f1a1(0x251)]==_0x3ecf76['product_name']&&_0x3c4c44[_0x16f1a1(0x1e6)]==_0x3ecf76[_0x16f1a1(0x1e6)]&&_0x3c4c44[_0x16f1a1(0x1bc)]==_0x3ecf76[_0x16f1a1(0x1bc)]&&_0x3c4c44['bin']==_0x3ecf76[_0x16f1a1(0x241)]&&_0x3c4c44['bay']==_0x3ecf76[_0x16f1a1(0x192)]&&_0x3c4c44[_0x16f1a1(0x1ab)]==_0x3ecf76[_0x16f1a1(0x1ab)]&&_0x3c4c44[_0x16f1a1(0x246)]==_0x3ecf76['storage']&&_0x3c4c44[_0x16f1a1(0x212)]==_0x3ecf76[_0x16f1a1(0x212)]&&_0x3c4c44[_0x16f1a1(0x24a)]==_0x3ecf76[_0x16f1a1(0x24a)]&&(_0x3c4c44[_0x16f1a1(0x206)]=_0x3c4c44[_0x16f1a1(0x206)]-_0x3ecf76[_0x16f1a1(0x239)]);});return _0x5b0123;});Promise['all'](_0x3d9817)[_0x6b04ff(0x1cc)](async _0x5e6700=>{var _0x23d17f=_0x6b04ff;try{for(const _0x49112 of _0x5e6700){await _0x49112['save']();}_0x3abec3[_0x23d17f(0x1a0)]=_0x23d17f(0x18b);const _0x2dfa99=await _0x3abec3[_0x23d17f(0x1fb)]();_0x5d252c[_0x23d17f(0x1e2)](_0x23d17f(0x235),'Sales\x20Update\x20successfully'),_0xef72b1[_0x23d17f(0x17a)](_0x23d17f(0x17d)+_0x114cab);}catch(_0x249cd0){console[_0x23d17f(0x1d3)](_0x249cd0),_0xef72b1[_0x23d17f(0x221)](0x1f4)[_0x23d17f(0x23c)]({'error':_0x23d17f(0x1eb)});}})[_0x6b04ff(0x1a3)](_0x4e2612=>{var _0x356e11=_0x6b04ff;console[_0x356e11(0x1d3)](_0x4e2612),_0xef72b1[_0x356e11(0x221)](0x1f4)[_0x356e11(0x23c)]({'error':_0x356e11(0x238)});});}catch(_0x43cce0){console[_0x6b04ff(0x1b8)](_0x43cce0);}}),router[a0_0x38a7d7(0x22b)](a0_0x38a7d7(0x1e1),auth,async(_0x41d35c,_0x5cbf26)=>{var _0x1da59b=a0_0x38a7d7;try{const {username:_0x456e49,email:_0x569e94,role:_0x597377}=_0x41d35c['user'],_0x4b724e=_0x41d35c[_0x1da59b(0x233)],_0x322a39=await profile[_0x1da59b(0x215)]({'email':_0x4b724e[_0x1da59b(0x1af)]}),_0x34fc58=await master_shop[_0x1da59b(0x255)](),_0x4b3080=_0x41d35c[_0x1da59b(0x20e)]['id'],_0x8d6d57=await sales[_0x1da59b(0x190)](_0x4b3080);let _0x1af2a1=new Date(_0x8d6d57[_0x1da59b(0x212)]),_0x448622=('0'+_0x1af2a1[_0x1da59b(0x17b)]())['slice'](-0x2),_0x33c3c0=('0'+(_0x1af2a1[_0x1da59b(0x196)]()+0x1))[_0x1da59b(0x207)](-0x2),_0x2da9f3=_0x1af2a1['getFullYear'](),_0x2ad239=_0x2da9f3+'-'+_0x33c3c0+'-'+_0x448622;var _0x3cf77a=[_0x1da59b(0x189),_0x1da59b(0x198)];const _0x119786=await warehouse[_0x1da59b(0x1aa)]([{'$match':{'name':_0x8d6d57[_0x1da59b(0x202)],'room':_0x8d6d57[_0x1da59b(0x18d)],'warehouse_category':_0x1da59b(0x226)}},{'$unwind':_0x1da59b(0x176)},{'$group':{'_id':_0x1da59b(0x195),'name':{'$first':_0x1da59b(0x1f1)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':'$product_details.bay'},'bin':{'$first':_0x1da59b(0x1f2)},'type':{'$first':_0x1da59b(0x22c)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x1da59b(0x179)},'secondary_code':{'$first':_0x1da59b(0x1f3)},'product_code':{'$first':_0x1da59b(0x178)},'storage':{'$first':_0x1da59b(0x23f)},'rack':{'$first':'$product_details.rack'}}}]),_0x5a495a=await customer[_0x1da59b(0x255)]({});let _0x266bf9;if(_0x4b724e[_0x1da59b(0x1fc)]==_0x1da59b(0x187)){const _0x35eaa7=await staff['findOne']({'email':_0x4b724e[_0x1da59b(0x1af)]});_0x266bf9=await warehouse[_0x1da59b(0x1aa)]([{'$match':{'status':_0x1da59b(0x1a1),'name':_0x35eaa7[_0x1da59b(0x183)],'warehouse_category':_0x1da59b(0x226)}},{'$group':{'_id':_0x1da59b(0x1d1),'name':{'$first':_0x1da59b(0x1d1)}}}]);}else _0x266bf9=await warehouse[_0x1da59b(0x1aa)]([{'$match':{'status':_0x1da59b(0x1a1),'warehouse_category':_0x1da59b(0x226)}},{'$group':{'_id':_0x1da59b(0x1d1),'name':{'$first':'$name'}}}]);const _0x4cdca7=await product[_0x1da59b(0x255)]({});if(_0x34fc58[0x0]['language']=='English\x20(US)'){var _0x439d15=users[_0x1da59b(0x182)];console[_0x1da59b(0x1b8)](_0x439d15);}else{if(_0x34fc58[0x0][_0x1da59b(0x225)]==_0x1da59b(0x1b6))var _0x439d15=users['Hindi'];else{if(_0x34fc58[0x0][_0x1da59b(0x225)]=='German')var _0x439d15=users['German'];else{if(_0x34fc58[0x0][_0x1da59b(0x225)]==_0x1da59b(0x20d))var _0x439d15=users[_0x1da59b(0x20d)];else{if(_0x34fc58[0x0][_0x1da59b(0x225)]==_0x1da59b(0x1bb))var _0x439d15=users[_0x1da59b(0x1bb)];else{if(_0x34fc58[0x0][_0x1da59b(0x225)]==_0x1da59b(0x1da))var _0x439d15=users[_0x1da59b(0x218)];else{if(_0x34fc58[0x0][_0x1da59b(0x225)]==_0x1da59b(0x19a))var _0x439d15=users[_0x1da59b(0x19a)];else{if(_0x34fc58[0x0][_0x1da59b(0x225)]==_0x1da59b(0x1b2))var _0x439d15=users['Arabic'];}}}}}}}_0x5cbf26[_0x1da59b(0x19d)]('edit_sales',{'success':_0x41d35c[_0x1da59b(0x1e2)](_0x1da59b(0x235)),'errors':_0x41d35c[_0x1da59b(0x1e2)](_0x1da59b(0x1b3)),'role':_0x4b724e,'profile':_0x322a39,'customer':_0x5a495a,'warehouse':_0x266bf9,'product':_0x119786,'user':_0x8d6d57,'master_shop':_0x34fc58,'unit':_0x4cdca7,'language':_0x439d15,'rooms_data':_0x3cf77a,'ed_fullDate':_0x2ad239});}catch(_0x197457){console[_0x1da59b(0x1b8)](_0x197457);}}),router[a0_0x38a7d7(0x19c)](a0_0x38a7d7(0x1e1),auth,async(_0x4a9f4f,_0x3f96f4)=>{var _0x56926b=a0_0x38a7d7;try{const _0x1bb881=_0x4a9f4f[_0x56926b(0x20e)]['id'],_0x1af8ef=await sales['findOne']({'_id':_0x4a9f4f['params']['id']}),_0x5b20dc=await warehouse['findOne']({'name':_0x1af8ef[_0x56926b(0x202)],'room':_0x4a9f4f[_0x56926b(0x25b)]['room']}),{invoice:_0xe23d21,customer:_0x23e213,date:_0x208b57,warehouse_name:_0x5d2515,product_name:_0x476241,stock:_0x56ba43,adjust_qty:_0x44b4f1,note:_0x1f39c0,room:_0x2b5b89,primary_code:_0xfad76b,secondary_code:_0x5e3a6b,prod_code:_0x3bd14c,level:_0x1596fb,isle:_0x2ac2dd,pallet:_0x397c40,expiry_date:_0x315e52}=_0x4a9f4f['body'];if(typeof _0x476241=='string')var _0x2e4058=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x251)]],_0x572edc=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x1fd)]],_0x5134f1=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x1d0)]],_0x2cfeaa=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x17c)]],_0x4aa218=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x16f)]],_0x2c42d8=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x21e)]],_0x279761=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x1f4)]],_0x1e4187=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x24b)]],_0x2e548e=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x23e)]],_0x52029f=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x212)]],_0x1836bc=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x246)]],_0x2f8174=[_0x4a9f4f['body']['rak']],_0x2cd7de=[_0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x1bc)]];else var _0x2e4058=[..._0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x251)]],_0x572edc=[..._0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x1fd)]],_0x5134f1=[..._0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x1d0)]],_0x2cfeaa=[..._0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x17c)]],_0x4aa218=[..._0x4a9f4f[_0x56926b(0x25b)]['secondary_code']],_0x2c42d8=[..._0x4a9f4f[_0x56926b(0x25b)]['prod_code']],_0x279761=[..._0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x1f4)]],_0x1e4187=[..._0x4a9f4f['body'][_0x56926b(0x24b)]],_0x2e548e=[..._0x4a9f4f['body'][_0x56926b(0x23e)]],_0x52029f=[..._0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x212)]],_0x1836bc=[..._0x4a9f4f[_0x56926b(0x25b)]['storage']],_0x2f8174=[..._0x4a9f4f[_0x56926b(0x25b)][_0x56926b(0x245)]],_0x2cd7de=[..._0x4a9f4f['body'][_0x56926b(0x1bc)]];const _0x52786b=_0x2e4058[_0x56926b(0x19e)](_0x51683d=>{return _0x51683d={'product_name':_0x51683d};});_0x572edc[_0x56926b(0x252)]((_0x58a545,_0x44316f)=>{var _0x33bb0b=_0x56926b;_0x52786b[_0x44316f][_0x33bb0b(0x1fd)]=_0x58a545;}),_0x5134f1[_0x56926b(0x252)]((_0x3eb117,_0x2abe75)=>{var _0x855874=_0x56926b;_0x52786b[_0x2abe75][_0x855874(0x239)]=_0x3eb117;}),_0x2cfeaa[_0x56926b(0x252)]((_0x47870d,_0x50c9fb)=>{var _0x3a8423=_0x56926b;_0x52786b[_0x50c9fb][_0x3a8423(0x17c)]=_0x47870d;}),_0x4aa218[_0x56926b(0x252)]((_0x525049,_0x1019d0)=>{var _0x25b2dd=_0x56926b;_0x52786b[_0x1019d0][_0x25b2dd(0x16f)]=_0x525049;}),_0x2c42d8[_0x56926b(0x252)]((_0xd78f19,_0x4b0120)=>{var _0x3e7a9b=_0x56926b;_0x52786b[_0x4b0120][_0x3e7a9b(0x191)]=_0xd78f19;}),_0x279761[_0x56926b(0x252)]((_0x51d51a,_0x2a052a)=>{var _0x58ccaf=_0x56926b;_0x52786b[_0x2a052a][_0x58ccaf(0x192)]=_0x51d51a;}),_0x1e4187[_0x56926b(0x252)]((_0xba1629,_0x51024b)=>{var _0x338b47=_0x56926b;_0x52786b[_0x51024b][_0x338b47(0x241)]=_0xba1629;}),_0x2e548e[_0x56926b(0x252)]((_0x127617,_0xdee467)=>{var _0x9f8cee=_0x56926b;_0x52786b[_0xdee467][_0x9f8cee(0x1e6)]=_0x127617;}),_0x52029f[_0x56926b(0x252)]((_0x19fb9e,_0x162ba1)=>{var _0x2880c2=_0x56926b;_0x52786b[_0x162ba1][_0x2880c2(0x212)]=_0x19fb9e;}),_0x2cd7de['forEach']((_0x18b089,_0x2ab999)=>{var _0x547cfb=_0x56926b;_0x52786b[_0x2ab999][_0x547cfb(0x1bc)]=_0x18b089;}),_0x1836bc[_0x56926b(0x252)]((_0x71dc44,_0x47b724)=>{var _0x12a328=_0x56926b;_0x52786b[_0x47b724][_0x12a328(0x246)]=_0x71dc44;}),_0x2f8174[_0x56926b(0x252)]((_0x5a449e,_0x145cdf)=>{var _0x3f429d=_0x56926b;_0x52786b[_0x145cdf][_0x3f429d(0x1ab)]=_0x5a449e;});var _0x305650=0x0;_0x52786b[_0x56926b(0x252)](_0x5ecef7=>{var _0x5d1ca3=_0x56926b;console['log']('foreach\x20newproduct',_0x5ecef7),(parseInt(_0x5ecef7[_0x5d1ca3(0x1fd)])<parseInt(_0x5ecef7[_0x5d1ca3(0x239)])||parseInt(_0x5ecef7[_0x5d1ca3(0x239)])==0x0)&&_0x305650++;});if(_0x305650!=0x0)return _0x4a9f4f[_0x56926b(0x1e2)](_0x56926b(0x1b3),_0x56926b(0x1be)),_0x3f96f4['redirect'](_0x56926b(0x20b));_0x1af8ef['sale_product'][_0x56926b(0x252)](_0xb5c2bc=>{var _0x5d6619=_0x56926b;const _0x52a80a=_0x5b20dc[_0x5d6619(0x1cd)]['map'](_0x3b33a6=>{var _0x520407=_0x5d6619;_0x3b33a6[_0x520407(0x251)]==_0xb5c2bc[_0x520407(0x251)]&&_0x3b33a6['floorlevel']==_0xb5c2bc[_0x520407(0x1e6)]&&_0x3b33a6[_0x520407(0x1bc)]==_0xb5c2bc[_0x520407(0x1bc)]&&_0x3b33a6['bin']==_0xb5c2bc[_0x520407(0x241)]&&_0x3b33a6[_0x520407(0x192)]==_0xb5c2bc[_0x520407(0x192)]&&(_0x3b33a6['product_stock']=parseInt(_0x3b33a6[_0x520407(0x206)])+parseInt(_0xb5c2bc[_0x520407(0x239)]));});}),console[_0x56926b(0x1b8)](_0x56926b(0x216),_0x5b20dc),await _0x5b20dc[_0x56926b(0x1fb)]();const _0x1a77fe=_0x52786b[_0x56926b(0x1a8)](_0x2520a5=>_0x2520a5[_0x56926b(0x239)]!=='0'&&_0x2520a5['quantity']!=='');_0x1af8ef['invoice']=_0xe23d21,_0x1af8ef['customer']=_0x23e213,_0x1af8ef[_0x56926b(0x201)]=_0x208b57,_0x1af8ef[_0x56926b(0x202)]=_0x5d2515,_0x1af8ef[_0x56926b(0x21f)]=_0x1a77fe,_0x1af8ef[_0x56926b(0x1f5)]=_0x1f39c0,_0x1af8ef[_0x56926b(0x18d)]=_0x2b5b89;const _0x375b83=await _0x1af8ef[_0x56926b(0x1fb)](),_0x3af914=await sales['findOne']({'_id':_0x4a9f4f['params']['id']}),_0x2c4901=await warehouse[_0x56926b(0x215)]({'name':_0x5d2515,'room':_0x2b5b89});_0x3af914[_0x56926b(0x21f)][_0x56926b(0x252)](_0x866383=>{var _0x48b5d2=_0x56926b;const _0x3a6bd9=_0x2c4901[_0x48b5d2(0x1cd)][_0x48b5d2(0x19e)](_0x358c5f=>{var _0x2d28a2=_0x48b5d2;_0x358c5f[_0x2d28a2(0x251)]==_0x866383['product_name']&&_0x358c5f[_0x2d28a2(0x1e6)]==_0x866383['floorlevel']&&_0x358c5f[_0x2d28a2(0x1bc)]==_0x866383['type']&&_0x358c5f[_0x2d28a2(0x241)]==_0x866383['bin']&&_0x358c5f[_0x2d28a2(0x192)]==_0x866383[_0x2d28a2(0x192)]&&(_0x358c5f[_0x2d28a2(0x206)]=parseInt(_0x358c5f[_0x2d28a2(0x206)])-parseInt(_0x866383[_0x2d28a2(0x239)]));});}),console[_0x56926b(0x1b8)](_0x56926b(0x240),_0x2c4901),await _0x2c4901[_0x56926b(0x1fb)]();const _0x290204=await c_payment_data['findOne']({'invoice':_0x4a9f4f[_0x56926b(0x25b)]['invoice']});_0x290204[_0x56926b(0x1b7)]=_0x4a9f4f[_0x56926b(0x25b)]['suppliers'],await _0x290204[_0x56926b(0x1fb)](),_0x4a9f4f[_0x56926b(0x1e2)](_0x56926b(0x235),_0x56926b(0x177)),_0x3f96f4[_0x56926b(0x17a)]('/all_sales/view');}catch(_0x506c99){console[_0x56926b(0x1b8)](_0x506c99);}}),router[a0_0x38a7d7(0x19c)](a0_0x38a7d7(0x1ea),auth,async(_0x1e4eb6,_0x461b12)=>{var _0x312b81=a0_0x38a7d7;try{const _0x4ef500=_0x1e4eb6[_0x312b81(0x20e)]['id'],{invoice:_0x4cc41a,customer:_0x11f5cf,receivable_amount:_0x2fef8e,received_amount:_0x3ec7ee}=_0x1e4eb6['body'],_0x1eb93b=await sales[_0x312b81(0x190)](_0x4ef500);console[_0x312b81(0x1b8)](_0x1eb93b);var _0x4fc8be=_0x2fef8e-_0x3ec7ee;console[_0x312b81(0x1b8)](_0x3ec7ee),_0x1eb93b[_0x312b81(0x210)]=parseFloat(_0x3ec7ee)+parseFloat(_0x1eb93b[_0x312b81(0x210)]),_0x1eb93b[_0x312b81(0x256)]=_0x4fc8be,console[_0x312b81(0x1b8)](_0x1eb93b);const _0x361518=await _0x1eb93b[_0x312b81(0x1fb)](),_0x2e8516=await c_payment_data[_0x312b81(0x215)]({'invoice':_0x4cc41a});_0x2e8516[_0x312b81(0x1f6)]=_0x4fc8be,await _0x2e8516[_0x312b81(0x1fb)]();let _0x43c435=new Date(),_0x59d2ed=('0'+_0x43c435[_0x312b81(0x17b)]())[_0x312b81(0x207)](-0x2),_0x5598cb=('0'+(_0x43c435[_0x312b81(0x196)]()+0x1))[_0x312b81(0x207)](-0x2),_0x56fd13=_0x43c435[_0x312b81(0x204)](),_0x105305=_0x56fd13+'-'+_0x5598cb+'-'+_0x59d2ed;const _0x23611a=new customer_payment({'invoice':_0x4cc41a,'date':_0x56fd13+'-'+_0x5598cb+'-'+_0x59d2ed,'customer':_0x11f5cf,'reason':_0x312b81(0x20f),'amount':_0x3ec7ee}),_0x2dc2eb=await _0x23611a[_0x312b81(0x1fb)]();_0x1e4eb6[_0x312b81(0x1e2)](_0x312b81(0x235),_0x312b81(0x18f)),_0x461b12[_0x312b81(0x17a)]('/all_sales/view');}catch(_0x4021dd){console[_0x312b81(0x1b8)](_0x4021dd);}}),router[a0_0x38a7d7(0x22b)](a0_0x38a7d7(0x199),auth,async(_0x53a260,_0x265ab8)=>{var _0x23f58b=a0_0x38a7d7;try{const {username:_0x29b332,email:_0x686fa9,role:_0x534222}=_0x53a260[_0x23f58b(0x233)],_0x5f4433=_0x53a260['user'],_0x4aeb1e=await profile['findOne']({'email':_0x5f4433[_0x23f58b(0x1af)]}),_0x23dbab=await master_shop[_0x23f58b(0x255)]();console[_0x23f58b(0x1b8)](_0x23f58b(0x21c),_0x23dbab);const _0x3fd598=_0x53a260[_0x23f58b(0x20e)]['id'],_0x4b80ff=await sales[_0x23f58b(0x190)](_0x3fd598);console[_0x23f58b(0x1b8)](_0x4b80ff);const _0x5b7308=await customer['findOne']({'name':_0x4b80ff[_0x23f58b(0x173)]});console[_0x23f58b(0x1b8)](_0x5b7308);if(_0x23dbab[0x0][_0x23f58b(0x225)]==_0x23f58b(0x1d8)){var _0x4ec7cd=users['English'];console[_0x23f58b(0x1b8)](_0x4ec7cd);}else{if(_0x23dbab[0x0][_0x23f58b(0x225)]==_0x23f58b(0x1b6))var _0x4ec7cd=users['Hindi'];else{if(_0x23dbab[0x0]['language']==_0x23f58b(0x194))var _0x4ec7cd=users[_0x23f58b(0x194)];else{if(_0x23dbab[0x0][_0x23f58b(0x225)]=='Spanish')var _0x4ec7cd=users['Spanish'];else{if(_0x23dbab[0x0][_0x23f58b(0x225)]=='French')var _0x4ec7cd=users['French'];else{if(_0x23dbab[0x0][_0x23f58b(0x225)]==_0x23f58b(0x1da))var _0x4ec7cd=users[_0x23f58b(0x218)];else{if(_0x23dbab[0x0][_0x23f58b(0x225)]==_0x23f58b(0x19a))var _0x4ec7cd=users[_0x23f58b(0x19a)];else{if(_0x23dbab[0x0][_0x23f58b(0x225)]==_0x23f58b(0x1b2))var _0x4ec7cd=users[_0x23f58b(0x1cf)];}}}}}}}_0x265ab8[_0x23f58b(0x19d)](_0x23f58b(0x1ff),{'success':_0x53a260[_0x23f58b(0x1e2)](_0x23f58b(0x235)),'errors':_0x53a260[_0x23f58b(0x1e2)]('errors'),'role':_0x5f4433,'profile':_0x4aeb1e,'master_shop':_0x23dbab,'customers':_0x5b7308,'sales':_0x4b80ff,'language':_0x4ec7cd});}catch(_0x18d7f2){console[_0x23f58b(0x1b8)](_0x18d7f2);}}),router[a0_0x38a7d7(0x22b)](a0_0x38a7d7(0x21a),auth,async(_0x59aa2e,_0x53b1e0)=>{var _0x520e1b=a0_0x38a7d7;try{const {username:_0x2c299d,email:_0x9db5df,role:_0x3fdda5}=_0x59aa2e['user'],_0x5e5040=_0x59aa2e['user'],_0x5638e1=await profile['findOne']({'email':_0x5e5040[_0x520e1b(0x1af)]}),_0x3e6877=await master_shop[_0x520e1b(0x255)]();console[_0x520e1b(0x1b8)](_0x520e1b(0x21c),_0x3e6877);const _0x7d57ee=_0x59aa2e[_0x520e1b(0x20e)]['id'];console[_0x520e1b(0x1b8)](_0x7d57ee);const _0x515983=await sales['findById'](_0x7d57ee);console[_0x520e1b(0x1b8)](_0x520e1b(0x1c7),_0x515983);const _0x73242b=await warehouse['aggregate']([{'$match':{'name':_0x520e1b(0x242),'room':'Return\x20Rooms'}},{'$unwind':_0x520e1b(0x176)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x520e1b(0x21d)},'level':{'$first':_0x520e1b(0x24e)},'isle':{'$first':_0x520e1b(0x250)},'pallet':{'$first':_0x520e1b(0x24d)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x520e1b(0x1f3)},'product_code':{'$first':_0x520e1b(0x178)}}}]);console[_0x520e1b(0x1b8)]('stock_data',_0x73242b);const _0x5c281f=await product['find']({});warehouse_data=await warehouse['aggregate']([{'$match':{'status':_0x520e1b(0x1a1),'name':_0x520e1b(0x242),'warehouse_category':_0x520e1b(0x226)}},{'$group':{'_id':_0x520e1b(0x1d1),'name':{'$first':_0x520e1b(0x1d1)}}},{'$sort':{'name':0x1}}]);var _0x451c3a=['Return\x20Rooms'];if(_0x3e6877[0x0][_0x520e1b(0x225)]==_0x520e1b(0x1d8)){var _0x33f3b5=users[_0x520e1b(0x182)];console[_0x520e1b(0x1b8)](_0x33f3b5);}else{if(_0x3e6877[0x0]['language']=='Hindi')var _0x33f3b5=users[_0x520e1b(0x1b6)];else{if(_0x3e6877[0x0]['language']=='German')var _0x33f3b5=users['German'];else{if(_0x3e6877[0x0]['language']==_0x520e1b(0x20d))var _0x33f3b5=users[_0x520e1b(0x20d)];else{if(_0x3e6877[0x0][_0x520e1b(0x225)]=='French')var _0x33f3b5=users[_0x520e1b(0x1bb)];else{if(_0x3e6877[0x0]['language']==_0x520e1b(0x1da))var _0x33f3b5=users[_0x520e1b(0x218)];else{if(_0x3e6877[0x0][_0x520e1b(0x225)]==_0x520e1b(0x19a))var _0x33f3b5=users[_0x520e1b(0x19a)];else{if(_0x3e6877[0x0][_0x520e1b(0x225)]==_0x520e1b(0x1b2))var _0x33f3b5=users[_0x520e1b(0x1cf)];}}}}}}}_0x53b1e0['render'](_0x520e1b(0x175),{'success':_0x59aa2e[_0x520e1b(0x1e2)](_0x520e1b(0x235)),'errors':_0x59aa2e[_0x520e1b(0x1e2)](_0x520e1b(0x1b3)),'role':_0x5e5040,'profile':_0x5638e1,'user':_0x515983,'stock':_0x73242b,'master_shop':_0x3e6877,'unit':_0x5c281f,'language':_0x33f3b5,'warehouses':warehouse_data,'rooms':_0x451c3a});}catch(_0x18e0b1){console[_0x520e1b(0x1b8)](_0x18e0b1),_0x53b1e0['status'](0xc8)[_0x520e1b(0x23c)]({'message':_0x18e0b1[_0x520e1b(0x224)]});}}),router[a0_0x38a7d7(0x19c)]('/view/return_sales/:id',auth,async(_0x3b736d,_0x41f27c)=>{var _0x402f45=a0_0x38a7d7;try{const {invoice:_0x15d812,date:_0x1d4f1e,warehouse_name:_0x11c969,product_name:_0x301a38,primary_code:_0x29e8f1,secondary_code:_0x15a54a,product_code:_0xe80b9,sales_quantity:_0x26bd4b,stocks:_0x101651,return_qty:_0x4991ef,Room_name:_0x512eb4,to_warehouse_name:_0x31a272,to_Roomname:_0x987b32,to_Room_name:_0x3ad70c,note:_0x1496ca,level:_0x29452d,isle:_0x502245,pallet:_0x5798ea}=_0x3b736d[_0x402f45(0x25b)];if(typeof _0x301a38==_0x402f45(0x1ec))var _0x5886cb=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x251)]],_0x59dfa4=[_0x3b736d['body'][_0x402f45(0x17c)]],_0x1b4fff=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x16f)]],_0x3e839a=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x191)]],_0x1e6dce=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x16d)]],_0x265ba5=[_0x3b736d[_0x402f45(0x25b)]['stocks']],_0x4a955c=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x1ba)]],_0x27281e=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x192)]],_0x506beb=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x241)]],_0x2d113f=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x237)]],_0x16b55c=[_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x1e6)]];else var _0x5886cb=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x251)]],_0x59dfa4=[..._0x3b736d[_0x402f45(0x25b)]['primary_code']],_0x1b4fff=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x16f)]],_0x3e839a=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x191)]],_0x1e6dce=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x16d)]],_0x265ba5=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x208)]],_0x4a955c=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x1ba)]],_0x27281e=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x192)]],_0x506beb=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x241)]],_0x2d113f=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x237)]],_0x16b55c=[..._0x3b736d[_0x402f45(0x25b)][_0x402f45(0x1e6)]];const _0x3d2432=_0x5886cb[_0x402f45(0x19e)](_0x178d47=>{return _0x178d47={'product_name':_0x178d47};});_0x59dfa4[_0x402f45(0x252)]((_0xc7030e,_0x226ef3)=>{var _0x3295cc=_0x402f45;_0x3d2432[_0x226ef3][_0x3295cc(0x17c)]=_0xc7030e;}),_0x1b4fff['forEach']((_0x52c240,_0x2c10db)=>{_0x3d2432[_0x2c10db]['secondary_code']=_0x52c240;}),_0x3e839a['forEach']((_0x2404ab,_0x7ec4d1)=>{var _0x371eb7=_0x402f45;_0x3d2432[_0x7ec4d1][_0x371eb7(0x191)]=_0x2404ab;}),_0x1e6dce['forEach']((_0x493ed7,_0x415417)=>{_0x3d2432[_0x415417]['sale_qty']=_0x493ed7;}),_0x265ba5[_0x402f45(0x252)]((_0x380727,_0x337f31)=>{_0x3d2432[_0x337f31]['stock']=_0x380727;}),_0x4a955c[_0x402f45(0x252)]((_0x23f915,_0xf7067)=>{_0x3d2432[_0xf7067]['return_qty']=_0x23f915;}),_0x27281e[_0x402f45(0x252)]((_0x22ed49,_0x2480ec)=>{var _0x435d4e=_0x402f45;_0x3d2432[_0x2480ec][_0x435d4e(0x192)]=_0x22ed49;}),_0x506beb['forEach']((_0x34b81e,_0x896ed)=>{var _0x5ccc51=_0x402f45;_0x3d2432[_0x896ed][_0x5ccc51(0x241)]=_0x34b81e;}),_0x2d113f['forEach']((_0x308e8e,_0xf490f2)=>{var _0x2a6728=_0x402f45;_0x3d2432[_0xf490f2][_0x2a6728(0x1bc)]=_0x308e8e;}),_0x16b55c[_0x402f45(0x252)]((_0x2a012f,_0x451d22)=>{var _0x7c25c4=_0x402f45;_0x3d2432[_0x451d22][_0x7c25c4(0x1e6)]=_0x2a012f;});var _0x3e0da2=0x0;_0x3d2432[_0x402f45(0x252)](_0x509a4a=>{var _0x6e2545=_0x402f45;console[_0x6e2545(0x1b8)](_0x6e2545(0x223),_0x509a4a),(parseInt(_0x509a4a[_0x6e2545(0x1c3)])<parseInt(_0x509a4a[_0x6e2545(0x1ba)])||parseInt(_0x509a4a[_0x6e2545(0x1fd)])<parseInt(_0x509a4a[_0x6e2545(0x1ba)])&&parseInt(_0x509a4a[_0x6e2545(0x1c3)])>parseInt(_0x509a4a[_0x6e2545(0x1ba)])||parseInt(_0x509a4a[_0x6e2545(0x1ba)])==0x0)&&_0x3e0da2++;});if(_0x3e0da2!=0x0)return _0x3b736d[_0x402f45(0x1e2)](_0x402f45(0x1b3),_0x402f45(0x1f9)),_0x41f27c[_0x402f45(0x17a)](_0x402f45(0x20b));const _0x5bafc4=await sales[_0x402f45(0x215)]({'invoice':_0x15d812});console[_0x402f45(0x1b8)](_0x5bafc4),_0x5bafc4['return_data']=_0x402f45(0x18b);const _0xe9986d=await _0x5bafc4['save'](),_0x468b6e=new sales_return({'invoice':_0x15d812,'customer':_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x173)],'date':_0x1d4f1e,'warehouse_name':_0x11c969,'room':_0x512eb4,'ToWarehouse':_0x31a272,'ToRoom':_0x3ad70c,'return_sale':_0x3d2432,'note':_0x1496ca}),_0x37677c=await _0x468b6e['save']();console[_0x402f45(0x1b8)](_0x468b6e);const _0x54344f=await sales_return[_0x402f45(0x215)]({'invoice':_0x15d812}),_0x5ea6a7=await warehouse[_0x402f45(0x215)]({'name':_0x31a272,'room':_0x3ad70c});_0x54344f[_0x402f45(0x175)]['forEach'](_0x159a56=>{var _0x26c592=_0x402f45,_0x211f70=0x0;const _0xa28fc=_0x5ea6a7[_0x26c592(0x1cd)][_0x26c592(0x19e)](_0x5a21d3=>{var _0x4f8e09=_0x26c592;_0x5a21d3[_0x4f8e09(0x251)]==_0x159a56[_0x4f8e09(0x251)]&&_0x5a21d3['floorlevel']==_0x159a56['floorlevel']&&_0x5a21d3[_0x4f8e09(0x1bc)]==_0x159a56[_0x4f8e09(0x1bc)]&&_0x5a21d3[_0x4f8e09(0x241)]==_0x159a56[_0x4f8e09(0x241)]&&_0x5a21d3[_0x4f8e09(0x192)]==_0x159a56[_0x4f8e09(0x192)]&&(_0x5a21d3[_0x4f8e09(0x206)]=parseInt(_0x5a21d3[_0x4f8e09(0x206)])+parseInt(_0x159a56['return_qty']),_0x211f70++);});_0x211f70=='0'&&(_0x5ea6a7[_0x26c592(0x1cd)]=_0x5ea6a7['product_details'][_0x26c592(0x258)]({'product_name':_0x159a56[_0x26c592(0x251)],'product_stock':_0x159a56['return_qty'],'primary_code':_0x159a56[_0x26c592(0x17c)],'secondary_code':_0x159a56[_0x26c592(0x16f)],'product_code':_0x159a56[_0x26c592(0x191)],'bay':_0x159a56[_0x26c592(0x192)],'bin':_0x159a56['bin'],'type':_0x159a56[_0x26c592(0x1bc)],'floorlevel':_0x159a56[_0x26c592(0x1e6)]})),console[_0x26c592(0x1b8)]('final',_0x5ea6a7);}),await _0x5ea6a7['save'](),console['log'](_0x3b736d[_0x402f45(0x25b)]);const _0x3d5fa5=new c_payment_data({'invoice':_0x15d812,'customer':_0x3b736d[_0x402f45(0x25b)]['customer'],'reason':_0x402f45(0x247)});await _0x3d5fa5['save']();const _0x51afdf=await master_shop[_0x402f45(0x255)]();console[_0x402f45(0x1b8)]('add\x20post',_0x51afdf[0x0][_0x402f45(0x257)]);const _0x5e7103=await email_settings['findOne'](),_0x64eeb4=await customer[_0x402f45(0x215)]({'name':_0x3b736d[_0x402f45(0x25b)][_0x402f45(0x173)]});console['log'](_0x402f45(0x1f8),_0x64eeb4);_0x51afdf[0x0]['currency_placement']==0x1?(right_currency=_0x51afdf[0x0][_0x402f45(0x1d9)],left_currency=''):(right_currency='',left_currency=_0x51afdf[0x0][_0x402f45(0x1d9)]);var _0x54155f=_0x5886cb,_0x23d9a5=_0x4a955c,_0x29f1dd='',_0xaadcd9;for(_0xaadcd9 in _0x54155f){_0x29f1dd+=_0x402f45(0x24f)+_0x402f45(0x18c)+_0x54155f[_0xaadcd9]+'</td>'+_0x402f45(0x18c)+_0x23d9a5[_0xaadcd9]+'</td>'+_0x402f45(0x228);}console[_0x402f45(0x1b8)]('product_list',_0x29f1dd);let _0x3ff2b4=nodemailer[_0x402f45(0x16b)]({'service':_0x402f45(0x20c),'auth':{'user':_0x5e7103['email'],'pass':_0x5e7103[_0x402f45(0x1ef)]}}),_0x1c8db5={'from':_0x5e7103[_0x402f45(0x1af)],'to':_0x64eeb4[_0x402f45(0x1af)],'subject':_0x402f45(0x1c4),'attachments':[{'filename':_0x402f45(0x205),'path':__dirname+_0x402f45(0x1a2)+_0x402f45(0x219)+_0x51afdf[0x0][_0x402f45(0x257)],'cid':_0x402f45(0x213)}],'html':_0x402f45(0x1a4)+'<html><head><title></title>'+'</head><body>'+_0x402f45(0x17e)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x402f45(0x17e)+_0x402f45(0x25d)+_0x402f45(0x1a5)+_0x402f45(0x17e)+_0x402f45(0x1a6)+_0x51afdf[0x0][_0x402f45(0x18e)]+_0x402f45(0x181)+'</div>'+_0x402f45(0x1a5)+_0x402f45(0x1c5)+_0x402f45(0x17e)+_0x402f45(0x1ac)+_0x402f45(0x1e9)+_0x15d812+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x402f45(0x1d4)+_0x1d4f1e+'\x20'+_0x402f45(0x200)+_0x402f45(0x172)+_0x402f45(0x1a5)+_0x402f45(0x185)+_0x402f45(0x1c6)+_0x402f45(0x24f)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x402f45(0x1ae)+_0x402f45(0x171)+_0x402f45(0x1db)+_0x402f45(0x228)+_0x402f45(0x236)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x29f1dd+'\x20'+'</tbody>'+_0x402f45(0x232)+'<div>'+'<strong>\x20Regards\x20</strong>'+'<h5>'+_0x51afdf[0x0]['site_title']+_0x402f45(0x172)+_0x402f45(0x1a5)+'</div>'+'</body></html>'};_0x3ff2b4['sendMail'](_0x1c8db5,function(_0x23f53b,_0x196e00){var _0x1984a1=_0x402f45;_0x23f53b?(console[_0x1984a1(0x1b8)](_0x23f53b),console[_0x1984a1(0x1b8)](_0x1984a1(0x186))):console[_0x1984a1(0x1b8)](_0x1984a1(0x184));}),_0x3b736d[_0x402f45(0x1e2)](_0x402f45(0x235),_0x402f45(0x209)),_0x41f27c[_0x402f45(0x17a)](_0x402f45(0x1b1));}catch(_0x265c3d){console[_0x402f45(0x1b8)](_0x265c3d),_0x41f27c[_0x402f45(0x221)](0xc8)['json']({'message1':_0x265c3d[_0x402f45(0x224)]});}}),router['get'](a0_0x38a7d7(0x180),auth,async(_0x21cbbb,_0x3d0380)=>{var _0x5a0af1=a0_0x38a7d7;try{const {username:_0x273593,email:_0x1ffdd6,role:_0x5d2767}=_0x21cbbb['user'],_0x4c4691=_0x21cbbb['user'],_0x4719fb=await profile[_0x5a0af1(0x215)]({'email':_0x4c4691['email']}),_0x3df89d=await master_shop[_0x5a0af1(0x255)]();console[_0x5a0af1(0x1b8)](_0x5a0af1(0x1d5),_0x3df89d);const _0x2d47ff=_0x21cbbb['params']['id'],_0x5e3a72=await sales['findById'](_0x2d47ff);console[_0x5a0af1(0x1b8)]('barcode\x20user_id',_0x5e3a72);if(_0x3df89d[0x0][_0x5a0af1(0x225)]==_0x5a0af1(0x1d8))var _0x96d8ce=users[_0x5a0af1(0x182)];else{if(_0x3df89d[0x0][_0x5a0af1(0x225)]=='Hindi')var _0x96d8ce=users[_0x5a0af1(0x1b6)];else{if(_0x3df89d[0x0][_0x5a0af1(0x225)]==_0x5a0af1(0x194))var _0x96d8ce=users['German'];else{if(_0x3df89d[0x0][_0x5a0af1(0x225)]==_0x5a0af1(0x20d))var _0x96d8ce=users[_0x5a0af1(0x20d)];else{if(_0x3df89d[0x0][_0x5a0af1(0x225)]==_0x5a0af1(0x1bb))var _0x96d8ce=users[_0x5a0af1(0x1bb)];else{if(_0x3df89d[0x0]['language']==_0x5a0af1(0x1da))var _0x96d8ce=users[_0x5a0af1(0x218)];else{if(_0x3df89d[0x0][_0x5a0af1(0x225)]==_0x5a0af1(0x19a))var _0x96d8ce=users[_0x5a0af1(0x19a)];else{if(_0x3df89d[0x0][_0x5a0af1(0x225)]=='Arabic\x20(ae)')var _0x96d8ce=users[_0x5a0af1(0x1cf)];}}}}}}}_0x3d0380[_0x5a0af1(0x19d)](_0x5a0af1(0x197),{'success':_0x21cbbb[_0x5a0af1(0x1e2)](_0x5a0af1(0x235)),'errors':_0x21cbbb[_0x5a0af1(0x1e2)]('errors'),'role':_0x4c4691,'profile':_0x4719fb,'alldata':_0x5e3a72,'master_shop':_0x3df89d,'language':_0x96d8ce});}catch(_0x316614){console[_0x5a0af1(0x1b8)](_0x316614);}}),router[a0_0x38a7d7(0x19c)](a0_0x38a7d7(0x1e3),async(_0xb7d230,_0x2d01d9)=>{var _0xb85730=a0_0x38a7d7;const {product_code:_0x291685,warehouse_name:_0x21dcd1,rooms_data:_0x12e29f,Roomslist:_0xb71813}=_0xb7d230[_0xb85730(0x25b)],_0x568a5b=_0xb71813[_0xb85730(0x253)](','),_0x54983e=[];async function _0x264936(_0x77c9a2){var _0x5d86f7=_0xb85730;const _0x54a6f3=await warehouse[_0x5d86f7(0x1aa)]([{'$match':{'name':_0x21dcd1,'room':_0x77c9a2}},{'$unwind':_0x5d86f7(0x176)},{'$match':{'product_details.primary_code':_0x291685}},{'$group':{'_id':_0x5d86f7(0x195),'name':{'$first':_0x5d86f7(0x1f1)},'product_stock':{'$first':_0x5d86f7(0x21d)},'primary_code':{'$first':_0x5d86f7(0x179)},'secondary_code':{'$first':_0x5d86f7(0x1f3)},'product_code':{'$first':_0x5d86f7(0x178)},'level':{'$first':_0x5d86f7(0x1d6)},'isle':{'$first':_0x5d86f7(0x1f2)},'type':{'$first':_0x5d86f7(0x22c)},'pallet':{'$first':_0x5d86f7(0x1c0)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x5d86f7(0x23f)},'rack':{'$first':_0x5d86f7(0x1e0)},'expiry_date':{'$first':_0x5d86f7(0x1de)},'production_date':{'$first':_0x5d86f7(0x24c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x5d86f7(0x249)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x5d86f7(0x1d2)}}}]),_0x339e59=await warehouse[_0x5d86f7(0x1aa)]([{'$match':{'name':_0x21dcd1,'room':_0x77c9a2}},{'$unwind':_0x5d86f7(0x176)},{'$match':{'product_details.secondary_code':_0x291685}},{'$group':{'_id':_0x5d86f7(0x195),'name':{'$first':_0x5d86f7(0x1f1)},'product_stock':{'$first':_0x5d86f7(0x21d)},'primary_code':{'$first':_0x5d86f7(0x179)},'secondary_code':{'$first':_0x5d86f7(0x1f3)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x5d86f7(0x1d6)},'isle':{'$first':_0x5d86f7(0x1f2)},'type':{'$first':_0x5d86f7(0x22c)},'pallet':{'$first':_0x5d86f7(0x1c0)},'unit':{'$first':_0x5d86f7(0x1f7)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x5d86f7(0x1e0)},'expiry_date':{'$first':_0x5d86f7(0x1de)},'production_date':{'$first':_0x5d86f7(0x24c)},'maxPerUnit':{'$first':_0x5d86f7(0x193)},'batch_code':{'$first':_0x5d86f7(0x16e)},'product_cat':{'$first':_0x5d86f7(0x249)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x54a6f3['length']>0x0)_0x54983e['push'](_0x54a6f3);else _0x339e59[_0x5d86f7(0x1bf)]>0x0&&_0x54983e[_0x5d86f7(0x1c9)](_0x339e59);}const _0x38b7c1=_0x568a5b['map'](_0x1ab9c1=>_0x264936(_0x1ab9c1));await Promise['all'](_0x38b7c1),_0x2d01d9['json'](_0x54983e);}),module[a0_0x38a7d7(0x1b9)]=router;