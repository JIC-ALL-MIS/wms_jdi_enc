var a0_0x378e80=a0_0x1ff8;function a0_0x1ff8(_0xd1fd96,_0x310439){var _0x347209=a0_0x3472();return a0_0x1ff8=function(_0x1ff876,_0xd84a18){_0x1ff876=_0x1ff876-0x18c;var _0xe55786=_0x347209[_0x1ff876];return _0xe55786;},a0_0x1ff8(_0xd1fd96,_0x310439);}(function(_0x39908b,_0x172aec){var _0x2693ca=a0_0x1ff8,_0x126c65=_0x39908b();while(!![]){try{var _0x13ec8f=-parseInt(_0x2693ca(0x223))/0x1+parseInt(_0x2693ca(0x18c))/0x2+parseInt(_0x2693ca(0x269))/0x3*(-parseInt(_0x2693ca(0x23f))/0x4)+parseInt(_0x2693ca(0x1f8))/0x5+-parseInt(_0x2693ca(0x221))/0x6+parseInt(_0x2693ca(0x1c4))/0x7+-parseInt(_0x2693ca(0x222))/0x8;if(_0x13ec8f===_0x172aec)break;else _0x126c65['push'](_0x126c65['shift']());}catch(_0x142b65){_0x126c65['push'](_0x126c65['shift']());}}}(a0_0x3472,0xc3802));function a0_0x3472(){var _0x34edd9=['$product_details.secondary_unit','</tbody>','edit_sales','$product_details.floorlevel','errors','all_sales_barcode','quantity_notConverted','purchases_data','Chinese','$sale_product.floorlevel','/preview/:id','received_amount','$product_details.production_date','adjust_qty','warehouse','createTransport','Received\x20Payment\x20For\x20Sale','True','express','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','$date','all','storage','$product_details.rack','</tr>','/upload/','forEach','4425384Ywfcdr','6068752mSBiny','558958twbwzs','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','customer','$product_details.bin','sales_invoice','Enabled','../models/all_models','$product_details.level','filter','<div>','$product_details.primary_code','Logo.png','error','padStart','</span>','German','batch_code','barcode\x20user_id','flash','split','final','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','find','rack','$product_details.bay','post','getFullYear','note','12sksmvz','stocks','/view/:id','An\x20error\x20occurred.','$sale_product.bin','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','room_name','$product_details.maxPerUnit','</table>','</h5>','currency','suppliers','Portuguese\x20(BR)','product_name','Return\x20Goods','map','$product_details','Shelves','$_id','RoomAssigned','sale_qty','<!DOCTYPE\x20html>','Raw\x20Materials','master','staff','\x20</h2>','back','$name','stock','$return_data','$product','catch','<table\x20style=\x22width:\x20100%\x20!important;\x22>','pallet','<h5\x20style=\x22text-align:\x20left;\x22>','Sale\x20Return\x20Mail','$sale_product.bay','/all_sales/preview/','</div>','Return\x20Rooms','$product_details.product_name','types','8031bMReEg','success','currency_placement','$invoice','/all_sales/view','sales_quantity','image','findById','Level','Sales\x20Add\x20successfully','old_warehouse_data','product_data','prod_code','Error\x20Occurs','delivery_code','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','production_date','<html><head><title></title>','logo','</td>','$product_details.storage','Floor','level','findOne','date','concat','length','3172338OfpfPQ','quantity','log','all_sales','return_qty','/give_payment/:id','Arabic\x20(ae)','_id','getDate','$warehouse_name','message','json','$product_details.unit','push','sale_product','product_details','redirect','warehouse_name','floorlevel','$product_details.product_cat','$sale_product.type','Ambient','render','return_data','aggregate','$customer','Sales\x20Update\x20successfully','slice','isle','An\x20error\x20occurred\x20while\x20saving\x20data.','max_per_unit','$product_details.batch_code','edit_sales_view','$product_details.product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','requested_qty','prod_cat','site_title','/barcode/:id','\x20Order\x20Number\x20:\x20','body','<span\x20style=\x22float:\x20right;\x22>','stock_data','amount','/view/return_sales/:id','</thead>','add\x20post','finalize','user','save','/view','$product_details.secondary_code','secondary_unit','Hindi','password','primary_unit','7146111nKhqvx','nodemailer','$product_details.type','$finalize','status','<tbody\x20style=\x22text-align:\x20center;\x22>','params','foreach\x20newproduct','<h2>\x20','Spanish','Receiving\x20Area','$sale_product.quantity','carton','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','customers','product_code','bay','/view/add_sale/product','invoice','<hr\x20class=\x22my-3\x22>','getMonth','<tr>','$product_details.expiry_date','English','role','secondary_code','$sale_product','Email\x20sent\x20successfully','<strong>\x20Regards\x20</strong>','Enclosed','product_stock','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','/view/add_sales','$product_details.product_stock','gmail','bin','Portuguese','expiry_date','type','$customers_docs','sales\x20all_data','Arabic','Router','primary_code','language','$note','../middleware/auth','product_list','maxperunit','product','French','user_id','1284375vhTuTa','get','customers_docs','../public/language/languages.json','delivery_date','return_sale','English\x20(US)','</body></html>','</head><body>','email','room','sales\x20item\x20return\x20successfull','$product_details._id','payment\x20successfull'];a0_0x3472=function(){return _0x34edd9;};return a0_0x3472();}const express=require(a0_0x378e80(0x218)),app=express(),router=express[a0_0x378e80(0x1ee)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings}=require(a0_0x378e80(0x229)),auth=require(a0_0x378e80(0x1f2)),nodemailer=require(a0_0x378e80(0x1c5)),users=require(a0_0x378e80(0x1fb));router[a0_0x378e80(0x1f9)](a0_0x378e80(0x1be),auth,async(_0x99aa80,_0x42a0f1)=>{var _0x1ff5ca=a0_0x378e80;try{const {username:_0x38583f,email:_0x5f261b,role:_0x4ab0ce}=_0x99aa80['user'],_0xaf4401=_0x99aa80[_0x1ff5ca(0x1bc)],_0x5e5b60=await profile[_0x1ff5ca(0x280)]({'email':_0xaf4401[_0x1ff5ca(0x201)]}),_0x57c49f=await master_shop[_0x1ff5ca(0x239)]();let _0x408937;if(_0xaf4401['role']==_0x1ff5ca(0x257)){const _0x10993a=await staff[_0x1ff5ca(0x280)]({'email':_0xaf4401[_0x1ff5ca(0x201)]});_0x408937=await sales[_0x1ff5ca(0x1a4)]([{'$lookup':{'from':_0x1ff5ca(0x1d2),'localField':_0x1ff5ca(0x225),'foreignField':'name','as':_0x1ff5ca(0x1fa)}},{'$unwind':_0x1ff5ca(0x1eb)},{'$unwind':_0x1ff5ca(0x1de)},{'$group':{'_id':'$_id','invoice':{'$first':_0x1ff5ca(0x26c)},'customers':{'$first':'$customer'},'date':{'$first':_0x1ff5ca(0x21a)},'warehouse_name':{'$first':_0x1ff5ca(0x195)},'sale_product':{'$push':_0x1ff5ca(0x1de)},'note':{'$first':_0x1ff5ca(0x1f1)},'return_data':{'$first':_0x1ff5ca(0x25c)},'customers_docs':{'$first':_0x1ff5ca(0x1eb)},'total_saleproduct_quantity':{'$sum':_0x1ff5ca(0x1cf)},'level':{'$addToSet':_0x1ff5ca(0x263)},'isle':{'$addToSet':'$sale_product.bin'},'type':{'$addToSet':_0x1ff5ca(0x1a0)},'pallet':{'$addToSet':_0x1ff5ca(0x20f)},'finalize':{'$first':_0x1ff5ca(0x1c7)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);}else _0x408937=await sales[_0x1ff5ca(0x1a4)]([{'$lookup':{'from':_0x1ff5ca(0x1d2),'localField':_0x1ff5ca(0x225),'foreignField':'name','as':'customers_docs'}},{'$unwind':_0x1ff5ca(0x1eb)},{'$unwind':_0x1ff5ca(0x1de)},{'$group':{'_id':_0x1ff5ca(0x251),'invoice':{'$first':_0x1ff5ca(0x26c)},'customers':{'$first':_0x1ff5ca(0x1a5)},'date':{'$first':_0x1ff5ca(0x21a)},'warehouse_name':{'$first':_0x1ff5ca(0x195)},'sale_product':{'$push':_0x1ff5ca(0x1de)},'note':{'$first':_0x1ff5ca(0x1f1)},'return_data':{'$first':_0x1ff5ca(0x25c)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x1ff5ca(0x1cf)},'level':{'$addToSet':_0x1ff5ca(0x263)},'isle':{'$addToSet':_0x1ff5ca(0x243)},'type':{'$addToSet':_0x1ff5ca(0x1a0)},'pallet':{'$addToSet':_0x1ff5ca(0x20f)},'finalize':{'$first':_0x1ff5ca(0x1c7)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1}}]);console['log'](_0x1ff5ca(0x1ec),_0x408937);if(_0x57c49f[0x0][_0x1ff5ca(0x1f0)]==_0x1ff5ca(0x1fe)){var _0x4e7c59=users[_0x1ff5ca(0x1db)];console['log'](_0x4e7c59);}else{if(_0x57c49f[0x0][_0x1ff5ca(0x1f0)]==_0x1ff5ca(0x1c1))var _0x4e7c59=users['Hindi'];else{if(_0x57c49f[0x0][_0x1ff5ca(0x1f0)]==_0x1ff5ca(0x232))var _0x4e7c59=users['German'];else{if(_0x57c49f[0x0][_0x1ff5ca(0x1f0)]==_0x1ff5ca(0x1cd))var _0x4e7c59=users[_0x1ff5ca(0x1cd)];else{if(_0x57c49f[0x0]['language']==_0x1ff5ca(0x1f6))var _0x4e7c59=users[_0x1ff5ca(0x1f6)];else{if(_0x57c49f[0x0][_0x1ff5ca(0x1f0)]==_0x1ff5ca(0x24b))var _0x4e7c59=users['Portuguese'];else{if(_0x57c49f[0x0][_0x1ff5ca(0x1f0)]==_0x1ff5ca(0x20e))var _0x4e7c59=users[_0x1ff5ca(0x20e)];else{if(_0x57c49f[0x0][_0x1ff5ca(0x1f0)]==_0x1ff5ca(0x192))var _0x4e7c59=users[_0x1ff5ca(0x1ed)];}}}}}}}_0x42a0f1['render'](_0x1ff5ca(0x18f),{'success':_0x99aa80[_0x1ff5ca(0x235)](_0x1ff5ca(0x26a)),'errors':_0x99aa80[_0x1ff5ca(0x235)](_0x1ff5ca(0x20a)),'sales':_0x408937,'profile':_0x5e5b60,'role':_0xaf4401,'master_shop':_0x57c49f,'language':_0x4e7c59});}catch(_0x22952d){console[_0x1ff5ca(0x18e)](_0x22952d);}}),router[a0_0x378e80(0x1f9)](a0_0x378e80(0x1e4),auth,async(_0x59da9d,_0x41d51d)=>{var _0x1d3b1c=a0_0x378e80;try{const {username:_0x55c4b1,email:_0xaaa233,role:_0x5c9835}=_0x59da9d[_0x1d3b1c(0x1bc)],_0x483341=_0x59da9d[_0x1d3b1c(0x1bc)],_0x4caa9b=await profile[_0x1d3b1c(0x280)]({'email':_0x483341['email']}),_0x19b69f=await master_shop['find'](),_0x417136=await customer[_0x1d3b1c(0x239)]({});let _0x3b80d1;if(_0x483341['role']==_0x1d3b1c(0x257)){const _0x51bc9b=await staff[_0x1d3b1c(0x280)]({'email':_0x483341[_0x1d3b1c(0x201)]});_0x3b80d1=await warehouse[_0x1d3b1c(0x1a4)]([{'$match':{'status':_0x1d3b1c(0x228),'name':_0x51bc9b[_0x1d3b1c(0x214)],'warehouse_category':_0x1d3b1c(0x255),'name':{'$ne':_0x1d3b1c(0x24d)}}},{'$group':{'_id':_0x1d3b1c(0x25a),'name':{'$first':_0x1d3b1c(0x25a)}}},{'$sort':{'name':0x1}}]);}else _0x3b80d1=await warehouse[_0x1d3b1c(0x1a4)]([{'$match':{'status':_0x1d3b1c(0x228),'warehouse_category':_0x1d3b1c(0x255),'name':{'$ne':_0x1d3b1c(0x24d)}}},{'$group':{'_id':_0x1d3b1c(0x25a),'name':{'$first':_0x1d3b1c(0x25a)}}},{'$sort':{'name':0x1}}]);const _0x57ab82=await product[_0x1d3b1c(0x239)]({});var _0x3fb326=['Ambient',_0x1d3b1c(0x1e1)];const _0x294dfc=await sales['find']({}),_0x24d917=_0x294dfc[_0x1d3b1c(0x283)]+0x1,_0x1acf99='OUT-'+_0x24d917['toString']()[_0x1d3b1c(0x230)](0x5,'0');if(_0x19b69f[0x0][_0x1d3b1c(0x1f0)]==_0x1d3b1c(0x1fe)){var _0x3887df=users[_0x1d3b1c(0x1db)];console['log'](_0x3887df);}else{if(_0x19b69f[0x0]['language']=='Hindi')var _0x3887df=users[_0x1d3b1c(0x1c1)];else{if(_0x19b69f[0x0][_0x1d3b1c(0x1f0)]==_0x1d3b1c(0x232))var _0x3887df=users[_0x1d3b1c(0x232)];else{if(_0x19b69f[0x0][_0x1d3b1c(0x1f0)]==_0x1d3b1c(0x1cd))var _0x3887df=users[_0x1d3b1c(0x1cd)];else{if(_0x19b69f[0x0][_0x1d3b1c(0x1f0)]==_0x1d3b1c(0x1f6))var _0x3887df=users['French'];else{if(_0x19b69f[0x0]['language']==_0x1d3b1c(0x24b))var _0x3887df=users[_0x1d3b1c(0x1e8)];else{if(_0x19b69f[0x0][_0x1d3b1c(0x1f0)]==_0x1d3b1c(0x20e))var _0x3887df=users['Chinese'];else{if(_0x19b69f[0x0][_0x1d3b1c(0x1f0)]==_0x1d3b1c(0x192))var _0x3887df=users['Arabic'];}}}}}}}_0x41d51d[_0x1d3b1c(0x1a2)]('add_sales',{'success':_0x59da9d[_0x1d3b1c(0x235)](_0x1d3b1c(0x26a)),'errors':_0x59da9d['flash'](_0x1d3b1c(0x20a)),'role':_0x483341,'profile':_0x4caa9b,'customer':_0x417136,'warehouse':_0x3b80d1,'product':_0x57ab82,'invoice':_0x1acf99,'master_shop':_0x19b69f,'language':_0x3887df,'rooms_data':_0x3fb326});}catch(_0x358fd7){console['log'](_0x358fd7);}}),router['get']('/view/add_sales/:id',auth,async(_0x329466,_0x16a858)=>{var _0x43095f=a0_0x378e80;try{const _0x56b52e=_0x329466['params']['id'];console['log'](_0x56b52e);const _0xc52c76=await product['find'](),_0x898d29=await purchases[_0x43095f(0x1a4)]([{'$match':{'warehouse_name':_0x56b52e}},{'$unwind':_0x43095f(0x25d)},{'$group':{'_id':'$product.product_name'}}]);console[_0x43095f(0x18e)](_0x43095f(0x20d),_0x898d29),_0x16a858[_0x43095f(0x1c8)](0xc8)[_0x43095f(0x197)]({'purchases_data':_0x898d29,'product_data':_0xc52c76});}catch(_0x5707bd){console['log'](_0x5707bd);}}),router[a0_0x378e80(0x23c)](a0_0x378e80(0x1d5),auth,async(_0x334c0d,_0x266622)=>{var _0x34fb92=a0_0x378e80;try{const {warehouse_data:_0x5f00c3,product_data:_0x5a684b}=_0x334c0d['body'];console[_0x34fb92(0x18e)](_0x334c0d[_0x34fb92(0x1b4)][_0x34fb92(0x274)]);;const _0x212c7b=await master_shop[_0x34fb92(0x239)]();console[_0x34fb92(0x18e)](_0x34fb92(0x256),_0x212c7b);const _0x3f7bfe=await product[_0x34fb92(0x280)]({'name':_0x5a684b});console[_0x34fb92(0x18e)](_0x34fb92(0x1f5),_0x3f7bfe);const _0x3ee14e=await warehouse['aggregate']([{'$match':{'name':_0x5f00c3}},{'$unwind':'$product_details'},{'$match':{'product_details.product_name':_0x5a684b}},{'$group':{'_id':_0x34fb92(0x267),'product_stock':{'$first':_0x34fb92(0x1e5)}}}]);console[_0x34fb92(0x18e)](_0x34fb92(0x1b6),_0x3ee14e),_0x266622[_0x34fb92(0x1c8)](0xc8)[_0x34fb92(0x197)]({'master':_0x212c7b,'new_product':_0x3f7bfe,'stock_data':_0x3ee14e});}catch(_0xa41cb9){console[_0x34fb92(0x18e)](_0xa41cb9);}}),router['post'](a0_0x378e80(0x1e4),auth,async(_0x1d39dd,_0x2cf944)=>{var _0x26c83a=a0_0x378e80;try{const {invoice:_0x4a66c6,date:_0x81cc34,warehouse_name:_0x2ccd2a,product_name:_0x5dee78,stock:_0x8418ae,quantity:_0x2a470e,note:_0x107234,room:_0x4540ce,primary_code:_0x2c3726,secondary_code:_0x14e0f3,prod_code:_0x39647b,level:_0x36589b,isle:_0xd70c36,pallet:_0x27b610,batch_code:_0x35e0e1,SCRN:_0x4adecd,expiry_date:_0x359fe8}=_0x1d39dd[_0x26c83a(0x1b4)];if(typeof _0x5dee78=='string')var _0x5ee894=[_0x1d39dd['body'][_0x26c83a(0x24c)]],_0x31c4a1=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x25b)]],_0x41a7a4=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1d0)]],_0x3d55d1=[_0x1d39dd['body']['primary_code']],_0x2cc9ed=[_0x1d39dd[_0x26c83a(0x1b4)]['secondary_code']],_0x4fee33=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x275)]],_0x58eeb4=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x27f)]],_0x17c281=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1c3)]],_0x4a4bfd=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1c0)]],_0x50070f=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x233)]],_0x3e6e3b=[_0x1d39dd[_0x26c83a(0x1b4)]['expiry_date']],_0x12c027=[_0x1d39dd['body'][_0x26c83a(0x1aa)]],_0x51cef4=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x279)]],_0x4e75ae=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1af)]],_0x5c32dc=[_0x1d39dd['body'][_0x26c83a(0x1fc)]],_0x59aeaa=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x277)]],_0x12c5e0=[_0x1d39dd[_0x26c83a(0x1b4)]['prod_cat']],_0x823ba9=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x18d)]],_0x2b4c0f=[_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x252)]];else var _0x5ee894=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x24c)]],_0x31c4a1=[..._0x1d39dd['body'][_0x26c83a(0x25b)]],_0x41a7a4=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1d0)]],_0x3d55d1=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1ef)]],_0x2cc9ed=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1dd)]],_0x4fee33=[..._0x1d39dd['body']['prod_code']],_0x58eeb4=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x27f)]],_0x17c281=[..._0x1d39dd[_0x26c83a(0x1b4)]['primary_unit']],_0x4a4bfd=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1c0)]],_0x50070f=[..._0x1d39dd[_0x26c83a(0x1b4)]['batch_code']],_0x3e6e3b=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1e9)]],_0x12c027=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1aa)]],_0x51cef4=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x279)]],_0x4e75ae=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1af)]],_0x5c32dc=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1fc)]],_0x59aeaa=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x277)]],_0x12c5e0=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x1b0)]],_0x823ba9=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x18d)]],_0x2b4c0f=[..._0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x252)]];const _0x32e127=_0x5ee894['map'](_0x5dcc02=>{return _0x5dcc02={'product_name':_0x5dcc02};});_0x31c4a1[_0x26c83a(0x220)]((_0x262cb6,_0x5cd297)=>{var _0x4ea116=_0x26c83a;_0x32e127[_0x5cd297][_0x4ea116(0x25b)]=_0x262cb6;}),_0x41a7a4[_0x26c83a(0x220)]((_0x2f5d34,_0x5b37eb)=>{var _0x37d017=_0x26c83a;_0x32e127[_0x5b37eb][_0x37d017(0x18d)]=_0x2f5d34;}),_0x3d55d1[_0x26c83a(0x220)]((_0x5d0440,_0x511be7)=>{var _0x1deffe=_0x26c83a;_0x32e127[_0x511be7][_0x1deffe(0x1ef)]=_0x5d0440;}),_0x2cc9ed['forEach']((_0x554172,_0x126b2b)=>{var _0x2469d8=_0x26c83a;_0x32e127[_0x126b2b][_0x2469d8(0x1dd)]=_0x554172;}),_0x4fee33[_0x26c83a(0x220)]((_0xfa9561,_0x157f08)=>{var _0x4dcf64=_0x26c83a;_0x32e127[_0x157f08][_0x4dcf64(0x1d3)]=_0xfa9561;}),_0x58eeb4[_0x26c83a(0x220)]((_0x323211,_0x3f604c)=>{var _0x40629b=_0x26c83a;_0x2b4c0f[_0x40629b(0x220)]((_0xb8d60c,_0x5d2285)=>{var _0x4c5cd1=_0x40629b;if(_0xb8d60c==_0x4c5cd1(0x1ce)&&_0x3f604c==_0x5d2285){var _0x16fd32=_0x323211['slice'](0x3);_0x32e127[_0x3f604c][_0x4c5cd1(0x21c)]=_0x323211[0x0],_0x32e127[_0x3f604c][_0x4c5cd1(0x23a)]=_0x323211[0x1],_0x32e127[_0x3f604c][_0x4c5cd1(0x1d4)]=0x0,_0x32e127[_0x3f604c][_0x4c5cd1(0x1e7)]=0x0,_0x32e127[_0x3f604c][_0x4c5cd1(0x1ea)]=_0x4c5cd1(0x27e),_0x32e127[_0x3f604c][_0x4c5cd1(0x19e)]=_0x16fd32;}else{if(_0xb8d60c==_0x4c5cd1(0x250)&&_0x3f604c==_0x5d2285){var _0x16fd32=_0x323211['slice'](0x3);_0x32e127[_0x3f604c]['storage']=_0x323211[0x0],_0x32e127[_0x3f604c]['rack']=_0x323211[0x1],_0x32e127[_0x3f604c][_0x4c5cd1(0x1d4)]=0x0,_0x32e127[_0x3f604c][_0x4c5cd1(0x1e7)]=0x0,_0x32e127[_0x3f604c][_0x4c5cd1(0x1ea)]='Floor',_0x32e127[_0x3f604c]['floorlevel']=_0x323211[0x5];}else{if(_0x3f604c==_0x5d2285){var _0x3efbd9;if(_0x323211[0x4]=='L')_0x3efbd9=_0x4c5cd1(0x271);else _0x323211[0x4]=='F'&&(_0x3efbd9=_0x4c5cd1(0x27e));_0x32e127[_0x3f604c]['storage']=_0x323211[0x0],_0x32e127[_0x3f604c][_0x4c5cd1(0x23a)]=_0x323211[0x1],_0x32e127[_0x3f604c][_0x4c5cd1(0x1d4)]=_0x323211[0x2],_0x32e127[_0x3f604c][_0x4c5cd1(0x1e7)]=_0x323211[0x3],_0x32e127[_0x3f604c][_0x4c5cd1(0x1ea)]=_0x3efbd9,_0x32e127[_0x3f604c][_0x4c5cd1(0x19e)]=_0x323211[0x5];}}}});}),_0x17c281[_0x26c83a(0x220)]((_0x5713f5,_0x4b177c)=>{_0x32e127[_0x4b177c]['unit']=_0x5713f5;}),_0x4a4bfd[_0x26c83a(0x220)]((_0x42853f,_0x4809ba)=>{_0x32e127[_0x4809ba]['secondary_unit']=_0x42853f;}),_0x50070f[_0x26c83a(0x220)]((_0x44f19d,_0xcff88e)=>{var _0x32b80d=_0x26c83a;_0x32e127[_0xcff88e][_0x32b80d(0x233)]=_0x44f19d;}),_0x3e6e3b['forEach']((_0x419387,_0x444f13)=>{var _0x1dc35c=_0x26c83a;_0x32e127[_0x444f13][_0x1dc35c(0x1e9)]=_0x419387;}),_0x12c027[_0x26c83a(0x220)]((_0x570861,_0x577333)=>{var _0x55c5ce=_0x26c83a;_0x32e127[_0x577333][_0x55c5ce(0x1f4)]=_0x570861;}),_0x51cef4[_0x26c83a(0x220)]((_0x4e505e,_0x386d08)=>{var _0x4c5b19=_0x26c83a;_0x32e127[_0x386d08][_0x4c5b19(0x279)]=_0x4e505e;}),_0x4e75ae[_0x26c83a(0x220)]((_0x5b9d7d,_0xec5b9e)=>{var _0x51f047=_0x26c83a;_0x32e127[_0xec5b9e][_0x51f047(0x1af)]=_0x5b9d7d;}),_0x5c32dc[_0x26c83a(0x220)]((_0x50640c,_0xb6156d)=>{var _0x11a95e=_0x26c83a;_0x32e127[_0xb6156d][_0x11a95e(0x1fc)]=_0x50640c;}),_0x59aeaa[_0x26c83a(0x220)]((_0x841173,_0x5862fd)=>{_0x32e127[_0x5862fd]['delivery_code']=_0x841173;}),_0x12c5e0[_0x26c83a(0x220)]((_0x4c9248,_0x4fe25e)=>{_0x32e127[_0x4fe25e]['prod_cat']=_0x4c9248;}),_0x823ba9[_0x26c83a(0x220)]((_0x4ef67d,_0x3ce37b)=>{var _0x5509ac=_0x26c83a;_0x32e127[_0x3ce37b][_0x5509ac(0x20c)]=_0x4ef67d;}),_0x2b4c0f['forEach']((_0x1cc682,_0x3d28c7)=>{var _0x3094c2=_0x26c83a;_0x32e127[_0x3d28c7][_0x3094c2(0x245)]=_0x1cc682;});var _0x3358df=0x0;_0x32e127[_0x26c83a(0x220)](_0x422426=>{var _0x39c589=_0x26c83a;(_0x422426[_0x39c589(0x25b)]<_0x422426[_0x39c589(0x20c)]||_0x422426[_0x39c589(0x20c)]==0x0)&&(console['log'](_0x39c589(0x1cb),_0x422426),_0x3358df++);});const _0x5df137=_0x32e127[_0x26c83a(0x22b)](_0x5912c8=>_0x5912c8['quantity']!=='0'&&_0x5912c8['quantity']!==''),_0x5f1f74=new sales({'invoice':_0x4a66c6,'customer':_0x1d39dd[_0x26c83a(0x1b4)][_0x26c83a(0x225)],'date':_0x81cc34,'warehouse_name':_0x2ccd2a,'sale_product':_0x5df137,'note':_0x107234,'room':_0x4540ce,'primary_code':_0x2c3726,'secondary_code':_0x14e0f3,'prod_code':_0x39647b,'SCRN':_0x4adecd}),_0x4a587e=await _0x5f1f74[_0x26c83a(0x1bd)]();_0x1d39dd[_0x26c83a(0x235)](_0x26c83a(0x26a),_0x26c83a(0x272)),_0x2cf944[_0x26c83a(0x19c)](_0x26c83a(0x264)+_0x4a587e[_0x26c83a(0x193)]);}catch(_0x3d3c4f){console[_0x26c83a(0x18e)](_0x3d3c4f);}}),router[a0_0x378e80(0x1f9)](a0_0x378e80(0x210),auth,async(_0x341cc7,_0xf6d391)=>{var _0x506555=a0_0x378e80;try{const {username:_0x522535,email:_0x13ad75,role:_0x6cce5c}=_0x341cc7['user'],_0x32e531=_0x341cc7[_0x506555(0x1bc)],_0x4ad358=await profile['findOne']({'email':_0x32e531['email']}),_0x2ea801=await master_shop[_0x506555(0x239)](),_0x4160f2=_0x341cc7[_0x506555(0x1ca)]['id'],_0xbb91d7=await sales[_0x506555(0x270)](_0x4160f2),_0x2487c9=await warehouse[_0x506555(0x1a4)]([{'$match':{'name':_0xbb91d7[_0x506555(0x19d)]}},{'$unwind':_0x506555(0x24f)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x506555(0x1e5)},'bay':{'$first':_0x506555(0x23b)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x506555(0x1c6)},'floorlevel':{'$first':_0x506555(0x209)},'primary_code':{'$first':_0x506555(0x22d)},'secondary_code':{'$first':_0x506555(0x1bf)},'product_code':{'$first':_0x506555(0x1ad)},'storage':{'$first':_0x506555(0x27d)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x506555(0x1da)},'production_date':{'$first':'$product_details.production_date'}}}]),_0x29079b=await customer[_0x506555(0x239)]({});let _0x5b5c94;if(_0x32e531[_0x506555(0x1dc)]==_0x506555(0x257)){const _0x59d578=await staff['findOne']({'email':_0x32e531[_0x506555(0x201)]});_0x5b5c94=await warehouse[_0x506555(0x1a4)]([{'$match':{'status':_0x506555(0x228),'name':_0x59d578[_0x506555(0x214)]}},{'$group':{'_id':'$name','name':{'$first':'$name'}}}]);}else _0x5b5c94=await warehouse[_0x506555(0x1a4)]([{'$match':{'status':_0x506555(0x228)}},{'$group':{'_id':_0x506555(0x25a),'name':{'$first':_0x506555(0x25a)}}}]);const _0x459947=await product['find']({}),_0x35463a=await suppliers[_0x506555(0x239)]({});if(_0x2ea801[0x0][_0x506555(0x1f0)]==_0x506555(0x1fe)){var _0x18c1d4=users[_0x506555(0x1db)];console[_0x506555(0x18e)](_0x18c1d4);}else{if(_0x2ea801[0x0][_0x506555(0x1f0)]==_0x506555(0x1c1))var _0x18c1d4=users['Hindi'];else{if(_0x2ea801[0x0][_0x506555(0x1f0)]==_0x506555(0x232))var _0x18c1d4=users['German'];else{if(_0x2ea801[0x0][_0x506555(0x1f0)]==_0x506555(0x1cd))var _0x18c1d4=users[_0x506555(0x1cd)];else{if(_0x2ea801[0x0][_0x506555(0x1f0)]==_0x506555(0x1f6))var _0x18c1d4=users['French'];else{if(_0x2ea801[0x0][_0x506555(0x1f0)]==_0x506555(0x24b))var _0x18c1d4=users[_0x506555(0x1e8)];else{if(_0x2ea801[0x0][_0x506555(0x1f0)]==_0x506555(0x20e))var _0x18c1d4=users[_0x506555(0x20e)];else{if(_0x2ea801[0x0][_0x506555(0x1f0)]=='Arabic\x20(ae)')var _0x18c1d4=users[_0x506555(0x1ed)];}}}}}}}_0xf6d391[_0x506555(0x1a2)](_0x506555(0x1ac),{'success':_0x341cc7[_0x506555(0x235)]('success'),'errors':_0x341cc7[_0x506555(0x235)]('errors'),'role':_0x32e531,'profile':_0x4ad358,'customer':_0x29079b,'warehouse':_0x5b5c94,'product':_0x2487c9,'user':_0xbb91d7,'master_shop':_0x2ea801,'unit':_0x459947,'language':_0x18c1d4,'suppliers':_0x35463a});}catch(_0x21bbbe){console['log'](_0x21bbbe);}}),router['post'](a0_0x378e80(0x210),auth,async(_0x1ad5be,_0x20985b)=>{var _0x41b037=a0_0x378e80;try{const _0x210cac=_0x1ad5be[_0x41b037(0x1ca)]['id'],{invoice:_0x2a2fc3,warehouse_name:_0xa6f75a,room:_0x41ad3c}=_0x1ad5be['body'],_0x509387=await sales['findOne']({'invoice':_0x2a2fc3}),_0x2869f0=_0x509387[_0x41b037(0x19a)][_0x41b037(0x24e)](async _0x3a140a=>{var _0x1aa886=_0x41b037,_0x371b4f=await warehouse[_0x1aa886(0x280)]({'name':_0xa6f75a,'room':_0x3a140a[_0x1aa886(0x245)],'warehouse_category':_0x1aa886(0x255)});const _0x124432=_0x371b4f['product_details'][_0x1aa886(0x24e)](_0x39dd9d=>{var _0x1fde85=_0x1aa886;_0x39dd9d['product_name']==_0x3a140a[_0x1fde85(0x24c)]&&_0x39dd9d[_0x1fde85(0x19e)]==_0x3a140a['floorlevel']&&_0x39dd9d[_0x1fde85(0x1ea)]==_0x3a140a[_0x1fde85(0x1ea)]&&_0x39dd9d[_0x1fde85(0x1e7)]==_0x3a140a[_0x1fde85(0x1e7)]&&_0x39dd9d[_0x1fde85(0x1d4)]==_0x3a140a[_0x1fde85(0x1d4)]&&_0x39dd9d[_0x1fde85(0x23a)]==_0x3a140a[_0x1fde85(0x23a)]&&_0x39dd9d['storage']==_0x3a140a['storage']&&_0x39dd9d[_0x1fde85(0x1e9)]==_0x3a140a[_0x1fde85(0x1e9)]&&_0x39dd9d[_0x1fde85(0x233)]==_0x3a140a[_0x1fde85(0x233)]&&(_0x39dd9d[_0x1fde85(0x1e2)]=_0x39dd9d[_0x1fde85(0x1e2)]-_0x3a140a[_0x1fde85(0x18d)]);});return _0x371b4f;});Promise['all'](_0x2869f0)['then'](async _0x29c732=>{var _0x20f320=_0x41b037;try{for(const _0x425f8e of _0x29c732){await _0x425f8e[_0x20f320(0x1bd)]();}_0x509387[_0x20f320(0x1bb)]='True';const _0x4b9e13=await _0x509387[_0x20f320(0x1bd)]();_0x1ad5be[_0x20f320(0x235)](_0x20f320(0x26a),'Sales\x20Update\x20successfully'),_0x20985b['redirect'](_0x20f320(0x264)+_0x210cac);}catch(_0x4080f0){console[_0x20f320(0x22f)](_0x4080f0),_0x20985b[_0x20f320(0x1c8)](0x1f4)[_0x20f320(0x197)]({'error':_0x20f320(0x1a9)});}})[_0x41b037(0x25e)](_0xe996b7=>{var _0x236ed2=_0x41b037;console[_0x236ed2(0x22f)](_0xe996b7),_0x20985b['status'](0x1f4)['json']({'error':_0x236ed2(0x242)});});}catch(_0x2360c1){console[_0x41b037(0x18e)](_0x2360c1);}}),router[a0_0x378e80(0x1f9)](a0_0x378e80(0x241),auth,async(_0x2ed5d3,_0x48bd62)=>{var _0x3841e6=a0_0x378e80;try{const {username:_0x2586c3,email:_0x586501,role:_0x435407}=_0x2ed5d3['user'],_0xa03251=_0x2ed5d3[_0x3841e6(0x1bc)],_0x50f10d=await profile[_0x3841e6(0x280)]({'email':_0xa03251['email']}),_0x46e301=await master_shop[_0x3841e6(0x239)](),_0x423e37=_0x2ed5d3['params']['id'],_0x548791=await sales[_0x3841e6(0x270)](_0x423e37);let _0x2805f4=new Date(_0x548791['expiry_date']),_0x3d4457=('0'+_0x2805f4[_0x3841e6(0x194)]())[_0x3841e6(0x1a7)](-0x2),_0x4e6a4a=('0'+(_0x2805f4[_0x3841e6(0x1d8)]()+0x1))['slice'](-0x2),_0x193f75=_0x2805f4['getFullYear'](),_0x43c067=_0x193f75+'-'+_0x4e6a4a+'-'+_0x3d4457;var _0x4f01ec=[_0x3841e6(0x1a1),_0x3841e6(0x1e1)];const _0x4a6b00=await warehouse[_0x3841e6(0x1a4)]([{'$match':{'name':_0x548791[_0x3841e6(0x19d)],'room':_0x548791[_0x3841e6(0x202)],'warehouse_category':'Raw\x20Materials'}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3841e6(0x204),'name':{'$first':_0x3841e6(0x267)},'product_stock':{'$first':_0x3841e6(0x1e5)},'bay':{'$first':_0x3841e6(0x23b)},'bin':{'$first':_0x3841e6(0x226)},'type':{'$first':_0x3841e6(0x1c6)},'floorlevel':{'$first':_0x3841e6(0x209)},'primary_code':{'$first':_0x3841e6(0x22d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3841e6(0x1ad)},'storage':{'$first':_0x3841e6(0x27d)},'rack':{'$first':'$product_details.rack'}}}]),_0x3163a9=await customer['find']({});let _0x547a5b;if(_0xa03251['role']=='staff'){const _0x344921=await staff[_0x3841e6(0x280)]({'email':_0xa03251[_0x3841e6(0x201)]});_0x547a5b=await warehouse[_0x3841e6(0x1a4)]([{'$match':{'status':_0x3841e6(0x228),'name':_0x344921[_0x3841e6(0x214)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':_0x3841e6(0x25a),'name':{'$first':_0x3841e6(0x25a)}}}]);}else _0x547a5b=await warehouse[_0x3841e6(0x1a4)]([{'$match':{'status':'Enabled','warehouse_category':_0x3841e6(0x255)}},{'$group':{'_id':_0x3841e6(0x25a),'name':{'$first':'$name'}}}]);const _0x502bc4=await product[_0x3841e6(0x239)]({});if(_0x46e301[0x0][_0x3841e6(0x1f0)]=='English\x20(US)'){var _0x2b87a5=users['English'];console[_0x3841e6(0x18e)](_0x2b87a5);}else{if(_0x46e301[0x0][_0x3841e6(0x1f0)]==_0x3841e6(0x1c1))var _0x2b87a5=users[_0x3841e6(0x1c1)];else{if(_0x46e301[0x0][_0x3841e6(0x1f0)]==_0x3841e6(0x232))var _0x2b87a5=users['German'];else{if(_0x46e301[0x0][_0x3841e6(0x1f0)]==_0x3841e6(0x1cd))var _0x2b87a5=users['Spanish'];else{if(_0x46e301[0x0]['language']==_0x3841e6(0x1f6))var _0x2b87a5=users['French'];else{if(_0x46e301[0x0][_0x3841e6(0x1f0)]==_0x3841e6(0x24b))var _0x2b87a5=users[_0x3841e6(0x1e8)];else{if(_0x46e301[0x0]['language']==_0x3841e6(0x20e))var _0x2b87a5=users[_0x3841e6(0x20e)];else{if(_0x46e301[0x0][_0x3841e6(0x1f0)]==_0x3841e6(0x192))var _0x2b87a5=users[_0x3841e6(0x1ed)];}}}}}}}_0x48bd62['render'](_0x3841e6(0x208),{'success':_0x2ed5d3[_0x3841e6(0x235)]('success'),'errors':_0x2ed5d3[_0x3841e6(0x235)](_0x3841e6(0x20a)),'role':_0xa03251,'profile':_0x50f10d,'customer':_0x3163a9,'warehouse':_0x547a5b,'product':_0x4a6b00,'user':_0x548791,'master_shop':_0x46e301,'unit':_0x502bc4,'language':_0x2b87a5,'rooms_data':_0x4f01ec,'ed_fullDate':_0x43c067});}catch(_0x141016){console[_0x3841e6(0x18e)](_0x141016);}}),router[a0_0x378e80(0x23c)](a0_0x378e80(0x241),auth,async(_0x326e16,_0x12a305)=>{var _0x1ff910=a0_0x378e80;try{const _0x11cd60=_0x326e16[_0x1ff910(0x1ca)]['id'],_0x1dcd65=await sales[_0x1ff910(0x280)]({'_id':_0x326e16[_0x1ff910(0x1ca)]['id']}),_0x1e4d73=await warehouse[_0x1ff910(0x280)]({'name':_0x1dcd65[_0x1ff910(0x19d)],'room':_0x326e16[_0x1ff910(0x1b4)]['room']}),{invoice:_0x22dd01,customer:_0x90194f,date:_0x4407fa,warehouse_name:_0x3d1f0d,product_name:_0x5c9a45,stock:_0x3dd6fd,adjust_qty:_0x2fee9d,note:_0x183af0,room:_0x3a5748,primary_code:_0x4de1e9,secondary_code:_0x356d5b,prod_code:_0x483085,level:_0x1219f4,isle:_0x24a739,pallet:_0xe136de,expiry_date:_0x507068}=_0x326e16[_0x1ff910(0x1b4)];if(typeof _0x5c9a45=='string')var _0x105846=[_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x24c)]],_0x588c96=[_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x25b)]],_0x40a7d0=[_0x326e16[_0x1ff910(0x1b4)]['adjust_qty']],_0x1c53a3=[_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x1ef)]],_0x52e256=[_0x326e16[_0x1ff910(0x1b4)]['secondary_code']],_0x5b05e1=[_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x275)]],_0x2e3c1d=[_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x27f)]],_0x477fb0=[_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x1a8)]],_0x5f1c9b=[_0x326e16['body'][_0x1ff910(0x260)]],_0x4d77eb=[_0x326e16[_0x1ff910(0x1b4)]['expiry_date']],_0x3146b5=[_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x21c)]],_0x13854b=[_0x326e16['body']['rak']],_0x5949bb=[_0x326e16['body'][_0x1ff910(0x1ea)]];else var _0x105846=[..._0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x24c)]],_0x588c96=[..._0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x25b)]],_0x40a7d0=[..._0x326e16['body'][_0x1ff910(0x213)]],_0x1c53a3=[..._0x326e16['body'][_0x1ff910(0x1ef)]],_0x52e256=[..._0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x1dd)]],_0x5b05e1=[..._0x326e16['body']['prod_code']],_0x2e3c1d=[..._0x326e16['body']['level']],_0x477fb0=[..._0x326e16[_0x1ff910(0x1b4)]['isle']],_0x5f1c9b=[..._0x326e16['body'][_0x1ff910(0x260)]],_0x4d77eb=[..._0x326e16['body'][_0x1ff910(0x1e9)]],_0x3146b5=[..._0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x21c)]],_0x13854b=[..._0x326e16[_0x1ff910(0x1b4)]['rak']],_0x5949bb=[..._0x326e16['body'][_0x1ff910(0x1ea)]];const _0x5c9c0f=_0x105846[_0x1ff910(0x24e)](_0x36f1d9=>{return _0x36f1d9={'product_name':_0x36f1d9};});_0x588c96[_0x1ff910(0x220)]((_0x449bd5,_0x2d8716)=>{var _0x58de45=_0x1ff910;_0x5c9c0f[_0x2d8716][_0x58de45(0x25b)]=_0x449bd5;}),_0x40a7d0[_0x1ff910(0x220)]((_0x559e5b,_0x5426a5)=>{var _0x5c124d=_0x1ff910;_0x5c9c0f[_0x5426a5][_0x5c124d(0x18d)]=_0x559e5b;}),_0x1c53a3[_0x1ff910(0x220)]((_0x58da95,_0x919246)=>{var _0x3325e2=_0x1ff910;_0x5c9c0f[_0x919246][_0x3325e2(0x1ef)]=_0x58da95;}),_0x52e256[_0x1ff910(0x220)]((_0x15976e,_0x351106)=>{_0x5c9c0f[_0x351106]['secondary_code']=_0x15976e;}),_0x5b05e1['forEach']((_0x45dc68,_0x17f931)=>{var _0x1efe6d=_0x1ff910;_0x5c9c0f[_0x17f931][_0x1efe6d(0x1d3)]=_0x45dc68;}),_0x2e3c1d[_0x1ff910(0x220)]((_0x15667e,_0x4759b1)=>{var _0x17cd37=_0x1ff910;_0x5c9c0f[_0x4759b1][_0x17cd37(0x1d4)]=_0x15667e;}),_0x477fb0['forEach']((_0x3e9a91,_0x343366)=>{_0x5c9c0f[_0x343366]['bin']=_0x3e9a91;}),_0x5f1c9b[_0x1ff910(0x220)]((_0x12ad5d,_0x22be9f)=>{var _0x534509=_0x1ff910;_0x5c9c0f[_0x22be9f][_0x534509(0x19e)]=_0x12ad5d;}),_0x4d77eb[_0x1ff910(0x220)]((_0x506126,_0xeaef14)=>{var _0x4f07a7=_0x1ff910;_0x5c9c0f[_0xeaef14][_0x4f07a7(0x1e9)]=_0x506126;}),_0x5949bb[_0x1ff910(0x220)]((_0x1caf21,_0x5846c7)=>{_0x5c9c0f[_0x5846c7]['type']=_0x1caf21;}),_0x3146b5[_0x1ff910(0x220)]((_0x32d4c1,_0x4d317c)=>{var _0x1b6492=_0x1ff910;_0x5c9c0f[_0x4d317c][_0x1b6492(0x21c)]=_0x32d4c1;}),_0x13854b[_0x1ff910(0x220)]((_0x110ff1,_0x51ffdc)=>{var _0x117b65=_0x1ff910;_0x5c9c0f[_0x51ffdc][_0x117b65(0x23a)]=_0x110ff1;});var _0x2aba16=0x0;_0x5c9c0f[_0x1ff910(0x220)](_0x5a2f69=>{var _0x5d69f3=_0x1ff910;console[_0x5d69f3(0x18e)](_0x5d69f3(0x1cb),_0x5a2f69),(parseInt(_0x5a2f69[_0x5d69f3(0x25b)])<parseInt(_0x5a2f69[_0x5d69f3(0x18d)])||parseInt(_0x5a2f69[_0x5d69f3(0x18d)])==0x0)&&_0x2aba16++;});if(_0x2aba16!=0x0)return _0x326e16[_0x1ff910(0x235)](_0x1ff910(0x20a),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x12a305[_0x1ff910(0x19c)](_0x1ff910(0x259));_0x1dcd65[_0x1ff910(0x19a)][_0x1ff910(0x220)](_0x2b13a1=>{var _0x4a35df=_0x1ff910;const _0x55e226=_0x1e4d73[_0x4a35df(0x19b)][_0x4a35df(0x24e)](_0x2822c3=>{var _0x47fe1d=_0x4a35df;_0x2822c3[_0x47fe1d(0x24c)]==_0x2b13a1[_0x47fe1d(0x24c)]&&_0x2822c3['floorlevel']==_0x2b13a1['floorlevel']&&_0x2822c3['type']==_0x2b13a1['type']&&_0x2822c3[_0x47fe1d(0x1e7)]==_0x2b13a1['bin']&&_0x2822c3['bay']==_0x2b13a1[_0x47fe1d(0x1d4)]&&(_0x2822c3[_0x47fe1d(0x1e2)]=parseInt(_0x2822c3[_0x47fe1d(0x1e2)])+parseInt(_0x2b13a1['quantity']));});}),console['log'](_0x1ff910(0x273),_0x1e4d73),await _0x1e4d73['save']();const _0x5e1e39=_0x5c9c0f['filter'](_0x50c447=>_0x50c447[_0x1ff910(0x18d)]!=='0'&&_0x50c447[_0x1ff910(0x18d)]!=='');_0x1dcd65[_0x1ff910(0x1d6)]=_0x22dd01,_0x1dcd65['customer']=_0x90194f,_0x1dcd65[_0x1ff910(0x281)]=_0x4407fa,_0x1dcd65[_0x1ff910(0x19d)]=_0x3d1f0d,_0x1dcd65['sale_product']=_0x5e1e39,_0x1dcd65[_0x1ff910(0x23e)]=_0x183af0,_0x1dcd65['room']=_0x3a5748;const _0x3995cb=await _0x1dcd65[_0x1ff910(0x1bd)](),_0x1d7be6=await sales[_0x1ff910(0x280)]({'_id':_0x326e16['params']['id']}),_0x3b665b=await warehouse['findOne']({'name':_0x3d1f0d,'room':_0x3a5748});_0x1d7be6[_0x1ff910(0x19a)][_0x1ff910(0x220)](_0x196439=>{var _0x1cc176=_0x1ff910;const _0x1afeb3=_0x3b665b[_0x1cc176(0x19b)][_0x1cc176(0x24e)](_0x4d0bde=>{var _0x49591e=_0x1cc176;_0x4d0bde[_0x49591e(0x24c)]==_0x196439[_0x49591e(0x24c)]&&_0x4d0bde[_0x49591e(0x19e)]==_0x196439[_0x49591e(0x19e)]&&_0x4d0bde[_0x49591e(0x1ea)]==_0x196439[_0x49591e(0x1ea)]&&_0x4d0bde[_0x49591e(0x1e7)]==_0x196439[_0x49591e(0x1e7)]&&_0x4d0bde['bay']==_0x196439[_0x49591e(0x1d4)]&&(_0x4d0bde['product_stock']=parseInt(_0x4d0bde[_0x49591e(0x1e2)])-parseInt(_0x196439['quantity']));});}),console[_0x1ff910(0x18e)](_0x1ff910(0x237),_0x3b665b),await _0x3b665b[_0x1ff910(0x1bd)]();const _0x265881=await c_payment_data[_0x1ff910(0x280)]({'invoice':_0x326e16['body'][_0x1ff910(0x1d6)]});_0x265881[_0x1ff910(0x24a)]=_0x326e16[_0x1ff910(0x1b4)][_0x1ff910(0x24a)],await _0x265881[_0x1ff910(0x1bd)](),_0x326e16[_0x1ff910(0x235)](_0x1ff910(0x26a),_0x1ff910(0x1a6)),_0x12a305[_0x1ff910(0x19c)](_0x1ff910(0x26d));}catch(_0x5c4b14){console['log'](_0x5c4b14);}}),router[a0_0x378e80(0x23c)](a0_0x378e80(0x191),auth,async(_0x4643fd,_0x50558c)=>{var _0xb6c0a2=a0_0x378e80;try{const _0x379f45=_0x4643fd[_0xb6c0a2(0x1ca)]['id'],{invoice:_0x5f3420,customer:_0x1804a6,receivable_amount:_0x29efa7,received_amount:_0x4bccf9}=_0x4643fd[_0xb6c0a2(0x1b4)],_0x339c27=await sales[_0xb6c0a2(0x270)](_0x379f45);console[_0xb6c0a2(0x18e)](_0x339c27);var _0x301074=_0x29efa7-_0x4bccf9;console[_0xb6c0a2(0x18e)](_0x4bccf9),_0x339c27[_0xb6c0a2(0x211)]=parseFloat(_0x4bccf9)+parseFloat(_0x339c27[_0xb6c0a2(0x211)]),_0x339c27['due_amount']=_0x301074,console[_0xb6c0a2(0x18e)](_0x339c27);const _0x5472ba=await _0x339c27[_0xb6c0a2(0x1bd)](),_0x730f76=await c_payment_data['findOne']({'invoice':_0x5f3420});_0x730f76[_0xb6c0a2(0x1b7)]=_0x301074,await _0x730f76[_0xb6c0a2(0x1bd)]();let _0x2ace2a=new Date(),_0x557174=('0'+_0x2ace2a[_0xb6c0a2(0x194)]())[_0xb6c0a2(0x1a7)](-0x2),_0x5f38af=('0'+(_0x2ace2a[_0xb6c0a2(0x1d8)]()+0x1))[_0xb6c0a2(0x1a7)](-0x2),_0x43b326=_0x2ace2a[_0xb6c0a2(0x23d)](),_0x559376=_0x43b326+'-'+_0x5f38af+'-'+_0x557174;const _0x14ff93=new customer_payment({'invoice':_0x5f3420,'date':_0x43b326+'-'+_0x5f38af+'-'+_0x557174,'customer':_0x1804a6,'reason':_0xb6c0a2(0x216),'amount':_0x4bccf9}),_0x4603cd=await _0x14ff93[_0xb6c0a2(0x1bd)]();_0x4643fd['flash'](_0xb6c0a2(0x26a),_0xb6c0a2(0x205)),_0x50558c[_0xb6c0a2(0x19c)](_0xb6c0a2(0x26d));}catch(_0xc98043){console[_0xb6c0a2(0x18e)](_0xc98043);}}),router[a0_0x378e80(0x1f9)]('/invoice/:id',auth,async(_0x52e682,_0xec139f)=>{var _0x508375=a0_0x378e80;try{const {username:_0x5e4046,email:_0xabc29c,role:_0x263846}=_0x52e682[_0x508375(0x1bc)],_0x227cf4=_0x52e682[_0x508375(0x1bc)],_0xf6cf7=await profile[_0x508375(0x280)]({'email':_0x227cf4[_0x508375(0x201)]}),_0x40053d=await master_shop[_0x508375(0x239)]();console[_0x508375(0x18e)](_0x508375(0x256),_0x40053d);const _0x1badf0=_0x52e682['params']['id'],_0xb17435=await sales[_0x508375(0x270)](_0x1badf0);console[_0x508375(0x18e)](_0xb17435);const _0x176cd0=await customer[_0x508375(0x280)]({'name':_0xb17435[_0x508375(0x225)]});console[_0x508375(0x18e)](_0x176cd0);if(_0x40053d[0x0]['language']=='English\x20(US)'){var _0x4044a6=users['English'];console['log'](_0x4044a6);}else{if(_0x40053d[0x0][_0x508375(0x1f0)]==_0x508375(0x1c1))var _0x4044a6=users[_0x508375(0x1c1)];else{if(_0x40053d[0x0]['language']=='German')var _0x4044a6=users['German'];else{if(_0x40053d[0x0][_0x508375(0x1f0)]=='Spanish')var _0x4044a6=users['Spanish'];else{if(_0x40053d[0x0][_0x508375(0x1f0)]==_0x508375(0x1f6))var _0x4044a6=users[_0x508375(0x1f6)];else{if(_0x40053d[0x0][_0x508375(0x1f0)]==_0x508375(0x24b))var _0x4044a6=users[_0x508375(0x1e8)];else{if(_0x40053d[0x0][_0x508375(0x1f0)]==_0x508375(0x20e))var _0x4044a6=users['Chinese'];else{if(_0x40053d[0x0]['language']==_0x508375(0x192))var _0x4044a6=users['Arabic'];}}}}}}}_0xec139f[_0x508375(0x1a2)](_0x508375(0x227),{'success':_0x52e682['flash']('success'),'errors':_0x52e682[_0x508375(0x235)](_0x508375(0x20a)),'role':_0x227cf4,'profile':_0xf6cf7,'master_shop':_0x40053d,'customers':_0x176cd0,'sales':_0xb17435,'language':_0x4044a6});}catch(_0x369f7d){console[_0x508375(0x18e)](_0x369f7d);}}),router['get'](a0_0x378e80(0x1b8),auth,async(_0x52bd4e,_0x501c71)=>{var _0x383f77=a0_0x378e80;try{const {username:_0x1a34b0,email:_0x28ff94,role:_0x3e794f}=_0x52bd4e['user'],_0x53300c=_0x52bd4e[_0x383f77(0x1bc)],_0x4b082e=await profile['findOne']({'email':_0x53300c[_0x383f77(0x201)]}),_0x3ab8a9=await master_shop[_0x383f77(0x239)]();console[_0x383f77(0x18e)](_0x383f77(0x256),_0x3ab8a9);const _0xa90626=_0x52bd4e[_0x383f77(0x1ca)]['id'];console[_0x383f77(0x18e)](_0xa90626);const _0x11ba68=await sales['findById'](_0xa90626);console[_0x383f77(0x18e)](_0x383f77(0x1f7),_0x11ba68);const _0x1e918a=await warehouse[_0x383f77(0x1a4)]([{'$match':{'name':'Return\x20Goods','room':_0x383f77(0x266)}},{'$unwind':_0x383f77(0x24f)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x383f77(0x267)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x383f77(0x22a)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x383f77(0x1ad)}}}]);console[_0x383f77(0x18e)]('stock_data',_0x1e918a);const _0x299bd9=await product[_0x383f77(0x239)]({});warehouse_data=await warehouse[_0x383f77(0x1a4)]([{'$match':{'status':_0x383f77(0x228),'name':_0x383f77(0x24d),'warehouse_category':_0x383f77(0x255)}},{'$group':{'_id':_0x383f77(0x25a),'name':{'$first':_0x383f77(0x25a)}}},{'$sort':{'name':0x1}}]);var _0x3f1423=[_0x383f77(0x266)];if(_0x3ab8a9[0x0][_0x383f77(0x1f0)]==_0x383f77(0x1fe)){var _0x145b7d=users[_0x383f77(0x1db)];console[_0x383f77(0x18e)](_0x145b7d);}else{if(_0x3ab8a9[0x0][_0x383f77(0x1f0)]==_0x383f77(0x1c1))var _0x145b7d=users[_0x383f77(0x1c1)];else{if(_0x3ab8a9[0x0]['language']==_0x383f77(0x232))var _0x145b7d=users[_0x383f77(0x232)];else{if(_0x3ab8a9[0x0]['language']==_0x383f77(0x1cd))var _0x145b7d=users[_0x383f77(0x1cd)];else{if(_0x3ab8a9[0x0]['language']==_0x383f77(0x1f6))var _0x145b7d=users[_0x383f77(0x1f6)];else{if(_0x3ab8a9[0x0][_0x383f77(0x1f0)]==_0x383f77(0x24b))var _0x145b7d=users['Portuguese'];else{if(_0x3ab8a9[0x0][_0x383f77(0x1f0)]==_0x383f77(0x20e))var _0x145b7d=users[_0x383f77(0x20e)];else{if(_0x3ab8a9[0x0]['language']==_0x383f77(0x192))var _0x145b7d=users['Arabic'];}}}}}}}_0x501c71[_0x383f77(0x1a2)](_0x383f77(0x1fd),{'success':_0x52bd4e[_0x383f77(0x235)]('success'),'errors':_0x52bd4e[_0x383f77(0x235)](_0x383f77(0x20a)),'role':_0x53300c,'profile':_0x4b082e,'user':_0x11ba68,'stock':_0x1e918a,'master_shop':_0x3ab8a9,'unit':_0x299bd9,'language':_0x145b7d,'warehouses':warehouse_data,'rooms':_0x3f1423});}catch(_0x3f56bc){console[_0x383f77(0x18e)](_0x3f56bc),_0x501c71['status'](0xc8)[_0x383f77(0x197)]({'message':_0x3f56bc['message']});}}),router[a0_0x378e80(0x23c)]('/view/return_sales/:id',auth,async(_0x314b0e,_0x2dd908)=>{var _0x350e41=a0_0x378e80;try{const {invoice:_0x14d0f6,date:_0x3b37ea,warehouse_name:_0xbdddd9,product_name:_0x1f8d7a,primary_code:_0x2f3140,secondary_code:_0x43736f,product_code:_0x3c8464,sales_quantity:_0x3ffe8c,stocks:_0x565078,return_qty:_0x1464a6,Room_name:_0x2747d1,to_warehouse_name:_0x3f4119,to_Roomname:_0x5bd453,to_Room_name:_0x98560f,note:_0x4f79a5,level:_0x46637d,isle:_0x43755d,pallet:_0x25d9b0}=_0x314b0e[_0x350e41(0x1b4)];if(typeof _0x1f8d7a=='string')var _0x192e33=[_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x24c)]],_0x5d59f0=[_0x314b0e['body'][_0x350e41(0x1ef)]],_0x3a5989=[_0x314b0e[_0x350e41(0x1b4)]['secondary_code']],_0x37801e=[_0x314b0e[_0x350e41(0x1b4)]['product_code']],_0x1fe4f4=[_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x26e)]],_0x5e531b=[_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x240)]],_0x24f73c=[_0x314b0e['body'][_0x350e41(0x190)]],_0x5768b9=[_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x1d4)]],_0x1fb4b7=[_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x1e7)]],_0x159afb=[_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x268)]],_0x48cc45=[_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x19e)]];else var _0x192e33=[..._0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x24c)]],_0x5d59f0=[..._0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x1ef)]],_0x3a5989=[..._0x314b0e['body'][_0x350e41(0x1dd)]],_0x37801e=[..._0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x1d3)]],_0x1fe4f4=[..._0x314b0e['body']['sales_quantity']],_0x5e531b=[..._0x314b0e['body'][_0x350e41(0x240)]],_0x24f73c=[..._0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x190)]],_0x5768b9=[..._0x314b0e['body'][_0x350e41(0x1d4)]],_0x1fb4b7=[..._0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x1e7)]],_0x159afb=[..._0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x268)]],_0x48cc45=[..._0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x19e)]];const _0x41b522=_0x192e33['map'](_0x51876e=>{return _0x51876e={'product_name':_0x51876e};});_0x5d59f0['forEach']((_0x57e362,_0x4e11cf)=>{_0x41b522[_0x4e11cf]['primary_code']=_0x57e362;}),_0x3a5989[_0x350e41(0x220)]((_0x5de4b6,_0x1f83f0)=>{var _0x333db2=_0x350e41;_0x41b522[_0x1f83f0][_0x333db2(0x1dd)]=_0x5de4b6;}),_0x37801e[_0x350e41(0x220)]((_0x42614a,_0x339075)=>{var _0x5667fa=_0x350e41;_0x41b522[_0x339075][_0x5667fa(0x1d3)]=_0x42614a;}),_0x1fe4f4[_0x350e41(0x220)]((_0xd54f31,_0x2b2eb5)=>{var _0x403b4b=_0x350e41;_0x41b522[_0x2b2eb5][_0x403b4b(0x253)]=_0xd54f31;}),_0x5e531b[_0x350e41(0x220)]((_0x1beb3f,_0x10baf2)=>{var _0x4a7b86=_0x350e41;_0x41b522[_0x10baf2][_0x4a7b86(0x25b)]=_0x1beb3f;}),_0x24f73c[_0x350e41(0x220)]((_0x397028,_0x3bafd5)=>{_0x41b522[_0x3bafd5]['return_qty']=_0x397028;}),_0x5768b9[_0x350e41(0x220)]((_0x7aac9,_0x51bcc5)=>{var _0xc7eee1=_0x350e41;_0x41b522[_0x51bcc5][_0xc7eee1(0x1d4)]=_0x7aac9;}),_0x1fb4b7[_0x350e41(0x220)]((_0x5d0369,_0x143dcd)=>{var _0x2bf742=_0x350e41;_0x41b522[_0x143dcd][_0x2bf742(0x1e7)]=_0x5d0369;}),_0x159afb[_0x350e41(0x220)]((_0x35467f,_0x302454)=>{_0x41b522[_0x302454]['type']=_0x35467f;}),_0x48cc45['forEach']((_0x2bf4d1,_0x543172)=>{var _0x44121b=_0x350e41;_0x41b522[_0x543172][_0x44121b(0x19e)]=_0x2bf4d1;});var _0x2bdbf4=0x0;_0x41b522[_0x350e41(0x220)](_0x57315f=>{var _0x58cc24=_0x350e41;console[_0x58cc24(0x18e)](_0x58cc24(0x1cb),_0x57315f),(parseInt(_0x57315f[_0x58cc24(0x253)])<parseInt(_0x57315f[_0x58cc24(0x190)])||parseInt(_0x57315f[_0x58cc24(0x25b)])<parseInt(_0x57315f['return_qty'])&&parseInt(_0x57315f[_0x58cc24(0x253)])>parseInt(_0x57315f[_0x58cc24(0x190)])||parseInt(_0x57315f['return_qty'])==0x0)&&_0x2bdbf4++;});if(_0x2bdbf4!=0x0)return _0x314b0e['flash'](_0x350e41(0x20a),_0x350e41(0x219)),_0x2dd908['redirect'](_0x350e41(0x259));const _0x59d470=await sales['findOne']({'invoice':_0x14d0f6});console[_0x350e41(0x18e)](_0x59d470),_0x59d470[_0x350e41(0x1a3)]=_0x350e41(0x217);const _0x5e32f6=await _0x59d470[_0x350e41(0x1bd)](),_0x29b943=new sales_return({'invoice':_0x14d0f6,'customer':_0x314b0e[_0x350e41(0x1b4)]['customer'],'date':_0x3b37ea,'warehouse_name':_0xbdddd9,'room':_0x2747d1,'ToWarehouse':_0x3f4119,'ToRoom':_0x98560f,'return_sale':_0x41b522,'note':_0x4f79a5}),_0x5e3cd5=await _0x29b943['save']();console['log'](_0x29b943);const _0x37d480=await sales_return['findOne']({'invoice':_0x14d0f6}),_0xf1ac1=await warehouse[_0x350e41(0x280)]({'name':_0x3f4119,'room':_0x98560f});_0x37d480[_0x350e41(0x1fd)]['forEach'](_0x1443bf=>{var _0x47d941=_0x350e41,_0x29c227=0x0;const _0x12dbac=_0xf1ac1[_0x47d941(0x19b)][_0x47d941(0x24e)](_0x59bf8a=>{var _0x8216d2=_0x47d941;_0x59bf8a[_0x8216d2(0x24c)]==_0x1443bf[_0x8216d2(0x24c)]&&_0x59bf8a['floorlevel']==_0x1443bf[_0x8216d2(0x19e)]&&_0x59bf8a[_0x8216d2(0x1ea)]==_0x1443bf[_0x8216d2(0x1ea)]&&_0x59bf8a[_0x8216d2(0x1e7)]==_0x1443bf[_0x8216d2(0x1e7)]&&_0x59bf8a[_0x8216d2(0x1d4)]==_0x1443bf[_0x8216d2(0x1d4)]&&(_0x59bf8a[_0x8216d2(0x1e2)]=parseInt(_0x59bf8a[_0x8216d2(0x1e2)])+parseInt(_0x1443bf[_0x8216d2(0x190)]),_0x29c227++);});_0x29c227=='0'&&(_0xf1ac1[_0x47d941(0x19b)]=_0xf1ac1['product_details'][_0x47d941(0x282)]({'product_name':_0x1443bf[_0x47d941(0x24c)],'product_stock':_0x1443bf[_0x47d941(0x190)],'primary_code':_0x1443bf[_0x47d941(0x1ef)],'secondary_code':_0x1443bf[_0x47d941(0x1dd)],'product_code':_0x1443bf[_0x47d941(0x1d3)],'bay':_0x1443bf[_0x47d941(0x1d4)],'bin':_0x1443bf[_0x47d941(0x1e7)],'type':_0x1443bf['type'],'floorlevel':_0x1443bf[_0x47d941(0x19e)]})),console[_0x47d941(0x18e)](_0x47d941(0x237),_0xf1ac1);}),await _0xf1ac1[_0x350e41(0x1bd)](),console[_0x350e41(0x18e)](_0x314b0e[_0x350e41(0x1b4)]);const _0x4417c5=new c_payment_data({'invoice':_0x14d0f6,'customer':_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x225)],'reason':'Sale\x20Return'});await _0x4417c5[_0x350e41(0x1bd)]();const _0x3dfff3=await master_shop[_0x350e41(0x239)]();console[_0x350e41(0x18e)](_0x350e41(0x1ba),_0x3dfff3[0x0][_0x350e41(0x26f)]);const _0x1e1dc2=await email_settings['findOne'](),_0x3d53d9=await customer[_0x350e41(0x280)]({'name':_0x314b0e[_0x350e41(0x1b4)][_0x350e41(0x225)]});console[_0x350e41(0x18e)]('customer_data',_0x3d53d9);_0x3dfff3[0x0][_0x350e41(0x26b)]==0x1?(right_currency=_0x3dfff3[0x0][_0x350e41(0x249)],left_currency=''):(right_currency='',left_currency=_0x3dfff3[0x0][_0x350e41(0x249)]);var _0x3fc934=_0x192e33,_0x5403b6=_0x24f73c,_0x58c9ec='',_0x3f5bf1;for(_0x3f5bf1 in _0x3fc934){_0x58c9ec+=_0x350e41(0x1d9)+_0x350e41(0x224)+_0x3fc934[_0x3f5bf1]+_0x350e41(0x27c)+_0x350e41(0x224)+_0x5403b6[_0x3f5bf1]+_0x350e41(0x27c)+_0x350e41(0x21e);}console[_0x350e41(0x18e)](_0x350e41(0x1f3),_0x58c9ec);let _0x192334=nodemailer[_0x350e41(0x215)]({'service':_0x350e41(0x1e6),'auth':{'user':_0x1e1dc2[_0x350e41(0x201)],'pass':_0x1e1dc2[_0x350e41(0x1c2)]}}),_0x3c9083={'from':_0x1e1dc2['email'],'to':_0x3d53d9[_0x350e41(0x201)],'subject':_0x350e41(0x262),'attachments':[{'filename':_0x350e41(0x22e),'path':__dirname+'/../public'+_0x350e41(0x21f)+_0x3dfff3[0x0][_0x350e41(0x26f)],'cid':_0x350e41(0x27b)}],'html':_0x350e41(0x254)+_0x350e41(0x27a)+_0x350e41(0x200)+_0x350e41(0x22c)+_0x350e41(0x244)+_0x350e41(0x22c)+_0x350e41(0x1d1)+_0x350e41(0x265)+_0x350e41(0x22c)+_0x350e41(0x1cc)+_0x3dfff3[0x0][_0x350e41(0x1b1)]+_0x350e41(0x258)+_0x350e41(0x265)+_0x350e41(0x265)+_0x350e41(0x1d7)+_0x350e41(0x22c)+_0x350e41(0x261)+_0x350e41(0x1b3)+_0x14d0f6+'\x20'+_0x350e41(0x1b5)+'\x20Order\x20Date\x20:\x20'+_0x3b37ea+'\x20'+_0x350e41(0x231)+'</h5>'+_0x350e41(0x265)+_0x350e41(0x25f)+_0x350e41(0x278)+_0x350e41(0x1d9)+_0x350e41(0x1e3)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>'+_0x350e41(0x238)+_0x350e41(0x1ae)+_0x350e41(0x21e)+_0x350e41(0x1b9)+_0x350e41(0x1c9)+'\x20'+_0x58c9ec+'\x20'+_0x350e41(0x207)+_0x350e41(0x247)+'<div>'+_0x350e41(0x1e0)+'<h5>'+_0x3dfff3[0x0]['site_title']+_0x350e41(0x248)+_0x350e41(0x265)+_0x350e41(0x265)+_0x350e41(0x1ff)};_0x192334['sendMail'](_0x3c9083,function(_0x2f26c1,_0x15c840){var _0x136f7e=_0x350e41;_0x2f26c1?(console[_0x136f7e(0x18e)](_0x2f26c1),console['log'](_0x136f7e(0x276))):console['log'](_0x136f7e(0x1df));}),_0x314b0e['flash'](_0x350e41(0x26a),_0x350e41(0x203)),_0x2dd908[_0x350e41(0x19c)](_0x350e41(0x26d));}catch(_0x4a9d8b){console['log'](_0x4a9d8b),_0x2dd908[_0x350e41(0x1c8)](0xc8)[_0x350e41(0x197)]({'message1':_0x4a9d8b[_0x350e41(0x196)]});}}),router[a0_0x378e80(0x1f9)](a0_0x378e80(0x1b2),auth,async(_0x2be2a3,_0x5b8374)=>{var _0x596c2a=a0_0x378e80;try{const {username:_0x4ecaac,email:_0x2c4155,role:_0x324e2a}=_0x2be2a3['user'],_0x4ed457=_0x2be2a3['user'],_0x3f012e=await profile[_0x596c2a(0x280)]({'email':_0x4ed457['email']}),_0x33e6d5=await master_shop[_0x596c2a(0x239)]();console[_0x596c2a(0x18e)]('barcode\x20Product\x20master',_0x33e6d5);const _0x4f3e5d=_0x2be2a3[_0x596c2a(0x1ca)]['id'],_0x49e7d5=await sales[_0x596c2a(0x270)](_0x4f3e5d);console[_0x596c2a(0x18e)](_0x596c2a(0x234),_0x49e7d5);if(_0x33e6d5[0x0]['language']==_0x596c2a(0x1fe))var _0x25a390=users[_0x596c2a(0x1db)];else{if(_0x33e6d5[0x0][_0x596c2a(0x1f0)]=='Hindi')var _0x25a390=users[_0x596c2a(0x1c1)];else{if(_0x33e6d5[0x0][_0x596c2a(0x1f0)]=='German')var _0x25a390=users[_0x596c2a(0x232)];else{if(_0x33e6d5[0x0]['language']==_0x596c2a(0x1cd))var _0x25a390=users[_0x596c2a(0x1cd)];else{if(_0x33e6d5[0x0]['language']=='French')var _0x25a390=users['French'];else{if(_0x33e6d5[0x0][_0x596c2a(0x1f0)]==_0x596c2a(0x24b))var _0x25a390=users[_0x596c2a(0x1e8)];else{if(_0x33e6d5[0x0][_0x596c2a(0x1f0)]==_0x596c2a(0x20e))var _0x25a390=users[_0x596c2a(0x20e)];else{if(_0x33e6d5[0x0]['language']==_0x596c2a(0x192))var _0x25a390=users['Arabic'];}}}}}}}_0x5b8374[_0x596c2a(0x1a2)](_0x596c2a(0x20b),{'success':_0x2be2a3[_0x596c2a(0x235)](_0x596c2a(0x26a)),'errors':_0x2be2a3[_0x596c2a(0x235)](_0x596c2a(0x20a)),'role':_0x4ed457,'profile':_0x3f012e,'alldata':_0x49e7d5,'master_shop':_0x33e6d5,'language':_0x25a390});}catch(_0x31aec8){console['log'](_0x31aec8);}}),router[a0_0x378e80(0x23c)]('/barcode_scanner',async(_0x53884b,_0x3a2aed)=>{var _0x4d9666=a0_0x378e80;const {product_code:_0x2a7dcb,warehouse_name:_0x539b22,rooms_data:_0x348e10,Roomslist:_0x41947c}=_0x53884b[_0x4d9666(0x1b4)],_0xf54a96=_0x41947c[_0x4d9666(0x236)](','),_0x50d9d3=[];async function _0x3b1e71(_0x344c83){var _0x364bce=_0x4d9666;const _0x309394=await warehouse[_0x364bce(0x1a4)]([{'$match':{'name':_0x539b22,'room':_0x344c83}},{'$unwind':_0x364bce(0x24f)},{'$match':{'product_details.primary_code':_0x2a7dcb}},{'$group':{'_id':_0x364bce(0x204),'name':{'$first':_0x364bce(0x267)},'product_stock':{'$first':_0x364bce(0x1e5)},'primary_code':{'$first':_0x364bce(0x22d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x364bce(0x23b)},'isle':{'$first':_0x364bce(0x226)},'type':{'$first':_0x364bce(0x1c6)},'pallet':{'$first':_0x364bce(0x209)},'unit':{'$first':_0x364bce(0x198)},'secondary_unit':{'$first':_0x364bce(0x206)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x364bce(0x21d)},'expiry_date':{'$first':_0x364bce(0x1da)},'production_date':{'$first':_0x364bce(0x212)},'maxPerUnit':{'$first':_0x364bce(0x246)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':_0x364bce(0x19f)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':'$room'}}}]),_0x4527df=await warehouse['aggregate']([{'$match':{'name':_0x539b22,'room':_0x344c83}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x2a7dcb}},{'$group':{'_id':_0x364bce(0x204),'name':{'$first':_0x364bce(0x267)},'product_stock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x364bce(0x22d)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x364bce(0x1ad)},'level':{'$first':_0x364bce(0x23b)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x364bce(0x1c6)},'pallet':{'$first':_0x364bce(0x209)},'unit':{'$first':_0x364bce(0x198)},'secondary_unit':{'$first':_0x364bce(0x206)},'storage':{'$first':_0x364bce(0x27d)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':_0x364bce(0x1ab)},'product_cat':{'$first':_0x364bce(0x19f)},'computeUsed':{'$first':'S'},'roomNamed':{'$first':'$room'}}}]);if(_0x309394[_0x364bce(0x283)]>0x0)_0x50d9d3[_0x364bce(0x199)](_0x309394);else _0x4527df['length']>0x0&&_0x50d9d3['push'](_0x4527df);}const _0xcc590b=_0xf54a96['map'](_0x592be9=>_0x3b1e71(_0x592be9));await Promise[_0x4d9666(0x21b)](_0xcc590b),_0x3a2aed[_0x4d9666(0x197)](_0x50d9d3);}),module['exports']=router;