var a0_0x32a01a=a0_0x2e57;(function(_0x12579c,_0xf5b5d3){var _0x367fed=a0_0x2e57,_0x41b941=_0x12579c();while(!![]){try{var _0x129805=parseInt(_0x367fed(0x189))/0x1+parseInt(_0x367fed(0x112))/0x2+parseInt(_0x367fed(0x121))/0x3+parseInt(_0x367fed(0xf3))/0x4+-parseInt(_0x367fed(0x167))/0x5*(-parseInt(_0x367fed(0x12e))/0x6)+parseInt(_0x367fed(0x109))/0x7*(-parseInt(_0x367fed(0x1ac))/0x8)+-parseInt(_0x367fed(0x178))/0x9;if(_0x129805===_0xf5b5d3)break;else _0x41b941['push'](_0x41b941['shift']());}catch(_0x2e505d){_0x41b941['push'](_0x41b941['shift']());}}}(a0_0x1553,0x1977d));const express=require(a0_0x32a01a(0x12d)),app=express(),router=express[a0_0x32a01a(0x108)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,email_settings,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,supervisor_settings}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x32a01a(0x136)),nodemailer=require('nodemailer');router['get'](a0_0x32a01a(0x1af),auth,async(_0x50de03,_0x2958d0)=>{var _0x3a5717=a0_0x32a01a;try{const {username:_0x46819f,email:_0xdf13df,role:_0x1e5267}=_0x50de03['user'],_0x37608c=_0x50de03['user'],_0x425be2=await profile[_0x3a5717(0x1b0)]({'email':_0x37608c[_0x3a5717(0x1ae)]}),_0x12d980=await master_shop[_0x3a5717(0x175)]();let _0xde365b;if(_0x37608c[_0x3a5717(0x19b)]==_0x3a5717(0x1b7)){const _0x829ec9=await staff[_0x3a5717(0x1b0)]({'email':_0x37608c['email']});_0xde365b=await transfers_finished[_0x3a5717(0x175)]({'from_warehouse':_0x829ec9[_0x3a5717(0x127)]});}else _0xde365b=await transfers_finished['aggregate']([{'$unwind':_0x3a5717(0x114)},{'$group':{'_id':_0x3a5717(0x131),'invoice':{'$first':'$invoice'},'date':{'$first':_0x3a5717(0x12c)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x3a5717(0x193)},'from_room_name':{'$addToSet':_0x3a5717(0x104)},'to_room_name':{'$addToSet':_0x3a5717(0x140)},'finalize':{'$first':_0x3a5717(0x194)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x12d980[0x0][_0x3a5717(0x154)]=='English\x20(US)')var _0x4da3d0=users[_0x3a5717(0xf1)];else{if(_0x12d980[0x0][_0x3a5717(0x154)]==_0x3a5717(0x181))var _0x4da3d0=users['Hindi'];else{if(_0x12d980[0x0][_0x3a5717(0x154)]=='German')var _0x4da3d0=users[_0x3a5717(0x179)];else{if(_0x12d980[0x0]['language']=='Spanish')var _0x4da3d0=users['Spanish'];else{if(_0x12d980[0x0][_0x3a5717(0x154)]==_0x3a5717(0x11b))var _0x4da3d0=users[_0x3a5717(0x11b)];else{if(_0x12d980[0x0]['language']=='Portuguese\x20(BR)')var _0x4da3d0=users[_0x3a5717(0xfc)];else{if(_0x12d980[0x0]['language']==_0x3a5717(0x11f))var _0x4da3d0=users[_0x3a5717(0x11f)];else{if(_0x12d980[0x0][_0x3a5717(0x154)]==_0x3a5717(0x130))var _0x4da3d0=users[_0x3a5717(0x1b2)];}}}}}}}_0x2958d0[_0x3a5717(0x103)]('transfer_finished',{'success':_0x50de03['flash']('success'),'errors':_0x50de03[_0x3a5717(0xf0)](_0x3a5717(0xfd)),'role':_0x37608c,'profile':_0x425be2,'master_shop':_0x12d980,'transfer':_0xde365b,'language':_0x4da3d0});}catch(_0x3e432e){console[_0x3a5717(0x115)](_0x3e432e);}});function a0_0x2e57(_0x113317,_0x352a5f){var _0x155332=a0_0x1553();return a0_0x2e57=function(_0x2e5796,_0x5907e5){_0x2e5796=_0x2e5796-0xd4;var _0x24bc73=_0x155332[_0x2e5796];return _0x24bc73;},a0_0x2e57(_0x113317,_0x352a5f);}async function getRandom8DigitNumber(){var _0x2bcc71=a0_0x32a01a;const _0x3166e5=0x989680,_0x3a8df3=0x5f5e0ff,_0x25886d=Math[_0x2bcc71(0x182)](Math[_0x2bcc71(0x171)]()*(_0x3a8df3-_0x3166e5+0x1))+_0x3166e5;var _0x218859;const _0x3ef8d8=await transfers_finished[_0x2bcc71(0x1b0)]({'invoice':_0x2bcc71(0x1a8)+_0x25886d});return _0x3ef8d8&&_0x3ef8d8['length']>0x0?_0x218859=_0x2bcc71(0x1a8)+_0x25886d:_0x218859=_0x2bcc71(0x1a8)+_0x25886d,_0x218859;}router['get']('/view/add_transfer',auth,async(_0x20bb46,_0x2d3e0c)=>{var _0x59f164=a0_0x32a01a;try{const {username:_0x59931c,email:_0x3ea708,role:_0x319fe5}=_0x20bb46[_0x59f164(0x1b1)],_0x14baee=_0x20bb46[_0x59f164(0x1b1)],_0x1ebbd3=await profile['findOne']({'email':_0x14baee['email']}),_0x3d99d5=await master_shop[_0x59f164(0x175)]();let _0x39a36a;if(_0x14baee['role']=='staff'){const _0x42a03e=await staff[_0x59f164(0x1b0)]({'email':_0x14baee[_0x59f164(0x1ae)]});_0x39a36a=await warehouse[_0x59f164(0xf8)]([{'$match':{'status':'Enabled','name':_0x42a03e[_0x59f164(0x127)],'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x59f164(0x1a7),'name':{'$first':_0x59f164(0x1a7)}}}]);}else _0x39a36a=await warehouse[_0x59f164(0xf8)]([{'$match':{'status':_0x59f164(0x18d),'name':{'$ne':_0x59f164(0x13f)}}},{'$group':{'_id':'$name','name':{'$first':_0x59f164(0x1a7)}}}]);var _0x5d9c68=[_0x59f164(0x173),'Enclosed',_0x59f164(0x119)];const _0x36556c=await transfers_finished[_0x59f164(0x175)]({}),_0x57bdfc=_0x36556c[_0x59f164(0x1a1)]+0x1,_0x8ee29e=_0x59f164(0x1a8)+_0x57bdfc[_0x59f164(0xec)]()[_0x59f164(0x124)](0x5,'0');if(_0x3d99d5[0x0][_0x59f164(0x154)]==_0x59f164(0x158))var _0x201f19=users[_0x59f164(0xf1)];else{if(_0x3d99d5[0x0][_0x59f164(0x154)]==_0x59f164(0x181))var _0x201f19=users[_0x59f164(0x181)];else{if(_0x3d99d5[0x0][_0x59f164(0x154)]==_0x59f164(0x179))var _0x201f19=users[_0x59f164(0x179)];else{if(_0x3d99d5[0x0][_0x59f164(0x154)]==_0x59f164(0x186))var _0x201f19=users['Spanish'];else{if(_0x3d99d5[0x0][_0x59f164(0x154)]=='French')var _0x201f19=users[_0x59f164(0x11b)];else{if(_0x3d99d5[0x0]['language']=='Portuguese\x20(BR)')var _0x201f19=users[_0x59f164(0xfc)];else{if(_0x3d99d5[0x0][_0x59f164(0x154)]=='Chinese')var _0x201f19=users[_0x59f164(0x11f)];else{if(_0x3d99d5[0x0][_0x59f164(0x154)]==_0x59f164(0x130))var _0x201f19=users[_0x59f164(0x1b2)];}}}}}}}const _0x500158=getRandom8DigitNumber();_0x500158[_0x59f164(0x153)](_0x2d606c=>{var _0x29069a=_0x59f164;_0x2d3e0c[_0x29069a(0x103)](_0x29069a(0x159),{'success':_0x20bb46[_0x29069a(0xf0)](_0x29069a(0xf4)),'errors':_0x20bb46[_0x29069a(0xf0)](_0x29069a(0xfd)),'role':_0x14baee,'profile':_0x1ebbd3,'master_shop':_0x3d99d5,'warehouse':_0x39a36a,'language':_0x201f19,'rooms_data':_0x5d9c68,'invoice':_0x2d606c});})[_0x59f164(0x190)](_0x4d4cdd=>{var _0x32e9fe=_0x59f164;_0x20bb46[_0x32e9fe(0xf0)](_0x32e9fe(0xfd),_0x32e9fe(0x14f)),_0x2d3e0c[_0x32e9fe(0xd4)](_0x32e9fe(0x1ad));});}catch(_0x24dc28){console[_0x59f164(0x115)](_0x24dc28);}}),router[a0_0x32a01a(0x17c)]('/view/add_transfer',auth,async(_0x278119,_0x5f2236)=>{var _0x31f890=a0_0x32a01a;try{const {date:_0x436b0b,from_warehouse:_0x1784c0,FromRoom_name:_0x3109c5,to_warehouse:_0x79d14,ToRoom_name:_0x26927a,prod_name:_0x22cf3b,from_prod_qty:_0x2f11b2,from_prod_level:_0x74d0d0,from_prod_isle:_0x5e159c,from_prod_pallet:_0x5da8cb,to_prod_qty:_0xaf8dec,to_prod_level:_0x396289,to_prod_isle:_0x15ddc7,to_prod_pallet:_0x3e0bfd,primary_code:_0x2e6f4f,secondary_code:_0x1cd33b,product_code3:_0x14765f,note:_0x3a4d5c,MaxStocks_data2:_0x2aaf6c,invoice:_0x2718c5,expiry_date:_0x53af20,PO_number:_0x13d4b8,ReqBy:_0x119100,dateofreq:_0x438d12,typeservicesData:_0x3c7499,destination:_0x17698f,deliverydate:_0x553295,driver:_0x545028,plate:_0x1222d6,van:_0x367226,DRSI:_0x33ba00,typevehicle:_0x202f74,TSU:_0x5302d1,TFU:_0x512733}=_0x278119[_0x31f890(0x118)];if(typeof _0x22cf3b=='string')var _0x1369f7=[_0x278119[_0x31f890(0x118)][_0x31f890(0x143)]],_0x293901=[_0x278119[_0x31f890(0x118)][_0x31f890(0x156)]],_0x323fe8=[_0x278119['body']['from_prod_level']],_0x2e1eef=[_0x278119[_0x31f890(0x118)][_0x31f890(0x199)]],_0x53747=[_0x278119[_0x31f890(0x118)][_0x31f890(0xe9)]],_0x1a0284=[_0x278119[_0x31f890(0x118)]['to_prod_level']],_0x4b9452=[_0x278119[_0x31f890(0x118)][_0x31f890(0x126)]],_0xf5bc14=[_0x278119[_0x31f890(0x118)][_0x31f890(0x10d)]],_0x34869b=[_0x278119[_0x31f890(0x118)][_0x31f890(0x13c)]],_0x127ec0=[_0x278119[_0x31f890(0x118)][_0x31f890(0xf9)]],_0x228894=[_0x278119[_0x31f890(0x118)][_0x31f890(0xe3)]],_0x26fe0d=[_0x278119[_0x31f890(0x118)][_0x31f890(0xe8)]],_0x3af34e=[_0x278119[_0x31f890(0x118)]['secondary_unit']],_0x364554=[_0x278119['body'][_0x31f890(0xdc)]],_0x3e4ba8=[_0x278119[_0x31f890(0x118)][_0x31f890(0x1ab)]],_0x4eec46=[_0x278119['body'][_0x31f890(0x180)]],_0x105b5c=[_0x278119[_0x31f890(0x118)][_0x31f890(0x10a)]],_0x5627e5=[_0x278119[_0x31f890(0x118)][_0x31f890(0xe4)]],_0x41fa42=[_0x278119[_0x31f890(0x118)][_0x31f890(0x129)]],_0x4c9c08=[_0x278119[_0x31f890(0x118)]['RoomAssigned']],_0x4fa67a=[_0x278119[_0x31f890(0x118)][_0x31f890(0xfa)]],_0x4316f5=[_0x278119[_0x31f890(0x118)]['CBM']],_0x2f1842=[_0x278119[_0x31f890(0x118)]['from_invoice']],_0x193907=[_0x278119[_0x31f890(0x118)][_0x31f890(0x1b4)]];else var _0x1369f7=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x143)]],_0x293901=[..._0x278119[_0x31f890(0x118)]['from_prod_qty']],_0x323fe8=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x17f)]],_0x2e1eef=[..._0x278119['body']['from_prod_leveling']],_0x53747=[..._0x278119[_0x31f890(0x118)][_0x31f890(0xe9)]],_0x1a0284=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x18e)]],_0x4b9452=[..._0x278119['body']['type']],_0xf5bc14=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x10d)]],_0x34869b=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x13c)]],_0x127ec0=[..._0x278119['body']['product_code3']],_0x228894=[..._0x278119[_0x31f890(0x118)]['MaxStocks_data2']],_0x26fe0d=[..._0x278119['body'][_0x31f890(0xe8)]],_0x3af34e=[..._0x278119[_0x31f890(0x118)][_0x31f890(0xfe)]],_0x364554=[..._0x278119['body'][_0x31f890(0xdc)]],_0x3e4ba8=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x1ab)]],_0x4eec46=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x180)]],_0x105b5c=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x10a)]],_0x5627e5=[..._0x278119[_0x31f890(0x118)][_0x31f890(0xe4)]],_0x41fa42=[..._0x278119['body'][_0x31f890(0x129)]],_0x4c9c08=[..._0x278119['body'][_0x31f890(0x100)]],_0x4fa67a=[..._0x278119[_0x31f890(0x118)][_0x31f890(0xfa)]],_0x4316f5=[..._0x278119[_0x31f890(0x118)]['CBM']],_0x2f1842=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x170)]],_0x193907=[..._0x278119[_0x31f890(0x118)][_0x31f890(0x1b4)]];const _0x53429f=_0x1369f7[_0x31f890(0x161)](_0x3d6820=>{return _0x3d6820={'product_name':_0x3d6820};});_0x293901['forEach']((_0x4ea8d6,_0x4f0200)=>{var _0x2842f2=_0x31f890;_0x53429f[_0x4f0200][_0x2842f2(0xd5)]=_0x4ea8d6;}),_0x2f1842[_0x31f890(0x12b)]((_0x5733aa,_0x36a24f)=>{_0x53429f[_0x36a24f]['from_invoice']=_0x5733aa;}),_0x193907[_0x31f890(0x12b)]((_0x258220,_0x47f729)=>{var _0x59506f=_0x31f890;_0x53429f[_0x47f729][_0x59506f(0x1b4)]=_0x258220;}),_0x323fe8[_0x31f890(0x12b)]((_0x48e996,_0x392b56)=>{var _0xedf22c=_0x31f890,_0x249ea1=_0x48e996[_0xedf22c(0xf2)](0x1);_0x53429f[_0x392b56][_0xedf22c(0x162)]=_0x48e996[0x0],_0x53429f[_0x392b56]['from_pallet']=_0x249ea1;}),_0x2e1eef[_0x31f890(0x12b)]((_0x2e27f1,_0x3e4355)=>{var _0x3d9528=_0x31f890;_0x53429f[_0x3e4355][_0x3d9528(0xd8)]=_0x2e27f1;}),_0x53747[_0x31f890(0x12b)]((_0x4cfa99,_0x283b19)=>{var _0x32e24f=_0x31f890;_0x53429f[_0x283b19][_0x32e24f(0x1b6)]=_0x4cfa99;}),_0x1a0284[_0x31f890(0x12b)]((_0x11c161,_0x305fb7)=>{var _0x28cbc6=_0x31f890,_0x4889f7=_0x11c161[_0x28cbc6(0xf2)](0x1);_0x53429f[_0x305fb7][_0x28cbc6(0x18a)]=_0x11c161[0x0],_0x53429f[_0x305fb7][_0x28cbc6(0x17b)]=_0x4889f7;}),_0x4b9452[_0x31f890(0x12b)]((_0x4893e0,_0x3c327d)=>{var _0x1420cc=_0x31f890;_0x53429f[_0x3c327d][_0x1420cc(0x17d)]=_0x4893e0;}),_0xf5bc14['forEach']((_0x2ce1d7,_0x1daf81)=>{var _0x213f64=_0x31f890;_0x53429f[_0x1daf81][_0x213f64(0x10d)]=_0x2ce1d7;}),_0x34869b[_0x31f890(0x12b)]((_0x4eb644,_0xf39339)=>{var _0x403f54=_0x31f890;_0x53429f[_0xf39339][_0x403f54(0x13c)]=_0x4eb644;}),_0x127ec0[_0x31f890(0x12b)]((_0x1c1d33,_0x54af2d)=>{_0x53429f[_0x54af2d]['product_code']=_0x1c1d33;}),_0x228894[_0x31f890(0x12b)]((_0x565337,_0x58201d)=>{var _0x30fdc6=_0x31f890;_0x53429f[_0x58201d][_0x30fdc6(0x101)]=_0x565337;}),_0x26fe0d[_0x31f890(0x12b)]((_0x552afd,_0x1607d1)=>{var _0xd71879=_0x31f890;_0x53429f[_0x1607d1][_0xd71879(0x16b)]=_0x552afd;}),_0x3af34e[_0x31f890(0x12b)]((_0x18f9d8,_0x3f3840)=>{_0x53429f[_0x3f3840]['secondary_unit']=_0x18f9d8;}),_0x364554[_0x31f890(0x12b)]((_0x1eebcc,_0x5b1b5f)=>{var _0x5b7cd7=_0x31f890;_0x53429f[_0x5b1b5f][_0x5b7cd7(0xdc)]=_0x1eebcc;}),_0x3e4ba8['forEach']((_0x4e52a6,_0x22a0f7)=>{_0x53429f[_0x22a0f7]['expiry_date']=_0x4e52a6;}),_0x4eec46[_0x31f890(0x12b)]((_0x54b3ff,_0x2d1360)=>{var _0x10588d=_0x31f890;_0x53429f[_0x2d1360][_0x10588d(0xe1)]=_0x54b3ff;}),_0x105b5c[_0x31f890(0x12b)]((_0x4f5a45,_0x561a35)=>{var _0x1fe8f1=_0x31f890;_0x53429f[_0x561a35][_0x1fe8f1(0x101)]=_0x4f5a45;}),_0x5627e5['forEach']((_0x152530,_0x2de614)=>{var _0x1e1039=_0x31f890;_0x53429f[_0x2de614][_0x1e1039(0xe4)]=_0x152530;}),_0x41fa42[_0x31f890(0x12b)]((_0x1382d2,_0xd9123a)=>{var _0x3cb691=_0x31f890;_0x53429f[_0xd9123a][_0x3cb691(0x129)]=_0x1382d2;}),_0x4c9c08[_0x31f890(0x12b)]((_0x2edf7c,_0x171867)=>{var _0x1d1ed1=_0x31f890;_0x53429f[_0x171867][_0x1d1ed1(0xf7)]=_0x2edf7c;}),_0x4fa67a[_0x31f890(0x12b)]((_0x3393cf,_0x4818c9)=>{var _0x18e607=_0x31f890;_0x53429f[_0x4818c9][_0x18e607(0xed)]=_0x3393cf;}),_0x4316f5[_0x31f890(0x12b)]((_0x520225,_0x3d911d)=>{var _0x50103a=_0x31f890;_0x53429f[_0x3d911d][_0x50103a(0xfb)]=_0x520225;});const _0x85ccf9=_0x53429f[_0x31f890(0x15c)](_0x526ba5=>_0x526ba5[_0x31f890(0x1b6)]!=='0'&&_0x526ba5[_0x31f890(0x1b6)]!==''||_0x526ba5[_0x31f890(0x132)]!=='0'&&_0x526ba5[_0x31f890(0x132)]!=='');var _0x15d02b=0x0;_0x85ccf9[_0x31f890(0x12b)](_0x566c1d=>{var _0x56da6b=_0x31f890;parseInt(_0x566c1d[_0x56da6b(0xd5)])<parseInt(_0x566c1d[_0x56da6b(0x1b6)])&&_0x15d02b++;});if(_0x15d02b!=0x0)return _0x278119[_0x31f890(0xf0)](_0x31f890(0xfd),_0x31f890(0xee)),_0x5f2236[_0x31f890(0xd4)]('back');const _0xd62473=new transfers_finished({'date':_0x436b0b,'from_warehouse':_0x1784c0,'to_warehouse':_0x79d14,'product':_0x85ccf9,'note':_0x3a4d5c,'invoice':_0x2718c5,'PO_number':_0x13d4b8,'RequestedBy':_0x119100,'DateofRequest':_0x438d12,'typeservices':_0x3c7499,'destination':_0x17698f,'deliverydate':_0x553295,'driver':_0x545028,'plate':_0x1222d6,'van':_0x367226,'DRSI':_0x33ba00,'typevehicle':_0x202f74,'TSU':_0x5302d1,'TFU':_0x512733}),_0x96f54d=await _0xd62473[_0x31f890(0x11e)]();_0x278119[_0x31f890(0xf0)](_0x31f890(0xf4),_0x31f890(0x17e)),_0x5f2236[_0x31f890(0xd4)](_0x31f890(0x125)+_0x96f54d[_0x31f890(0x1a3)]);}catch(_0x434b48){console[_0x31f890(0x115)](_0x434b48),_0x5f2236[_0x31f890(0x10c)](0xc8)[_0x31f890(0x1a6)]({'errorMessage':_0x434b48[_0x31f890(0x150)]});}}),router[a0_0x32a01a(0xe5)](a0_0x32a01a(0x102),auth,async(_0x3a16c9,_0x4e5223)=>{var _0x309a4e=a0_0x32a01a;try{const {username:_0x486355,email:_0x53f512,role:_0x56c979}=_0x3a16c9['user'],_0x1b825d=_0x3a16c9[_0x309a4e(0x1b1)],_0x3ce9cd=await profile[_0x309a4e(0x1b0)]({'email':_0x1b825d['email']}),_0x25de4a=await master_shop[_0x309a4e(0x175)](),_0x48306a=await transfers_finished[_0x309a4e(0x168)](_0x3a16c9['params']['id']);let _0x2ad2e0;if(_0x1b825d[_0x309a4e(0x19b)]=='staff'){const _0x58e5c5=await staff['findOne']({'email':_0x1b825d[_0x309a4e(0x1ae)]});_0x2ad2e0=await warehouse[_0x309a4e(0x175)]({'status':_0x309a4e(0x18d),'name':_0x58e5c5[_0x309a4e(0x127)]});}else _0x2ad2e0=await warehouse[_0x309a4e(0x175)]({'status':_0x309a4e(0x18d)});const _0x15d12d=await warehouse[_0x309a4e(0xf8)]([{'$match':{'name':_0x48306a[_0x309a4e(0x197)]}},{'$unwind':_0x309a4e(0x15d)},{'$group':{'_id':_0x309a4e(0x10b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x309a4e(0x120)},'isle':{'$first':_0x309a4e(0x149)},'pallet':{'$first':'$product_details.pallet'},'primary_code':{'$first':_0x309a4e(0x165)},'secondary_code':{'$first':_0x309a4e(0x137)},'product_code':{'$first':_0x309a4e(0x169)},'storage':{'$first':_0x309a4e(0xea)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x309a4e(0x107)},'room':{'$first':_0x309a4e(0x176)},'warehoue_name':{'$first':_0x309a4e(0x1a7)}}}]),_0x2d8997=await product['find']({});if(_0x25de4a[0x0][_0x309a4e(0x154)]=='English\x20(US)'){var _0x666de5=users[_0x309a4e(0xf1)];console[_0x309a4e(0x115)](_0x666de5);}else{if(_0x25de4a[0x0][_0x309a4e(0x154)]=='Hindi')var _0x666de5=users['Hindi'];else{if(_0x25de4a[0x0][_0x309a4e(0x154)]==_0x309a4e(0x179))var _0x666de5=users[_0x309a4e(0x179)];else{if(_0x25de4a[0x0][_0x309a4e(0x154)]==_0x309a4e(0x186))var _0x666de5=users['Spanish'];else{if(_0x25de4a[0x0][_0x309a4e(0x154)]==_0x309a4e(0x11b))var _0x666de5=users[_0x309a4e(0x11b)];else{if(_0x25de4a[0x0][_0x309a4e(0x154)]==_0x309a4e(0x1aa))var _0x666de5=users['Portuguese'];else{if(_0x25de4a[0x0][_0x309a4e(0x154)]=='Chinese')var _0x666de5=users['Chinese'];else{if(_0x25de4a[0x0][_0x309a4e(0x154)]=='Arabic\x20(ae)')var _0x666de5=users[_0x309a4e(0x1b2)];}}}}}}}_0x4e5223['render'](_0x309a4e(0x166),{'success':_0x3a16c9[_0x309a4e(0xf0)](_0x309a4e(0xf4)),'errors':_0x3a16c9['flash'](_0x309a4e(0xfd)),'role':_0x1b825d,'profile':_0x3ce9cd,'master_shop':_0x25de4a,'warehouse':_0x2ad2e0,'transfer':_0x48306a,'stock':_0x15d12d,'unit':_0x2d8997,'language':_0x666de5});}catch(_0x362a8f){console[_0x309a4e(0x115)](_0x362a8f);}}),router['post'](a0_0x32a01a(0x102),auth,async(_0x3a2866,_0x3af9c6)=>{var _0x405656=a0_0x32a01a;try{const {invoice:_0x20bbc0,from_warehouse:_0x25bdb3,FromRoom_name:_0x2a05cf,to_warehouse:_0x28c33f,ToRoom_name:_0x12b60b}=_0x3a2866[_0x405656(0x118)],_0xb7ae8=await transfers_finished[_0x405656(0x168)](_0x3a2866[_0x405656(0xe6)]['id']),_0x555c0c=_0xb7ae8[_0x405656(0x1b8)][_0x405656(0x161)](async _0x14f8c2=>{var _0x59c5de=_0x405656;if(_0x14f8c2['to_quantity']>0x0){var _0x1a3be7=await warehouse[_0x59c5de(0x1b0)]({'name':_0x25bdb3,'room':_0x14f8c2[_0x59c5de(0xf7)]});const _0x3fb050=_0x1a3be7[_0x59c5de(0x198)][_0x59c5de(0x161)](_0x21e9f2=>{var _0x623b4a=_0x59c5de;_0x21e9f2[_0x623b4a(0x1b5)]==_0x14f8c2[_0x623b4a(0x1b5)]&&_0x21e9f2[_0x623b4a(0x123)]==_0x14f8c2['from_level']&&_0x21e9f2[_0x623b4a(0x16d)]==_0x14f8c2[_0x623b4a(0x162)]&&_0x21e9f2[_0x623b4a(0x172)]==_0x14f8c2[_0x623b4a(0xeb)]&&_0x21e9f2['expiry_date']==_0x14f8c2[_0x623b4a(0x1ab)]&&_0x21e9f2[_0x623b4a(0xe1)]==_0x14f8c2[_0x623b4a(0xe1)]&&_0x21e9f2[_0x623b4a(0xdc)]==_0x14f8c2['batch_code']&&_0x21e9f2['invoice']==_0x14f8c2[_0x623b4a(0x170)]&&(_0x21e9f2['product_stock']=_0x21e9f2[_0x623b4a(0xe0)]-_0x14f8c2[_0x623b4a(0x1b6)]);});}return _0x1a3be7;});Promise[_0x405656(0xdf)](_0x555c0c)[_0x405656(0x153)](async _0x57e63d=>{var _0x547c92=_0x405656;try{for(const _0x22ea84 of _0x57e63d){await _0x22ea84['save']();}const _0x5d99e4=_0xb7ae8[_0x547c92(0x1b8)][_0x547c92(0x161)](async _0x33a47a=>{var _0xc7f45=_0x547c92,_0x4e2834=await warehouse['findOne']({'name':_0x28c33f,'room':_0x33a47a[_0xc7f45(0xed)]});if(_0x33a47a[_0xc7f45(0x1b6)]>0x0){var _0x48546f=0x0;const _0x14d9ef=_0x4e2834[_0xc7f45(0x198)]['map'](_0x1f21f6=>{var _0x4880b6=_0xc7f45;_0x1f21f6[_0x4880b6(0x1b5)]==_0x33a47a[_0x4880b6(0x1b5)]&&_0x1f21f6[_0x4880b6(0x123)]==_0x33a47a[_0x4880b6(0x17d)]&&_0x1f21f6[_0x4880b6(0x16d)]==_0x33a47a[_0x4880b6(0x18a)]&&_0x1f21f6[_0x4880b6(0x172)]==_0x33a47a[_0x4880b6(0x17b)]&&_0x1f21f6['expiry_date']==_0x33a47a[_0x4880b6(0x1ab)]&&_0x1f21f6[_0x4880b6(0xe1)]==_0x33a47a[_0x4880b6(0xe1)]&&_0x1f21f6['batch_code']==_0x33a47a[_0x4880b6(0xdc)]&&_0x1f21f6[_0x4880b6(0x142)]==_0x33a47a[_0x4880b6(0x1b4)]&&(_0x1f21f6['product_stock']=_0x1f21f6[_0x4880b6(0xe0)]+_0x33a47a[_0x4880b6(0x1b6)],_0x48546f++);});_0x48546f=='0'&&(_0x4e2834[_0xc7f45(0x198)]=_0x4e2834[_0xc7f45(0x198)][_0xc7f45(0x13a)]({'product_name':_0x33a47a[_0xc7f45(0x1b5)],'product_stock':_0x33a47a[_0xc7f45(0x1b6)],'level':_0x33a47a[_0xc7f45(0x17d)],'isle':_0x33a47a[_0xc7f45(0x18a)],'pallet':_0x33a47a[_0xc7f45(0x17b)],'product_code':_0x33a47a[_0xc7f45(0x192)],'primary_code':_0x33a47a[_0xc7f45(0x10d)],'secondary_code':_0x33a47a['secondary_code'],'expiry_date':_0x33a47a[_0xc7f45(0x1ab)],'production_date':_0x33a47a[_0xc7f45(0xe1)],'maxProducts':_0x33a47a[_0xc7f45(0x101)],'batch_code':_0x33a47a[_0xc7f45(0xdc)],'secondary_unit':_0x33a47a[_0xc7f45(0xfe)],'unit':_0x33a47a[_0xc7f45(0x16b)],'maxProducts':_0x33a47a['maxProducts'],'maxPerUnit':_0x33a47a[_0xc7f45(0xe4)],'CBM':_0x33a47a['CBM']}));}return _0x4e2834;});Promise['all'](_0x5d99e4)[_0x547c92(0x153)](async _0x27bb40=>{var _0x5f1c0e=_0x547c92;try{for(const _0x43bc38 of _0x27bb40){await warehouse[_0x5f1c0e(0x133)]({'_id':_0x43bc38[_0x5f1c0e(0x1a3)]},{'$addToSet':{'product_details':{'$each':_0x43bc38[_0x5f1c0e(0x198)]}}});}_0xb7ae8[_0x5f1c0e(0x138)]=_0x5f1c0e(0x12f);const _0x16d0c7=await _0xb7ae8[_0x5f1c0e(0x11e)]();var _0x25d92f=_0xb7ae8[_0x5f1c0e(0x1b8)];const _0x47d27c=await master_shop[_0x5f1c0e(0x175)](),_0x1f8cde=await email_settings[_0x5f1c0e(0x1b0)](),_0x5355f1=await supervisor_settings['find']();let _0x4c6442=nodemailer['createTransport']({'host':_0x1f8cde[_0x5f1c0e(0x1b3)],'port':Number(_0x1f8cde[_0x5f1c0e(0x15a)]),'secure':![],'auth':{'user':_0x1f8cde[_0x5f1c0e(0x1ae)],'pass':_0x1f8cde[_0x5f1c0e(0x13e)]}});var _0x2fef53='',_0xd0e0f3;for(_0xd0e0f3 in _0x25d92f){_0x2fef53+=_0x5f1c0e(0xf5)+_0x5f1c0e(0x113)+_0x25d92f[_0xd0e0f3][_0x5f1c0e(0x1b5)]+'</td>'+_0x5f1c0e(0x113)+_0x25d92f[_0xd0e0f3][_0x5f1c0e(0x1b6)]+_0x5f1c0e(0x185)+_0x5f1c0e(0x113)+_0x25d92f[_0xd0e0f3][_0x5f1c0e(0xed)]+_0x5f1c0e(0x185)+'<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>'+_0x25d92f[_0xd0e0f3][_0x5f1c0e(0x17d)]+'</td>'+_0x5f1c0e(0x113)+_0x25d92f[_0xd0e0f3]['to_isle']+_0x25d92f[_0xd0e0f3][_0x5f1c0e(0x17b)]+_0x5f1c0e(0x185)+_0x5f1c0e(0x146);}let _0x1f691f={'from':_0x1f8cde[_0x5f1c0e(0x1ae)],'to':_0x5355f1[0x0][_0x5f1c0e(0x18b)],'subject':_0x5f1c0e(0x19a),'attachments':[{'filename':_0x5f1c0e(0x19d),'path':__dirname+_0x5f1c0e(0xde)+_0x5f1c0e(0x15f)+_0x47d27c[0x0][_0x5f1c0e(0x106)],'cid':'logo'}],'html':_0x5f1c0e(0xd9)+_0x5f1c0e(0x174)+'</head><body>'+'<div>'+_0x5f1c0e(0x155)+_0x5f1c0e(0x16a)+_0x5f1c0e(0x10f)+'</div>'+'<div>'+_0x5f1c0e(0x196)+_0x47d27c[0x0][_0x5f1c0e(0x15e)]+'\x20</h2>'+_0x5f1c0e(0x11a)+'</div>'+_0x5f1c0e(0x141)+_0x5f1c0e(0x16a)+_0x5f1c0e(0x117)+'\x20Order\x20Number\x20:\x20'+_0xb7ae8[_0x5f1c0e(0x142)]+'\x20'+_0x5f1c0e(0x105)+_0x5f1c0e(0x11d)+_0xb7ae8[_0x5f1c0e(0x14c)]+'\x20'+_0x5f1c0e(0x14a)+_0x5f1c0e(0x16f)+_0x5f1c0e(0x11a)+_0x5f1c0e(0x1a4)+_0x5f1c0e(0xe7)+_0x5f1c0e(0xf5)+_0x5f1c0e(0x10e)+_0x5f1c0e(0x151)+_0x5f1c0e(0xf6)+_0x5f1c0e(0x148)+_0x5f1c0e(0x135)+_0x5f1c0e(0x146)+_0x5f1c0e(0x18f)+_0x5f1c0e(0x128)+'\x20'+_0x2fef53+'\x20'+'</tbody>'+'</table>'+_0x5f1c0e(0x16a)+_0x5f1c0e(0x184)+_0x5f1c0e(0x139)+_0x47d27c[0x0][_0x5f1c0e(0x15e)]+'</h5>'+_0x5f1c0e(0x11a)+_0x5f1c0e(0x11a)+_0x5f1c0e(0xe2)};_0x4c6442['sendMail'](_0x1f691f,function(_0x3e736a,_0x5522dc){var _0x192970=_0x5f1c0e;_0x3e736a?(console[_0x192970(0x115)](_0x3e736a),console[_0x192970(0x115)](_0x192970(0x134))):console['log']('Email\x20sent\x20successfully');}),_0x3a2866[_0x5f1c0e(0xf0)]('success',_0x5f1c0e(0x147)),_0x3af9c6[_0x5f1c0e(0xd4)](_0x5f1c0e(0x17a)+_0x16d0c7[_0x5f1c0e(0x1a3)]);}catch(_0x53e538){console[_0x5f1c0e(0x11c)](_0x53e538),_0x3af9c6[_0x5f1c0e(0x10c)](0x1f4)['json']({'error':_0x5f1c0e(0x157)});}})['catch'](_0x474201=>{var _0x866356=_0x547c92;console['error'](_0x474201),_0x3af9c6[_0x866356(0x10c)](0x1f4)[_0x866356(0x1a6)]({'error':_0x866356(0x18c)});});}catch(_0x50d231){console[_0x547c92(0x11c)](_0x50d231),_0x3af9c6[_0x547c92(0x10c)](0x1f4)[_0x547c92(0x1a6)]({'error':_0x547c92(0x116)});}})[_0x405656(0x190)](_0x477f19=>{var _0x25d332=_0x405656;console[_0x25d332(0x11c)](_0x477f19),_0x3af9c6['status'](0x1f4)[_0x25d332(0x1a6)]({'error':_0x25d332(0x18c)});});}catch(_0xdbf1c3){_0x3af9c6[_0x405656(0x1a6)]({'message':_0xdbf1c3[_0x405656(0x150)]});}});function BayBinSelected(_0x125393,_0x4d3e7c){var _0x3c42fd=a0_0x32a01a,_0x49b358=[];let _0x38496f=[];var _0x3a12bc=[];if(_0x125393==_0x3c42fd(0x191)){switch(_0x4d3e7c){case _0x3c42fd(0xdd):_0x49b358=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x3c42fd(0x152):_0x49b358=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3a12bc=['DG'];}else{if(_0x125393==_0x3c42fd(0x111)){switch(_0x4d3e7c){case _0x3c42fd(0xdd):_0x49b358=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x3c42fd(0x152):_0x49b358=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3a12bc=['FG'];}}return{'levels':_0x49b358,'identify':_0x3a12bc};}router[a0_0x32a01a(0xe5)]('/view/:id',auth,async(_0x487308,_0x34bd38)=>{var _0x5c2125=a0_0x32a01a;try{const {username:_0x5af280,email:_0xbe1915,role:_0x27f1f1}=_0x487308[_0x5c2125(0x1b1)],_0x239140=_0x487308[_0x5c2125(0x1b1)],_0x55d7fb=await profile['findOne']({'email':_0x239140['email']}),_0x4997bd=await master_shop[_0x5c2125(0x175)](),_0x1d2068=await transfers_finished[_0x5c2125(0x168)](_0x487308[_0x5c2125(0xe6)]['id']);let _0x2e86fc=new Date(_0x1d2068[_0x5c2125(0x1ab)]),_0x37b7d1=('0'+_0x2e86fc[_0x5c2125(0x19c)]())['slice'](-0x2),_0x2fb733=('0'+(_0x2e86fc[_0x5c2125(0x1a0)]()+0x1))[_0x5c2125(0xf2)](-0x2),_0x2d2249=_0x2e86fc[_0x5c2125(0x19f)](),_0x2c3f98=_0x2d2249+'-'+_0x2fb733+'-'+_0x37b7d1,_0x787c4c;if(_0x239140[_0x5c2125(0x19b)]==_0x5c2125(0x1b7)){const _0x4d9063=await staff[_0x5c2125(0x1b0)]({'email':_0x239140[_0x5c2125(0x1ae)]});_0x787c4c=await warehouse[_0x5c2125(0x175)]({'status':_0x5c2125(0x18d),'name':_0x4d9063[_0x5c2125(0x127)],'warehouse_category':_0x5c2125(0x1a5)});}else _0x787c4c=await warehouse[_0x5c2125(0x175)]({'status':'Enabled','warehouse_category':'Finished\x20Goods'});const _0x8917f4=await warehouse[_0x5c2125(0xf8)]([{'$match':{'name':_0x1d2068['from_warehouse'],'room':_0x1d2068[_0x5c2125(0x144)]}},{'$unwind':_0x5c2125(0x15d)},{'$group':{'_id':_0x5c2125(0x10b),'name':{'$first':_0x5c2125(0xdb)},'product_stock':{'$first':_0x5c2125(0x13b)},'level':{'$first':_0x5c2125(0x120)},'isle':{'$first':_0x5c2125(0x149)},'pallet':{'$first':_0x5c2125(0x177)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5c2125(0xea)},'rack':{'$first':'$product_details.rack'}}}]);var _0x36d771=[0x1,0x2,0x3,0x4],_0x31befb=['A','B','C','D','E','F','G','H','I','J'],_0x5bf771=['Ambient',_0x5c2125(0x195)];const _0x10ac2e=await product[_0x5c2125(0x175)]({}),_0xcb5b68=BayBinSelected(_0x1d2068[_0x5c2125(0xd6)],_0x1d2068['to_room']);if(_0x4997bd[0x0]['language']=='English\x20(US)'){var _0x166e58=users[_0x5c2125(0xf1)];console['log'](_0x166e58);}else{if(_0x4997bd[0x0][_0x5c2125(0x154)]==_0x5c2125(0x181))var _0x166e58=users['Hindi'];else{if(_0x4997bd[0x0][_0x5c2125(0x154)]==_0x5c2125(0x179))var _0x166e58=users['German'];else{if(_0x4997bd[0x0][_0x5c2125(0x154)]==_0x5c2125(0x186))var _0x166e58=users[_0x5c2125(0x186)];else{if(_0x4997bd[0x0][_0x5c2125(0x154)]=='French')var _0x166e58=users[_0x5c2125(0x11b)];else{if(_0x4997bd[0x0][_0x5c2125(0x154)]==_0x5c2125(0x1aa))var _0x166e58=users[_0x5c2125(0xfc)];else{if(_0x4997bd[0x0][_0x5c2125(0x154)]=='Chinese')var _0x166e58=users['Chinese'];else{if(_0x4997bd[0x0][_0x5c2125(0x154)]==_0x5c2125(0x130))var _0x166e58=users[_0x5c2125(0x1b2)];}}}}}}}_0x34bd38[_0x5c2125(0x103)]('edit_transfer_finished',{'success':_0x487308['flash']('success'),'errors':_0x487308[_0x5c2125(0xf0)](_0x5c2125(0xfd)),'role':_0x239140,'profile':_0x55d7fb,'master_shop':_0x4997bd,'warehouse':_0x787c4c,'transfer':_0x1d2068,'stock':_0x8917f4,'unit':_0x10ac2e,'language':_0x166e58,'levels':_0x36d771,'Isle':_0x31befb,'rooms_data':_0x5bf771,'ed_fullDate':_0x2c3f98,'dataSelected':_0xcb5b68});}catch(_0x40bf0f){console[_0x5c2125(0x115)](_0x40bf0f);}}),router[a0_0x32a01a(0x17c)](a0_0x32a01a(0x110),auth,async(_0x4280cf,_0x2617e1)=>{var _0x354eb2=a0_0x32a01a;try{const _0x50563f=_0x4280cf[_0x354eb2(0xe6)]['id'];console[_0x354eb2(0x115)](_0x4280cf[_0x354eb2(0x118)]);const _0x8b1444=await transfers_finished[_0x354eb2(0x168)](_0x50563f);console[_0x354eb2(0x115)](_0x354eb2(0x1a2),_0x8b1444);const {date:_0x20855c,from_warehouse:_0xab5773,FromRoom_name:_0x543ef9,to_warehouse:_0x58791a,ToRoom_name:_0xf53ed1,prod_name:_0x12409b,from_prod_qty:_0x4e1e42,from_prod_level:_0x52837f,from_prod_isle:_0x466cc6,from_prod_pallet:_0x363f01,to_prod_qty:_0xaec058,to_prod_level:_0x4cae40,to_prod_isle:_0xc59dd8,to_prod_pallet:_0x17a472,primary_code:_0x555c5c,secondary_code:_0x2b1484,product_code3:_0x9a2177,note:_0xd572c4,invoice:_0x2fecda,expiry_date:_0x34a6f6}=_0x4280cf[_0x354eb2(0x118)];if(typeof _0x12409b==_0x354eb2(0x16c))var _0x355177=[_0x4280cf[_0x354eb2(0x118)]['prod_name']],_0x5b43c2=[_0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x156)]],_0x273569=[_0x4280cf[_0x354eb2(0x118)]['from_prod_level']],_0x49750a=[_0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x183)]],_0x4a0bd7=[_0x4280cf[_0x354eb2(0x118)]['to_prod_level']],_0x314cf4=[_0x4280cf['body'][_0x354eb2(0x10d)]],_0x14a426=[_0x4280cf['body']['secondary_code']],_0x466910=[_0x4280cf[_0x354eb2(0x118)][_0x354eb2(0xf9)]],_0x5e89ae=[_0x4280cf[_0x354eb2(0x118)]['MaxStocks_data2']],_0x1eaf52=[_0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x16b)]],_0x19abca=[_0x4280cf[_0x354eb2(0x118)][_0x354eb2(0xfe)]],_0x18b8fd=[_0x4280cf[_0x354eb2(0x118)][_0x354eb2(0xdc)]],_0x488222=[_0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x1ab)]];else var _0x355177=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x143)]],_0x5b43c2=[..._0x4280cf['body'][_0x354eb2(0x156)]],_0x273569=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x17f)]],_0x49750a=[..._0x4280cf[_0x354eb2(0x118)]['to_prod_qty']],_0x4a0bd7=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x18e)]],_0x314cf4=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x10d)]],_0x14a426=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x13c)]],_0x466910=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0xf9)]],_0x5e89ae=[..._0x4280cf[_0x354eb2(0x118)]['MaxStocks_data2']],_0x1eaf52=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0x16b)]],_0x19abca=[..._0x4280cf['body'][_0x354eb2(0xfe)]],_0x18b8fd=[..._0x4280cf[_0x354eb2(0x118)][_0x354eb2(0xdc)]],_0x488222=[..._0x4280cf[_0x354eb2(0x118)]['expiry_date']];const _0x3a20d1=_0x355177['map'](_0x2797c8=>{return _0x2797c8={'product_name':_0x2797c8};});_0x5b43c2['forEach']((_0xa3f02,_0x1e5d0b)=>{var _0xba89eb=_0x354eb2;_0x3a20d1[_0x1e5d0b][_0xba89eb(0xd5)]=_0xa3f02;}),_0x273569['forEach']((_0x4f8655,_0x2ed5a1)=>{var _0x41b296=_0x354eb2;_0x3a20d1[_0x2ed5a1][_0x41b296(0xef)]=_0x4f8655;}),_0x49750a[_0x354eb2(0x12b)]((_0x3b4cbd,_0x4c2657)=>{var _0x35f3f1=_0x354eb2;_0x3a20d1[_0x4c2657][_0x35f3f1(0x1b6)]=_0x3b4cbd;}),_0x4a0bd7[_0x354eb2(0x12b)]((_0x48ed5f,_0x23a0a1)=>{var _0x2df379=_0x354eb2;_0x3a20d1[_0x23a0a1][_0x2df379(0x16e)]=_0x48ed5f;}),_0x314cf4[_0x354eb2(0x12b)]((_0x137021,_0x407926)=>{var _0xd8fd8d=_0x354eb2;_0x3a20d1[_0x407926][_0xd8fd8d(0x10d)]=_0x137021;}),_0x14a426[_0x354eb2(0x12b)]((_0x5e4783,_0x3e0df8)=>{var _0x1f5a2d=_0x354eb2;_0x3a20d1[_0x3e0df8][_0x1f5a2d(0x13c)]=_0x5e4783;}),_0x466910[_0x354eb2(0x12b)]((_0xacd0f0,_0x5c2928)=>{_0x3a20d1[_0x5c2928]['product_code']=_0xacd0f0;}),_0x5e89ae[_0x354eb2(0x12b)]((_0x317d5e,_0xe9bed1)=>{var _0x13690f=_0x354eb2;_0x3a20d1[_0xe9bed1][_0x13690f(0x101)]=_0x317d5e;}),_0x1eaf52[_0x354eb2(0x12b)]((_0x5686ca,_0x5b7062)=>{var _0x42ca7c=_0x354eb2;_0x3a20d1[_0x5b7062][_0x42ca7c(0x16b)]=_0x5686ca;}),_0x19abca['forEach']((_0x4ddbdd,_0x70d971)=>{var _0x1a9149=_0x354eb2;_0x3a20d1[_0x70d971][_0x1a9149(0xfe)]=_0x4ddbdd;}),_0x18b8fd[_0x354eb2(0x12b)]((_0x128b05,_0xf90eef)=>{_0x3a20d1[_0xf90eef]['batch_code']=_0x128b05;}),_0x488222['forEach']((_0x5bcf79,_0x26739a)=>{var _0x21355e=_0x354eb2;_0x3a20d1[_0x26739a][_0x21355e(0x1ab)]=_0x5bcf79;});const _0x44282c=_0x3a20d1['filter'](_0x516cc2=>_0x516cc2['to_quantity']!=='0'&&_0x516cc2[_0x354eb2(0x1b6)]!==''||_0x516cc2[_0x354eb2(0x132)]!=='0'&&_0x516cc2['to_floorlevel']!=='');var _0x16cb4d=0x0;_0x44282c[_0x354eb2(0x12b)](_0x59182a=>{var _0x3cc4f6=_0x354eb2;parseInt(_0x59182a['from_quantity'])<parseInt(_0x59182a[_0x3cc4f6(0x1b6)])&&_0x16cb4d++;});if(_0x16cb4d!=0x0)return _0x4280cf[_0x354eb2(0xf0)](_0x354eb2(0xfd),_0x354eb2(0xee)),_0x2617e1[_0x354eb2(0xd4)](_0x354eb2(0x19e));const _0x5f1ea8=await warehouse[_0x354eb2(0x1b0)]({'name':_0x8b1444['from_warehouse'],'room':_0x8b1444['from_room']});_0x8b1444[_0x354eb2(0x1b8)][_0x354eb2(0x12b)](_0x40b786=>{var _0x33482f=_0x354eb2;if(_0x40b786[_0x33482f(0x1b6)]>0x0){const _0x179549=_0x5f1ea8[_0x33482f(0x198)][_0x33482f(0x161)](_0x2b6be3=>{var _0x250249=_0x33482f;_0x2b6be3[_0x250249(0x1b5)]==_0x40b786[_0x250249(0x1b5)]&&_0x2b6be3[_0x250249(0xd7)]==_0x40b786['from_bay']&&(_0x2b6be3['product_stock']=parseInt(_0x2b6be3['product_stock'])+parseInt(_0x40b786[_0x250249(0x1b6)]));});}}),await _0x5f1ea8[_0x354eb2(0x11e)]();const _0x13ac0a=await warehouse[_0x354eb2(0x1b0)]({'name':_0x8b1444[_0x354eb2(0xd6)],'room':_0x8b1444[_0x354eb2(0x14b)]});_0x8b1444[_0x354eb2(0x1b8)][_0x354eb2(0x12b)](_0x5417a9=>{var _0x233a2d=_0x354eb2;if(_0x5417a9[_0x233a2d(0x1b6)]>0x0){const _0x4f45b5=_0x13ac0a[_0x233a2d(0x198)][_0x233a2d(0x161)](_0x5a0ab7=>{var _0x1f8a71=_0x233a2d;_0x5a0ab7[_0x1f8a71(0x1b5)]==_0x5417a9[_0x1f8a71(0x1b5)]&&_0x5a0ab7['bay']==_0x5417a9[_0x1f8a71(0x16e)]&&(_0x5a0ab7['product_stock']=parseInt(_0x5a0ab7['product_stock'])-parseInt(_0x5417a9['to_quantity']));});}}),await _0x13ac0a['save'](),_0x8b1444[_0x354eb2(0x14c)]=_0x20855c,_0x8b1444[_0x354eb2(0x197)]=_0xab5773,_0x8b1444['to_warehouse']=_0x58791a,_0x8b1444[_0x354eb2(0x1b8)]=_0x44282c,_0x8b1444[_0x354eb2(0xff)]=_0xd572c4,_0x8b1444['invoice']=_0x2fecda;const _0x206e10=await _0x8b1444[_0x354eb2(0x11e)](),_0x1f272d=await warehouse[_0x354eb2(0x1b0)]({'name':_0xab5773,'room':_0x543ef9});_0x206e10[_0x354eb2(0x1b8)][_0x354eb2(0x12b)](_0x5b07f4=>{var _0x161815=_0x354eb2;if(_0x5b07f4[_0x161815(0x1b6)]>0x0){const _0x4efe48=_0x1f272d['product_details']['map'](_0x4914bf=>{var _0x54b90e=_0x161815;_0x4914bf[_0x54b90e(0x1b5)]==_0x5b07f4[_0x54b90e(0x1b5)]&&_0x4914bf[_0x54b90e(0xd7)]==_0x5b07f4['from_bay']&&(_0x4914bf[_0x54b90e(0xe0)]=parseInt(_0x4914bf[_0x54b90e(0xe0)])-parseInt(_0x5b07f4[_0x54b90e(0x1b6)]));});}}),await _0x1f272d[_0x354eb2(0x11e)]();const _0x335035=await warehouse['findOne']({'name':_0x58791a,'room':_0xf53ed1});_0x206e10[_0x354eb2(0x1b8)][_0x354eb2(0x12b)](_0x1d0778=>{var _0x539eb3=_0x354eb2;if(_0x1d0778['to_quantity']>0x0){var _0x10ab81=0x0;const _0x19732a=_0x335035['product_details'][_0x539eb3(0x161)](_0x5e56a0=>{var _0x5457dc=_0x539eb3;_0x5e56a0[_0x5457dc(0x1b5)]==_0x1d0778[_0x5457dc(0x1b5)]&&_0x5e56a0[_0x5457dc(0xd7)]==_0x1d0778[_0x5457dc(0x16e)]&&(_0x5e56a0[_0x5457dc(0xe0)]=parseInt(_0x5e56a0[_0x5457dc(0xe0)])+parseInt(_0x1d0778['to_quantity']),_0x10ab81++);});_0x10ab81=='0'&&(_0x335035[_0x539eb3(0x198)]=_0x335035[_0x539eb3(0x198)]['concat']({'product_name':_0x1d0778['product_name'],'product_stock':_0x1d0778[_0x539eb3(0x1b6)],'bay':_0x1d0778['to_bay'],'product_code':_0x1d0778['product_code'],'primary_code':_0x1d0778[_0x539eb3(0x10d)],'secondary_code':_0x1d0778[_0x539eb3(0x13c)],'maxProducts':_0x1d0778['maxProducts']}));}}),await _0x335035[_0x354eb2(0x11e)](),_0x4280cf[_0x354eb2(0xf0)](_0x354eb2(0xf4),_0x354eb2(0x13d)),_0x2617e1[_0x354eb2(0xd4)](_0x354eb2(0x1ad));}catch(_0x24b2b6){console[_0x354eb2(0x115)](_0x24b2b6);}}),router[a0_0x32a01a(0x17c)]('/barcode_scanner',async(_0x1f2692,_0x5c9e8f)=>{var _0x1f0edf=a0_0x32a01a;const {FromWareHouse:_0x1e2510,FromRoom:_0x1012e5,ToWarehouse:_0x1a1fb0,ToRoom:_0x21bca7,primary_code:_0x56049c,Roomslist:_0x1dad6b}=_0x1f2692['body'],_0x1298b4=_0x1dad6b[_0x1f0edf(0x188)](','),_0x3ad995=[];async function _0x508ab8(_0x1dd4d1){var _0x3e4f06=_0x1f0edf;const _0x4b88fd=await warehouse['aggregate']([{'$match':{'name':_0x1e2510,'room':_0x1dd4d1}},{'$unwind':_0x3e4f06(0x15d)},{'$match':{'product_details.primary_code':_0x56049c}},{'$group':{'_id':_0x3e4f06(0x10b),'name':{'$first':_0x3e4f06(0xdb)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x3e4f06(0x165)},'secondary_code':{'$first':_0x3e4f06(0x137)},'product_code':{'$first':_0x3e4f06(0x169)},'level':{'$first':_0x3e4f06(0x120)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'unit':{'$first':_0x3e4f06(0x1a9)},'secondary_unit':{'$first':_0x3e4f06(0x122)},'storage':{'$first':_0x3e4f06(0xea)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3e4f06(0x187)},'production_date':{'$first':_0x3e4f06(0x107)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x3e4f06(0x14e)},'roomNamed':{'$first':_0x3e4f06(0x176)},'prod_cat':{'$first':'P'},'maxProducts':{'$first':_0x3e4f06(0x164)},'CBM':{'$first':{'$toDouble':_0x3e4f06(0x15b)}},'invoice':{'$first':_0x3e4f06(0x14d)}}}]),_0x561ae7=await warehouse[_0x3e4f06(0xf8)]([{'$match':{'name':_0x1e2510,'room':_0x1dd4d1}},{'$unwind':_0x3e4f06(0x15d)},{'$match':{'product_details.secondary_code':_0x56049c}},{'$group':{'_id':_0x3e4f06(0x10b),'name':{'$first':_0x3e4f06(0xdb)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x3e4f06(0x165)},'secondary_code':{'$first':_0x3e4f06(0x137)},'product_code':{'$first':_0x3e4f06(0x169)},'level':{'$first':_0x3e4f06(0x120)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'unit':{'$first':_0x3e4f06(0x1a9)},'secondary_unit':{'$first':_0x3e4f06(0x122)},'storage':{'$first':_0x3e4f06(0xea)},'rack':{'$first':_0x3e4f06(0xda)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3e4f06(0x107)},'batch_code':{'$first':_0x3e4f06(0x145)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x3e4f06(0x176)},'prod_cat':{'$first':'S'},'maxProducts':{'$first':_0x3e4f06(0x164)},'CBM':{'$first':{'$toDouble':_0x3e4f06(0x15b)}},'invoice':{'$first':'$product_details.invoice'}}}]);if(_0x4b88fd[_0x3e4f06(0x1a1)]>0x0)_0x3ad995[_0x3e4f06(0x163)](_0x4b88fd);else _0x561ae7['length']>0x0&&_0x3ad995['push'](_0x561ae7);}const _0x227c1e=_0x1298b4[_0x1f0edf(0x161)](_0x5c77c1=>_0x508ab8(_0x5c77c1));await Promise[_0x1f0edf(0xdf)](_0x227c1e),_0x5c9e8f['json'](_0x3ad995);}),router[a0_0x32a01a(0x17c)]('/barcode_scanner2',async(_0x3bd62a,_0x10989a)=>{var _0x389d60=a0_0x32a01a;try{const {FromWareHouse:_0x4e8fe2,FromRoom:_0x6aaac,ToWarehouse:_0x3bf70e,ToRoom:_0xa46eab,secondary_code:_0x8e4ea8}=_0x3bd62a[_0x389d60(0x118)],_0x1e139c=await warehouse[_0x389d60(0xf8)]([{'$match':{'name':_0x4e8fe2}},{'$unwind':_0x389d60(0x15d)},{'$match':{'product_details.secondary_code':_0x8e4ea8}},{'$group':{'_id':_0x389d60(0x10b),'name':{'$first':_0x389d60(0xdb)},'primary_code':{'$first':_0x389d60(0x165)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x389d60(0x169)},'instock':{'$first':_0x389d60(0x13b)},'warehouse':{'$first':_0x389d60(0x1a7)},'level':{'$first':_0x389d60(0x120)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x389d60(0x177)},'maxProducts':{'$first':_0x389d60(0x164)},'unit':{'$first':_0x389d60(0x1a9)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x389d60(0x107)}}}]);_0x10989a[_0x389d60(0x10c)](0xc8)[_0x389d60(0x1a6)](_0x1e139c);}catch(_0x381c4b){_0x10989a['status'](0x194)[_0x389d60(0x1a6)]({'message':_0x381c4b[_0x389d60(0x150)]});}}),router['post'](a0_0x32a01a(0x160),async(_0x3af4e3,_0x15b8d1)=>{var _0x4571ef=a0_0x32a01a;try{const {FromWareHouse:_0x502bbf,FromRoom:_0x4a2bc0,ToWarehouse:_0x5c9065,ToRoom:_0x5e0cef,product_code:_0x3da5b1}=_0x3af4e3['body'],_0x4ed2b6=await warehouse[_0x4571ef(0xf8)]([{'$match':{'name':_0x502bbf}},{'$unwind':_0x4571ef(0x15d)},{'$match':{'product_details.product_code':_0x3da5b1}},{'$group':{'_id':'$product_details._id','name':{'$first':_0x4571ef(0xdb)},'primary_code':{'$first':_0x4571ef(0x165)},'secondary_code':{'$first':_0x4571ef(0x137)},'product_code':{'$first':_0x4571ef(0x169)},'instock':{'$first':_0x4571ef(0x13b)},'warehouse':{'$first':_0x4571ef(0x1a7)},'level':{'$first':_0x4571ef(0x120)},'isle':{'$first':_0x4571ef(0x149)},'pallet':{'$first':_0x4571ef(0x177)},'maxProducts':{'$first':_0x4571ef(0x164)},'unit':{'$first':_0x4571ef(0x1a9)}}}]);_0x15b8d1['status'](0xc8)[_0x4571ef(0x1a6)](_0x4ed2b6);}catch(_0xc5d5a1){_0x15b8d1[_0x4571ef(0x10c)](0x194)[_0x4571ef(0x1a6)]({'message':_0xc5d5a1[_0x4571ef(0x150)]});}}),router[a0_0x32a01a(0x17c)]('/CheckingWarehouse',async(_0x3fc299,_0xd8a411)=>{var _0x1256a4=a0_0x32a01a;const {productCode:_0x19e49f,bay:_0xbcb11d,warehouses:_0x4901ce,room:_0x308d4a}=_0x3fc299[_0x1256a4(0x118)];try{const _0x5bd8b9=await warehouse[_0x1256a4(0xf8)]([{'$match':{'name':_0x4901ce,'room':_0x308d4a}},{'$unwind':_0x1256a4(0x15d)},{'$match':{'product_details.pallet':parseInt(_0xbcb11d)}},{'$group':{'_id':_0x1256a4(0xdb),'name':{'$first':'$product_details.product_name'},'product_stock':{'$sum':_0x1256a4(0x13b)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);console[_0x1256a4(0x115)](_0x5bd8b9),_0xd8a411[_0x1256a4(0x10c)](0xc8)['json'](_0x5bd8b9);}catch(_0x395a76){_0xd8a411[_0x1256a4(0x10c)](0x194)[_0x1256a4(0x1a6)]({'message':_0x395a76[_0x1256a4(0x150)]});}}),module[a0_0x32a01a(0x12a)]=router;function a0_0x1553(){var _0x54b51a=['to_quantity','staff','product','redirect','from_quantity','to_warehouse','bay','from_level','<!DOCTYPE\x20html>','$product_details.rack','$product_details.product_name','batch_code','Rack\x201','/../public','all','product_stock','production_date','</body></html>','MaxStocks_data2','maxPerUnit','get','params','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','primary_unit','New_Qty_Converted','$product_details.storage','from_pallet','toString','to_room_name','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','from_bay','flash','English','slice','382536JdFyaZ','success','<tr>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room\x20</th>','from_room_name','aggregate','product_code3','ToRoomAssigned','CBM','Portuguese','errors','secondary_unit','note','RoomAssigned','maxProducts','/preview/:id','render','$product.from_room_name','<span\x20style=\x22float:\x20right;\x22>','image','$product_details.production_date','Router','3570tefcjq','MaxStocks_data','$product_details._id','status','primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','/view/:id','FROZEN\x20GOODS','164504vQSSsq','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product','log','An\x20error\x20occurred\x20while\x20saving\x20data.','<h5\x20style=\x22text-align:\x20left;\x22>','body','Return\x20Rooms','</div>','French','error','\x20Order\x20Date\x20:\x20','save','Chinese','$product_details.level','55875gYiaqi','$product_details.secondary_unit','level','padStart','/transfer_finished/preview/','type','warehouse','<tbody\x20style=\x22text-align:\x20center;\x22>','prod_cat','exports','forEach','$date','express','13626zJqnfs','True','Arabic\x20(ae)','$_id','to_floorlevel','updateOne','Error\x20Occurs','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','../public/language/languages.json','$product_details.secondary_code','finalize','<h5>','concat','$product_details.product_stock','secondary_code','Transfer\x20Edit\x20Successfully','password','QA\x20Warehouse','$product.to_room_name','<hr\x20class=\x22my-3\x22>','invoice','prod_name','from_room','$product_details.batch_code','</tr>','Transfer\x20Finalize\x20Successfully','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Level\x20</th>','$product_details.isle','</span>','to_room','date','$product_details.invoice','$product_details.maxPerUnit','There\x27s\x20a\x20error\x20in\x20this\x20transaction','message','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','Rack\x202','then','language','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','from_prod_qty','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','English\x20(US)','add_transfer_finished','port','$product_details.CBM','filter','$product_details','site_title','/upload/','/barcode_scanner3','map','from_isle','push','$product_details.maxProducts','$product_details.primary_code','edit_transfer_finished_view','205ELrXMq','findById','$product_details.product_code','<div>','unit','string','isle','to_bay','</h5>','from_invoice','random','pallet','Ambient','<html><head><title></title>','find','$room','$product_details.pallet','1745874dreyvo','German','/picking_list/PDF_transferFinal/','to_pallet','post','to_level','Product\x20Transfer\x20successfully','from_prod_level','product_date','Hindi','floor','to_prod_qty','<strong>\x20Regards\x20</strong>','</td>','Spanish','$product_details.expiry_date','split','167291bQPsPK','to_isle','RMSEmail','An\x20error\x20occurred.','Enabled','to_prod_level','</thead>','catch','DRY\x20GOODS','product_code','$to_warehouse','$finalize','Enclosed','<h2>\x20','from_warehouse','product_details','from_prod_leveling','Transfer\x20Product\x20Mail','role','getDate','Logo.png','back','getFullYear','getMonth','length','transfer_data','_id','<table\x20style=\x22width:\x20100%\x20!important;\x22>','Finished\x20Goods','json','$name','TRF-','$product_details.unit','Portuguese\x20(BR)','expiry_date','2488UhnJan','/transfer_finished/view','email','/view','findOne','user','Arabic','host','to_invoice','product_name'];a0_0x1553=function(){return _0x54b51a;};return a0_0x1553();}