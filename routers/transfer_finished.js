var a0_0x5411bc=a0_0x19a5;function a0_0x38f6(){var _0x234d75=['to_prod_level','push','$date','split','note','1974nVkuge','$product_details.CBM','body','to_room','maxProducts','getDate','Portuguese\x20(BR)','user','product_date','An\x20error\x20occurred\x20while\x20saving\x20data.','nodemailer','</h5>','/view/add_transfer','to_warehouse','</head><body>','$product_details.expiry_date','/CheckingWarehouse','/upload/','$product_details.unit','product','to_level','$invoice','find','$product_details.level','success','batch_code','$product_details.production_date','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','message','from_warehouse','/barcode_scanner','</span>','from_room_name','Transfer\x20Finalize\x20Successfully','Enclosed','forEach','json','<h5\x20style=\x22text-align:\x20left;\x22>','/preview/:id','$name','ToRoomAssigned','redirect','type','all','from_level','There\x27s\x20a\x20error\x20in\x20this\x20transaction','isle','product_code','production_date','<span\x20style=\x22float:\x20right;\x22>','then','<strong>\x20Regards\x20</strong>','$product_details.invoice','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','Rack\x201','to_invoice','Arabic','createTransport','findOne','from_bay','warehouse','\x20</h2>','Transfer\x20Edit\x20Successfully','to_floorlevel','exports','</body></html>','<!DOCTYPE\x20html>','from_invoice','finalize','QA\x20Warehouse','$product_details.isle','$product_details.product_code','$product_details.product_stock','add_transfer_finished','from_isle','flash','status','9360330PpgpNd','secondary_code','product_code3','$room','German','language','map','</td>','$product_details.rack','48MZgral','bay','to_prod_qty','to_isle','random','$product_details.product_name','maxPerUnit','length','CBM','</tr>','unit','email','Logo.png','Product\x20Transfer\x20successfully','errors','22596NWOZQD','primary_code','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','<h2>\x20','$finalize','$to_warehouse','primary_unit','from_prod_leveling','Finished\x20Goods','$product_details._id','post','New_Qty_Converted','expiry_date','edit_transfer_finished','log','</tbody>','prod_name','Email\x20sent\x20successfully','</table>','to_room_name','concat','_id','site_title','product_stock','/view','<tr>','4503176PpnTpw','<div>','/../public','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','MaxStocks_data2','pallet','prod_cat','get','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room\x20</th>','3515405kzwObr','$product.from_room_name','$product_details','<hr\x20class=\x22my-3\x22>','render','error','English','Spanish','to_pallet','Portuguese','$product_details.pallet','RMSEmail','../models/all_models','Transfer\x20Product\x20Mail','../middleware/auth','657549mkSCQE','image','3gWOdOn','slice','from_prod_level','<table\x20style=\x22width:\x20100%\x20!important;\x22>','/barcode_scanner2','\x20Order\x20Number\x20:\x20','$product_details.storage','$product','padStart','RoomAssigned','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','$product_details.primary_code','level','French','<tbody\x20style=\x22text-align:\x20center;\x22>','An\x20error\x20occurred.','aggregate','port','$product_details.batch_code','findById','updateOne','English\x20(US)','from_prod_qty','<html><head><title></title>','logo','1010596qSllVI','Ambient','TRF-','filter','</div>','secondary_unit','857597XJGEkX','Rack\x202','Enabled','catch','$from_warehouse','../public/language/languages.json','product_name','True','edit_transfer_finished_view','password','Hindi','$_id','invoice','to_quantity','save','$product_details.secondary_unit','To\x20An\x20error\x20occurred\x20while\x20saving\x20data.','$product_details.secondary_code','$product_details.maxProducts','string','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','DRY\x20GOODS','</thead>','/picking_list/PDF_transferFinal/','to_bay','/transfer_finished/view','sendMail','Arabic\x20(ae)','/transfer_finished/preview/','from_room','/view/:id','date','Error\x20Occurs','role','product_details','host','params','express','staff','from_quantity','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Level\x20</th>','<h5>','MaxStocks_data','$product_details.maxPerUnit','Chinese'];a0_0x38f6=function(){return _0x234d75;};return a0_0x38f6();}function a0_0x19a5(_0x5bebc2,_0x46fae6){var _0x38f635=a0_0x38f6();return a0_0x19a5=function(_0x19a5ff,_0x358639){_0x19a5ff=_0x19a5ff-0x112;var _0x18a885=_0x38f635[_0x19a5ff];return _0x18a885;},a0_0x19a5(_0x5bebc2,_0x46fae6);}(function(_0x4a83b1,_0x4cbbf5){var _0x2a29fd=a0_0x19a5,_0x584c5f=_0x4a83b1();while(!![]){try{var _0x1f5fb2=-parseInt(_0x2a29fd(0x1cd))/0x1+-parseInt(_0x2a29fd(0x1c7))/0x2+parseInt(_0x2a29fd(0x1ae))/0x3*(parseInt(_0x2a29fd(0x194))/0x4)+-parseInt(_0x2a29fd(0x19d))/0x5+parseInt(_0x2a29fd(0x114))/0x6*(parseInt(_0x2a29fd(0x179))/0x7)+parseInt(_0x2a29fd(0x16a))/0x8*(-parseInt(_0x2a29fd(0x1ac))/0x9)+parseInt(_0x2a29fd(0x161))/0xa;if(_0x1f5fb2===_0x4cbbf5)break;else _0x584c5f['push'](_0x584c5f['shift']());}catch(_0xb7e1b0){_0x584c5f['push'](_0x584c5f['shift']());}}}(a0_0x38f6,0x973e9));const express=require(a0_0x5411bc(0x1f2)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,email_settings,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers,transfers_finished,supervisor_settings}=require(a0_0x5411bc(0x1a9)),auth=require(a0_0x5411bc(0x1ab)),users=require(a0_0x5411bc(0x1d2)),nodemailer=require(a0_0x5411bc(0x11e));router['get'](a0_0x5411bc(0x192),auth,async(_0x113b7c,_0x30e13f)=>{var _0x454cdd=a0_0x5411bc;try{const {username:_0xcab388,email:_0x56a221,role:_0x5652e8}=_0x113b7c[_0x454cdd(0x11b)],_0x21f6a7=_0x113b7c[_0x454cdd(0x11b)],_0x5ced34=await profile[_0x454cdd(0x14e)]({'email':_0x21f6a7[_0x454cdd(0x175)]}),_0x168149=await master_shop[_0x454cdd(0x12a)]();let _0xf0f74e;if(_0x21f6a7[_0x454cdd(0x1ee)]=='staff'){const _0x43fd1a=await staff[_0x454cdd(0x14e)]({'email':_0x21f6a7[_0x454cdd(0x175)]});_0xf0f74e=await transfers_finished[_0x454cdd(0x12a)]({'from_warehouse':_0x43fd1a['warehouse']});}else _0xf0f74e=await transfers_finished[_0x454cdd(0x1be)]([{'$unwind':_0x454cdd(0x1b5)},{'$group':{'_id':_0x454cdd(0x1d8),'invoice':{'$first':_0x454cdd(0x129)},'date':{'$first':_0x454cdd(0x1fc)},'from_warehouse':{'$first':_0x454cdd(0x1d1)},'to_warehouse':{'$first':_0x454cdd(0x17f)},'from_room_name':{'$addToSet':_0x454cdd(0x19e)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':_0x454cdd(0x17e)}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x168149[0x0]['language']==_0x454cdd(0x1c3))var _0xcb67f0=users[_0x454cdd(0x1a3)];else{if(_0x168149[0x0][_0x454cdd(0x166)]=='Hindi')var _0xcb67f0=users[_0x454cdd(0x1d7)];else{if(_0x168149[0x0][_0x454cdd(0x166)]==_0x454cdd(0x165))var _0xcb67f0=users[_0x454cdd(0x165)];else{if(_0x168149[0x0][_0x454cdd(0x166)]=='Spanish')var _0xcb67f0=users[_0x454cdd(0x1a4)];else{if(_0x168149[0x0][_0x454cdd(0x166)]==_0x454cdd(0x1bb))var _0xcb67f0=users['French'];else{if(_0x168149[0x0][_0x454cdd(0x166)]=='Portuguese\x20(BR)')var _0xcb67f0=users[_0x454cdd(0x1a6)];else{if(_0x168149[0x0][_0x454cdd(0x166)]=='Chinese')var _0xcb67f0=users[_0x454cdd(0x1f9)];else{if(_0x168149[0x0][_0x454cdd(0x166)]=='Arabic\x20(ae)')var _0xcb67f0=users[_0x454cdd(0x14c)];}}}}}}}_0x30e13f[_0x454cdd(0x1a1)]('transfer_finished',{'success':_0x113b7c[_0x454cdd(0x15f)]('success'),'errors':_0x113b7c[_0x454cdd(0x15f)](_0x454cdd(0x178)),'role':_0x21f6a7,'profile':_0x5ced34,'master_shop':_0x168149,'transfer':_0xf0f74e,'language':_0xcb67f0});}catch(_0xf06f4f){console['log'](_0xf06f4f);}});async function getRandom8DigitNumber(){var _0x5d6257=a0_0x5411bc;const _0x3864d1=0x989680,_0x2eced0=0x5f5e0ff,_0x13f9a8=Math['floor'](Math[_0x5d6257(0x16e)]()*(_0x2eced0-_0x3864d1+0x1))+_0x3864d1;var _0x276828;const _0x2ad6a6=await transfers_finished[_0x5d6257(0x14e)]({'invoice':_0x5d6257(0x1c9)+_0x13f9a8});return _0x2ad6a6&&_0x2ad6a6[_0x5d6257(0x171)]>0x0?_0x276828='TRF-'+_0x13f9a8:_0x276828=_0x5d6257(0x1c9)+_0x13f9a8,_0x276828;}router[a0_0x5411bc(0x19b)](a0_0x5411bc(0x120),auth,async(_0x3b6abb,_0x3bf470)=>{var _0xcc5b5c=a0_0x5411bc;try{const {username:_0x429375,email:_0x49422a,role:_0x3a5fc3}=_0x3b6abb['user'],_0x5e0565=_0x3b6abb[_0xcc5b5c(0x11b)],_0x7b80a7=await profile['findOne']({'email':_0x5e0565[_0xcc5b5c(0x175)]}),_0x451458=await master_shop['find']();let _0x3a8ec1;if(_0x5e0565[_0xcc5b5c(0x1ee)]==_0xcc5b5c(0x1f3)){const _0x413125=await staff['findOne']({'email':_0x5e0565['email']});_0x3a8ec1=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0x413125[_0xcc5b5c(0x150)],'name':{'$ne':_0xcc5b5c(0x159)}}},{'$group':{'_id':_0xcc5b5c(0x13b),'name':{'$first':'$name'}}}]);}else _0x3a8ec1=await warehouse['aggregate']([{'$match':{'status':_0xcc5b5c(0x1cf),'name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0xcc5b5c(0x13b),'name':{'$first':_0xcc5b5c(0x13b)}}}]);var _0x4f50f3=[_0xcc5b5c(0x1c8),_0xcc5b5c(0x136),'Return\x20Rooms'];const _0x4c7243=await transfers_finished[_0xcc5b5c(0x12a)]({}),_0x2fe965=_0x4c7243[_0xcc5b5c(0x171)]+0x1,_0x1dd7a1=_0xcc5b5c(0x1c9)+_0x2fe965['toString']()[_0xcc5b5c(0x1b6)](0x5,'0');if(_0x451458[0x0]['language']==_0xcc5b5c(0x1c3))var _0x483b12=users['English'];else{if(_0x451458[0x0][_0xcc5b5c(0x166)]==_0xcc5b5c(0x1d7))var _0x483b12=users[_0xcc5b5c(0x1d7)];else{if(_0x451458[0x0][_0xcc5b5c(0x166)]==_0xcc5b5c(0x165))var _0x483b12=users[_0xcc5b5c(0x165)];else{if(_0x451458[0x0]['language']==_0xcc5b5c(0x1a4))var _0x483b12=users[_0xcc5b5c(0x1a4)];else{if(_0x451458[0x0]['language']=='French')var _0x483b12=users['French'];else{if(_0x451458[0x0][_0xcc5b5c(0x166)]==_0xcc5b5c(0x11a))var _0x483b12=users['Portuguese'];else{if(_0x451458[0x0][_0xcc5b5c(0x166)]==_0xcc5b5c(0x1f9))var _0x483b12=users[_0xcc5b5c(0x1f9)];else{if(_0x451458[0x0][_0xcc5b5c(0x166)]==_0xcc5b5c(0x1e8))var _0x483b12=users[_0xcc5b5c(0x14c)];}}}}}}}const _0x59bb7c=getRandom8DigitNumber();_0x59bb7c['then'](_0x377d70=>{var _0x5e29b9=_0xcc5b5c;_0x3bf470[_0x5e29b9(0x1a1)](_0x5e29b9(0x15d),{'success':_0x3b6abb[_0x5e29b9(0x15f)](_0x5e29b9(0x12c)),'errors':_0x3b6abb['flash'](_0x5e29b9(0x178)),'role':_0x5e0565,'profile':_0x7b80a7,'master_shop':_0x451458,'warehouse':_0x3a8ec1,'language':_0x483b12,'rooms_data':_0x4f50f3,'invoice':_0x377d70});})['catch'](_0x2bb05c=>{var _0x2429f6=_0xcc5b5c;_0x3b6abb[_0x2429f6(0x15f)](_0x2429f6(0x178),_0x2429f6(0x141)),_0x3bf470[_0x2429f6(0x13d)](_0x2429f6(0x1e6));});}catch(_0x27ec1d){console[_0xcc5b5c(0x188)](_0x27ec1d);}}),router[a0_0x5411bc(0x184)](a0_0x5411bc(0x120),auth,async(_0x2568bd,_0x5bd395)=>{var _0x14b5be=a0_0x5411bc;try{const {date:_0x3d3615,from_warehouse:_0xafb16e,FromRoom_name:_0x210bbf,to_warehouse:_0x191394,ToRoom_name:_0x201d3b,prod_name:_0x4f9bce,from_prod_qty:_0x2cb020,from_prod_level:_0xb38646,from_prod_isle:_0x572c23,from_prod_pallet:_0x44ac42,to_prod_qty:_0x3cb16b,to_prod_level:_0x46565b,to_prod_isle:_0x146d18,to_prod_pallet:_0x3bfa6b,primary_code:_0x1e95ec,secondary_code:_0x33bf55,product_code3:_0x2c3d7f,note:_0x2ffddc,MaxStocks_data2:_0x5e09f0,invoice:_0x22f8f6,expiry_date:_0x1457b1,PO_number:_0x3f7e82,ReqBy:_0x21b5bc,dateofreq:_0x31e557,typeservicesData:_0xa89f9a,destination:_0x343882,deliverydate:_0x2354ba,driver:_0x1b963c,plate:_0x1b16f2,van:_0x2f002a,DRSI:_0x28a720,typevehicle:_0x21c034,TSU:_0x1c3e61,TFU:_0x5804e6}=_0x2568bd['body'];if(typeof _0x4f9bce==_0x14b5be(0x1e0))var _0x49e023=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x18a)]],_0x4133e3=[_0x2568bd[_0x14b5be(0x116)]['from_prod_qty']],_0x4f4683=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1b0)]],_0x50c104=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x181)]],_0x4c3891=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x185)]],_0x4c744d=[_0x2568bd[_0x14b5be(0x116)]['to_prod_level']],_0x4c23dc=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x13e)]],_0x103e39=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x17a)]],_0x524608=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x162)]],_0x12c8c0=[_0x2568bd['body']['product_code3']],_0x487d94=[_0x2568bd['body'][_0x14b5be(0x198)]],_0x141a58=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x180)]],_0x446b4a=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1cc)]],_0x526f8b=[_0x2568bd['body'][_0x14b5be(0x12d)]],_0x100c45=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x186)]],_0x3c9d89=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x11c)]],_0x26026c=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1f7)]],_0x2f2743=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x170)]],_0x200647=[_0x2568bd['body'][_0x14b5be(0x19a)]],_0x4726f4=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1b7)]],_0x3cf78f=[_0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x13c)]],_0x1138de=[_0x2568bd[_0x14b5be(0x116)]['CBM']],_0x466ee6=[_0x2568bd[_0x14b5be(0x116)]['from_invoice']],_0x4b65d5=[_0x2568bd[_0x14b5be(0x116)]['to_invoice']];else var _0x49e023=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x18a)]],_0x4133e3=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1c4)]],_0x4f4683=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1b0)]],_0x50c104=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x181)]],_0x4c3891=[..._0x2568bd[_0x14b5be(0x116)]['New_Qty_Converted']],_0x4c744d=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1fa)]],_0x4c23dc=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x13e)]],_0x103e39=[..._0x2568bd[_0x14b5be(0x116)]['primary_code']],_0x524608=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x162)]],_0x12c8c0=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x163)]],_0x487d94=[..._0x2568bd['body'][_0x14b5be(0x198)]],_0x141a58=[..._0x2568bd[_0x14b5be(0x116)]['primary_unit']],_0x446b4a=[..._0x2568bd[_0x14b5be(0x116)]['secondary_unit']],_0x526f8b=[..._0x2568bd['body'][_0x14b5be(0x12d)]],_0x100c45=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x186)]],_0x3c9d89=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x11c)]],_0x26026c=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x1f7)]],_0x2f2743=[..._0x2568bd[_0x14b5be(0x116)]['maxPerUnit']],_0x200647=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x19a)]],_0x4726f4=[..._0x2568bd[_0x14b5be(0x116)]['RoomAssigned']],_0x3cf78f=[..._0x2568bd['body'][_0x14b5be(0x13c)]],_0x1138de=[..._0x2568bd['body']['CBM']],_0x466ee6=[..._0x2568bd[_0x14b5be(0x116)][_0x14b5be(0x157)]],_0x4b65d5=[..._0x2568bd['body'][_0x14b5be(0x14b)]];const _0x3c8c3b=_0x49e023[_0x14b5be(0x167)](_0x27af22=>{return _0x27af22={'product_name':_0x27af22};});_0x4133e3[_0x14b5be(0x137)]((_0x5b1f83,_0x2c7428)=>{var _0x49674e=_0x14b5be;_0x3c8c3b[_0x2c7428][_0x49674e(0x1f4)]=_0x5b1f83;}),_0x466ee6[_0x14b5be(0x137)]((_0x920309,_0x51ff44)=>{var _0x109ced=_0x14b5be;_0x3c8c3b[_0x51ff44][_0x109ced(0x157)]=_0x920309;}),_0x4b65d5['forEach']((_0x15bcb4,_0x5a1b34)=>{var _0x21a2df=_0x14b5be;_0x3c8c3b[_0x5a1b34][_0x21a2df(0x14b)]=_0x15bcb4;}),_0x4f4683[_0x14b5be(0x137)]((_0x71ebd8,_0x59d087)=>{var _0x1b21be=_0x14b5be,_0x35729a=_0x71ebd8[_0x1b21be(0x1af)](0x1);_0x3c8c3b[_0x59d087][_0x1b21be(0x15e)]=_0x71ebd8[0x0],_0x3c8c3b[_0x59d087]['from_pallet']=_0x35729a;}),_0x50c104[_0x14b5be(0x137)]((_0x2a56fd,_0x25e632)=>{_0x3c8c3b[_0x25e632]['from_level']=_0x2a56fd;}),_0x4c3891[_0x14b5be(0x137)]((_0x3703f9,_0x91d455)=>{var _0x380bf6=_0x14b5be;_0x3c8c3b[_0x91d455][_0x380bf6(0x1da)]=_0x3703f9;}),_0x4c744d[_0x14b5be(0x137)]((_0x2a4e22,_0x383c01)=>{var _0x50735b=_0x14b5be,_0x2f27bf=_0x2a4e22['slice'](0x1);_0x3c8c3b[_0x383c01][_0x50735b(0x16d)]=_0x2a4e22[0x0],_0x3c8c3b[_0x383c01][_0x50735b(0x1a5)]=_0x2f27bf;}),_0x4c23dc[_0x14b5be(0x137)]((_0xf21940,_0xf05b49)=>{var _0x20fefb=_0x14b5be;_0x3c8c3b[_0xf05b49][_0x20fefb(0x128)]=_0xf21940;}),_0x103e39[_0x14b5be(0x137)]((_0x101cc6,_0xc225c5)=>{_0x3c8c3b[_0xc225c5]['primary_code']=_0x101cc6;}),_0x524608[_0x14b5be(0x137)]((_0x11eccf,_0x43f2fd)=>{_0x3c8c3b[_0x43f2fd]['secondary_code']=_0x11eccf;}),_0x12c8c0['forEach']((_0x78c8a,_0x2acefb)=>{var _0x2c08af=_0x14b5be;_0x3c8c3b[_0x2acefb][_0x2c08af(0x143)]=_0x78c8a;}),_0x487d94[_0x14b5be(0x137)]((_0x4a6c85,_0x5c7f1d)=>{var _0x2a177f=_0x14b5be;_0x3c8c3b[_0x5c7f1d][_0x2a177f(0x118)]=_0x4a6c85;}),_0x141a58[_0x14b5be(0x137)]((_0x919a17,_0x29e919)=>{var _0x173f8c=_0x14b5be;_0x3c8c3b[_0x29e919][_0x173f8c(0x174)]=_0x919a17;}),_0x446b4a['forEach']((_0x422b79,_0x5673bf)=>{var _0x3983e4=_0x14b5be;_0x3c8c3b[_0x5673bf][_0x3983e4(0x1cc)]=_0x422b79;}),_0x526f8b[_0x14b5be(0x137)]((_0x540f00,_0x54e2ff)=>{var _0x1276ce=_0x14b5be;_0x3c8c3b[_0x54e2ff][_0x1276ce(0x12d)]=_0x540f00;}),_0x100c45[_0x14b5be(0x137)]((_0x1d19dc,_0x30b0d1)=>{_0x3c8c3b[_0x30b0d1]['expiry_date']=_0x1d19dc;}),_0x3c9d89['forEach']((_0x25a757,_0x488c54)=>{_0x3c8c3b[_0x488c54]['production_date']=_0x25a757;}),_0x26026c[_0x14b5be(0x137)]((_0x3fdd83,_0x385969)=>{var _0x9cb7f5=_0x14b5be;_0x3c8c3b[_0x385969][_0x9cb7f5(0x118)]=_0x3fdd83;}),_0x2f2743[_0x14b5be(0x137)]((_0x432fee,_0x1b88a0)=>{var _0x36efc5=_0x14b5be;_0x3c8c3b[_0x1b88a0][_0x36efc5(0x170)]=_0x432fee;}),_0x200647['forEach']((_0xfaa34c,_0x127471)=>{var _0x4de441=_0x14b5be;_0x3c8c3b[_0x127471][_0x4de441(0x19a)]=_0xfaa34c;}),_0x4726f4[_0x14b5be(0x137)]((_0x1c2bb7,_0xbe42f2)=>{var _0x47d4c0=_0x14b5be;_0x3c8c3b[_0xbe42f2][_0x47d4c0(0x134)]=_0x1c2bb7;}),_0x3cf78f[_0x14b5be(0x137)]((_0x593cab,_0xe9892)=>{var _0x529907=_0x14b5be;_0x3c8c3b[_0xe9892][_0x529907(0x18d)]=_0x593cab;}),_0x1138de[_0x14b5be(0x137)]((_0x1b7659,_0x5c69f6)=>{var _0xd58f77=_0x14b5be;_0x3c8c3b[_0x5c69f6][_0xd58f77(0x172)]=_0x1b7659;});const _0x2037fc=_0x3c8c3b[_0x14b5be(0x1ca)](_0x3f32e3=>_0x3f32e3[_0x14b5be(0x1da)]!=='0'&&_0x3f32e3[_0x14b5be(0x1da)]!==''||_0x3f32e3[_0x14b5be(0x153)]!=='0'&&_0x3f32e3['to_floorlevel']!=='');var _0x2ca33d=0x0;_0x2037fc[_0x14b5be(0x137)](_0x25962e=>{var _0x372dea=_0x14b5be;parseInt(_0x25962e[_0x372dea(0x1f4)])<parseInt(_0x25962e['to_quantity'])&&_0x2ca33d++;});if(_0x2ca33d!=0x0)return _0x2568bd['flash'](_0x14b5be(0x178),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x5bd395[_0x14b5be(0x13d)]('back');const _0x439216=new transfers_finished({'date':_0x3d3615,'from_warehouse':_0xafb16e,'to_warehouse':_0x191394,'product':_0x2037fc,'note':_0x2ffddc,'invoice':_0x22f8f6,'PO_number':_0x3f7e82,'RequestedBy':_0x21b5bc,'DateofRequest':_0x31e557,'typeservices':_0xa89f9a,'destination':_0x343882,'deliverydate':_0x2354ba,'driver':_0x1b963c,'plate':_0x1b16f2,'van':_0x2f002a,'DRSI':_0x28a720,'typevehicle':_0x21c034,'TSU':_0x1c3e61,'TFU':_0x5804e6}),_0x4e620d=await _0x439216[_0x14b5be(0x1db)]();_0x2568bd[_0x14b5be(0x15f)](_0x14b5be(0x12c),_0x14b5be(0x177)),_0x5bd395['redirect'](_0x14b5be(0x1e9)+_0x4e620d['_id']);}catch(_0x9162e2){console[_0x14b5be(0x188)](_0x9162e2),_0x5bd395[_0x14b5be(0x160)](0xc8)['json']({'errorMessage':_0x9162e2[_0x14b5be(0x130)]});}}),router[a0_0x5411bc(0x19b)]('/preview/:id',auth,async(_0xfa8ddc,_0x15671d)=>{var _0x434a9c=a0_0x5411bc;try{const {username:_0x17e4ef,email:_0x18e4a6,role:_0x5b47ae}=_0xfa8ddc[_0x434a9c(0x11b)],_0x2fab48=_0xfa8ddc[_0x434a9c(0x11b)],_0x59ca1d=await profile[_0x434a9c(0x14e)]({'email':_0x2fab48[_0x434a9c(0x175)]}),_0x46a8e1=await master_shop[_0x434a9c(0x12a)](),_0x2d5728=await transfers_finished[_0x434a9c(0x1c1)](_0xfa8ddc['params']['id']);let _0x3495a4;if(_0x2fab48[_0x434a9c(0x1ee)]==_0x434a9c(0x1f3)){const _0x48caf0=await staff[_0x434a9c(0x14e)]({'email':_0x2fab48['email']});_0x3495a4=await warehouse['find']({'status':'Enabled','name':_0x48caf0[_0x434a9c(0x150)]});}else _0x3495a4=await warehouse[_0x434a9c(0x12a)]({'status':_0x434a9c(0x1cf)});const _0x772dc9=await warehouse[_0x434a9c(0x1be)]([{'$match':{'name':_0x2d5728[_0x434a9c(0x131)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x434a9c(0x183),'name':{'$first':_0x434a9c(0x16f)},'product_stock':{'$first':_0x434a9c(0x15c)},'level':{'$first':_0x434a9c(0x12b)},'isle':{'$first':_0x434a9c(0x15a)},'pallet':{'$first':_0x434a9c(0x1a7)},'primary_code':{'$first':_0x434a9c(0x1b9)},'secondary_code':{'$first':_0x434a9c(0x1de)},'product_code':{'$first':_0x434a9c(0x15b)},'storage':{'$first':_0x434a9c(0x1b4)},'rack':{'$first':_0x434a9c(0x169)},'expiry_date':{'$first':_0x434a9c(0x123)},'production_date':{'$first':_0x434a9c(0x12e)},'room':{'$first':_0x434a9c(0x164)},'warehoue_name':{'$first':_0x434a9c(0x13b)}}}]),_0x1e8428=await product[_0x434a9c(0x12a)]({});if(_0x46a8e1[0x0][_0x434a9c(0x166)]==_0x434a9c(0x1c3)){var _0x2b1da5=users[_0x434a9c(0x1a3)];console[_0x434a9c(0x188)](_0x2b1da5);}else{if(_0x46a8e1[0x0][_0x434a9c(0x166)]=='Hindi')var _0x2b1da5=users['Hindi'];else{if(_0x46a8e1[0x0]['language']==_0x434a9c(0x165))var _0x2b1da5=users[_0x434a9c(0x165)];else{if(_0x46a8e1[0x0][_0x434a9c(0x166)]=='Spanish')var _0x2b1da5=users[_0x434a9c(0x1a4)];else{if(_0x46a8e1[0x0][_0x434a9c(0x166)]=='French')var _0x2b1da5=users[_0x434a9c(0x1bb)];else{if(_0x46a8e1[0x0]['language']==_0x434a9c(0x11a))var _0x2b1da5=users[_0x434a9c(0x1a6)];else{if(_0x46a8e1[0x0]['language']==_0x434a9c(0x1f9))var _0x2b1da5=users[_0x434a9c(0x1f9)];else{if(_0x46a8e1[0x0][_0x434a9c(0x166)]==_0x434a9c(0x1e8))var _0x2b1da5=users[_0x434a9c(0x14c)];}}}}}}}_0x15671d[_0x434a9c(0x1a1)](_0x434a9c(0x1d5),{'success':_0xfa8ddc[_0x434a9c(0x15f)]('success'),'errors':_0xfa8ddc['flash']('errors'),'role':_0x2fab48,'profile':_0x59ca1d,'master_shop':_0x46a8e1,'warehouse':_0x3495a4,'transfer':_0x2d5728,'stock':_0x772dc9,'unit':_0x1e8428,'language':_0x2b1da5});}catch(_0xdef62){console[_0x434a9c(0x188)](_0xdef62);}}),router[a0_0x5411bc(0x184)](a0_0x5411bc(0x13a),auth,async(_0x1ad554,_0x5019d6)=>{var _0x57944f=a0_0x5411bc;try{const {invoice:_0x2b6cdd,from_warehouse:_0x5a5a13,FromRoom_name:_0x4a8325,to_warehouse:_0x4cfd6e,ToRoom_name:_0x1afc02}=_0x1ad554[_0x57944f(0x116)],_0x5efdc8=await transfers_finished['findById'](_0x1ad554[_0x57944f(0x1f1)]['id']),_0x55d935=_0x5efdc8[_0x57944f(0x127)][_0x57944f(0x167)](async _0xaf6e07=>{var _0x15f1f1=_0x57944f;if(_0xaf6e07[_0x15f1f1(0x1da)]>0x0){var _0x42d0ab=await warehouse[_0x15f1f1(0x14e)]({'name':_0x5a5a13,'room':_0xaf6e07[_0x15f1f1(0x134)]});const _0x2edfc1=_0x42d0ab['product_details']['map'](_0x3483d1=>{var _0x4eff3c=_0x15f1f1;_0x3483d1['product_name']==_0xaf6e07[_0x4eff3c(0x1d3)]&&_0x3483d1[_0x4eff3c(0x1ba)]==_0xaf6e07[_0x4eff3c(0x140)]&&_0x3483d1['isle']==_0xaf6e07[_0x4eff3c(0x15e)]&&_0x3483d1[_0x4eff3c(0x199)]==_0xaf6e07['from_pallet']&&_0x3483d1['expiry_date']==_0xaf6e07['expiry_date']&&_0x3483d1['production_date']==_0xaf6e07[_0x4eff3c(0x144)]&&_0x3483d1['batch_code']==_0xaf6e07[_0x4eff3c(0x12d)]&&_0x3483d1[_0x4eff3c(0x1d9)]==_0xaf6e07[_0x4eff3c(0x157)]&&(_0x3483d1[_0x4eff3c(0x191)]=_0x3483d1[_0x4eff3c(0x191)]-_0xaf6e07[_0x4eff3c(0x1da)]);});}return _0x42d0ab;});Promise[_0x57944f(0x13f)](_0x55d935)[_0x57944f(0x146)](async _0x5c2599=>{var _0x4cd62a=_0x57944f;try{for(const _0x76ff73 of _0x5c2599){await _0x76ff73[_0x4cd62a(0x1db)]();}const _0x1601d7=_0x5efdc8[_0x4cd62a(0x127)][_0x4cd62a(0x167)](async _0x17987e=>{var _0x3f6919=_0x4cd62a,_0x1b994e=await warehouse['findOne']({'name':_0x4cfd6e,'room':_0x17987e[_0x3f6919(0x18d)]});if(_0x17987e[_0x3f6919(0x1da)]>0x0){var _0x2298d7=0x0;const _0x2ba979=_0x1b994e['product_details']['map'](_0x14ca98=>{var _0x3f6478=_0x3f6919;_0x14ca98[_0x3f6478(0x1d3)]==_0x17987e['product_name']&&_0x14ca98[_0x3f6478(0x1ba)]==_0x17987e[_0x3f6478(0x128)]&&_0x14ca98[_0x3f6478(0x142)]==_0x17987e['to_isle']&&_0x14ca98['pallet']==_0x17987e[_0x3f6478(0x1a5)]&&_0x14ca98['expiry_date']==_0x17987e[_0x3f6478(0x186)]&&_0x14ca98[_0x3f6478(0x144)]==_0x17987e[_0x3f6478(0x144)]&&_0x14ca98[_0x3f6478(0x12d)]==_0x17987e['batch_code']&&_0x14ca98[_0x3f6478(0x1d9)]==_0x17987e[_0x3f6478(0x14b)]&&(_0x14ca98['product_stock']=_0x14ca98[_0x3f6478(0x191)]+_0x17987e[_0x3f6478(0x1da)],_0x2298d7++);});_0x2298d7=='0'&&(_0x1b994e[_0x3f6919(0x1ef)]=_0x1b994e[_0x3f6919(0x1ef)][_0x3f6919(0x18e)]({'product_name':_0x17987e[_0x3f6919(0x1d3)],'product_stock':_0x17987e[_0x3f6919(0x1da)],'level':_0x17987e[_0x3f6919(0x128)],'isle':_0x17987e['to_isle'],'pallet':_0x17987e[_0x3f6919(0x1a5)],'product_code':_0x17987e[_0x3f6919(0x143)],'primary_code':_0x17987e['primary_code'],'secondary_code':_0x17987e['secondary_code'],'expiry_date':_0x17987e[_0x3f6919(0x186)],'production_date':_0x17987e[_0x3f6919(0x144)],'maxProducts':_0x17987e['maxProducts'],'batch_code':_0x17987e[_0x3f6919(0x12d)],'secondary_unit':_0x17987e[_0x3f6919(0x1cc)],'unit':_0x17987e[_0x3f6919(0x174)],'maxProducts':_0x17987e[_0x3f6919(0x118)],'maxPerUnit':_0x17987e[_0x3f6919(0x170)],'CBM':_0x17987e[_0x3f6919(0x172)]}));}return _0x1b994e;});Promise[_0x4cd62a(0x13f)](_0x1601d7)[_0x4cd62a(0x146)](async _0xd98444=>{var _0x29af39=_0x4cd62a;try{for(const _0x33810b of _0xd98444){await warehouse[_0x29af39(0x1c2)]({'_id':_0x33810b['_id']},{'$addToSet':{'product_details':{'$each':_0x33810b[_0x29af39(0x1ef)]}}});}_0x5efdc8[_0x29af39(0x158)]=_0x29af39(0x1d4);const _0x9a8b12=await _0x5efdc8[_0x29af39(0x1db)]();var _0x5d7f40=_0x5efdc8['product'];const _0x342af8=await master_shop[_0x29af39(0x12a)](),_0x606b5=await email_settings[_0x29af39(0x14e)](),_0x284ca7=await supervisor_settings[_0x29af39(0x12a)]();let _0x37d6c3=nodemailer[_0x29af39(0x14d)]({'host':_0x606b5[_0x29af39(0x1f0)],'port':Number(_0x606b5[_0x29af39(0x1bf)]),'secure':![],'auth':{'user':_0x606b5[_0x29af39(0x175)],'pass':_0x606b5[_0x29af39(0x1d6)]}});var _0xe98dee='',_0xfb4e51;for(_0xfb4e51 in _0x5d7f40){_0xe98dee+=_0x29af39(0x193)+_0x29af39(0x17b)+_0x5d7f40[_0xfb4e51]['product_name']+_0x29af39(0x168)+_0x29af39(0x17b)+_0x5d7f40[_0xfb4e51][_0x29af39(0x1da)]+_0x29af39(0x168)+_0x29af39(0x17b)+_0x5d7f40[_0xfb4e51]['to_room_name']+'</td>'+_0x29af39(0x17b)+_0x5d7f40[_0xfb4e51]['to_level']+'</td>'+_0x29af39(0x17b)+_0x5d7f40[_0xfb4e51][_0x29af39(0x16d)]+_0x5d7f40[_0xfb4e51][_0x29af39(0x1a5)]+_0x29af39(0x168)+_0x29af39(0x173);}let _0x3f637b={'from':_0x606b5[_0x29af39(0x175)],'to':_0x284ca7[0x0][_0x29af39(0x1a8)],'subject':_0x29af39(0x1aa),'attachments':[{'filename':_0x29af39(0x176),'path':__dirname+_0x29af39(0x196)+_0x29af39(0x125)+_0x342af8[0x0][_0x29af39(0x1ad)],'cid':_0x29af39(0x1c6)}],'html':_0x29af39(0x156)+_0x29af39(0x1c5)+_0x29af39(0x122)+_0x29af39(0x195)+_0x29af39(0x17c)+_0x29af39(0x195)+_0x29af39(0x1b8)+_0x29af39(0x1cb)+'<div>'+_0x29af39(0x17d)+_0x342af8[0x0][_0x29af39(0x190)]+_0x29af39(0x151)+'</div>'+_0x29af39(0x1cb)+_0x29af39(0x1a0)+_0x29af39(0x195)+_0x29af39(0x139)+_0x29af39(0x1b3)+_0x5efdc8[_0x29af39(0x1d9)]+'\x20'+_0x29af39(0x145)+'\x20Order\x20Date\x20:\x20'+_0x5efdc8[_0x29af39(0x1ec)]+'\x20'+_0x29af39(0x133)+_0x29af39(0x11f)+_0x29af39(0x1cb)+_0x29af39(0x1b1)+_0x29af39(0x197)+_0x29af39(0x193)+_0x29af39(0x1e1)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>'+_0x29af39(0x19c)+_0x29af39(0x1f5)+_0x29af39(0x12f)+_0x29af39(0x173)+_0x29af39(0x1e3)+_0x29af39(0x1bc)+'\x20'+_0xe98dee+'\x20'+_0x29af39(0x189)+_0x29af39(0x18c)+'<div>'+_0x29af39(0x147)+_0x29af39(0x1f6)+_0x342af8[0x0]['site_title']+_0x29af39(0x11f)+'</div>'+'</div>'+_0x29af39(0x155)};_0x37d6c3[_0x29af39(0x1e7)](_0x3f637b,function(_0xe600fc,_0xad5583){var _0x4e97f9=_0x29af39;_0xe600fc?(console['log'](_0xe600fc),console[_0x4e97f9(0x188)](_0x4e97f9(0x1ed))):console[_0x4e97f9(0x188)](_0x4e97f9(0x18b));}),_0x1ad554[_0x29af39(0x15f)](_0x29af39(0x12c),_0x29af39(0x135)),_0x5019d6[_0x29af39(0x13d)](_0x29af39(0x1e4)+_0x9a8b12[_0x29af39(0x18f)]);}catch(_0x647fbd){console[_0x29af39(0x1a2)](_0x647fbd),_0x5019d6[_0x29af39(0x160)](0x1f4)[_0x29af39(0x138)]({'error':_0x29af39(0x1dd)});}})[_0x4cd62a(0x1d0)](_0x44a114=>{var _0x2450df=_0x4cd62a;console[_0x2450df(0x1a2)](_0x44a114),_0x5019d6[_0x2450df(0x160)](0x1f4)[_0x2450df(0x138)]({'error':_0x2450df(0x1bd)});});}catch(_0x297745){console[_0x4cd62a(0x1a2)](_0x297745),_0x5019d6[_0x4cd62a(0x160)](0x1f4)[_0x4cd62a(0x138)]({'error':_0x4cd62a(0x11d)});}})[_0x57944f(0x1d0)](_0x2d441e=>{var _0x32922d=_0x57944f;console[_0x32922d(0x1a2)](_0x2d441e),_0x5019d6['status'](0x1f4)['json']({'error':_0x32922d(0x1bd)});});}catch(_0x2b11a2){_0x5019d6[_0x57944f(0x138)]({'message':_0x2b11a2['message']});}});function BayBinSelected(_0x2d8424,_0x5db183){var _0x274888=a0_0x5411bc,_0x3bb111=[];let _0x3ab749=[];var _0x3cd804=[];if(_0x2d8424==_0x274888(0x1e2)){switch(_0x5db183){case _0x274888(0x14a):_0x3bb111=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10];break;case _0x274888(0x1ce):_0x3bb111=[0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1a,0x1b,0x1c,0x1d,0x1e,0x1f,0x20];break;}_0x3cd804=['DG'];}else{if(_0x2d8424=='FROZEN\x20GOODS'){switch(_0x5db183){case _0x274888(0x14a):_0x3bb111=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9];break;case _0x274888(0x1ce):_0x3bb111=[0xa,0xb,0xc,0xd,0xe,0xf,0x10,0x11,0x12];break;}_0x3cd804=['FG'];}}return{'levels':_0x3bb111,'identify':_0x3cd804};}router[a0_0x5411bc(0x19b)]('/view/:id',auth,async(_0xc27a2,_0x317c2c)=>{var _0x286781=a0_0x5411bc;try{const {username:_0x11767e,email:_0x49af6f,role:_0x2c6ff2}=_0xc27a2['user'],_0x1c27e1=_0xc27a2[_0x286781(0x11b)],_0x4ac130=await profile[_0x286781(0x14e)]({'email':_0x1c27e1[_0x286781(0x175)]}),_0x5ed6e8=await master_shop[_0x286781(0x12a)](),_0x721739=await transfers_finished[_0x286781(0x1c1)](_0xc27a2[_0x286781(0x1f1)]['id']);let _0x588db9=new Date(_0x721739[_0x286781(0x186)]),_0x3d69cf=('0'+_0x588db9[_0x286781(0x119)]())[_0x286781(0x1af)](-0x2),_0x819fe=('0'+(_0x588db9['getMonth']()+0x1))[_0x286781(0x1af)](-0x2),_0x17d4bd=_0x588db9['getFullYear'](),_0x17b7c7=_0x17d4bd+'-'+_0x819fe+'-'+_0x3d69cf,_0x559cd6;if(_0x1c27e1['role']==_0x286781(0x1f3)){const _0x4a3320=await staff[_0x286781(0x14e)]({'email':_0x1c27e1['email']});_0x559cd6=await warehouse[_0x286781(0x12a)]({'status':_0x286781(0x1cf),'name':_0x4a3320[_0x286781(0x150)],'warehouse_category':_0x286781(0x182)});}else _0x559cd6=await warehouse['find']({'status':_0x286781(0x1cf),'warehouse_category':'Finished\x20Goods'});const _0x69cc77=await warehouse[_0x286781(0x1be)]([{'$match':{'name':_0x721739[_0x286781(0x131)],'room':_0x721739[_0x286781(0x1ea)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x286781(0x16f)},'product_stock':{'$first':_0x286781(0x15c)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':_0x286781(0x1a7)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x286781(0x1de)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x286781(0x1b4)},'rack':{'$first':'$product_details.rack'}}}]);var _0xc1d166=[0x1,0x2,0x3,0x4],_0x33430b=['A','B','C','D','E','F','G','H','I','J'],_0x392bff=[_0x286781(0x1c8),_0x286781(0x136)];const _0x2a87bf=await product[_0x286781(0x12a)]({}),_0x5cadc8=BayBinSelected(_0x721739[_0x286781(0x121)],_0x721739[_0x286781(0x117)]);if(_0x5ed6e8[0x0]['language']==_0x286781(0x1c3)){var _0x368edd=users['English'];console['log'](_0x368edd);}else{if(_0x5ed6e8[0x0][_0x286781(0x166)]==_0x286781(0x1d7))var _0x368edd=users[_0x286781(0x1d7)];else{if(_0x5ed6e8[0x0][_0x286781(0x166)]=='German')var _0x368edd=users[_0x286781(0x165)];else{if(_0x5ed6e8[0x0][_0x286781(0x166)]==_0x286781(0x1a4))var _0x368edd=users['Spanish'];else{if(_0x5ed6e8[0x0]['language']==_0x286781(0x1bb))var _0x368edd=users[_0x286781(0x1bb)];else{if(_0x5ed6e8[0x0][_0x286781(0x166)]==_0x286781(0x11a))var _0x368edd=users[_0x286781(0x1a6)];else{if(_0x5ed6e8[0x0][_0x286781(0x166)]=='Chinese')var _0x368edd=users[_0x286781(0x1f9)];else{if(_0x5ed6e8[0x0]['language']==_0x286781(0x1e8))var _0x368edd=users['Arabic'];}}}}}}}_0x317c2c['render'](_0x286781(0x187),{'success':_0xc27a2['flash'](_0x286781(0x12c)),'errors':_0xc27a2[_0x286781(0x15f)](_0x286781(0x178)),'role':_0x1c27e1,'profile':_0x4ac130,'master_shop':_0x5ed6e8,'warehouse':_0x559cd6,'transfer':_0x721739,'stock':_0x69cc77,'unit':_0x2a87bf,'language':_0x368edd,'levels':_0xc1d166,'Isle':_0x33430b,'rooms_data':_0x392bff,'ed_fullDate':_0x17b7c7,'dataSelected':_0x5cadc8});}catch(_0x76f8a4){console[_0x286781(0x188)](_0x76f8a4);}}),router['post'](a0_0x5411bc(0x1eb),auth,async(_0x8d7b2f,_0x206600)=>{var _0x421a9a=a0_0x5411bc;try{const _0x1c1dfd=_0x8d7b2f['params']['id'];console[_0x421a9a(0x188)](_0x8d7b2f[_0x421a9a(0x116)]);const _0x1f85f6=await transfers_finished[_0x421a9a(0x1c1)](_0x1c1dfd);console['log']('transfer_data',_0x1f85f6);const {date:_0x4c6225,from_warehouse:_0x5b3a7b,FromRoom_name:_0x36471e,to_warehouse:_0x3bb37b,ToRoom_name:_0x4da285,prod_name:_0x382c38,from_prod_qty:_0x3fca91,from_prod_level:_0x2e7b50,from_prod_isle:_0x28d334,from_prod_pallet:_0x428779,to_prod_qty:_0x1f21bd,to_prod_level:_0x4983a6,to_prod_isle:_0x513467,to_prod_pallet:_0x353b7c,primary_code:_0x2604fe,secondary_code:_0x3fa531,product_code3:_0x4a0e29,note:_0x1dd19f,invoice:_0x50e268,expiry_date:_0x5268c1}=_0x8d7b2f[_0x421a9a(0x116)];if(typeof _0x382c38==_0x421a9a(0x1e0))var _0x56f68c=[_0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x18a)]],_0x2893e3=[_0x8d7b2f['body'][_0x421a9a(0x1c4)]],_0x217abe=[_0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x1b0)]],_0x1c0e9b=[_0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x16c)]],_0xfda544=[_0x8d7b2f[_0x421a9a(0x116)]['to_prod_level']],_0x3eb62e=[_0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x17a)]],_0x16045a=[_0x8d7b2f['body']['secondary_code']],_0x271465=[_0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x163)]],_0x40d277=[_0x8d7b2f[_0x421a9a(0x116)]['MaxStocks_data2']],_0x9dddc5=[_0x8d7b2f[_0x421a9a(0x116)]['unit']],_0x28074=[_0x8d7b2f['body'][_0x421a9a(0x1cc)]],_0x544bb0=[_0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x12d)]],_0x3ef8ca=[_0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x186)]];else var _0x56f68c=[..._0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x18a)]],_0x2893e3=[..._0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x1c4)]],_0x217abe=[..._0x8d7b2f['body'][_0x421a9a(0x1b0)]],_0x1c0e9b=[..._0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x16c)]],_0xfda544=[..._0x8d7b2f['body'][_0x421a9a(0x1fa)]],_0x3eb62e=[..._0x8d7b2f['body'][_0x421a9a(0x17a)]],_0x16045a=[..._0x8d7b2f['body'][_0x421a9a(0x162)]],_0x271465=[..._0x8d7b2f[_0x421a9a(0x116)]['product_code3']],_0x40d277=[..._0x8d7b2f[_0x421a9a(0x116)]['MaxStocks_data2']],_0x9dddc5=[..._0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x174)]],_0x28074=[..._0x8d7b2f[_0x421a9a(0x116)]['secondary_unit']],_0x544bb0=[..._0x8d7b2f['body'][_0x421a9a(0x12d)]],_0x3ef8ca=[..._0x8d7b2f[_0x421a9a(0x116)][_0x421a9a(0x186)]];const _0x430d4f=_0x56f68c[_0x421a9a(0x167)](_0x2a2b94=>{return _0x2a2b94={'product_name':_0x2a2b94};});_0x2893e3[_0x421a9a(0x137)]((_0x3c2ad1,_0x2a0430)=>{var _0x259888=_0x421a9a;_0x430d4f[_0x2a0430][_0x259888(0x1f4)]=_0x3c2ad1;}),_0x217abe[_0x421a9a(0x137)]((_0x5341c1,_0x34b10c)=>{_0x430d4f[_0x34b10c]['from_bay']=_0x5341c1;}),_0x1c0e9b['forEach']((_0x2eaf45,_0xdbb680)=>{_0x430d4f[_0xdbb680]['to_quantity']=_0x2eaf45;}),_0xfda544[_0x421a9a(0x137)]((_0x2beb5a,_0x5d197c)=>{var _0x79ddfb=_0x421a9a;_0x430d4f[_0x5d197c][_0x79ddfb(0x1e5)]=_0x2beb5a;}),_0x3eb62e[_0x421a9a(0x137)]((_0x17ca3f,_0x6dee57)=>{var _0x272ea7=_0x421a9a;_0x430d4f[_0x6dee57][_0x272ea7(0x17a)]=_0x17ca3f;}),_0x16045a[_0x421a9a(0x137)]((_0x165361,_0x117ebe)=>{var _0x373c5c=_0x421a9a;_0x430d4f[_0x117ebe][_0x373c5c(0x162)]=_0x165361;}),_0x271465[_0x421a9a(0x137)]((_0x3488cf,_0x27e81c)=>{var _0x57b156=_0x421a9a;_0x430d4f[_0x27e81c][_0x57b156(0x143)]=_0x3488cf;}),_0x40d277[_0x421a9a(0x137)]((_0x130196,_0x2f1e87)=>{var _0x2f09fe=_0x421a9a;_0x430d4f[_0x2f1e87][_0x2f09fe(0x118)]=_0x130196;}),_0x9dddc5['forEach']((_0x1c469a,_0x447944)=>{var _0x52baf3=_0x421a9a;_0x430d4f[_0x447944][_0x52baf3(0x174)]=_0x1c469a;}),_0x28074[_0x421a9a(0x137)]((_0x2805ac,_0x320db6)=>{var _0x1a825a=_0x421a9a;_0x430d4f[_0x320db6][_0x1a825a(0x1cc)]=_0x2805ac;}),_0x544bb0[_0x421a9a(0x137)]((_0x242225,_0x3af9da)=>{var _0x3b95f0=_0x421a9a;_0x430d4f[_0x3af9da][_0x3b95f0(0x12d)]=_0x242225;}),_0x3ef8ca[_0x421a9a(0x137)]((_0x2ec71e,_0x5dd60b)=>{var _0x664fd7=_0x421a9a;_0x430d4f[_0x5dd60b][_0x664fd7(0x186)]=_0x2ec71e;});const _0x34e578=_0x430d4f[_0x421a9a(0x1ca)](_0x46c982=>_0x46c982[_0x421a9a(0x1da)]!=='0'&&_0x46c982['to_quantity']!==''||_0x46c982[_0x421a9a(0x153)]!=='0'&&_0x46c982['to_floorlevel']!=='');var _0x939c09=0x0;_0x34e578['forEach'](_0x5045c3=>{var _0x87f992=_0x421a9a;parseInt(_0x5045c3[_0x87f992(0x1f4)])<parseInt(_0x5045c3[_0x87f992(0x1da)])&&_0x939c09++;});if(_0x939c09!=0x0)return _0x8d7b2f[_0x421a9a(0x15f)](_0x421a9a(0x178),_0x421a9a(0x149)),_0x206600[_0x421a9a(0x13d)]('back');const _0x412a26=await warehouse[_0x421a9a(0x14e)]({'name':_0x1f85f6[_0x421a9a(0x131)],'room':_0x1f85f6[_0x421a9a(0x1ea)]});_0x1f85f6[_0x421a9a(0x127)][_0x421a9a(0x137)](_0x186a23=>{var _0x559f0c=_0x421a9a;if(_0x186a23[_0x559f0c(0x1da)]>0x0){const _0x39ccd0=_0x412a26[_0x559f0c(0x1ef)][_0x559f0c(0x167)](_0x4ae91a=>{var _0x251f35=_0x559f0c;_0x4ae91a[_0x251f35(0x1d3)]==_0x186a23[_0x251f35(0x1d3)]&&_0x4ae91a[_0x251f35(0x16b)]==_0x186a23[_0x251f35(0x14f)]&&(_0x4ae91a[_0x251f35(0x191)]=parseInt(_0x4ae91a[_0x251f35(0x191)])+parseInt(_0x186a23[_0x251f35(0x1da)]));});}}),await _0x412a26['save']();const _0x140495=await warehouse[_0x421a9a(0x14e)]({'name':_0x1f85f6[_0x421a9a(0x121)],'room':_0x1f85f6[_0x421a9a(0x117)]});_0x1f85f6[_0x421a9a(0x127)][_0x421a9a(0x137)](_0x5f56d1=>{var _0x292731=_0x421a9a;if(_0x5f56d1[_0x292731(0x1da)]>0x0){const _0x30d1f5=_0x140495[_0x292731(0x1ef)][_0x292731(0x167)](_0x529d01=>{var _0x48e49d=_0x292731;_0x529d01[_0x48e49d(0x1d3)]==_0x5f56d1[_0x48e49d(0x1d3)]&&_0x529d01[_0x48e49d(0x16b)]==_0x5f56d1[_0x48e49d(0x1e5)]&&(_0x529d01[_0x48e49d(0x191)]=parseInt(_0x529d01[_0x48e49d(0x191)])-parseInt(_0x5f56d1['to_quantity']));});}}),await _0x140495['save'](),_0x1f85f6[_0x421a9a(0x1ec)]=_0x4c6225,_0x1f85f6['from_warehouse']=_0x5b3a7b,_0x1f85f6[_0x421a9a(0x121)]=_0x3bb37b,_0x1f85f6[_0x421a9a(0x127)]=_0x34e578,_0x1f85f6[_0x421a9a(0x113)]=_0x1dd19f,_0x1f85f6[_0x421a9a(0x1d9)]=_0x50e268;const _0xd7797e=await _0x1f85f6['save'](),_0x4cc439=await warehouse[_0x421a9a(0x14e)]({'name':_0x5b3a7b,'room':_0x36471e});_0xd7797e[_0x421a9a(0x127)]['forEach'](_0xb55d0f=>{var _0x3d7a59=_0x421a9a;if(_0xb55d0f[_0x3d7a59(0x1da)]>0x0){const _0x90f387=_0x4cc439['product_details'][_0x3d7a59(0x167)](_0x4c7357=>{var _0x56414a=_0x3d7a59;_0x4c7357[_0x56414a(0x1d3)]==_0xb55d0f[_0x56414a(0x1d3)]&&_0x4c7357[_0x56414a(0x16b)]==_0xb55d0f[_0x56414a(0x14f)]&&(_0x4c7357[_0x56414a(0x191)]=parseInt(_0x4c7357[_0x56414a(0x191)])-parseInt(_0xb55d0f['to_quantity']));});}}),await _0x4cc439[_0x421a9a(0x1db)]();const _0x314308=await warehouse['findOne']({'name':_0x3bb37b,'room':_0x4da285});_0xd7797e['product']['forEach'](_0x5172e4=>{var _0x504998=_0x421a9a;if(_0x5172e4['to_quantity']>0x0){var _0x3c7575=0x0;const _0x9aec02=_0x314308[_0x504998(0x1ef)][_0x504998(0x167)](_0xe7bb03=>{var _0x511705=_0x504998;_0xe7bb03[_0x511705(0x1d3)]==_0x5172e4[_0x511705(0x1d3)]&&_0xe7bb03[_0x511705(0x16b)]==_0x5172e4['to_bay']&&(_0xe7bb03[_0x511705(0x191)]=parseInt(_0xe7bb03['product_stock'])+parseInt(_0x5172e4[_0x511705(0x1da)]),_0x3c7575++);});_0x3c7575=='0'&&(_0x314308[_0x504998(0x1ef)]=_0x314308['product_details'][_0x504998(0x18e)]({'product_name':_0x5172e4[_0x504998(0x1d3)],'product_stock':_0x5172e4['to_quantity'],'bay':_0x5172e4['to_bay'],'product_code':_0x5172e4[_0x504998(0x143)],'primary_code':_0x5172e4[_0x504998(0x17a)],'secondary_code':_0x5172e4[_0x504998(0x162)],'maxProducts':_0x5172e4[_0x504998(0x118)]}));}}),await _0x314308[_0x421a9a(0x1db)](),_0x8d7b2f[_0x421a9a(0x15f)](_0x421a9a(0x12c),_0x421a9a(0x152)),_0x206600[_0x421a9a(0x13d)]('/transfer_finished/view');}catch(_0x5b774f){console[_0x421a9a(0x188)](_0x5b774f);}}),router[a0_0x5411bc(0x184)](a0_0x5411bc(0x132),async(_0x58aab1,_0x3d2b37)=>{var _0x29db6a=a0_0x5411bc;const {FromWareHouse:_0x10fa2,FromRoom:_0x5c8438,ToWarehouse:_0x29b3a1,ToRoom:_0x5b4910,primary_code:_0x574648,Roomslist:_0x56d424}=_0x58aab1[_0x29db6a(0x116)],_0x276817=_0x56d424[_0x29db6a(0x112)](','),_0x140c4e=[];async function _0x56c20a(_0x10a549){var _0x30cdc0=_0x29db6a;const _0x509d31=await warehouse[_0x30cdc0(0x1be)]([{'$match':{'name':_0x10fa2,'room':_0x10a549}},{'$unwind':_0x30cdc0(0x19f)},{'$match':{'product_details.primary_code':_0x574648}},{'$group':{'_id':_0x30cdc0(0x183),'name':{'$first':_0x30cdc0(0x16f)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x30cdc0(0x1b9)},'secondary_code':{'$first':_0x30cdc0(0x1de)},'product_code':{'$first':_0x30cdc0(0x15b)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x30cdc0(0x15a)},'pallet':{'$first':_0x30cdc0(0x1a7)},'unit':{'$first':_0x30cdc0(0x126)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x30cdc0(0x1b4)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x30cdc0(0x1c0)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'roomNamed':{'$first':_0x30cdc0(0x164)},'prod_cat':{'$first':'P'},'maxProducts':{'$first':'$product_details.maxProducts'},'CBM':{'$first':{'$toDouble':_0x30cdc0(0x115)}},'invoice':{'$first':_0x30cdc0(0x148)}}}]),_0x33811e=await warehouse[_0x30cdc0(0x1be)]([{'$match':{'name':_0x10fa2,'room':_0x10a549}},{'$unwind':_0x30cdc0(0x19f)},{'$match':{'product_details.secondary_code':_0x574648}},{'$group':{'_id':_0x30cdc0(0x183),'name':{'$first':_0x30cdc0(0x16f)},'instock':{'$first':_0x30cdc0(0x15c)},'primary_code':{'$first':_0x30cdc0(0x1b9)},'secondary_code':{'$first':_0x30cdc0(0x1de)},'product_code':{'$first':_0x30cdc0(0x15b)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x30cdc0(0x15a)},'pallet':{'$first':_0x30cdc0(0x1a7)},'unit':{'$first':_0x30cdc0(0x126)},'secondary_unit':{'$first':_0x30cdc0(0x1dc)},'storage':{'$first':_0x30cdc0(0x1b4)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x30cdc0(0x123)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x30cdc0(0x1c0)},'maxPerUnit':{'$first':_0x30cdc0(0x1f8)},'roomNamed':{'$first':'$room'},'prod_cat':{'$first':'S'},'maxProducts':{'$first':_0x30cdc0(0x1df)},'CBM':{'$first':{'$toDouble':_0x30cdc0(0x115)}},'invoice':{'$first':_0x30cdc0(0x148)}}}]);if(_0x509d31['length']>0x0)_0x140c4e[_0x30cdc0(0x1fb)](_0x509d31);else _0x33811e[_0x30cdc0(0x171)]>0x0&&_0x140c4e[_0x30cdc0(0x1fb)](_0x33811e);}const _0x10e991=_0x276817[_0x29db6a(0x167)](_0x570d42=>_0x56c20a(_0x570d42));await Promise['all'](_0x10e991),_0x3d2b37[_0x29db6a(0x138)](_0x140c4e);}),router['post'](a0_0x5411bc(0x1b2),async(_0x55775b,_0x21bd12)=>{var _0x483acf=a0_0x5411bc;try{const {FromWareHouse:_0x3116de,FromRoom:_0x5d26c6,ToWarehouse:_0x35b599,ToRoom:_0x94c468,secondary_code:_0x3ee8c8}=_0x55775b[_0x483acf(0x116)],_0x33db8d=await warehouse[_0x483acf(0x1be)]([{'$match':{'name':_0x3116de}},{'$unwind':_0x483acf(0x19f)},{'$match':{'product_details.secondary_code':_0x3ee8c8}},{'$group':{'_id':_0x483acf(0x183),'name':{'$first':_0x483acf(0x16f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x483acf(0x1de)},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':'$product_details.product_stock'},'warehouse':{'$first':_0x483acf(0x13b)},'level':{'$first':_0x483acf(0x12b)},'isle':{'$first':_0x483acf(0x15a)},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':_0x483acf(0x1df)},'unit':{'$first':'$product_details.unit'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x483acf(0x12e)}}}]);_0x21bd12[_0x483acf(0x160)](0xc8)[_0x483acf(0x138)](_0x33db8d);}catch(_0x1f3d6a){_0x21bd12[_0x483acf(0x160)](0x194)['json']({'message':_0x1f3d6a[_0x483acf(0x130)]});}}),router[a0_0x5411bc(0x184)]('/barcode_scanner3',async(_0x42380d,_0x17efa1)=>{var _0x358652=a0_0x5411bc;try{const {FromWareHouse:_0x9ebacb,FromRoom:_0x57f3b7,ToWarehouse:_0x36c14a,ToRoom:_0x186407,product_code:_0x11dace}=_0x42380d[_0x358652(0x116)],_0x1c2f59=await warehouse[_0x358652(0x1be)]([{'$match':{'name':_0x9ebacb}},{'$unwind':'$product_details'},{'$match':{'product_details.product_code':_0x11dace}},{'$group':{'_id':_0x358652(0x183),'name':{'$first':_0x358652(0x16f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x358652(0x1de)},'product_code':{'$first':_0x358652(0x15b)},'instock':{'$first':_0x358652(0x15c)},'warehouse':{'$first':_0x358652(0x13b)},'level':{'$first':_0x358652(0x12b)},'isle':{'$first':_0x358652(0x15a)},'pallet':{'$first':_0x358652(0x1a7)},'maxProducts':{'$first':_0x358652(0x1df)},'unit':{'$first':_0x358652(0x126)}}}]);_0x17efa1[_0x358652(0x160)](0xc8)[_0x358652(0x138)](_0x1c2f59);}catch(_0x32be17){_0x17efa1[_0x358652(0x160)](0x194)[_0x358652(0x138)]({'message':_0x32be17[_0x358652(0x130)]});}}),router[a0_0x5411bc(0x184)](a0_0x5411bc(0x124),async(_0x30ca72,_0xfb86f8)=>{var _0xddff86=a0_0x5411bc;const {productCode:_0x1e3499,bay:_0x49c95b,warehouses:_0x3ab684,room:_0x3a9cfa}=_0x30ca72[_0xddff86(0x116)];try{const _0x31e5c7=await warehouse[_0xddff86(0x1be)]([{'$match':{'name':_0x3ab684,'room':_0x3a9cfa}},{'$unwind':'$product_details'},{'$match':{'product_details.pallet':parseInt(_0x49c95b)}},{'$group':{'_id':_0xddff86(0x16f),'name':{'$first':_0xddff86(0x16f)},'product_stock':{'$sum':_0xddff86(0x15c)},'pallet':{'$first':_0xddff86(0x1a7)},'maxProducts':{'$first':_0xddff86(0x1df)}}}]);console[_0xddff86(0x188)](_0x31e5c7),_0xfb86f8[_0xddff86(0x160)](0xc8)[_0xddff86(0x138)](_0x31e5c7);}catch(_0xc80c66){_0xfb86f8[_0xddff86(0x160)](0x194)[_0xddff86(0x138)]({'message':_0xc80c66['message']});}}),module[a0_0x5411bc(0x154)]=router;