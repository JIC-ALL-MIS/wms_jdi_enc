function a0_0x3e09(){var _0x29e7a4=['errors','product_details','add_adjustment_finished','createTransport','product_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Level\x20</th>','$product.room_names','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','773581UKJknk','secondary_unit','$product','nodemailer','Return\x20Rooms','/adjustment_finished/preview/','aggregate','length','$product_details._id','minus','/barcode_scanner','error','stock','note','Sale\x20Product\x20Mail','getFullYear','</thead>','Arabic\x20(ae)','$product_details.product_code','forEach','$product_details.rack','8407KRHUno','map','render','date','Enabled','isle','/view/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','type','<h2>\x20','warehouse_name','product_stock','warehouse','master','$product_details.maxProducts','secondary_code','$product_details.unit','Adjustment\x20Finalize\x20Successfully','product_date','<h5>','../public/language/languages.json','$product_details.expiry_date','redirect','<tbody\x20style=\x22text-align:\x20center;\x22>','room_names','$product_details.CBM','</tr>','$product.product_name','Chinese','product_name','$product_details.type','$room','$product_details.secondary_code','<h5\x20style=\x22text-align:\x20left;\x22>','purchases_data','getDate','find','status','express','padStart','split','Secondary_units','JO_number','/preview/:id','_id','/view','$product_details.secondary_unit','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','/adjustment_finished/view','<span\x20style=\x22float:\x20right;\x22>','/CheckingWarehouse','edit_adjustment_finished','</td>','user','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','primary_code','/view/add_adjustment','batch_code','role','$product_details.pallet','Router','CBM','language','$product_details.level','adjustment_finished','/../public','maxPerUnit','../middleware/auth','<hr\x20class=\x22my-3\x22>','An\x20error\x20occurred.','all','host','\x20Order\x20Date\x20:\x20','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','staff','bay','$product_details.production_date','Ambient','stockBefore','prod_invoice','</h5>','json','success','30wGtBOP','getMonth','adjustment\x20data\x20update\x20successfully','save','message','catch','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Unit\x20of\x20measure\x20</th>','get','/picking_list/PDF_adjustmentFinal/','178384niKeaE','adjust_qty','expiry_date','$invoice','$product_details.bay','$product_details.primary_code','prod_name','New_Qty_Converted_adj','prod_code','Return\x20Goods','63HjNPPb','finalize','unit','push','then','1816IuNmgQ','$product_details.storage','$product_details.isle','filter','product','ADJ-','production_date','German','<div>','French','213450tojkKr','flash','</table>','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','invoice','email','findOne','site_title','There\x27s\x20a\x20error\x20in\x20this\x20transaction','body','log','Primary_Units','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','905622VzMrwm','pallet','Spanish','<tr>','types','Arabic','</tbody>','$_id','</div>','$name','Hindi','<strong>\x20Regards\x20</strong>','Portuguese','$warehouse_name','$product_details.product_name','toString','random','post','Enclosed','Portuguese\x20(BR)','English','back','prod_cat','</body></html>','1810416ixVDjD','$product_details','</span>','An\x20error\x20occurred\x20while\x20saving\x20data.','3151050EaLoCm','string','findById','slice','foreach\x20newproduct','params','$product_details.batch_code','logo','new_adjust_qty','$product_details.maxPerUnit','level','$finalize','English\x20(US)','New_Qty_Converted','room','Rooms','$product_details.product_stock','$product_details.invoice','Error\x20Occurs','Email\x20sent\x20successfully','</head><body>','True'];a0_0x3e09=function(){return _0x29e7a4;};return a0_0x3e09();}function a0_0x44da(_0x4ee9ae,_0x3f083f){var _0x3e09cb=a0_0x3e09();return a0_0x44da=function(_0x44dad5,_0x34414d){_0x44dad5=_0x44dad5-0x14a;var _0x44a2c0=_0x3e09cb[_0x44dad5];return _0x44a2c0;},a0_0x44da(_0x4ee9ae,_0x3f083f);}var a0_0x25d265=a0_0x44da;(function(_0x477493,_0x51f8cf){var _0x90ca0=a0_0x44da,_0x209cc6=_0x477493();while(!![]){try{var _0x2478c6=parseInt(_0x90ca0(0x15a))/0x1+-parseInt(_0x90ca0(0x209))/0x2+-parseInt(_0x90ca0(0x1e4))/0x3+parseInt(_0x90ca0(0x1cb))/0x4+-parseInt(_0x90ca0(0x1c2))/0x5*(parseInt(_0x90ca0(0x1f1))/0x6)+parseInt(_0x90ca0(0x16f))/0x7*(-parseInt(_0x90ca0(0x1da))/0x8)+-parseInt(_0x90ca0(0x1d5))/0x9*(-parseInt(_0x90ca0(0x20d))/0xa);if(_0x2478c6===_0x51f8cf)break;else _0x209cc6['push'](_0x209cc6['shift']());}catch(_0x342ca5){_0x209cc6['push'](_0x209cc6['shift']());}}}(a0_0x3e09,0xd43b9));const express=require(a0_0x25d265(0x195)),app=express(),router=express[a0_0x25d265(0x1ab)](),auth=require(a0_0x25d265(0x1b2)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment,adjustment_finished,email_settings,supervisor_settings}=require('../models/all_models'),users=require(a0_0x25d265(0x183)),nodemailer=require(a0_0x25d265(0x15d));router['get'](a0_0x25d265(0x19c),auth,async(_0x23421,_0x315bfa)=>{var _0x3bb7a2=a0_0x25d265;try{const {username:_0x57eb36,email:_0x248899,role:_0xb44925}=_0x23421[_0x3bb7a2(0x1a4)],_0x3a42ae=_0x23421['user'],_0x5e9f6b=await profile[_0x3bb7a2(0x1ea)]({'email':_0x3a42ae[_0x3bb7a2(0x1e9)]}),_0x227d69=await master_shop[_0x3bb7a2(0x193)]();let _0x377284;if(_0x3a42ae['role']==_0x3bb7a2(0x1b9)){const _0x4b90e9=await staff[_0x3bb7a2(0x1ea)]({'email':_0x3a42ae['email']});_0x377284=await warehouse['find']({'status':_0x3bb7a2(0x173),'name':_0x4b90e9[_0x3bb7a2(0x17b)]});}else _0x377284=await warehouse[_0x3bb7a2(0x193)]({'status':_0x3bb7a2(0x173)});const _0xf0fcbe=await product[_0x3bb7a2(0x193)]();let _0x3a9bd0;if(_0x3a42ae[_0x3bb7a2(0x1a9)]==_0x3bb7a2(0x1b9)){const _0x450219=await staff[_0x3bb7a2(0x1ea)]({'email':_0x3a42ae[_0x3bb7a2(0x1e9)]});_0x3a9bd0=await adjustment_finished['find']({'warehouse_name':_0x450219[_0x3bb7a2(0x17b)]});}else _0x3a9bd0=await adjustment_finished[_0x3bb7a2(0x160)]([{'$unwind':_0x3bb7a2(0x15c)},{'$group':{'_id':_0x3bb7a2(0x1f8),'invoice':{'$first':_0x3bb7a2(0x1ce)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x3bb7a2(0x1fe)},'room':{'$addToSet':_0x3bb7a2(0x158)},'finalize':{'$first':_0x3bb7a2(0x218)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0x227d69[0x0][_0x3bb7a2(0x1ad)]==_0x3bb7a2(0x219)){var _0x1af53d=users[_0x3bb7a2(0x205)];console[_0x3bb7a2(0x1ee)](_0x1af53d);}else{if(_0x227d69[0x0][_0x3bb7a2(0x1ad)]==_0x3bb7a2(0x1fb))var _0x1af53d=users[_0x3bb7a2(0x1fb)];else{if(_0x227d69[0x0][_0x3bb7a2(0x1ad)]==_0x3bb7a2(0x1e1))var _0x1af53d=users[_0x3bb7a2(0x1e1)];else{if(_0x227d69[0x0][_0x3bb7a2(0x1ad)]==_0x3bb7a2(0x1f3))var _0x1af53d=users[_0x3bb7a2(0x1f3)];else{if(_0x227d69[0x0]['language']==_0x3bb7a2(0x1e3))var _0x1af53d=users[_0x3bb7a2(0x1e3)];else{if(_0x227d69[0x0][_0x3bb7a2(0x1ad)]=='Portuguese\x20(BR)')var _0x1af53d=users[_0x3bb7a2(0x1fd)];else{if(_0x227d69[0x0][_0x3bb7a2(0x1ad)]==_0x3bb7a2(0x18b))var _0x1af53d=users[_0x3bb7a2(0x18b)];else{if(_0x227d69[0x0][_0x3bb7a2(0x1ad)]==_0x3bb7a2(0x16b))var _0x1af53d=users[_0x3bb7a2(0x1f6)];}}}}}}}_0x315bfa[_0x3bb7a2(0x171)](_0x3bb7a2(0x1af),{'success':_0x23421[_0x3bb7a2(0x1e5)]('success'),'errors':_0x23421[_0x3bb7a2(0x1e5)](_0x3bb7a2(0x152)),'role':_0x3a42ae,'profile':_0x5e9f6b,'warehouse':_0x377284,'product':_0xf0fcbe,'adjustment':_0x3a9bd0,'master_shop':_0x227d69,'language':_0x1af53d});}catch(_0x161fb1){console[_0x3bb7a2(0x1ee)](_0x161fb1);}});async function getRandom8DigitNumber(){var _0x2d4db1=a0_0x25d265;const _0x39f439=0x989680,_0x2ab637=0x5f5e0ff,_0x3d1791=Math['floor'](Math[_0x2d4db1(0x201)]()*(_0x2ab637-_0x39f439+0x1))+_0x39f439;var _0x54886e;const _0x5f393b=await adjustment_finished[_0x2d4db1(0x1ea)]({'invoice':_0x2d4db1(0x1df)+_0x3d1791});return _0x5f393b&&_0x5f393b[_0x2d4db1(0x161)]>0x0?_0x54886e=_0x2d4db1(0x1df)+_0x3d1791:_0x54886e=_0x2d4db1(0x1df)+_0x3d1791,_0x54886e;}router[a0_0x25d265(0x1c9)](a0_0x25d265(0x1a7),auth,async(_0xd0886d,_0x3c1533)=>{var _0x27ac20=a0_0x25d265;try{const {username:_0x34d86f,email:_0x13410f,role:_0x28717b}=_0xd0886d['user'],_0x463939=_0xd0886d['user'],_0x54fdb2=await profile['findOne']({'email':_0x463939[_0x27ac20(0x1e9)]}),_0x4f6a1c=await master_shop[_0x27ac20(0x193)]();let _0xc86433;if(_0x463939['role']==_0x27ac20(0x1b9)){const _0x4f694c=await staff['findOne']({'email':_0x463939[_0x27ac20(0x1e9)]});_0xc86433=await warehouse[_0x27ac20(0x160)]([{'$match':{'status':_0x27ac20(0x173),'name':_0x4f694c[_0x27ac20(0x17b)],'name':{'$ne':_0x27ac20(0x1d4)}}},{'$group':{'_id':'$name','name':{'$first':_0x27ac20(0x1fa)}}}]);}else _0xc86433=await warehouse[_0x27ac20(0x160)]([{'$match':{'status':_0x27ac20(0x173),'name':{'$ne':_0x27ac20(0x1d4)}}},{'$group':{'_id':'$name','name':{'$first':_0x27ac20(0x1fa)}}}]);const _0x1ef324=await product[_0x27ac20(0x193)]({}),_0x3211f1=await adjustment_finished[_0x27ac20(0x193)]({}),_0x547ea7=_0x3211f1[_0x27ac20(0x161)]+0x1,_0xe52a8b=_0x27ac20(0x1df)+_0x547ea7[_0x27ac20(0x200)]()[_0x27ac20(0x196)](0x5,'0');var _0xb1dc94=[_0x27ac20(0x1bc),'Enclosed',_0x27ac20(0x15e)];if(_0x4f6a1c[0x0]['language']==_0x27ac20(0x219))var _0x591646=users[_0x27ac20(0x205)];else{if(_0x4f6a1c[0x0][_0x27ac20(0x1ad)]=='Hindi')var _0x591646=users[_0x27ac20(0x1fb)];else{if(_0x4f6a1c[0x0][_0x27ac20(0x1ad)]==_0x27ac20(0x1e1))var _0x591646=users[_0x27ac20(0x1e1)];else{if(_0x4f6a1c[0x0][_0x27ac20(0x1ad)]==_0x27ac20(0x1f3))var _0x591646=users['Spanish'];else{if(_0x4f6a1c[0x0][_0x27ac20(0x1ad)]==_0x27ac20(0x1e3))var _0x591646=users[_0x27ac20(0x1e3)];else{if(_0x4f6a1c[0x0]['language']==_0x27ac20(0x204))var _0x591646=users[_0x27ac20(0x1fd)];else{if(_0x4f6a1c[0x0][_0x27ac20(0x1ad)]==_0x27ac20(0x18b))var _0x591646=users['Chinese'];else{if(_0x4f6a1c[0x0]['language']==_0x27ac20(0x16b))var _0x591646=users['Arabic'];}}}}}}}const _0x158e7c=getRandom8DigitNumber();_0x158e7c[_0x27ac20(0x1d9)](_0xb09faf=>{var _0x379bd8=_0x27ac20;_0x3c1533[_0x379bd8(0x171)](_0x379bd8(0x154),{'success':_0xd0886d['flash']('success'),'errors':_0xd0886d[_0x379bd8(0x1e5)]('errors'),'role':_0x463939,'profile':_0x54fdb2,'warehouse':_0xc86433,'product':_0x1ef324,'master_shop':_0x4f6a1c,'language':_0x591646,'rooms_data':_0xb1dc94,'invoice_no':_0xb09faf});})[_0x27ac20(0x1c7)](_0x47346f=>{var _0x146cb3=_0x27ac20;_0xd0886d[_0x146cb3(0x1e5)](_0x146cb3(0x152),_0x146cb3(0x1ec)),_0x3c1533[_0x146cb3(0x185)](_0x146cb3(0x19f));});}catch(_0x1d89de){console['log'](_0x1d89de);}}),router['post'](a0_0x25d265(0x1a7),auth,async(_0x3d6ecf,_0x1de10e)=>{var _0x176f42=a0_0x25d265;try{const {warehouse_name:_0x3a99b3,date:_0x3e0fd5,prod_name:_0x300de5,level:_0x32bd63,isle:_0x15e485,pallet:_0x43766b,stock:_0x2c7ce3,types:_0x3d4db1,adjust_qty:_0x569ffe,new_adjust_qty:_0x46252f,note:_0x311e15,Room_name:_0x335ee1,invoice:_0x120940,JO_number:_0x556d8b,expiry_date:_0x32f416,PO_number:_0x6ab1dd,ReqBy:_0x20c2fe,dateofreq:_0x38baaf,typeservicesData:_0x3fb147,destination:_0x56c27b,deliverydate:_0x21b3d2,driver:_0x1591ef,plate:_0x4d1961,van:_0x1ab0f1,DRSI:_0x2ff0c9,typevehicle:_0x814045,TSU:_0x115b9e,TFU:_0x486ebc}=_0x3d6ecf[_0x176f42(0x1ed)];if(typeof _0x300de5==_0x176f42(0x20e))var _0x3b6210=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1d1)]],_0x53a4ae=[_0x3d6ecf['body'][_0x176f42(0x217)]],_0x16feb1=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x166)]],_0x66997f=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1f5)]],_0x37871f=[_0x3d6ecf['body'][_0x176f42(0x1d2)]],_0x215772=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x21a)]],_0x2f6d51=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1ef)]],_0x2459dc=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x198)]],_0x45a82f=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1d3)]],_0x1b03c7=[_0x3d6ecf[_0x176f42(0x1ed)]['batch_code']],_0x249b84=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1cd)]],_0x58e35c=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x181)]],_0x3efa73=[_0x3d6ecf[_0x176f42(0x1ed)]['prod_cat']],_0x141110=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x14b)]],_0x3fd62e=[_0x3d6ecf['body'][_0x176f42(0x1b1)]],_0x188969=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x177)]],_0x5978ad=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1a6)]],_0x4238a0=[_0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x17e)]],_0x1c680c=[_0x3d6ecf['body'][_0x176f42(0x1ac)]],_0x24bee7=[_0x3d6ecf['body'][_0x176f42(0x1be)]];else var _0x3b6210=[..._0x3d6ecf['body']['prod_name']],_0x53a4ae=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x217)]],_0x16feb1=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x166)]],_0x66997f=[..._0x3d6ecf[_0x176f42(0x1ed)]['types']],_0x37871f=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1d2)]],_0x215772=[..._0x3d6ecf['body']['New_Qty_Converted']],_0x2f6d51=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1ef)]],_0x2459dc=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x198)]],_0x45a82f=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1d3)]],_0x1b03c7=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1a8)]],_0x249b84=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1cd)]],_0x58e35c=[..._0x3d6ecf[_0x176f42(0x1ed)]['product_date']],_0x3efa73=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x207)]],_0x141110=[..._0x3d6ecf[_0x176f42(0x1ed)]['Rooms']],_0x3fd62e=[..._0x3d6ecf['body'][_0x176f42(0x1b1)]],_0x188969=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x177)]],_0x5978ad=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1a6)]],_0x4238a0=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x17e)]],_0x1c680c=[..._0x3d6ecf[_0x176f42(0x1ed)]['CBM']],_0x24bee7=[..._0x3d6ecf[_0x176f42(0x1ed)][_0x176f42(0x1be)]];const _0x1d1bce=_0x3b6210[_0x176f42(0x170)](_0x506c76=>{return _0x506c76={'product_name':_0x506c76};});_0x5978ad[_0x176f42(0x16d)]((_0x5666bf,_0x496eb2)=>{var _0x49f243=_0x176f42;_0x1d1bce[_0x496eb2][_0x49f243(0x1a6)]=_0x5666bf;}),_0x4238a0[_0x176f42(0x16d)]((_0x37bf00,_0x3b1bf5)=>{var _0x1bfdbc=_0x176f42;_0x1d1bce[_0x3b1bf5][_0x1bfdbc(0x17e)]=_0x37bf00;}),_0x53a4ae[_0x176f42(0x16d)]((_0x383016,_0x530716)=>{var _0x3d3233=_0x176f42,_0x4fe386=_0x383016[_0x3d3233(0x210)](0x1);_0x1d1bce[_0x530716][_0x3d3233(0x174)]=_0x383016[0x0],_0x1d1bce[_0x530716][_0x3d3233(0x1f2)]=_0x4fe386;}),_0x188969[_0x176f42(0x16d)]((_0x2fb463,_0x30037e)=>{var _0x3d801a=_0x176f42;_0x1d1bce[_0x30037e][_0x3d801a(0x217)]=_0x2fb463;}),_0x16feb1[_0x176f42(0x16d)]((_0x57682e,_0x530170)=>{var _0xdfe542=_0x176f42;_0x1d1bce[_0x530170][_0xdfe542(0x1bd)]=_0x57682e;}),_0x66997f[_0x176f42(0x16d)]((_0x5e5c36,_0x1206b0)=>{var _0x3d16b2=_0x176f42;_0x1d1bce[_0x1206b0][_0x3d16b2(0x1f5)]=_0x5e5c36;}),_0x37871f[_0x176f42(0x16d)]((_0x1732c5,_0xd0a80a)=>{var _0xa862fd=_0x176f42;_0x1d1bce[_0xd0a80a][_0xa862fd(0x1cc)]=_0x1732c5;}),_0x215772[_0x176f42(0x16d)]((_0x3925fa,_0x52d70b)=>{_0x1d1bce[_0x52d70b]['new_adjust_qty']=_0x3925fa;}),_0x2f6d51[_0x176f42(0x16d)]((_0x278abe,_0x1fa34f)=>{var _0x1347d0=_0x176f42;_0x1d1bce[_0x1fa34f][_0x1347d0(0x1d7)]=_0x278abe;}),_0x2459dc[_0x176f42(0x16d)]((_0x511fde,_0x4c8ef1)=>{var _0x3af455=_0x176f42;_0x1d1bce[_0x4c8ef1][_0x3af455(0x15b)]=_0x511fde;}),_0x45a82f[_0x176f42(0x16d)]((_0x599bea,_0x1bfe31)=>{var _0x22a98b=_0x176f42;_0x1d1bce[_0x1bfe31][_0x22a98b(0x156)]=_0x599bea;}),_0x1b03c7[_0x176f42(0x16d)]((_0x266b0b,_0x39fa7e)=>{var _0x4403ab=_0x176f42;_0x1d1bce[_0x39fa7e][_0x4403ab(0x1a8)]=_0x266b0b;}),_0x249b84['forEach']((_0x5daffa,_0x5b5388)=>{var _0x325b67=_0x176f42;_0x1d1bce[_0x5b5388][_0x325b67(0x1cd)]=_0x5daffa;}),_0x58e35c[_0x176f42(0x16d)]((_0x43a1c1,_0x5d6d2e)=>{_0x1d1bce[_0x5d6d2e]['production_date']=_0x43a1c1;}),_0x3efa73[_0x176f42(0x16d)]((_0x650702,_0x326f93)=>{_0x1d1bce[_0x326f93]['prod_cat']=_0x650702;}),_0x141110['forEach']((_0x212acb,_0x2f2d9d)=>{var _0x456717=_0x176f42;_0x1d1bce[_0x2f2d9d][_0x456717(0x187)]=_0x212acb;}),_0x3fd62e[_0x176f42(0x16d)]((_0x543bb7,_0x3a3ba1)=>{var _0x4f6e1e=_0x176f42;_0x1d1bce[_0x3a3ba1][_0x4f6e1e(0x1b1)]=_0x543bb7;}),_0x1c680c[_0x176f42(0x16d)]((_0x2e7e5e,_0x4404f1)=>{var _0x2075b2=_0x176f42;_0x1d1bce[_0x4404f1][_0x2075b2(0x1ac)]=_0x2e7e5e;}),_0x24bee7['forEach']((_0x1d0896,_0x55309c)=>{_0x1d1bce[_0x55309c]['invoice']=_0x1d0896;});const _0x1d65f1=_0x1d1bce['filter'](_0x23ad16=>_0x23ad16[_0x176f42(0x215)]!=='0'&&_0x23ad16[_0x176f42(0x215)]!=='');var _0x4b0275=0x0;_0x1d65f1[_0x176f42(0x16d)](_0x5e71d2=>{var _0x5765b9=_0x176f42;console['log'](_0x5765b9(0x211),_0x5e71d2),parseInt(_0x5e71d2[_0x5765b9(0x215)])<0x0&&_0x4b0275++;});if(_0x4b0275!=0x0)return _0x3d6ecf['flash']('errors','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0x1de10e['redirect'](_0x176f42(0x206));const _0x34e161=new adjustment_finished({'warehouse_name':_0x3a99b3,'date':_0x3e0fd5,'product':_0x1d65f1,'note':_0x311e15,'room':_0x335ee1,'invoice':_0x120940,'JO_number':_0x556d8b,'expiry_date':_0x32f416,'PO_number':_0x6ab1dd,'RequestedBy':_0x20c2fe,'DateofRequest':_0x38baaf,'typeservices':_0x3fb147,'destination':_0x56c27b,'deliverydate':_0x21b3d2,'driver':_0x1591ef,'plate':_0x4d1961,'van':_0x1ab0f1,'DRSI':_0x2ff0c9,'typevehicle':_0x814045,'TSU':_0x115b9e,'TFU':_0x486ebc}),_0x3439d5=await _0x34e161[_0x176f42(0x1c5)]();_0x3d6ecf[_0x176f42(0x1e5)](_0x176f42(0x1c1),'adjustment\x20add\x20successfull'),_0x1de10e[_0x176f42(0x185)](_0x176f42(0x15f)+_0x3439d5[_0x176f42(0x19b)]);}catch(_0x2340b2){console['log'](_0x2340b2),_0x1de10e[_0x176f42(0x194)](0xc8)[_0x176f42(0x1c0)]({'message':_0x2340b2[_0x176f42(0x1c6)]});}}),router[a0_0x25d265(0x1c9)](a0_0x25d265(0x19a),auth,async(_0x309309,_0x26fa8c)=>{var _0x4a02ac=a0_0x25d265;try{const {username:_0x2e7477,email:_0x5eb605,role:_0x38d928}=_0x309309[_0x4a02ac(0x1a4)],_0x591f4b=_0x309309[_0x4a02ac(0x1a4)],_0x3b52e7=await profile[_0x4a02ac(0x1ea)]({'email':_0x591f4b[_0x4a02ac(0x1e9)]}),_0x48df7f=await master_shop[_0x4a02ac(0x193)](),_0x510cfd=_0x309309[_0x4a02ac(0x212)]['id'],_0x5440a7=await adjustment_finished[_0x4a02ac(0x20f)]({'_id':_0x510cfd}),_0x599bb3=await purchases[_0x4a02ac(0x160)]([{'$match':{'warehouse_name':_0x5440a7['warehouse_name']}},{'$unwind':_0x4a02ac(0x15c)},{'$group':{'_id':_0x4a02ac(0x18a)}}]),_0x174d25=await product['find']({}),_0x4f68ad=await warehouse['aggregate']([{'$match':{'name':_0x5440a7['warehouse_name']}},{'$unwind':_0x4a02ac(0x20a)},{'$group':{'_id':_0x4a02ac(0x162),'name':{'$first':_0x4a02ac(0x1ff)},'product_stock':{'$first':_0x4a02ac(0x14c)},'level':{'$first':_0x4a02ac(0x1ae)},'isle':{'$first':_0x4a02ac(0x1dc)},'pallet':{'$first':_0x4a02ac(0x1aa)},'primary_code':{'$first':_0x4a02ac(0x1d0)},'secondary_code':{'$first':_0x4a02ac(0x18f)},'product_code':{'$first':_0x4a02ac(0x16c)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4a02ac(0x184)},'production_date':{'$first':_0x4a02ac(0x1bb)},'batch_code':{'$first':_0x4a02ac(0x213)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'room':{'$first':'$room'}}}]);if(_0x48df7f[0x0][_0x4a02ac(0x1ad)]==_0x4a02ac(0x219)){var _0x5544df=users[_0x4a02ac(0x205)];console[_0x4a02ac(0x1ee)](_0x5544df);}else{if(_0x48df7f[0x0][_0x4a02ac(0x1ad)]=='Hindi')var _0x5544df=users[_0x4a02ac(0x1fb)];else{if(_0x48df7f[0x0][_0x4a02ac(0x1ad)]==_0x4a02ac(0x1e1))var _0x5544df=users['German'];else{if(_0x48df7f[0x0][_0x4a02ac(0x1ad)]==_0x4a02ac(0x1f3))var _0x5544df=users[_0x4a02ac(0x1f3)];else{if(_0x48df7f[0x0][_0x4a02ac(0x1ad)]=='French')var _0x5544df=users[_0x4a02ac(0x1e3)];else{if(_0x48df7f[0x0]['language']==_0x4a02ac(0x204))var _0x5544df=users['Portuguese'];else{if(_0x48df7f[0x0][_0x4a02ac(0x1ad)]=='Chinese')var _0x5544df=users[_0x4a02ac(0x18b)];else{if(_0x48df7f[0x0][_0x4a02ac(0x1ad)]==_0x4a02ac(0x16b))var _0x5544df=users[_0x4a02ac(0x1f6)];}}}}}}}_0x26fa8c[_0x4a02ac(0x171)]('edit_adjustment_finished_view',{'success':_0x309309['flash'](_0x4a02ac(0x1c1)),'errors':_0x309309[_0x4a02ac(0x1e5)](_0x4a02ac(0x152)),'role':_0x591f4b,'profile':_0x3b52e7,'adjustment':_0x5440a7,'stock':_0x4f68ad,'master_shop':_0x48df7f,'warehouse_name':_0x599bb3,'unit':_0x174d25,'language':_0x5544df});}catch(_0x585df3){console[_0x4a02ac(0x1ee)](_0x585df3),_0x26fa8c[_0x4a02ac(0x194)](0xc8)['json']({'message':_0x585df3[_0x4a02ac(0x1c6)]});}}),router[a0_0x25d265(0x202)]('/preview/:id',auth,async(_0x308295,_0x28e7c2)=>{var _0x3f33e2=a0_0x25d265;try{const {invoice:_0x489cae,warehouse_name:_0x2b0cce,Room_name:_0x3d8d97}=_0x308295[_0x3f33e2(0x1ed)],_0x22ed52=_0x308295[_0x3f33e2(0x212)]['id'],_0x2c8c73=await adjustment_finished[_0x3f33e2(0x20f)]({'_id':_0x22ed52});var _0x2d9987;const _0x4de886=_0x2c8c73[_0x3f33e2(0x1de)][_0x3f33e2(0x170)](async _0x161639=>{var _0x3baae9=_0x3f33e2;if(_0x161639[_0x3baae9(0x1cc)]>0x0){_0x2d9987=await warehouse[_0x3baae9(0x1ea)]({'name':_0x2b0cce,'room':_0x161639[_0x3baae9(0x187)]});const _0x379a8c=_0x2d9987['product_details']['map'](_0x388951=>{var _0x23a7c0=_0x3baae9;console[_0x23a7c0(0x1ee)](_0x161639[_0x23a7c0(0x1f5)]);if(_0x161639[_0x23a7c0(0x1f5)]=='minus')_0x388951['product_name']==_0x161639[_0x23a7c0(0x18c)]&&_0x388951['level']==_0x161639['level']&&_0x388951[_0x23a7c0(0x174)]==_0x161639[_0x23a7c0(0x174)]&&_0x388951['pallet']==_0x161639[_0x23a7c0(0x1f2)]&&_0x388951[_0x23a7c0(0x1cd)]==_0x161639[_0x23a7c0(0x1cd)]&&_0x388951['production_date']==_0x161639['production_date']&&_0x388951[_0x23a7c0(0x1a8)]==_0x161639[_0x23a7c0(0x1a8)]&&_0x388951[_0x23a7c0(0x1e8)]==_0x161639[_0x23a7c0(0x1e8)]&&(_0x388951[_0x23a7c0(0x17a)]=_0x388951['product_stock']-_0x161639[_0x23a7c0(0x1cc)]);else _0x161639[_0x23a7c0(0x1f5)]=='add'&&(_0x388951[_0x23a7c0(0x18c)]==_0x161639['product_name']&&_0x388951[_0x23a7c0(0x217)]==_0x161639[_0x23a7c0(0x217)]&&_0x388951[_0x23a7c0(0x174)]==_0x161639[_0x23a7c0(0x174)]&&_0x388951[_0x23a7c0(0x1f2)]==_0x161639[_0x23a7c0(0x1f2)]&&_0x388951[_0x23a7c0(0x1cd)]==_0x161639[_0x23a7c0(0x1cd)]&&_0x388951['production_date']==_0x161639[_0x23a7c0(0x1e0)]&&_0x388951['batch_code']==_0x161639[_0x23a7c0(0x1a8)]&&_0x388951['invoice']==_0x161639[_0x23a7c0(0x1e8)]&&(_0x388951[_0x23a7c0(0x17a)]=_0x388951['product_stock']+_0x161639[_0x23a7c0(0x1cc)]));});}return _0x2d9987;});Promise[_0x3f33e2(0x1b5)](_0x4de886)[_0x3f33e2(0x1d9)](async _0x57e770=>{var _0x4eb2ef=_0x3f33e2;try{for(const _0xf12dca of _0x57e770){await _0xf12dca[_0x4eb2ef(0x1c5)]();}_0x2c8c73[_0x4eb2ef(0x1d6)]=_0x4eb2ef(0x151);const _0x5d48b2=await _0x2c8c73['save']();var _0x5a6b96=_0x2c8c73[_0x4eb2ef(0x1de)];const _0x39e5a8=await master_shop['find'](),_0x5dc3af=await email_settings[_0x4eb2ef(0x1ea)](),_0x48e3c0=await supervisor_settings[_0x4eb2ef(0x193)]();let _0x2ad860=nodemailer[_0x4eb2ef(0x155)]({'host':_0x5dc3af[_0x4eb2ef(0x1b6)],'port':Number(_0x5dc3af['port']),'secure':![],'auth':{'user':_0x5dc3af[_0x4eb2ef(0x1e9)],'pass':_0x5dc3af['password']}});var _0x416a72='',_0x1581da;for(_0x1581da in _0x5a6b96){_0x416a72+=_0x4eb2ef(0x1f4)+_0x4eb2ef(0x159)+_0x5a6b96[_0x1581da][_0x4eb2ef(0x18c)]+_0x4eb2ef(0x1a3)+_0x4eb2ef(0x159)+_0x5a6b96[_0x1581da]['new_adjust_qty']+_0x4eb2ef(0x1a3)+_0x4eb2ef(0x159)+_0x5a6b96[_0x1581da][_0x4eb2ef(0x1d7)]+_0x4eb2ef(0x1a3)+_0x4eb2ef(0x159)+_0x5a6b96[_0x1581da][_0x4eb2ef(0x187)]+_0x4eb2ef(0x1a3)+_0x4eb2ef(0x159)+_0x5a6b96[_0x1581da][_0x4eb2ef(0x217)]+_0x4eb2ef(0x1a3)+_0x4eb2ef(0x159)+_0x5a6b96[_0x1581da][_0x4eb2ef(0x174)]+_0x5a6b96[_0x1581da]['pallet']+_0x4eb2ef(0x1a3)+_0x4eb2ef(0x189);}let _0x2538d7={'from':_0x5dc3af[_0x4eb2ef(0x1e9)],'to':_0x48e3c0[0x0]['RMSEmail'],'subject':_0x4eb2ef(0x168),'attachments':[{'filename':'Logo.png','path':__dirname+_0x4eb2ef(0x1b0)+'/upload/'+_0x39e5a8[0x0]['image'],'cid':_0x4eb2ef(0x214)}],'html':'<!DOCTYPE\x20html>'+'<html><head><title></title>'+_0x4eb2ef(0x150)+'<div>'+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+'<div>'+_0x4eb2ef(0x1a5)+'</div>'+_0x4eb2ef(0x1e2)+_0x4eb2ef(0x178)+_0x39e5a8[0x0][_0x4eb2ef(0x1eb)]+'\x20</h2>'+_0x4eb2ef(0x1f9)+_0x4eb2ef(0x1f9)+_0x4eb2ef(0x1b3)+_0x4eb2ef(0x1e2)+_0x4eb2ef(0x190)+'\x20Order\x20Number\x20:\x20'+_0x2c8c73[_0x4eb2ef(0x1e8)]+'\x20'+_0x4eb2ef(0x1a0)+_0x4eb2ef(0x1b7)+_0x2c8c73[_0x4eb2ef(0x172)]+'\x20'+_0x4eb2ef(0x20b)+_0x4eb2ef(0x1bf)+_0x4eb2ef(0x1f9)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x4eb2ef(0x1b8)+_0x4eb2ef(0x1f4)+_0x4eb2ef(0x1e7)+_0x4eb2ef(0x176)+_0x4eb2ef(0x1c8)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room\x20</th>'+_0x4eb2ef(0x157)+_0x4eb2ef(0x1f0)+_0x4eb2ef(0x189)+_0x4eb2ef(0x16a)+_0x4eb2ef(0x186)+'\x20'+_0x416a72+'\x20'+_0x4eb2ef(0x1f7)+_0x4eb2ef(0x1e6)+_0x4eb2ef(0x1e2)+_0x4eb2ef(0x1fc)+_0x4eb2ef(0x182)+_0x39e5a8[0x0][_0x4eb2ef(0x1eb)]+_0x4eb2ef(0x1bf)+_0x4eb2ef(0x1f9)+_0x4eb2ef(0x1f9)+_0x4eb2ef(0x208)};_0x2ad860['sendMail'](_0x2538d7,function(_0x2d380d,_0x1f08a7){var _0x22c551=_0x4eb2ef;_0x2d380d?(console['log'](_0x2d380d),console['log'](_0x22c551(0x14e))):console[_0x22c551(0x1ee)](_0x22c551(0x14f));}),_0x308295[_0x4eb2ef(0x1e5)](_0x4eb2ef(0x1c1),_0x4eb2ef(0x180)),_0x28e7c2[_0x4eb2ef(0x185)](_0x4eb2ef(0x1ca)+_0x5d48b2[_0x4eb2ef(0x19b)]);}catch(_0xd3f1fe){console[_0x4eb2ef(0x165)](_0xd3f1fe),_0x28e7c2[_0x4eb2ef(0x194)](0x1f4)[_0x4eb2ef(0x1c0)]({'error':_0x4eb2ef(0x20c)});}})['catch'](_0x4555c8=>{var _0x551ca4=_0x3f33e2;console[_0x551ca4(0x165)](_0x4555c8),_0x28e7c2[_0x551ca4(0x194)](0x1f4)[_0x551ca4(0x1c0)]({'error':_0x551ca4(0x1b4)});});}catch(_0x255d59){_0x28e7c2['json']({'message':_0x255d59[_0x3f33e2(0x1c6)]});}}),router[a0_0x25d265(0x1c9)]('/view/:id',auth,async(_0x19a350,_0x459ffe)=>{var _0x25b741=a0_0x25d265;try{const {username:_0x2672ec,email:_0xcc1e93,role:_0x2cd502}=_0x19a350['user'],_0x789c0b=_0x19a350[_0x25b741(0x1a4)],_0x2af24d=await profile[_0x25b741(0x1ea)]({'email':_0x789c0b[_0x25b741(0x1e9)]}),_0x125d89=await master_shop[_0x25b741(0x193)]();console[_0x25b741(0x1ee)](_0x25b741(0x17c),_0x125d89);const _0x3abea7=_0x19a350[_0x25b741(0x212)]['id'],_0x9a374=await adjustment_finished[_0x25b741(0x20f)]({'_id':_0x3abea7});let _0x25a97b=new Date(_0x9a374['expiry_date']),_0x2f4cb8=('0'+_0x25a97b[_0x25b741(0x192)]())['slice'](-0x2),_0x1c85ce=('0'+(_0x25a97b[_0x25b741(0x1c3)]()+0x1))[_0x25b741(0x210)](-0x2),_0x31b103=_0x25a97b[_0x25b741(0x169)](),_0x25133a=_0x31b103+'-'+_0x1c85ce+'-'+_0x2f4cb8;var _0xe4fb7b=['Ambient',_0x25b741(0x203),_0x25b741(0x15e)];const _0x400d84=await purchases[_0x25b741(0x160)]([{'$match':{'warehouse_name':_0x9a374[_0x25b741(0x179)]}},{'$unwind':'$product'},{'$group':{'_id':_0x25b741(0x18a)}}]);console[_0x25b741(0x1ee)](_0x25b741(0x191),_0x400d84);const _0x5934eb=await product[_0x25b741(0x193)]({}),_0xbaffc2=await warehouse[_0x25b741(0x160)]([{'$match':{'name':_0x9a374[_0x25b741(0x179)],'room':_0x9a374[_0x25b741(0x14a)]}},{'$unwind':'$product_details'},{'$group':{'_id':_0x25b741(0x162),'name':{'$first':_0x25b741(0x1ff)},'product_stock':{'$first':_0x25b741(0x14c)},'bay':{'$first':'$product_details.bay'},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x25b741(0x18d)},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x25b741(0x1d0)},'secondary_code':{'$first':_0x25b741(0x18f)},'product_code':{'$first':_0x25b741(0x16c)},'storage':{'$first':_0x25b741(0x1db)},'rack':{'$first':_0x25b741(0x16e)}}}]);if(_0x125d89[0x0][_0x25b741(0x1ad)]==_0x25b741(0x219)){var _0x586a7c=users[_0x25b741(0x205)];console[_0x25b741(0x1ee)](_0x586a7c);}else{if(_0x125d89[0x0][_0x25b741(0x1ad)]==_0x25b741(0x1fb))var _0x586a7c=users[_0x25b741(0x1fb)];else{if(_0x125d89[0x0]['language']==_0x25b741(0x1e1))var _0x586a7c=users[_0x25b741(0x1e1)];else{if(_0x125d89[0x0][_0x25b741(0x1ad)]=='Spanish')var _0x586a7c=users[_0x25b741(0x1f3)];else{if(_0x125d89[0x0]['language']==_0x25b741(0x1e3))var _0x586a7c=users['French'];else{if(_0x125d89[0x0][_0x25b741(0x1ad)]=='Portuguese\x20(BR)')var _0x586a7c=users[_0x25b741(0x1fd)];else{if(_0x125d89[0x0][_0x25b741(0x1ad)]==_0x25b741(0x18b))var _0x586a7c=users[_0x25b741(0x18b)];else{if(_0x125d89[0x0][_0x25b741(0x1ad)]==_0x25b741(0x16b))var _0x586a7c=users[_0x25b741(0x1f6)];}}}}}}}_0x459ffe['render'](_0x25b741(0x1a2),{'success':_0x19a350[_0x25b741(0x1e5)](_0x25b741(0x1c1)),'errors':_0x19a350[_0x25b741(0x1e5)](_0x25b741(0x152)),'role':_0x789c0b,'profile':_0x2af24d,'adjustment':_0x9a374,'stock':_0xbaffc2,'master_shop':_0x125d89,'warehouse_name':_0x400d84,'unit':_0x5934eb,'language':_0x586a7c,'rooms_data':_0xe4fb7b,'ed_fullDate':_0x25133a});}catch(_0x2117c3){console['log'](_0x2117c3),_0x459ffe['status'](0xc8)[_0x25b741(0x1c0)]({'message':_0x2117c3[_0x25b741(0x1c6)]});}}),router[a0_0x25d265(0x202)](a0_0x25d265(0x175),auth,async(_0x394e89,_0x2539ea)=>{var _0x425ead=a0_0x25d265;try{const _0x1ec382=_0x394e89[_0x425ead(0x212)]['id'],_0x442ab5=await adjustment_finished[_0x425ead(0x20f)]({'_id':_0x1ec382}),_0x517be7=await warehouse[_0x425ead(0x1ea)]({'name':_0x442ab5[_0x425ead(0x179)],'room':_0x442ab5['room']}),{warehouse_name:_0x2065b9,date:_0x4a7b2b,prod_name:_0x4388e2,level:_0xe81679,isle:_0x255b75,pallet:_0x1e69c3,stock:_0x3a3192,types:_0x149196,adjust_qty:_0x5784f9,new_adjust_qty:_0xb86a3f,note:_0x125761,Room_name:_0x479c81,invoice:_0x473740,JO_number:_0x4731d6}=_0x394e89[_0x425ead(0x1ed)];if(typeof _0x4388e2=='string')var _0x127e9b=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1d1)]],_0x2d54ce=[_0x394e89['body'][_0x425ead(0x217)]],_0x55c108=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x166)]],_0x10e0fb=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1f5)]],_0xd27b9a=[_0x394e89['body'][_0x425ead(0x1cc)]],_0x1db1f5=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x215)]],_0x5308de=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1d3)]],_0x475acd=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1d7)]],_0x48cdb8=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x198)]],_0x23cdff=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1a8)]],_0x2da12e=[_0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1cd)]];else var _0x127e9b=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1d1)]],_0x2d54ce=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x217)]],_0x55c108=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x166)]],_0x10e0fb=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1f5)]],_0xd27b9a=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1cc)]],_0x1db1f5=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x215)]],_0x5308de=[..._0x394e89['body'][_0x425ead(0x1d3)]],_0x475acd=[..._0x394e89['body'][_0x425ead(0x1d7)]],_0x48cdb8=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x198)]],_0x23cdff=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1a8)]],_0x2da12e=[..._0x394e89[_0x425ead(0x1ed)][_0x425ead(0x1cd)]];const _0xed1fb2=_0x127e9b['map'](_0x57e8d9=>{return _0x57e8d9={'product_name':_0x57e8d9};});_0x2d54ce[_0x425ead(0x16d)]((_0x2a5bda,_0xfcf988)=>{var _0x62271d=_0x425ead;_0xed1fb2[_0xfcf988][_0x62271d(0x1ba)]=_0x2a5bda;}),_0x55c108['forEach']((_0x5d4d71,_0x58246a)=>{_0xed1fb2[_0x58246a]['stockBefore']=_0x5d4d71;}),_0x10e0fb[_0x425ead(0x16d)]((_0x3b53e6,_0x5d8e15)=>{var _0x5d5bda=_0x425ead;_0xed1fb2[_0x5d8e15][_0x5d5bda(0x1f5)]=_0x3b53e6;}),_0xd27b9a['forEach']((_0x82af1,_0x20de51)=>{var _0x2ac71b=_0x425ead;_0xed1fb2[_0x20de51][_0x2ac71b(0x1cc)]=_0x82af1;}),_0x1db1f5['forEach']((_0x197693,_0x5e25da)=>{var _0x117f0e=_0x425ead;_0xed1fb2[_0x5e25da][_0x117f0e(0x215)]=_0x197693;}),_0x475acd['forEach']((_0x76ddf2,_0x15f33e)=>{var _0x4e2909=_0x425ead;_0xed1fb2[_0x15f33e][_0x4e2909(0x1d7)]=_0x76ddf2;}),_0x48cdb8[_0x425ead(0x16d)]((_0x333814,_0xd82148)=>{_0xed1fb2[_0xd82148]['secondary_unit']=_0x333814;}),_0x5308de[_0x425ead(0x16d)]((_0x42130b,_0x5134ed)=>{var _0x3ac8d4=_0x425ead;_0xed1fb2[_0x5134ed][_0x3ac8d4(0x156)]=_0x42130b;}),_0x23cdff[_0x425ead(0x16d)]((_0x5c4813,_0x3ffba8)=>{var _0xb8ab88=_0x425ead;_0xed1fb2[_0x3ffba8][_0xb8ab88(0x1a8)]=_0x5c4813;}),_0x2da12e[_0x425ead(0x16d)]((_0x351778,_0x5f5749)=>{_0xed1fb2[_0x5f5749]['expiry_date']=_0x351778;});const _0x459848=_0xed1fb2[_0x425ead(0x1dd)](_0x456c2c=>_0x456c2c[_0x425ead(0x1cc)]!=='0'&&_0x456c2c['adjust_qty']!=='');var _0x24455c=0x0;_0x459848[_0x425ead(0x16d)](_0x2b756e=>{var _0x48f5db=_0x425ead;console[_0x48f5db(0x1ee)](_0x48f5db(0x211),_0x2b756e),parseInt(_0x2b756e['adjust_qty'])<=0x0&&_0x24455c++;});if(_0x24455c!=0x0)return _0x394e89[_0x425ead(0x1e5)](_0x425ead(0x152),_0x425ead(0x19e)),_0x2539ea[_0x425ead(0x185)]('back');_0x442ab5['warehouse_name']=_0x2065b9,_0x442ab5[_0x425ead(0x172)]=_0x4a7b2b,_0x442ab5[_0x425ead(0x1de)]=_0x459848,_0x442ab5[_0x425ead(0x167)]=_0x125761,_0x442ab5[_0x425ead(0x14a)]=_0x479c81,_0x442ab5[_0x425ead(0x1e8)]=_0x473740,_0x442ab5[_0x425ead(0x199)]=_0x4731d6;const _0x10ac05=await _0x442ab5[_0x425ead(0x1c5)](),_0x468131=await warehouse[_0x425ead(0x1ea)]({'name':_0x2065b9,'room':_0x479c81});_0x10ac05[_0x425ead(0x1de)][_0x425ead(0x16d)](_0x340cbb=>{var _0x3f2895=_0x425ead;const _0x5839e2=_0x468131[_0x3f2895(0x153)][_0x3f2895(0x170)](_0x3b8392=>{var _0x14c614=_0x3f2895;_0x340cbb[_0x14c614(0x1f5)]==_0x14c614(0x163)?_0x3b8392[_0x14c614(0x18c)]==_0x340cbb['product_name']&&_0x3b8392['bay']==_0x340cbb[_0x14c614(0x1ba)]&&(_0x3b8392[_0x14c614(0x17a)]=parseInt(_0x3b8392['product_stock'])-parseInt(_0x340cbb['adjust_qty'])):_0x3b8392['product_name']==_0x340cbb[_0x14c614(0x18c)]&&_0x3b8392[_0x14c614(0x1ba)]==_0x340cbb[_0x14c614(0x1ba)]&&(_0x3b8392['product_stock']=parseInt(_0x3b8392[_0x14c614(0x17a)])+parseInt(_0x340cbb[_0x14c614(0x1cc)]));});}),await _0x468131[_0x425ead(0x1c5)](),_0x394e89[_0x425ead(0x1e5)](_0x425ead(0x1c1),_0x425ead(0x1c4)),_0x2539ea[_0x425ead(0x185)](_0x425ead(0x19f));}catch(_0x4bd81b){console[_0x425ead(0x1ee)](_0x4bd81b);}}),router[a0_0x25d265(0x202)](a0_0x25d265(0x164),async(_0x5a4f10,_0x386d47)=>{var _0x581727=a0_0x25d265;const {primary_code:_0x5f15d8,warehouse_data:_0x30f372,rooms_data:_0x1c28fb,Roomslist:_0x2797af}=_0x5a4f10['body'],_0x2c8b8b=_0x2797af[_0x581727(0x197)](','),_0x4d9262=[];async function _0x44df4b(_0xaeca8e){var _0x11ff40=_0x581727;const _0xf78822=await warehouse['aggregate']([{'$match':{'name':_0x30f372,'room':_0xaeca8e}},{'$unwind':_0x11ff40(0x20a)},{'$match':{'product_details.primary_code':_0x5f15d8}},{'$group':{'_id':_0x11ff40(0x162),'name':{'$first':_0x11ff40(0x1ff)},'product_stock':{'$first':_0x11ff40(0x14c)},'primary_code':{'$first':_0x11ff40(0x1d0)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x11ff40(0x16c)},'level':{'$first':_0x11ff40(0x1ae)},'isle':{'$first':_0x11ff40(0x1dc)},'pallet':{'$first':'$product_details.pallet'},'unit':{'$first':_0x11ff40(0x17f)},'secondary_unit':{'$first':_0x11ff40(0x19d)},'storage':{'$first':_0x11ff40(0x1db)},'rack':{'$first':_0x11ff40(0x16e)},'expiry_date':{'$first':_0x11ff40(0x184)},'production_date':{'$first':_0x11ff40(0x1bb)},'batch_code':{'$first':_0x11ff40(0x213)},'product_cat':{'$first':'P'},'maxPerUnit':{'$first':_0x11ff40(0x216)},'roomNamed':{'$first':'$room'},'CBM':{'$first':{'$toDouble':_0x11ff40(0x188)}},'maxProducts':{'$first':_0x11ff40(0x17d)},'invoice':{'$first':'$product_details.invoice'}}}]),_0x18588d=await warehouse[_0x11ff40(0x160)]([{'$match':{'name':_0x30f372,'room':_0xaeca8e}},{'$unwind':_0x11ff40(0x20a)},{'$match':{'product_details.secondary_code':_0x5f15d8}},{'$group':{'_id':_0x11ff40(0x162),'name':{'$first':_0x11ff40(0x1ff)},'product_stock':{'$first':_0x11ff40(0x14c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x11ff40(0x18f)},'product_code':{'$first':_0x11ff40(0x16c)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x11ff40(0x1dc)},'pallet':{'$first':_0x11ff40(0x1aa)},'unit':{'$first':_0x11ff40(0x17f)},'secondary_unit':{'$first':_0x11ff40(0x19d)},'storage':{'$first':_0x11ff40(0x1db)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x11ff40(0x184)},'production_date':{'$first':_0x11ff40(0x1bb)},'batch_code':{'$first':_0x11ff40(0x213)},'product_cat':{'$first':'S'},'maxPerUnit':{'$first':_0x11ff40(0x216)},'roomNamed':{'$first':_0x11ff40(0x18e)},'CBM':{'$first':{'$toDouble':'$product_details.CBM'}},'maxProducts':{'$first':_0x11ff40(0x17d)},'invoice':{'$first':_0x11ff40(0x14d)}}}]);if(_0xf78822['length']>0x0)_0x4d9262[_0x11ff40(0x1d8)](_0xf78822);else _0x18588d['length']>0x0&&_0x4d9262['push'](_0x18588d);}const _0x3bc670=_0x2c8b8b[_0x581727(0x170)](_0x379b64=>_0x44df4b(_0x379b64));await Promise[_0x581727(0x1b5)](_0x3bc670),_0x386d47[_0x581727(0x1c0)](_0x4d9262);}),router['post'](a0_0x25d265(0x1a1),async(_0x5662b8,_0x329e38)=>{var _0x35a39b=a0_0x25d265;const {productCode:_0xb3fc7b,bay:_0x8b3c91,warehouses:_0x5afcfe,room:_0x19ced0}=_0x5662b8['body'];console['log'](_0x5662b8[_0x35a39b(0x1ed)]);try{const _0x169e26=await warehouse['aggregate']([{'$match':{'name':_0x5afcfe,'room':_0x19ced0}},{'$unwind':_0x35a39b(0x20a)},{'$match':{'product_details.bay':parseInt(_0x8b3c91)}},{'$group':{'_id':_0x35a39b(0x162),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x35a39b(0x14c)},'bay':{'$first':_0x35a39b(0x1cf)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x329e38[_0x35a39b(0x194)](0xc8)['json'](_0x169e26);}catch(_0x3cd52b){_0x329e38[_0x35a39b(0x194)](0x194)['json']({'message':_0x3cd52b[_0x35a39b(0x1c6)]});}}),module['exports']=router;