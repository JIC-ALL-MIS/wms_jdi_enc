function a0_0x58e1(_0x46b007,_0x41e23d){var _0x419c87=a0_0x419c();return a0_0x58e1=function(_0x58e1df,_0xf5d554){_0x58e1df=_0x58e1df-0xe0;var _0x57ab0c=_0x419c87[_0x58e1df];return _0x57ab0c;},a0_0x58e1(_0x46b007,_0x41e23d);}var a0_0x58e264=a0_0x58e1;(function(_0x2976f1,_0x556ca2){var _0x375b45=a0_0x58e1,_0xefacce=_0x2976f1();while(!![]){try{var _0x463343=-parseInt(_0x375b45(0xfc))/0x1+parseInt(_0x375b45(0x161))/0x2+-parseInt(_0x375b45(0x12e))/0x3*(parseInt(_0x375b45(0x17a))/0x4)+parseInt(_0x375b45(0x162))/0x5*(-parseInt(_0x375b45(0x192))/0x6)+parseInt(_0x375b45(0x124))/0x7*(parseInt(_0x375b45(0xed))/0x8)+parseInt(_0x375b45(0x111))/0x9*(-parseInt(_0x375b45(0x13d))/0xa)+parseInt(_0x375b45(0x152))/0xb;if(_0x463343===_0x556ca2)break;else _0xefacce['push'](_0xefacce['shift']());}catch(_0x1bcaa5){_0xefacce['push'](_0xefacce['shift']());}}}(a0_0x419c,0xb18c3));const express=require(a0_0x58e264(0x166)),app=express(),router=express[a0_0x58e264(0x179)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,transfers}=require(a0_0x58e264(0x119)),auth=require(a0_0x58e264(0xeb)),users=require(a0_0x58e264(0xe5));router[a0_0x58e264(0x160)](a0_0x58e264(0x129),auth,async(_0x228c30,_0x20521b)=>{var _0x344220=a0_0x58e264;try{const {username:_0x360412,email:_0x390e0e,role:_0x2718b9}=_0x228c30[_0x344220(0x167)],_0x4138d9=_0x228c30[_0x344220(0x167)],_0x592c48=await profile['findOne']({'email':_0x4138d9[_0x344220(0x128)]}),_0x3a771f=await master_shop[_0x344220(0xe7)]();console[_0x344220(0x174)](_0x344220(0xe4),_0x3a771f);let _0x270f3f;if(_0x4138d9[_0x344220(0x10c)]=='staff'){const _0x2d9f56=await staff['findOne']({'email':_0x4138d9['email']});_0x270f3f=await transfers[_0x344220(0xe7)]({'from_warehouse':_0x2d9f56[_0x344220(0x180)]});}else _0x270f3f=await transfers[_0x344220(0x15b)]([{'$unwind':'$product'},{'$group':{'_id':_0x344220(0xe8),'invoice':{'$first':_0x344220(0xe2)},'date':{'$first':_0x344220(0x15d)},'from_warehouse':{'$first':'$from_warehouse'},'to_warehouse':{'$first':_0x344220(0x15e)},'from_room_name':{'$addToSet':_0x344220(0x182)},'to_room_name':{'$addToSet':'$product.to_room_name'},'finalize':{'$first':'$finalize'}}},{'$project':{'_id':0x1,'invoice':0x1,'date':0x1,'from_warehouse':0x1,'to_warehouse':0x1,'from_room_name':0x1,'to_room_name':0x1,'finalize':0x1}}]);if(_0x3a771f[0x0][_0x344220(0x187)]==_0x344220(0xf5)){var _0x34dbf6=users[_0x344220(0x123)];console['log'](_0x34dbf6);}else{if(_0x3a771f[0x0][_0x344220(0x187)]==_0x344220(0x11b))var _0x34dbf6=users[_0x344220(0x11b)];else{if(_0x3a771f[0x0][_0x344220(0x187)]==_0x344220(0x197))var _0x34dbf6=users[_0x344220(0x197)];else{if(_0x3a771f[0x0][_0x344220(0x187)]==_0x344220(0x13a))var _0x34dbf6=users[_0x344220(0x13a)];else{if(_0x3a771f[0x0][_0x344220(0x187)]==_0x344220(0x148))var _0x34dbf6=users[_0x344220(0x148)];else{if(_0x3a771f[0x0]['language']==_0x344220(0x140))var _0x34dbf6=users[_0x344220(0x103)];else{if(_0x3a771f[0x0][_0x344220(0x187)]==_0x344220(0x17e))var _0x34dbf6=users[_0x344220(0x17e)];else{if(_0x3a771f[0x0][_0x344220(0x187)]==_0x344220(0xf8))var _0x34dbf6=users[_0x344220(0x102)];}}}}}}}_0x20521b[_0x344220(0x17d)](_0x344220(0x101),{'success':_0x228c30['flash'](_0x344220(0x157)),'errors':_0x228c30[_0x344220(0x113)](_0x344220(0x19c)),'role':_0x4138d9,'profile':_0x592c48,'master_shop':_0x3a771f,'transfer':_0x270f3f,'language':_0x34dbf6});}catch(_0x4f6580){console[_0x344220(0x174)](_0x4f6580);}}),router[a0_0x58e264(0x160)](a0_0x58e264(0xf2),auth,async(_0x21c52d,_0x8b8476)=>{var _0x35e1df=a0_0x58e264;try{const {username:_0xf6c463,email:_0x587965,role:_0x5e190a}=_0x21c52d[_0x35e1df(0x167)],_0xffce6e=_0x21c52d[_0x35e1df(0x167)],_0x426af7=await profile['findOne']({'email':_0xffce6e[_0x35e1df(0x128)]}),_0x79ad75=await master_shop[_0x35e1df(0xe7)]();console['log']('master',_0x79ad75);let _0x4e167e;if(_0xffce6e[_0x35e1df(0x10c)]==_0x35e1df(0x12f)){const _0xbdb783=await staff[_0x35e1df(0x19d)]({'email':_0xffce6e[_0x35e1df(0x128)]});_0x4e167e=await warehouse['aggregate']([{'$match':{'status':_0x35e1df(0x159),'name':_0xbdb783[_0x35e1df(0x180)],'warehouse_category':'Raw\x20Materials'}},{'$group':{'_id':'$name','name':{'$first':_0x35e1df(0xe1)}}}]);}else _0x4e167e=await warehouse[_0x35e1df(0x15b)]([{'$match':{'status':_0x35e1df(0x159),'warehouse_category':_0x35e1df(0xfa)}},{'$group':{'_id':_0x35e1df(0xe1),'name':{'$first':_0x35e1df(0xe1)}}}]);var _0x29297d=['Ambient',_0x35e1df(0x172),_0x35e1df(0x14d)];const _0x4ec64a=await transfers[_0x35e1df(0xe7)]({}),_0x40f7c1=_0x4ec64a[_0x35e1df(0x143)]+0x1,_0x1fa45b=_0x35e1df(0xff)+_0x40f7c1['toString']()[_0x35e1df(0x13c)](0x5,'0');if(_0x79ad75[0x0][_0x35e1df(0x187)]==_0x35e1df(0xf5)){var _0x66184=users[_0x35e1df(0x123)];console[_0x35e1df(0x174)](_0x66184);}else{if(_0x79ad75[0x0]['language']==_0x35e1df(0x11b))var _0x66184=users[_0x35e1df(0x11b)];else{if(_0x79ad75[0x0][_0x35e1df(0x187)]==_0x35e1df(0x197))var _0x66184=users[_0x35e1df(0x197)];else{if(_0x79ad75[0x0][_0x35e1df(0x187)]=='Spanish')var _0x66184=users['Spanish'];else{if(_0x79ad75[0x0][_0x35e1df(0x187)]=='French')var _0x66184=users[_0x35e1df(0x148)];else{if(_0x79ad75[0x0][_0x35e1df(0x187)]==_0x35e1df(0x140))var _0x66184=users[_0x35e1df(0x103)];else{if(_0x79ad75[0x0]['language']==_0x35e1df(0x17e))var _0x66184=users[_0x35e1df(0x17e)];else{if(_0x79ad75[0x0]['language']==_0x35e1df(0xf8))var _0x66184=users['Arabic'];}}}}}}}_0x8b8476[_0x35e1df(0x17d)](_0x35e1df(0x10a),{'success':_0x21c52d[_0x35e1df(0x113)](_0x35e1df(0x157)),'errors':_0x21c52d['flash']('errors'),'role':_0xffce6e,'profile':_0x426af7,'master_shop':_0x79ad75,'warehouse':_0x4e167e,'language':_0x66184,'rooms_data':_0x29297d,'invoice':_0x1fa45b});}catch(_0xb657b3){console[_0x35e1df(0x174)](_0xb657b3);}}),router[a0_0x58e264(0x142)]('/view/add_transfer',auth,async(_0x33c937,_0xa0e9ea)=>{var _0x40a9bc=a0_0x58e264;try{console[_0x40a9bc(0x174)](_0x33c937['body']);const {date:_0x521874,from_warehouse:_0x104ab7,FromRoom_name:_0x561439,to_warehouse:_0x5b7e9d,ToRoom_name:_0x4263d4,prod_name:_0x36dfa7,from_prod_qty:_0x476c7a,from_prod_level:_0x4a2e7f,from_prod_isle:_0x8f73e2,from_prod_pallet:_0x3d85f7,to_prod_qty:_0x306435,to_prod_level:_0x442cae,to_prod_isle:_0x237a56,to_prod_pallet:_0xf69f38,primary_code:_0x52bb02,secondary_code:_0x4d5f8f,product_code3:_0x2f7286,note:_0x39496e,MaxStocks_data2:_0x26d093,invoice:_0x933a3d,expiry_date:_0x1ee041}=_0x33c937['body'];if(typeof _0x36dfa7==_0x40a9bc(0x165))var _0x356800=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x147)]],_0x3eb71a=[_0x33c937['body']['from_prod_qty']],_0xdb47c9=[_0x33c937['body'][_0x40a9bc(0x186)]],_0x31074c=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x112)]],_0x460893=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x132)]],_0x209fc1=[_0x33c937['body'][_0x40a9bc(0x173)]],_0x2e2f2b=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x130)]],_0x257071=[_0x33c937['body']['product_code3']],_0x412809=[_0x33c937['body'][_0x40a9bc(0xe6)]],_0x47943e=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x108)]],_0x3bed0c=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x135)]],_0x1046a5=[_0x33c937[_0x40a9bc(0x150)]['batch_code']],_0x14353c=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x19f)]],_0x218079=[_0x33c937['body']['max_per_unit']],_0xbae553=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x178)]],_0x1c6a29=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x177)]],_0x3ec4c6=[_0x33c937[_0x40a9bc(0x150)]['RoomAssigned']],_0x28f117=[_0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x18b)]];else var _0x356800=[..._0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x147)]],_0x3eb71a=[..._0x33c937[_0x40a9bc(0x150)]['from_prod_qty']],_0xdb47c9=[..._0x33c937['body'][_0x40a9bc(0x186)]],_0x31074c=[..._0x33c937['body'][_0x40a9bc(0x112)]],_0x460893=[..._0x33c937[_0x40a9bc(0x150)]['to_prod_level']],_0x209fc1=[..._0x33c937['body'][_0x40a9bc(0x173)]],_0x2e2f2b=[..._0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x130)]],_0x257071=[..._0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x117)]],_0x412809=[..._0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0xe6)]],_0x47943e=[..._0x33c937['body'][_0x40a9bc(0x108)]],_0x3bed0c=[..._0x33c937[_0x40a9bc(0x150)]['secondary_unit']],_0x1046a5=[..._0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x141)]],_0x14353c=[..._0x33c937[_0x40a9bc(0x150)]['expiry_date']],_0x218079=[..._0x33c937['body'][_0x40a9bc(0x12a)]],_0xbae553=[..._0x33c937['body'][_0x40a9bc(0x178)]],_0x1c6a29=[..._0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x177)]],_0x3ec4c6=[..._0x33c937['body']['RoomAssigned']],_0x28f117=[..._0x33c937[_0x40a9bc(0x150)][_0x40a9bc(0x18b)]];const _0x884da0=_0x356800['map'](_0x2ef0da=>{return _0x2ef0da={'product_name':_0x2ef0da};});_0x3eb71a[_0x40a9bc(0x137)]((_0x46ac51,_0x25cc47)=>{var _0x2a6737=_0x40a9bc;_0x884da0[_0x25cc47][_0x2a6737(0xf1)]=_0x46ac51;}),_0xdb47c9[_0x40a9bc(0x137)]((_0x4df9f7,_0x42ae53)=>{var _0x5e58fc=_0x40a9bc;_0x3ec4c6[_0x5e58fc(0x137)]((_0x2e03cd,_0x3b3c3b)=>{var _0x2e578d=_0x5e58fc;if(_0x2e03cd==_0x2e578d(0x14b)&&_0x42ae53==_0x3b3c3b){var _0x11bebe=_0x4df9f7['slice'](0x3);_0x884da0[_0x42ae53][_0x2e578d(0x13f)]=_0x4df9f7[0x0],_0x884da0[_0x42ae53]['from_rack']=_0x4df9f7[0x1],_0x884da0[_0x42ae53][_0x2e578d(0x13e)]=0x0,_0x884da0[_0x42ae53][_0x2e578d(0x107)]=0x0,_0x884da0[_0x42ae53]['from_types']='Floor',_0x884da0[_0x42ae53][_0x2e578d(0x133)]=_0x11bebe;}else{if(_0x2e03cd==_0x2e578d(0x12d)&&_0x42ae53==_0x3b3c3b){var _0x11bebe=_0x4df9f7['slice'](0x3);_0x884da0[_0x42ae53]['from_storage']=_0x4df9f7[0x0],_0x884da0[_0x42ae53]['from_rack']=_0x4df9f7[0x1],_0x884da0[_0x42ae53][_0x2e578d(0x13e)]=0x0,_0x884da0[_0x42ae53]['from_bin']=0x0,_0x884da0[_0x42ae53][_0x2e578d(0x158)]=_0x2e578d(0x19a),_0x884da0[_0x42ae53][_0x2e578d(0x133)]=_0x4df9f7[0x5];}else{if(_0x42ae53==_0x3b3c3b){var _0x40113c;if(_0x4df9f7[0x4]=='L')_0x40113c=_0x2e578d(0x195);else _0x4df9f7[0x4]=='F'&&(_0x40113c=_0x2e578d(0x19a));_0x884da0[_0x42ae53][_0x2e578d(0x13f)]=_0x4df9f7[0x0],_0x884da0[_0x42ae53]['from_rack']=_0x4df9f7[0x1],_0x884da0[_0x42ae53][_0x2e578d(0x13e)]=_0x4df9f7[0x2],_0x884da0[_0x42ae53][_0x2e578d(0x107)]=_0x4df9f7[0x3],_0x884da0[_0x42ae53]['from_types']=_0x40113c,_0x884da0[_0x42ae53][_0x2e578d(0x133)]=_0x4df9f7[0x5];}}}});}),_0x31074c[_0x40a9bc(0x137)]((_0x557338,_0x1aa89e)=>{var _0x1ef2c3=_0x40a9bc;_0x884da0[_0x1aa89e][_0x1ef2c3(0xf0)]=_0x557338;}),_0x460893[_0x40a9bc(0x137)]((_0x1e065a,_0x37c7e9)=>{var _0x531931=_0x40a9bc;_0x28f117[_0x531931(0x137)]((_0x552788,_0x459909)=>{var _0x22d6f7=_0x531931;if(_0x552788==_0x22d6f7(0x14b)&&_0x37c7e9==_0x459909){var _0x336016=_0x1e065a[_0x22d6f7(0x121)](0x3);_0x884da0[_0x37c7e9][_0x22d6f7(0x154)]=_0x1e065a[0x0],_0x884da0[_0x37c7e9][_0x22d6f7(0x145)]=_0x1e065a[0x1],_0x884da0[_0x37c7e9][_0x22d6f7(0x144)]=0x0,_0x884da0[_0x37c7e9][_0x22d6f7(0x105)]=0x0,_0x884da0[_0x37c7e9][_0x22d6f7(0x170)]=_0x22d6f7(0x19a),_0x884da0[_0x37c7e9][_0x22d6f7(0x14a)]=_0x336016;}else{if(_0x552788==_0x22d6f7(0x12d)&&_0x37c7e9==_0x459909){var _0x336016=_0x1e065a['slice'](0x3);_0x884da0[_0x37c7e9][_0x22d6f7(0x154)]=_0x1e065a[0x0],_0x884da0[_0x37c7e9][_0x22d6f7(0x145)]=_0x1e065a[0x1],_0x884da0[_0x37c7e9][_0x22d6f7(0x144)]=0x0,_0x884da0[_0x37c7e9][_0x22d6f7(0x105)]=0x0,_0x884da0[_0x37c7e9][_0x22d6f7(0x170)]=_0x22d6f7(0x19a),_0x884da0[_0x37c7e9]['to_floorlevel']=_0x1e065a[0x5];}else{if(_0x37c7e9==_0x459909){var _0x4c81ac;if(_0x1e065a[0x4]=='L')_0x4c81ac=_0x22d6f7(0x195);else _0x1e065a[0x4]=='F'&&(_0x4c81ac=_0x22d6f7(0x19a));_0x884da0[_0x37c7e9]['storage']=_0x1e065a[0x0],_0x884da0[_0x37c7e9][_0x22d6f7(0x145)]=_0x1e065a[0x1],_0x884da0[_0x37c7e9]['to_bay']=_0x1e065a[0x2],_0x884da0[_0x37c7e9][_0x22d6f7(0x105)]=_0x1e065a[0x3],_0x884da0[_0x37c7e9][_0x22d6f7(0x170)]=_0x4c81ac,_0x884da0[_0x37c7e9][_0x22d6f7(0x14a)]=_0x1e065a[0x5];}}}});}),_0x209fc1['forEach']((_0x36a13e,_0xd4e6f0)=>{var _0xf99446=_0x40a9bc;_0x884da0[_0xd4e6f0][_0xf99446(0x173)]=_0x36a13e;}),_0x2e2f2b[_0x40a9bc(0x137)]((_0x1af2e7,_0x14da05)=>{_0x884da0[_0x14da05]['secondary_code']=_0x1af2e7;}),_0x257071[_0x40a9bc(0x137)]((_0xbbb0cf,_0x457d5d)=>{_0x884da0[_0x457d5d]['product_code']=_0xbbb0cf;}),_0x412809['forEach']((_0x27e9c0,_0x9f0a6c)=>{_0x884da0[_0x9f0a6c]['maxProducts']=_0x27e9c0;}),_0x47943e[_0x40a9bc(0x137)]((_0x16875d,_0x5c2152)=>{_0x884da0[_0x5c2152]['unit']=_0x16875d;}),_0x3bed0c[_0x40a9bc(0x137)]((_0x3689a6,_0x47f9d4)=>{var _0x2e92e9=_0x40a9bc;_0x884da0[_0x47f9d4][_0x2e92e9(0x135)]=_0x3689a6;}),_0x1046a5['forEach']((_0x5e7a30,_0x69f6f5)=>{_0x884da0[_0x69f6f5]['batch_code']=_0x5e7a30;}),_0x14353c['forEach']((_0x5ebc6d,_0x1c4e93)=>{_0x884da0[_0x1c4e93]['expiry_date']=_0x5ebc6d;}),_0x218079[_0x40a9bc(0x137)]((_0xb3064b,_0x3121f5)=>{var _0x46ed88=_0x40a9bc;_0x884da0[_0x3121f5][_0x46ed88(0x138)]=_0xb3064b;}),_0xbae553[_0x40a9bc(0x137)]((_0x277c9b,_0x28ee8a)=>{var _0x546fed=_0x40a9bc;_0x884da0[_0x28ee8a][_0x546fed(0x178)]=_0x277c9b;}),_0x1c6a29['forEach']((_0x310a1a,_0x323b22)=>{_0x884da0[_0x323b22]['prod_cat']=_0x310a1a;}),_0x3ec4c6[_0x40a9bc(0x137)]((_0x2b29d2,_0x3e3124)=>{var _0x1c5363=_0x40a9bc;_0x884da0[_0x3e3124][_0x1c5363(0x10f)]=_0x2b29d2;}),_0x28f117['forEach']((_0x408586,_0x35051a)=>{var _0x48bb1d=_0x40a9bc;_0x884da0[_0x35051a][_0x48bb1d(0x17f)]=_0x408586;});const _0x58977c=_0x884da0[_0x40a9bc(0xf7)](_0x430fb8=>_0x430fb8['to_quantity']!=='0'&&_0x430fb8[_0x40a9bc(0xf0)]!==''||_0x430fb8[_0x40a9bc(0x14a)]!=='0'&&_0x430fb8['to_floorlevel']!==''),_0x564887=new transfers({'date':_0x521874,'from_warehouse':_0x104ab7,'to_warehouse':_0x5b7e9d,'product':_0x58977c,'note':_0x39496e,'invoice':_0x933a3d}),_0x1f9028=await _0x564887[_0x40a9bc(0x198)]();_0x33c937['flash'](_0x40a9bc(0x157),_0x40a9bc(0xf4)),_0xa0e9ea[_0x40a9bc(0x19e)]('/transfer/preview/'+_0x1f9028['_id']);}catch(_0x136a13){console[_0x40a9bc(0x174)](_0x136a13),_0xa0e9ea[_0x40a9bc(0x18f)](0xc8)[_0x40a9bc(0x199)]({'errorMessage':_0x136a13[_0x40a9bc(0xe3)]});}}),router[a0_0x58e264(0x160)](a0_0x58e264(0x188),auth,async(_0x3945d4,_0x3ddecb)=>{var _0x4943b1=a0_0x58e264;try{const {username:_0x553fa0,email:_0x538c84,role:_0x17761d}=_0x3945d4['user'],_0x530fd9=_0x3945d4[_0x4943b1(0x167)],_0x2ef457=await profile['findOne']({'email':_0x530fd9[_0x4943b1(0x128)]}),_0x451e14=await master_shop[_0x4943b1(0xe7)]();console[_0x4943b1(0x174)]('master',_0x451e14);const _0x1b018=await transfers[_0x4943b1(0xee)](_0x3945d4['params']['id']);let _0x39e55b=new Date(_0x1b018[_0x4943b1(0x19f)]),_0x4ef106=('0'+_0x39e55b[_0x4943b1(0x109)]())['slice'](-0x2),_0x108c07=('0'+(_0x39e55b['getMonth']()+0x1))[_0x4943b1(0x121)](-0x2),_0x181d93=_0x39e55b[_0x4943b1(0x168)](),_0x4eac1e=_0x181d93+'-'+_0x108c07+'-'+_0x4ef106,_0x56f449;if(_0x530fd9['role']=='staff'){const _0x5c80ef=await staff['findOne']({'email':_0x530fd9['email']});_0x56f449=await warehouse[_0x4943b1(0xe7)]({'status':_0x4943b1(0x159),'name':_0x5c80ef[_0x4943b1(0x180)],'warehouse_category':'Raw\x20Materials'});}else _0x56f449=await warehouse['find']({'status':_0x4943b1(0x159),'warehouse_category':'Raw\x20Materials'});const _0x32229f=await warehouse[_0x4943b1(0x15b)]([{'$match':{'name':_0x1b018[_0x4943b1(0x18a)]}},{'$unwind':_0x4943b1(0x122)},{'$group':{'_id':_0x4943b1(0x18e),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x4943b1(0x11d)},'bay':{'$first':_0x4943b1(0xe9)},'bin':{'$first':_0x4943b1(0x164)},'type':{'$first':_0x4943b1(0x151)},'floorlevel':{'$first':_0x4943b1(0x14f)},'primary_code':{'$first':_0x4943b1(0x15a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x4943b1(0x126)},'storage':{'$first':_0x4943b1(0x16f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x4943b1(0x127)},'production_date':{'$first':'$product_details.production_date'},'room':{'$first':'$room'}}}]);if(_0x451e14[0x0][_0x4943b1(0x187)]==_0x4943b1(0xf5)){var _0x4aa43d=users[_0x4943b1(0x123)];console[_0x4943b1(0x174)](_0x4aa43d);}else{if(_0x451e14[0x0][_0x4943b1(0x187)]==_0x4943b1(0x11b))var _0x4aa43d=users['Hindi'];else{if(_0x451e14[0x0][_0x4943b1(0x187)]=='German')var _0x4aa43d=users[_0x4943b1(0x197)];else{if(_0x451e14[0x0]['language']=='Spanish')var _0x4aa43d=users[_0x4943b1(0x13a)];else{if(_0x451e14[0x0][_0x4943b1(0x187)]==_0x4943b1(0x148))var _0x4aa43d=users[_0x4943b1(0x148)];else{if(_0x451e14[0x0][_0x4943b1(0x187)]==_0x4943b1(0x140))var _0x4aa43d=users[_0x4943b1(0x103)];else{if(_0x451e14[0x0][_0x4943b1(0x187)]==_0x4943b1(0x17e))var _0x4aa43d=users[_0x4943b1(0x17e)];else{if(_0x451e14[0x0]['language']=='Arabic\x20(ae)')var _0x4aa43d=users[_0x4943b1(0x102)];}}}}}}}_0x3ddecb[_0x4943b1(0x17d)](_0x4943b1(0x175),{'success':_0x3945d4[_0x4943b1(0x113)](_0x4943b1(0x157)),'errors':_0x3945d4[_0x4943b1(0x113)](_0x4943b1(0x19c)),'role':_0x530fd9,'profile':_0x2ef457,'master_shop':_0x451e14,'warehouse':_0x56f449,'transfer':_0x1b018,'stock':_0x32229f,'language':_0x4aa43d});}catch(_0x439838){console[_0x4943b1(0x174)](_0x439838);}}),router[a0_0x58e264(0x142)]('/preview/:id',auth,async(_0x24aef3,_0x1022d9)=>{var _0xf02698=a0_0x58e264;try{const _0x4883e5=_0x24aef3['params']['id'],{from_warehouse:_0x28a7d1,FromRoom_name:_0x251b3f,to_warehouse:_0x3ad743,ToRoom_name:_0xa7a278}=_0x24aef3[_0xf02698(0x150)],_0x22b075=await transfers[_0xf02698(0xee)]({'_id':_0x4883e5}),_0x367dbb=_0x22b075[_0xf02698(0x10e)]['map'](async _0x2afb5d=>{var _0x3fbdbc=_0xf02698;if(_0x2afb5d[_0x3fbdbc(0xf0)]>0x0){var _0x14c440=await warehouse[_0x3fbdbc(0x19d)]({'name':_0x22b075[_0x3fbdbc(0x18a)],'room':_0x2afb5d[_0x3fbdbc(0x10f)],'warehouse_category':'Raw\x20Materials'});const _0xd50bdb=_0x14c440[_0x3fbdbc(0x185)][_0x3fbdbc(0xec)](_0x262aa7=>{var _0x20eeae=_0x3fbdbc;_0x262aa7[_0x20eeae(0x11a)]==_0x2afb5d[_0x20eeae(0x11a)]&&_0x262aa7[_0x20eeae(0xef)]==_0x2afb5d['from_floorlevel']&&_0x262aa7[_0x20eeae(0xe0)]==_0x2afb5d[_0x20eeae(0x158)]&&_0x262aa7[_0x20eeae(0x181)]==_0x2afb5d[_0x20eeae(0x107)]&&_0x262aa7[_0x20eeae(0x16d)]==_0x2afb5d[_0x20eeae(0x13e)]&&_0x262aa7[_0x20eeae(0x145)]==_0x2afb5d['from_rack']&&_0x262aa7[_0x20eeae(0x154)]==_0x2afb5d[_0x20eeae(0x13f)]&&_0x262aa7[_0x20eeae(0x19f)]==_0x2afb5d[_0x20eeae(0x19f)]&&_0x262aa7[_0x20eeae(0x141)]==_0x2afb5d[_0x20eeae(0x141)]&&_0x262aa7[_0x20eeae(0x178)]==_0x2afb5d['production_date']&&(_0x262aa7[_0x20eeae(0x11f)]=_0x262aa7['product_stock']-_0x2afb5d[_0x20eeae(0xf0)]);});}return _0x14c440;});Promise[_0xf02698(0x194)](_0x367dbb)['then'](async _0x2dc880=>{var _0x3f5544=_0xf02698;try{for(const _0x38e38a of _0x2dc880){await _0x38e38a[_0x3f5544(0x198)]();}try{const _0x246079=_0x22b075[_0x3f5544(0x10e)][_0x3f5544(0xec)](async _0x256ac6=>{var _0x2e9a85=_0x3f5544;if(_0x256ac6[_0x2e9a85(0xf0)]>0x0){var _0x427589=await warehouse[_0x2e9a85(0x19d)]({'name':_0x22b075[_0x2e9a85(0x12b)],'room':_0x256ac6[_0x2e9a85(0x17f)],'warehouse_category':_0x2e9a85(0xfa)}),_0x41cbff=0x0;const _0x171297=_0x427589[_0x2e9a85(0x185)][_0x2e9a85(0xec)](_0x150ae7=>{var _0x12dc58=_0x2e9a85;_0x150ae7[_0x12dc58(0x11a)]==_0x256ac6[_0x12dc58(0x11a)]&&_0x150ae7[_0x12dc58(0xef)]==_0x256ac6[_0x12dc58(0x14a)]&&_0x150ae7['type']==_0x256ac6['to_types']&&_0x150ae7[_0x12dc58(0x181)]==_0x256ac6[_0x12dc58(0x105)]&&_0x150ae7['bay']==_0x256ac6[_0x12dc58(0x144)]&&_0x150ae7[_0x12dc58(0x145)]==_0x256ac6['rack']&&_0x150ae7['storage']==_0x256ac6[_0x12dc58(0x154)]&&_0x150ae7['expiry_date']==_0x256ac6['expiry_date']&&_0x150ae7['batch_code']==_0x256ac6[_0x12dc58(0x141)]&&_0x150ae7[_0x12dc58(0x178)]==_0x256ac6[_0x12dc58(0x178)]&&(_0x150ae7[_0x12dc58(0x11f)]=_0x150ae7[_0x12dc58(0x11f)]+_0x256ac6[_0x12dc58(0xf0)],_0x41cbff++);});_0x41cbff=='0'&&(_0x427589[_0x2e9a85(0x185)]=_0x427589[_0x2e9a85(0x185)][_0x2e9a85(0x134)]({'product_name':_0x256ac6[_0x2e9a85(0x11a)],'product_stock':_0x256ac6[_0x2e9a85(0xf0)],'bay':_0x256ac6['to_bay'],'bin':_0x256ac6[_0x2e9a85(0x105)],'type':_0x256ac6[_0x2e9a85(0x170)],'floorlevel':_0x256ac6[_0x2e9a85(0x14a)],'storage':_0x256ac6[_0x2e9a85(0x154)],'rack':_0x256ac6[_0x2e9a85(0x145)],'product_code':_0x256ac6['product_code'],'primary_code':_0x256ac6[_0x2e9a85(0x173)],'secondary_code':_0x256ac6[_0x2e9a85(0x130)],'maxProducts':_0x256ac6[_0x2e9a85(0xfd)],'storage':_0x256ac6[_0x2e9a85(0x154)],'rack':_0x256ac6['rack'],'expiry_date':_0x256ac6[_0x2e9a85(0x19f)],'maxPerUnit':_0x256ac6[_0x2e9a85(0x138)],'batch_code':_0x256ac6[_0x2e9a85(0x141)],'production_date':_0x256ac6[_0x2e9a85(0x178)]}));}return _0x427589;});Promise[_0x3f5544(0x194)](_0x246079)['then'](async _0xa9fa4b=>{var _0x533b86=_0x3f5544;try{for(const _0x1650c8 of _0xa9fa4b){await warehouse[_0x533b86(0x114)]({'_id':_0x1650c8[_0x533b86(0xf6)]},{'$addToSet':{'product_details':{'$each':_0x1650c8[_0x533b86(0x185)]}}});}_0x22b075[_0x533b86(0x15f)]=_0x533b86(0x100);const _0x2ae7e3=await _0x22b075[_0x533b86(0x198)]();_0x24aef3[_0x533b86(0x113)](_0x533b86(0x157),_0x533b86(0xea)),_0x1022d9[_0x533b86(0x19e)](_0x533b86(0x171)+_0x2ae7e3[_0x533b86(0xf6)]);}catch(_0x682a38){console[_0x533b86(0x16b)](_0x682a38),_0x1022d9[_0x533b86(0x18f)](0x1f4)['json']({'Perror':'An\x20error\x20occurred\x20while\x20saving\x20data.','message':_0x682a38[_0x533b86(0xe3)]});}})[_0x3f5544(0x10b)](_0x2aa63b=>{var _0x4a0a96=_0x3f5544;console['error'](_0x2aa63b),_0x1022d9[_0x4a0a96(0x18f)](0x1f4)['json']({'Perror':'An\x20error\x20occurred.'});});}catch(_0x139a9b){_0x1022d9[_0x3f5544(0x199)](_0x139a9b);}}catch(_0x486b06){console[_0x3f5544(0x16b)](_0x486b06),_0x1022d9[_0x3f5544(0x18f)](0x1f4)[_0x3f5544(0x199)]({'Merror':_0x3f5544(0x176),'Message':_0x486b06[_0x3f5544(0xe3)]});}})['catch'](_0x1309ae=>{var _0x34cf8b=_0xf02698;console[_0x34cf8b(0x16b)](_0x1309ae),_0x1022d9['status'](0x1f4)[_0x34cf8b(0x199)]({'Merror':_0x34cf8b(0x12c)});});}catch(_0x3a2b4d){console[_0xf02698(0x174)](_0x3a2b4d);}});function BayBinSelected(_0x1bcacb,_0x17ccae){var _0x3c5b40=a0_0x58e264,_0x3625e8=[],_0x1f22a6=[],_0x44fdce=[],_0x4189fd=[],_0x4b7aac=[],_0x4a5182=[];let _0x1793b5=[];if(_0x1bcacb==_0x3c5b40(0x17c))switch(_0x17ccae){case _0x3c5b40(0x149):_0x3625e8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8],_0x1f22a6=[0x1,0x2],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=[_0x3c5b40(0x195),'Floor'],_0x4b7aac=['D'],_0x4a5182=['A'];break;case _0x3c5b40(0x17b):_0x3625e8=[0x6,0x5,0x4,0x3,0x2,0x1],_0x1f22a6=[0x1,0x2],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=['Level',_0x3c5b40(0x19a)],_0x4b7aac=['D'],_0x4a5182=['B'];break;case'Shelves':_0x3625e8=[0x0],_0x1f22a6=[0x0],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=[_0x3c5b40(0x19a)],_0x4b7aac=['D'],_0x4a5182=['S'];break;case'Receiving\x20Area':_0x3625e8=[0x0],_0x1f22a6=[0x0],_0x4189fd=[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8,0x9,0xa,0xb,0xc,0xd,0xe,0xf,0x10],_0x44fdce=[_0x3c5b40(0x19a)],_0x4b7aac=['D'],_0x4a5182=['R'];break;}else{if(_0x1bcacb=='COLD\x20STORAGE')switch(_0x17ccae){case _0x3c5b40(0x149):_0x3625e8=[0x1,0x2,0x3,0x4,0x5,0x6,0x7],_0x1f22a6=['B','F'],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=['Level',_0x3c5b40(0x19a)],_0x4b7aac=['C'],_0x4a5182=['A'];break;case _0x3c5b40(0x17b):_0x3625e8=[0x5,0x4,0x3,0x2,0x1],_0x1f22a6=['F','B','S'],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=['Level','Floor'],_0x4b7aac=['C'],_0x4a5182=['B'];break;case _0x3c5b40(0x16e):_0x3625e8=[0x1,0x2,0x3,0x4,0x5],_0x1f22a6=['B','F','S'],_0x4189fd=[0x5,0x4,0x3,0x2,0x1],_0x44fdce=['Level','Floor'],_0x4b7aac=['C'],_0x4a5182=['C'];break;case'Rack\x20D':_0x3625e8=[0x5,0x4,0x3,0x2,0x1],_0x1f22a6=['F','B','S'],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=[_0x3c5b40(0x195),_0x3c5b40(0x19a)],_0x4b7aac=['C'],_0x4a5182=['D'];break;case'Rack\x20E':_0x3625e8=[0x4,0x3,0x2,0x1],_0x1f22a6=[0x1,0x2],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=[_0x3c5b40(0x195),_0x3c5b40(0x19a)],_0x4b7aac=['C'],_0x4a5182=['E'];break;case _0x3c5b40(0x163):_0x3625e8=[0x1,0x2,0x3],_0x1f22a6=[0x1,0x2],_0x4189fd=[0x1,0x2,0x3,0x4,0x5],_0x44fdce=[_0x3c5b40(0x195)],_0x4b7aac=['C'],_0x4a5182=['F'];break;}}return{'levels':_0x3625e8,'Isle':_0x1f22a6,'rack':_0x4189fd,'type':_0x44fdce,'storage':_0x4b7aac,'rak':_0x4a5182};}function a0_0x419c(){var _0x5eb024=['storage','product_code','$product_details.maxProducts','success','from_types','Enabled','$product_details.primary_code','aggregate','/barcode_scanner3','$date','$to_warehouse','finalize','get','1428954jLflDQ','65LcMwEy','Rack\x20F','$product_details.bin','string','express','user','getFullYear','$product_details.maxPerUnit','to_prod_qty','error','$product_details.secondary_code','bay','Rack\x20C','$product_details.storage','to_types','/picking_list/PDF_transfer_rm/','Enclosed','primary_code','log','edit_transfer_view','An\x20error\x20occurred\x20while\x20saving\x20data.','prod_cat','production_date','Router','44yuMIlu','Rack\x20B','DRY\x20STORAGE','render','Chinese','to_room_name','warehouse','bin','$product.from_room_name','$product_details.secondary_unit','$product_details.isle','product_details','from_prod_level','language','/preview/:id','from_room','from_warehouse','ToRoomAssigned','from_prod_isle','rak','$product_details._id','status','$product_details.unit','from_rack','651906rIBsEM','transfer_data','all','Level','$product_details.level','German','save','json','Floor','params','errors','findOne','redirect','expiry_date','type','$name','$invoice','message','master','../public/language/languages.json','MaxStocks_data2','find','$_id','$product_details.bay','Transfer\x20Finalize\x20Successfully','../middleware/auth','map','1204592YoUDtK','findById','floorlevel','to_quantity','from_quantity','/view/add_transfer','from_rak','Product\x20Transfer\x20successfully','English\x20(US)','_id','filter','Arabic\x20(ae)','exports','Raw\x20Materials','$product_details.pallet','95485PbCaUR','maxProducts','edit_transfer','TRF-','True','transfer','Arabic','Portuguese','to_prod_isle','to_bin','$room','from_bin','primary_unit','getDate','add_transfer','catch','role','unit','product','from_room_name','Transfer\x20Edit\x20Successfully','9VpxIaa','New_Qty_Converted','flash','updateOne','$product_details.rack','/transfer/view','product_code3','/view/:id','../models/all_models','product_name','Hindi','from_prod_qty','$product_details.product_stock','invoice','product_stock','$product_details.product_name','slice','$product_details','English','28QatfdY','to_room','$product_details.product_code','$product_details.expiry_date','email','/view','max_per_unit','to_warehouse','An\x20error\x20occurred.','Shelves','374151RvuBMZ','staff','secondary_code','split','to_prod_level','from_floorlevel','concat','secondary_unit','from_prod_pallet','forEach','maxperunit','date','Spanish','push','padStart','4516020UmShDH','from_bay','from_storage','Portuguese\x20(BR)','batch_code','post','length','to_bay','rack','to_prod_pallet','prod_name','French','Rack\x20A','to_floorlevel','Receiving\x20Area','$product_details.batch_code','Return\x20Rooms','/barcode_scanner','$product_details.floorlevel','body','$product_details.type','30160889jQCnvT','$product_details.production_date'];a0_0x419c=function(){return _0x5eb024;};return a0_0x419c();}router[a0_0x58e264(0x160)](a0_0x58e264(0x118),auth,async(_0x9cb7c9,_0x5d0613)=>{var _0x3831f4=a0_0x58e264;try{const {username:_0x8303ca,email:_0x4c8649,role:_0x3826c2}=_0x9cb7c9['user'],_0x554898=_0x9cb7c9[_0x3831f4(0x167)],_0x41dcc8=await profile[_0x3831f4(0x19d)]({'email':_0x554898[_0x3831f4(0x128)]}),_0x4d2a1a=await master_shop[_0x3831f4(0xe7)]();console['log']('master',_0x4d2a1a);const _0x2ffe2a=await transfers[_0x3831f4(0xee)](_0x9cb7c9[_0x3831f4(0x19b)]['id']);let _0x361962;if(_0x554898[_0x3831f4(0x10c)]=='staff'){const _0x1fd9a8=await staff[_0x3831f4(0x19d)]({'email':_0x554898[_0x3831f4(0x128)]});_0x361962=await warehouse['find']({'status':_0x3831f4(0x159),'name':_0x1fd9a8[_0x3831f4(0x180)],'warehouse_category':_0x3831f4(0xfa)});}else _0x361962=await warehouse[_0x3831f4(0xe7)]({'status':_0x3831f4(0x159),'warehouse_category':_0x3831f4(0xfa)});const _0x416d80=await warehouse[_0x3831f4(0x15b)]([{'$match':{'name':_0x2ffe2a[_0x3831f4(0x18a)],'room':_0x2ffe2a[_0x3831f4(0x189)]}},{'$unwind':_0x3831f4(0x122)},{'$group':{'_id':_0x3831f4(0x18e),'name':{'$first':_0x3831f4(0x120)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3831f4(0xe9)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3831f4(0x151)},'floorlevel':{'$first':_0x3831f4(0x14f)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3831f4(0x16c)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x3831f4(0x16f)},'rack':{'$first':_0x3831f4(0x115)}}}]),_0x3fa4c9=await product[_0x3831f4(0xe7)]({}),_0x578caf=BayBinSelected(_0x2ffe2a['to_warehouse'],_0x2ffe2a['to_room']);if(_0x4d2a1a[0x0][_0x3831f4(0x187)]=='English\x20(US)'){var _0x3bce7a=users['English'];console[_0x3831f4(0x174)](_0x3bce7a);}else{if(_0x4d2a1a[0x0]['language']=='Hindi')var _0x3bce7a=users[_0x3831f4(0x11b)];else{if(_0x4d2a1a[0x0][_0x3831f4(0x187)]==_0x3831f4(0x197))var _0x3bce7a=users['German'];else{if(_0x4d2a1a[0x0][_0x3831f4(0x187)]==_0x3831f4(0x13a))var _0x3bce7a=users[_0x3831f4(0x13a)];else{if(_0x4d2a1a[0x0][_0x3831f4(0x187)]==_0x3831f4(0x148))var _0x3bce7a=users[_0x3831f4(0x148)];else{if(_0x4d2a1a[0x0][_0x3831f4(0x187)]==_0x3831f4(0x140))var _0x3bce7a=users[_0x3831f4(0x103)];else{if(_0x4d2a1a[0x0]['language']==_0x3831f4(0x17e))var _0x3bce7a=users['Chinese'];else{if(_0x4d2a1a[0x0][_0x3831f4(0x187)]=='Arabic\x20(ae)')var _0x3bce7a=users[_0x3831f4(0x102)];}}}}}}}_0x5d0613[_0x3831f4(0x17d)](_0x3831f4(0xfe),{'success':_0x9cb7c9['flash'](_0x3831f4(0x157)),'errors':_0x9cb7c9['flash'](_0x3831f4(0x19c)),'role':_0x554898,'profile':_0x41dcc8,'master_shop':_0x4d2a1a,'warehouse':_0x361962,'transfer':_0x2ffe2a,'stock':_0x416d80,'unit':_0x3fa4c9,'language':_0x3bce7a});}catch(_0x409697){console[_0x3831f4(0x174)](_0x409697);}}),router['post'](a0_0x58e264(0x118),auth,async(_0x5c1a5e,_0x36e98c)=>{var _0x316888=a0_0x58e264;try{const _0x191b2e=_0x5c1a5e[_0x316888(0x19b)]['id'];console[_0x316888(0x174)](_0x5c1a5e[_0x316888(0x150)]);const _0xb7160e=await transfers[_0x316888(0xee)](_0x191b2e);console[_0x316888(0x174)](_0x316888(0x193),_0xb7160e);const {date:_0xa5dc2a,from_warehouse:_0x2e8c87,FromRoom_name:_0x3d7e12,to_warehouse:_0x1bea4e,ToRoom_name:_0x3b13f2,prod_name:_0x1c37fe,from_prod_qty:_0x10ea4f,from_prod_level:_0x26c0cb,from_prod_isle:_0x2cf782,from_prod_pallet:_0x36fab2,to_prod_qty:_0x508796,to_prod_level:_0x526a70,to_prod_isle:_0x2844a0,to_prod_pallet:_0x4eb7be,primary_code:_0x12841b,secondary_code:_0x3ff976,product_code3:_0x2da40a,note:_0x2efde3,invoice:_0x792635,expiry_date:_0x3ab948}=_0x5c1a5e['body'];if(typeof _0x1c37fe==_0x316888(0x165))var _0xe992e0=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x147)]],_0x1bdd34=[_0x5c1a5e['body'][_0x316888(0x11c)]],_0xb443d7=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x186)]],_0x532511=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x18c)]],_0x53a08f=[_0x5c1a5e[_0x316888(0x150)]['from_prod_pallet']],_0x3f9fee=[_0x5c1a5e['body'][_0x316888(0x158)]],_0x2ca8e8=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x16a)]],_0x2ff76d=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x132)]],_0x38e932=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x104)]],_0xe6e1db=[_0x5c1a5e['body'][_0x316888(0x146)]],_0x20a0d3=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x170)]],_0x3c05bf=[_0x5c1a5e['body'][_0x316888(0x154)]],_0x475504=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x18d)]],_0x463e22=[_0x5c1a5e[_0x316888(0x150)]['primary_code']],_0x4d69df=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x130)]],_0x1bda54=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x117)]],_0x2750ec=[_0x5c1a5e['body'][_0x316888(0xe6)]],_0x2c607c=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x10d)]],_0xda4af3=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x135)]],_0x5a9c50=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x141)]],_0x48bcaa=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x19f)]],_0x4e3a74=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0x13f)]],_0x44336a=[_0x5c1a5e[_0x316888(0x150)][_0x316888(0xf3)]];else var _0xe992e0=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x147)]],_0x3c05bf=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x154)]],_0x475504=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x18d)]],_0x3f9fee=[..._0x5c1a5e['body'][_0x316888(0x158)]],_0x20a0d3=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x170)]],_0x1bdd34=[..._0x5c1a5e['body'][_0x316888(0x11c)]],_0xb443d7=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x186)]],_0x532511=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x18c)]],_0x53a08f=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x136)]],_0x2ca8e8=[..._0x5c1a5e['body'][_0x316888(0x16a)]],_0x2ff76d=[..._0x5c1a5e[_0x316888(0x150)]['to_prod_level']],_0x38e932=[..._0x5c1a5e[_0x316888(0x150)]['to_prod_isle']],_0xe6e1db=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x146)]],_0x463e22=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x173)]],_0x4d69df=[..._0x5c1a5e['body'][_0x316888(0x130)]],_0x1bda54=[..._0x5c1a5e[_0x316888(0x150)]['product_code3']],_0x2750ec=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0xe6)]],_0x2c607c=[..._0x5c1a5e['body'][_0x316888(0x10d)]],_0xda4af3=[..._0x5c1a5e[_0x316888(0x150)]['secondary_unit']],_0x5a9c50=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0x141)]],_0x48bcaa=[..._0x5c1a5e['body'][_0x316888(0x19f)]],_0x4e3a74=[..._0x5c1a5e[_0x316888(0x150)]['from_storage']],_0x44336a=[..._0x5c1a5e[_0x316888(0x150)][_0x316888(0xf3)]];const _0x42d52d=_0xe992e0[_0x316888(0xec)](_0x47380b=>{return _0x47380b={'product_name':_0x47380b};});_0x1bdd34[_0x316888(0x137)]((_0x20e533,_0x6f3775)=>{var _0x26fc61=_0x316888;_0x42d52d[_0x6f3775][_0x26fc61(0xf1)]=_0x20e533;}),_0xb443d7[_0x316888(0x137)]((_0x235070,_0x39c7f6)=>{_0x42d52d[_0x39c7f6]['from_bay']=_0x235070;}),_0x532511[_0x316888(0x137)]((_0x2d07be,_0x168cb4)=>{_0x42d52d[_0x168cb4]['from_bin']=_0x2d07be;}),_0x53a08f[_0x316888(0x137)]((_0x1060e2,_0x3c0a4d)=>{var _0xa9ab70=_0x316888;_0x42d52d[_0x3c0a4d][_0xa9ab70(0x133)]=_0x1060e2;}),_0x2ca8e8[_0x316888(0x137)]((_0x5daf83,_0x42f2e7)=>{var _0x452a5c=_0x316888;_0x42d52d[_0x42f2e7][_0x452a5c(0xf0)]=_0x5daf83;}),_0x2ff76d[_0x316888(0x137)]((_0x4e452c,_0x32fb25)=>{var _0x33e45a=_0x316888;_0x42d52d[_0x32fb25][_0x33e45a(0x144)]=_0x4e452c;}),_0x38e932[_0x316888(0x137)]((_0x3b43ba,_0xf101f3)=>{var _0x4442a9=_0x316888;_0x42d52d[_0xf101f3][_0x4442a9(0x105)]=_0x3b43ba;}),_0xe6e1db[_0x316888(0x137)]((_0x5947a3,_0x1ea4da)=>{var _0x221c2=_0x316888;_0x42d52d[_0x1ea4da][_0x221c2(0x14a)]=_0x5947a3;}),_0x463e22[_0x316888(0x137)]((_0x3e1342,_0x219187)=>{var _0x2ead02=_0x316888;_0x42d52d[_0x219187][_0x2ead02(0x173)]=_0x3e1342;}),_0x4d69df['forEach']((_0x4d0e30,_0x1f8bed)=>{_0x42d52d[_0x1f8bed]['secondary_code']=_0x4d0e30;}),_0x1bda54[_0x316888(0x137)]((_0x56d596,_0x293980)=>{var _0x230e16=_0x316888;_0x42d52d[_0x293980][_0x230e16(0x155)]=_0x56d596;}),_0x2750ec[_0x316888(0x137)]((_0x56aaaf,_0x5a2db1)=>{var _0x4bfa37=_0x316888;_0x42d52d[_0x5a2db1][_0x4bfa37(0xfd)]=_0x56aaaf;}),_0x2c607c[_0x316888(0x137)]((_0x4e7375,_0x3a7537)=>{var _0x290486=_0x316888;_0x42d52d[_0x3a7537][_0x290486(0x10d)]=_0x4e7375;}),_0xda4af3['forEach']((_0x2e3e7d,_0x1c9a27)=>{_0x42d52d[_0x1c9a27]['secondary_unit']=_0x2e3e7d;}),_0x5a9c50['forEach']((_0x596e5d,_0x3597fe)=>{var _0x4414dc=_0x316888;_0x42d52d[_0x3597fe][_0x4414dc(0x141)]=_0x596e5d;}),_0x48bcaa[_0x316888(0x137)]((_0x1938e4,_0x4bbe70)=>{var _0x4e4c07=_0x316888;_0x42d52d[_0x4bbe70][_0x4e4c07(0x19f)]=_0x1938e4;}),_0x3c05bf[_0x316888(0x137)]((_0x1c9b1f,_0x38f495)=>{var _0xb236fb=_0x316888;_0x42d52d[_0x38f495][_0xb236fb(0x154)]=_0x1c9b1f;}),_0x475504[_0x316888(0x137)]((_0x4121fd,_0x3aef3b)=>{_0x42d52d[_0x3aef3b]['rack']=_0x4121fd;}),_0x3f9fee[_0x316888(0x137)]((_0x2994f9,_0x211b02)=>{var _0x4e4f15=_0x316888;_0x42d52d[_0x211b02][_0x4e4f15(0x158)]=_0x2994f9;}),_0x20a0d3[_0x316888(0x137)]((_0x3be2c8,_0x438375)=>{var _0x260d1f=_0x316888;_0x42d52d[_0x438375][_0x260d1f(0x170)]=_0x3be2c8;}),_0x4e3a74[_0x316888(0x137)]((_0x253354,_0x777967)=>{var _0x2984bf=_0x316888;_0x42d52d[_0x777967][_0x2984bf(0x13f)]=_0x253354;}),_0x44336a[_0x316888(0x137)]((_0x54e90f,_0x49834b)=>{var _0x577085=_0x316888;_0x42d52d[_0x49834b][_0x577085(0x191)]=_0x54e90f;});const _0x3ce1df=_0x42d52d[_0x316888(0xf7)](_0x42914e=>_0x42914e[_0x316888(0xf0)]!=='0'&&_0x42914e[_0x316888(0xf0)]!==''||_0x42914e[_0x316888(0x14a)]!=='0'&&_0x42914e[_0x316888(0x14a)]!=='');var _0x22ef42=0x0;_0x3ce1df[_0x316888(0x137)](_0x282d3e=>{var _0x17a61d=_0x316888;parseInt(_0x282d3e[_0x17a61d(0xf1)])<parseInt(_0x282d3e[_0x17a61d(0xf0)])&&_0x22ef42++;});if(_0x22ef42!=0x0)return _0x5c1a5e[_0x316888(0x113)]('errors','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x36e98c[_0x316888(0x19e)]('back');const _0x1f7538=await warehouse['findOne']({'name':_0xb7160e[_0x316888(0x18a)],'room':_0xb7160e['from_room']});_0xb7160e[_0x316888(0x10e)][_0x316888(0x137)](_0x20c43c=>{var _0x671e79=_0x316888;if(_0x20c43c[_0x671e79(0xf0)]>0x0){const _0x952774=_0x1f7538[_0x671e79(0x185)]['map'](_0x26aeaf=>{var _0x12f2df=_0x671e79;_0x26aeaf[_0x12f2df(0x11a)]==_0x20c43c[_0x12f2df(0x11a)]&&_0x26aeaf[_0x12f2df(0xef)]==_0x20c43c[_0x12f2df(0x133)]&&_0x26aeaf[_0x12f2df(0xe0)]==_0x20c43c['from_types']&&_0x26aeaf[_0x12f2df(0x181)]==_0x20c43c[_0x12f2df(0x107)]&&_0x26aeaf[_0x12f2df(0x16d)]==_0x20c43c['from_bay']&&_0x26aeaf[_0x12f2df(0x145)]==_0x20c43c['from_rack']&&_0x26aeaf[_0x12f2df(0x154)]==_0x20c43c[_0x12f2df(0x13f)]&&(_0x26aeaf[_0x12f2df(0x11f)]=parseInt(_0x26aeaf[_0x12f2df(0x11f)])+parseInt(_0x20c43c[_0x12f2df(0xf0)]));});}}),await _0x1f7538[_0x316888(0x198)]();const _0x1d1b22=await warehouse['findOne']({'name':_0xb7160e[_0x316888(0x12b)],'room':_0xb7160e[_0x316888(0x125)]});_0xb7160e['product'][_0x316888(0x137)](_0x3e8105=>{var _0x2a9324=_0x316888;if(_0x3e8105['to_quantity']>0x0){const _0x4c3148=_0x1d1b22[_0x2a9324(0x185)][_0x2a9324(0xec)](_0x4fceec=>{var _0x2515f=_0x2a9324;_0x4fceec[_0x2515f(0x11a)]==_0x3e8105[_0x2515f(0x11a)]&&_0x4fceec[_0x2515f(0xef)]==_0x3e8105[_0x2515f(0x14a)]&&_0x4fceec[_0x2515f(0xe0)]==_0x3e8105[_0x2515f(0x170)]&&_0x4fceec[_0x2515f(0x181)]==_0x3e8105['to_bin']&&_0x4fceec[_0x2515f(0x16d)]==_0x3e8105['to_bay']&&_0x4fceec[_0x2515f(0x145)]==_0x3e8105[_0x2515f(0x145)]&&_0x4fceec[_0x2515f(0x154)]==_0x3e8105[_0x2515f(0x154)]&&(_0x4fceec[_0x2515f(0x11f)]=parseInt(_0x4fceec['product_stock'])-parseInt(_0x3e8105[_0x2515f(0xf0)]));});}}),await _0x1d1b22['save'](),_0xb7160e[_0x316888(0x139)]=_0xa5dc2a,_0xb7160e[_0x316888(0x18a)]=_0x2e8c87,_0xb7160e[_0x316888(0x12b)]=_0x1bea4e,_0xb7160e['product']=_0x3ce1df,_0xb7160e['note']=_0x2efde3,_0xb7160e[_0x316888(0x11e)]=_0x792635;const _0x374763=await _0xb7160e[_0x316888(0x198)]();console['log'](_0x374763);const _0x5519ff=await warehouse[_0x316888(0x19d)]({'name':_0x2e8c87,'room':_0x3d7e12});_0x374763[_0x316888(0x10e)]['forEach'](_0x4aa694=>{var _0x318042=_0x316888;if(_0x4aa694[_0x318042(0xf0)]>0x0){const _0x38e7fd=_0x5519ff[_0x318042(0x185)][_0x318042(0xec)](_0x27169b=>{var _0x374c79=_0x318042;_0x27169b[_0x374c79(0x11a)]==_0x4aa694[_0x374c79(0x11a)]&&_0x27169b['floorlevel']==_0x4aa694[_0x374c79(0x133)]&&_0x27169b[_0x374c79(0xe0)]==_0x4aa694[_0x374c79(0x158)]&&_0x27169b[_0x374c79(0x181)]==_0x4aa694[_0x374c79(0x107)]&&_0x27169b[_0x374c79(0x16d)]==_0x4aa694[_0x374c79(0x13e)]&&_0x27169b['rack']==_0x4aa694['from_rack']&&_0x27169b[_0x374c79(0x154)]==_0x4aa694['from_storage']&&(_0x27169b[_0x374c79(0x11f)]=parseInt(_0x27169b[_0x374c79(0x11f)])-parseInt(_0x4aa694['to_quantity']));});}}),await _0x5519ff[_0x316888(0x198)]();const _0x2482e8=await warehouse[_0x316888(0x19d)]({'name':_0x1bea4e,'room':_0x3b13f2});_0x374763[_0x316888(0x10e)][_0x316888(0x137)](_0xacb479=>{var _0x3701df=_0x316888;if(_0xacb479['to_quantity']>0x0){var _0x1be112=0x0;const _0x5f5af2=_0x2482e8[_0x3701df(0x185)][_0x3701df(0xec)](_0x15a4ff=>{var _0x32b48b=_0x3701df;_0x15a4ff[_0x32b48b(0x11a)]==_0xacb479['product_name']&&_0x15a4ff[_0x32b48b(0xef)]==_0xacb479[_0x32b48b(0x14a)]&&_0x15a4ff[_0x32b48b(0xe0)]==_0xacb479[_0x32b48b(0x170)]&&_0x15a4ff[_0x32b48b(0x181)]==_0xacb479[_0x32b48b(0x105)]&&_0x15a4ff[_0x32b48b(0x16d)]==_0xacb479['to_bay']&&_0x15a4ff['rack']==_0xacb479[_0x32b48b(0x145)]&&_0x15a4ff[_0x32b48b(0x154)]==_0xacb479[_0x32b48b(0x154)]&&(_0x15a4ff[_0x32b48b(0x11f)]=parseInt(_0x15a4ff[_0x32b48b(0x11f)])+parseInt(_0xacb479[_0x32b48b(0xf0)]),_0x1be112++);});_0x1be112=='0'&&(_0x2482e8['product_details']=_0x2482e8['product_details'][_0x3701df(0x134)]({'product_name':_0xacb479['product_name'],'product_stock':_0xacb479[_0x3701df(0xf0)],'bay':_0xacb479[_0x3701df(0x144)],'bin':_0xacb479[_0x3701df(0x105)],'type':_0xacb479['to_types'],'floorlevel':_0xacb479[_0x3701df(0x14a)],'storage':_0xacb479[_0x3701df(0x154)],'rack':_0xacb479[_0x3701df(0x145)],'product_code':_0xacb479[_0x3701df(0x155)],'primary_code':_0xacb479[_0x3701df(0x173)],'secondary_code':_0xacb479[_0x3701df(0x130)],'maxProducts':_0xacb479[_0x3701df(0xfd)],'storage':_0xacb479[_0x3701df(0x154)],'rack':_0xacb479[_0x3701df(0x145)]}));}}),await _0x2482e8[_0x316888(0x198)](),_0x5c1a5e[_0x316888(0x113)](_0x316888(0x157),_0x316888(0x110)),_0x36e98c[_0x316888(0x19e)](_0x316888(0x116));}catch(_0x3765c0){console[_0x316888(0x174)](_0x3765c0);}}),router['post'](a0_0x58e264(0x14e),async(_0x943589,_0x324c07)=>{var _0x68a9ee=a0_0x58e264;const {FromWareHouse:_0x1744f3,FromRoom:_0x2c9112,ToWarehouse:_0x373286,ToRoom:_0x502212,primary_code:_0x48a95c,Roomslist:_0x4f6a83}=_0x943589[_0x68a9ee(0x150)],_0x1804f1=_0x4f6a83[_0x68a9ee(0x131)](','),_0x24a2d0=[];async function _0x3af1be(_0x23474e){var _0x26681f=_0x68a9ee;const _0x5c9e40=await warehouse[_0x26681f(0x15b)]([{'$match':{'name':_0x1744f3,'room':_0x23474e}},{'$unwind':_0x26681f(0x122)},{'$match':{'product_details.primary_code':_0x48a95c}},{'$group':{'_id':_0x26681f(0x18e),'name':{'$first':_0x26681f(0x120)},'instock':{'$first':'$product_details.product_stock'},'primary_code':{'$first':_0x26681f(0x15a)},'secondary_code':{'$first':_0x26681f(0x16c)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x26681f(0xe9)},'isle':{'$first':_0x26681f(0x164)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x26681f(0x14f)},'unit':{'$first':_0x26681f(0x190)},'secondary_unit':{'$first':_0x26681f(0x183)},'storage':{'$first':_0x26681f(0x16f)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x26681f(0x153)},'batch_code':{'$first':'$product_details.batch_code'},'maxPerUnit':{'$first':_0x26681f(0x169)},'prod_cat':{'$first':'P'},'roomNamed':{'$first':'$room'},'maxProducts':{'$first':_0x26681f(0x156)}}}]),_0x32b973=await warehouse[_0x26681f(0x15b)]([{'$match':{'name':_0x1744f3,'room':_0x23474e}},{'$unwind':_0x26681f(0x122)},{'$match':{'product_details.secondary_code':_0x48a95c}},{'$group':{'_id':_0x26681f(0x18e),'name':{'$first':_0x26681f(0x120)},'instock':{'$first':_0x26681f(0x11d)},'primary_code':{'$first':_0x26681f(0x15a)},'secondary_code':{'$first':_0x26681f(0x16c)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.bay'},'isle':{'$first':_0x26681f(0x164)},'type':{'$first':_0x26681f(0x151)},'pallet':{'$first':_0x26681f(0x14f)},'unit':{'$first':_0x26681f(0x190)},'secondary_unit':{'$first':_0x26681f(0x183)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x26681f(0x115)},'expiry_date':{'$first':_0x26681f(0x127)},'production_date':{'$first':_0x26681f(0x153)},'batch_code':{'$first':_0x26681f(0x14c)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'prod_cat':{'$first':'S'},'roomNamed':{'$first':_0x26681f(0x106)},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);if(_0x5c9e40[_0x26681f(0x143)]>0x0)_0x24a2d0['push'](_0x5c9e40);else _0x32b973[_0x26681f(0x143)]>0x0&&_0x24a2d0[_0x26681f(0x13b)](_0x32b973);}const _0x21a18d=_0x1804f1[_0x68a9ee(0xec)](_0x29fb19=>_0x3af1be(_0x29fb19));await Promise[_0x68a9ee(0x194)](_0x21a18d),_0x324c07[_0x68a9ee(0x199)](_0x24a2d0);}),router['post']('/barcode_scanner2',async(_0x540e87,_0x162d85)=>{var _0x35e711=a0_0x58e264;try{const {FromWareHouse:_0x40b9d3,FromRoom:_0x5b8a11,ToWarehouse:_0x32910e,ToRoom:_0x32a9b7,secondary_code:_0x2b2c65}=_0x540e87[_0x35e711(0x150)],_0x449bc3=await warehouse['aggregate']([{'$match':{'name':_0x40b9d3}},{'$unwind':_0x35e711(0x122)},{'$match':{'product_details.secondary_code':_0x2b2c65}},{'$group':{'_id':_0x35e711(0x18e),'name':{'$first':_0x35e711(0x120)},'primary_code':{'$first':_0x35e711(0x15a)},'secondary_code':{'$first':_0x35e711(0x16c)},'product_code':{'$first':_0x35e711(0x126)},'instock':{'$first':_0x35e711(0x11d)},'warehouse':{'$first':'$name'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x35e711(0x184)},'pallet':{'$first':_0x35e711(0xfb)},'maxProducts':{'$first':_0x35e711(0x156)},'unit':{'$first':_0x35e711(0x190)}}}]);_0x162d85[_0x35e711(0x18f)](0xc8)[_0x35e711(0x199)](_0x449bc3);}catch(_0x27fc3b){_0x162d85[_0x35e711(0x18f)](0x194)['json']({'message':_0x27fc3b[_0x35e711(0xe3)]});}}),router[a0_0x58e264(0x142)](a0_0x58e264(0x15c),async(_0x426410,_0x4a2efe)=>{var _0xb42c0b=a0_0x58e264;try{const {FromWareHouse:_0x27e49d,FromRoom:_0x424580,ToWarehouse:_0x38a404,ToRoom:_0x49e63e,product_code:_0x5d2d22}=_0x426410[_0xb42c0b(0x150)],_0x3e1a27=await warehouse[_0xb42c0b(0x15b)]([{'$match':{'name':_0x27e49d}},{'$unwind':_0xb42c0b(0x122)},{'$match':{'product_details.product_code':_0x5d2d22}},{'$group':{'_id':_0xb42c0b(0x18e),'name':{'$first':_0xb42c0b(0x120)},'primary_code':{'$first':_0xb42c0b(0x15a)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'instock':{'$first':_0xb42c0b(0x11d)},'warehouse':{'$first':_0xb42c0b(0xe1)},'level':{'$first':_0xb42c0b(0x196)},'isle':{'$first':_0xb42c0b(0x184)},'pallet':{'$first':_0xb42c0b(0xfb)},'maxProducts':{'$first':_0xb42c0b(0x156)},'unit':{'$first':_0xb42c0b(0x190)}}}]);_0x4a2efe[_0xb42c0b(0x18f)](0xc8)[_0xb42c0b(0x199)](_0x3e1a27);}catch(_0x156bdd){_0x4a2efe['status'](0x194)[_0xb42c0b(0x199)]({'message':_0x156bdd['message']});}}),router['post']('/CheckingWarehouse',async(_0x5c6a17,_0x16de65)=>{var _0x368038=a0_0x58e264;const {level:_0x2e2239,isle:_0x36be1a,pallet:_0x33b8c6,warehouses:_0x3de1e9,room:_0x35474f}=_0x5c6a17[_0x368038(0x150)];try{const _0x3e16b7=await warehouse[_0x368038(0x15b)]([{'$match':{'name':_0x3de1e9,'room':_0x35474f}},{'$unwind':'$product_details'},{'$match':{'product_details.level':parseInt(_0x2e2239),'product_details.isle':_0x36be1a,'product_details.pallet':parseInt(_0x33b8c6)}},{'$group':{'_id':_0x368038(0x18e),'name':{'$first':_0x368038(0x120)},'product_stock':{'$first':_0x368038(0x11d)},'level':{'$first':'$product_details.level'},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'maxProducts':{'$first':'$product_details.maxProducts'}}}]);_0x16de65[_0x368038(0x18f)](0xc8)[_0x368038(0x199)](_0x3e16b7);}catch(_0x2e7879){_0x16de65[_0x368038(0x18f)](0x194)[_0x368038(0x199)]({'message':_0x2e7879[_0x368038(0xe3)]});}}),module[a0_0x58e264(0xf9)]=router;