var a0_0x6b8f7e=a0_0x5277;(function(_0x295e53,_0x382743){var _0x1e394d=a0_0x5277,_0x456f31=_0x295e53();while(!![]){try{var _0x418c81=parseInt(_0x1e394d(0x1e8))/0x1*(-parseInt(_0x1e394d(0x1e9))/0x2)+parseInt(_0x1e394d(0x1e1))/0x3+-parseInt(_0x1e394d(0x1d6))/0x4*(parseInt(_0x1e394d(0x1fe))/0x5)+-parseInt(_0x1e394d(0x1b0))/0x6*(parseInt(_0x1e394d(0x1f4))/0x7)+-parseInt(_0x1e394d(0x1cd))/0x8*(parseInt(_0x1e394d(0x1ed))/0x9)+-parseInt(_0x1e394d(0x1ff))/0xa+-parseInt(_0x1e394d(0x19c))/0xb*(-parseInt(_0x1e394d(0x1df))/0xc);if(_0x418c81===_0x382743)break;else _0x456f31['push'](_0x456f31['shift']());}catch(_0x2201ac){_0x456f31['push'](_0x456f31['shift']());}}}(a0_0x114b,0x4f05c));function a0_0x5277(_0x9ce068,_0x3d1e6f){var _0x114be3=a0_0x114b();return a0_0x5277=function(_0x527793,_0x497491){_0x527793=_0x527793-0x18a;var _0x999085=_0x114be3[_0x527793];return _0x999085;},a0_0x5277(_0x9ce068,_0x3d1e6f);}function a0_0x114b(){var _0x466939=['Arabic','forEach','28GhlplN','aggregate','status','Portuguese\x20(BR)','secondary_code','bay','map','Enabled','due_amount','/invoice/:id','103935WrrJTg','2162560TThvzH','string','new\x20new_data','c_payment','Hindi','log','product_details','master','primary_code','invoice','product_code_QA','$product_details.primary_code','json','Portuguese','/view/:id','$product_details.bin','English','Router','findOne','bin','paid_amount','redirect','11VEbKbN','get','save','subtract','purchase\x20return\x20successfully','note','customer_docs','email','render','return_sale_edit_finished','message','../public/language/languages.json','English\x20(US)','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','sale_qty','Returned\x20Payment\x20For\x20Sale\x20Return','ToRoom','flash','find','stocks','615012marnBM','French','return_sale','sales_return_invoice','params','data','$product_details.secondary_code','Arabic\x20(ae)','QA\x20Warehouse','body','primary_code_QA','for_categorize','express','/sales_return/view','findById','$product_details.bay','slice','return_qty','Sale\x20Return','return_sale_QA','$product_details.product_stock','errors','$customer_docs','product_name','ToWarehouse','warehouse_name','secondary_code_QA','$product_details.storage','foreach\x20newproduct','8lgaSYV','old_data','floorlevel','Chinese','payment\x20successfull','Spanish','sales_quantity','types','name','4VaFaXJ','post','stock','language','customer','/sales_return_finished/view','product_code','Return\x20Rooms','product_stock','7868472ZGfhWd','getFullYear','1820487MvlJtL','German','type','success','return_qty_QA','back','stocks_QA','3JcHSLF','178484WuFfIQ','$name','old_warehouse_data','date','216738ZkbirL','sales_quantity_QA','suppliers','user','$product_details.product_name'];a0_0x114b=function(){return _0x466939;};return a0_0x114b();}const express=require(a0_0x6b8f7e(0x1bc)),app=express(),router=express[a0_0x6b8f7e(0x197)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require('../middleware/auth'),users=require(a0_0x6b8f7e(0x1a7));router['get']('/view',auth,async(_0x42999d,_0x234fdd)=>{var _0x32a8ad=a0_0x6b8f7e;try{const {username:_0x2d3881,email:_0x2d0d59,role:_0x25c236}=_0x42999d['user'],_0x32f42d=_0x42999d['user'],_0x5c0ed9=await profile[_0x32a8ad(0x198)]({'email':_0x32f42d['email']}),_0x2d0c1a=await master_shop[_0x32a8ad(0x1ae)](),_0x3ea1a1=await sales_return_finished[_0x32a8ad(0x1f5)]([{'$lookup':{'from':'customers','localField':_0x32a8ad(0x1da),'foreignField':_0x32a8ad(0x1d5),'as':_0x32a8ad(0x1a2)}},{'$unwind':_0x32a8ad(0x1c6)}]);if(_0x2d0c1a[0x0]['language']=='English\x20(US)'){var _0x1cb9ab=users[_0x32a8ad(0x196)];console[_0x32a8ad(0x18b)](_0x1cb9ab);}else{if(_0x2d0c1a[0x0]['language']==_0x32a8ad(0x18a))var _0x1cb9ab=users[_0x32a8ad(0x18a)];else{if(_0x2d0c1a[0x0][_0x32a8ad(0x1d9)]==_0x32a8ad(0x1e2))var _0x1cb9ab=users[_0x32a8ad(0x1e2)];else{if(_0x2d0c1a[0x0]['language']==_0x32a8ad(0x1d2))var _0x1cb9ab=users[_0x32a8ad(0x1d2)];else{if(_0x2d0c1a[0x0]['language']==_0x32a8ad(0x1b1))var _0x1cb9ab=users[_0x32a8ad(0x1b1)];else{if(_0x2d0c1a[0x0][_0x32a8ad(0x1d9)]==_0x32a8ad(0x1f7))var _0x1cb9ab=users['Portuguese'];else{if(_0x2d0c1a[0x0][_0x32a8ad(0x1d9)]==_0x32a8ad(0x1d0))var _0x1cb9ab=users[_0x32a8ad(0x1d0)];else{if(_0x2d0c1a[0x0][_0x32a8ad(0x1d9)]==_0x32a8ad(0x1b7))var _0x1cb9ab=users['Arabic'];}}}}}}}_0x234fdd[_0x32a8ad(0x1a4)]('sales_return_finished',{'success':_0x42999d[_0x32a8ad(0x1ad)](_0x32a8ad(0x1e4)),'errors':_0x42999d[_0x32a8ad(0x1ad)]('errors'),'role':_0x32f42d,'profile':_0x5c0ed9,'master_shop':_0x2d0c1a,'user':_0x3ea1a1,'language':_0x1cb9ab});}catch(_0x4027e2){console[_0x32a8ad(0x18b)](_0x4027e2);}}),router[a0_0x6b8f7e(0x19d)](a0_0x6b8f7e(0x194),auth,async(_0x25922,_0x4127ee)=>{var _0x5df5b4=a0_0x6b8f7e;try{const {username:_0x5daf1f,email:_0x521eb8,role:_0x47a01f}=_0x25922[_0x5df5b4(0x1f0)],_0x22e4c1=_0x25922[_0x5df5b4(0x1f0)],_0x2ac8bb=await profile[_0x5df5b4(0x198)]({'email':_0x22e4c1[_0x5df5b4(0x1a3)]}),_0x17bda8=await master_shop[_0x5df5b4(0x1ae)]();console['log']('master',_0x17bda8);const _0x32a634=_0x25922['params']['id'];console[_0x5df5b4(0x18b)](_0x32a634);var _0x423ab7=[_0x5df5b4(0x1dd)];const _0x4f3682=await sales_return_finished[_0x5df5b4(0x1be)](_0x32a634),_0x45822d=await warehouse[_0x5df5b4(0x1f5)]([{'$match':{'name':_0x4f3682[_0x5df5b4(0x1c8)],'room':_0x4f3682[_0x5df5b4(0x1ac)]}},{'$unwind':'$product_details'},{'$group':{'_id':'$product_details._id','name':{'$first':_0x5df5b4(0x1f1)},'product_stock':{'$first':_0x5df5b4(0x1c4)},'bay':{'$first':_0x5df5b4(0x1bf)},'bin':{'$first':_0x5df5b4(0x195)},'type':{'$first':'$product_details.type'},'floorlevel':{'$first':'$product_details.floorlevel'},'primary_code':{'$first':_0x5df5b4(0x191)},'secondary_code':{'$first':_0x5df5b4(0x1b6)},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':_0x5df5b4(0x1cb)},'rack':{'$first':'$product_details.rack'}}}]);console[_0x5df5b4(0x18b)](_0x45822d);const _0x570156=await warehouse['aggregate']([{'$match':{'status':'Enabled','warehouse_category':'Finished\x20Goods'}},{'$group':{'_id':_0x5df5b4(0x1ea),'name':{'$first':_0x5df5b4(0x1ea)}}},{'$sort':{'name':0x1}}]),_0xa32edd=await warehouse[_0x5df5b4(0x1f5)]([{'$match':{'status':_0x5df5b4(0x1fb),'name':_0x5df5b4(0x1b8)}},{'$group':{'_id':_0x5df5b4(0x1ea),'name':{'$first':_0x5df5b4(0x1ea)}}},{'$sort':{'name':0x1}}]),_0x21b5ea=await product[_0x5df5b4(0x1ae)]({});if(_0x17bda8[0x0][_0x5df5b4(0x1d9)]==_0x5df5b4(0x1a8)){var _0x5c1c36=users['English'];console[_0x5df5b4(0x18b)](_0x5c1c36);}else{if(_0x17bda8[0x0][_0x5df5b4(0x1d9)]==_0x5df5b4(0x18a))var _0x5c1c36=users[_0x5df5b4(0x18a)];else{if(_0x17bda8[0x0]['language']==_0x5df5b4(0x1e2))var _0x5c1c36=users[_0x5df5b4(0x1e2)];else{if(_0x17bda8[0x0][_0x5df5b4(0x1d9)]==_0x5df5b4(0x1d2))var _0x5c1c36=users['Spanish'];else{if(_0x17bda8[0x0][_0x5df5b4(0x1d9)]==_0x5df5b4(0x1b1))var _0x5c1c36=users['French'];else{if(_0x17bda8[0x0][_0x5df5b4(0x1d9)]==_0x5df5b4(0x1f7))var _0x5c1c36=users['Portuguese'];else{if(_0x17bda8[0x0]['language']==_0x5df5b4(0x1d0))var _0x5c1c36=users[_0x5df5b4(0x1d0)];else{if(_0x17bda8[0x0][_0x5df5b4(0x1d9)]==_0x5df5b4(0x1b7))var _0x5c1c36=users[_0x5df5b4(0x1f2)];}}}}}}}_0x4127ee[_0x5df5b4(0x1a4)](_0x5df5b4(0x1a5),{'success':_0x25922[_0x5df5b4(0x1ad)]('success'),'errors':_0x25922[_0x5df5b4(0x1ad)]('errors'),'role':_0x22e4c1,'profile':_0x2ac8bb,'master_shop':_0x17bda8,'user':_0x4f3682,'stock':_0x45822d,'unit':_0x21b5ea,'language':_0x5c1c36,'warehouses':_0x570156,'rooms':_0x423ab7,'warehouse_QA':_0xa32edd});}catch(_0x32dfa3){console[_0x5df5b4(0x18b)](_0x32dfa3);}}),router[a0_0x6b8f7e(0x1d7)](a0_0x6b8f7e(0x194),auth,async(_0x5070d6,_0x36f4f5)=>{var _0x35727d=a0_0x6b8f7e;if(_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1bb)]=='QA')try{const _0x5a796f=_0x5070d6[_0x35727d(0x1b4)]['id'],_0x7797b1=await sales_return[_0x35727d(0x198)]({'invoice':_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x18f)]}),_0x239af0=await warehouse[_0x35727d(0x198)]({'name':_0x7797b1[_0x35727d(0x1c8)],'room':_0x7797b1[_0x35727d(0x1ac)]}),{invoice:_0x37d1c5,customer:_0x24ec5a,date:_0x3723d3,warehouse_name:_0x4ec560,product_name:_0x4658b5,primary_code:_0x294729,secondary_code:_0x23a1fe,product_code:_0x1f7ef0,sales_quantity:_0x2a9b22,stocks:_0x399114,return_qty:_0x251b40,note:_0x1038f3,to_warehouse_name_QA:_0x8b0ff,to_Room_name_QA:_0x7026c9}=_0x5070d6[_0x35727d(0x1b9)];if(typeof product_name_QA=='string')var _0xad7b0e=[_0x5070d6[_0x35727d(0x1b9)]['product_name_QA']],_0x410ff3=[_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1ba)]],_0x505d7f=[_0x5070d6[_0x35727d(0x1b9)]['secondary_code_QA']],_0x7e77a8=[_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x190)]],_0x51b2ea=[_0x5070d6['body'][_0x35727d(0x1ee)]],_0x11ad6=[_0x5070d6[_0x35727d(0x1b9)]['stocks_QA']],_0x8042e2=[_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1e5)]];else var _0xad7b0e=[..._0x5070d6['body']['product_name_QA']],_0x410ff3=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1ba)]],_0x505d7f=[..._0x5070d6['body'][_0x35727d(0x1ca)]],_0x7e77a8=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x190)]],_0x51b2ea=[..._0x5070d6['body']['sales_quantity_QA']],_0x11ad6=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1e7)]],_0x8042e2=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1e5)]];const _0x2de555=_0xad7b0e['map'](_0x2d8ceb=>{return _0x2d8ceb={'product_name':_0x2d8ceb};});_0x410ff3[_0x35727d(0x1f3)]((_0x2f3256,_0x86ac91)=>{var _0x1a2b48=_0x35727d;_0x2de555[_0x86ac91][_0x1a2b48(0x18e)]=_0x2f3256;}),_0x505d7f[_0x35727d(0x1f3)]((_0x5295fe,_0x39fb9b)=>{var _0x4fc858=_0x35727d;_0x2de555[_0x39fb9b][_0x4fc858(0x1f8)]=_0x5295fe;}),_0x7e77a8['forEach']((_0x584e36,_0x20dc36)=>{_0x2de555[_0x20dc36]['product_code']=_0x584e36;}),_0x51b2ea[_0x35727d(0x1f3)]((_0x5b4bc9,_0x19f625)=>{var _0x192513=_0x35727d;_0x2de555[_0x19f625][_0x192513(0x1aa)]=_0x5b4bc9;}),_0x11ad6[_0x35727d(0x1f3)]((_0x581880,_0x3aea44)=>{_0x2de555[_0x3aea44]['stock']=_0x581880;}),_0x8042e2[_0x35727d(0x1f3)]((_0xed384e,_0x1b8354)=>{_0x2de555[_0x1b8354]['return_qty']=_0xed384e;}),_0x7797b1[_0x35727d(0x1c3)][_0x35727d(0x1f3)](_0x16c939=>{var _0x1cb095=_0x35727d;const _0x51cb8a=_0x239af0[_0x1cb095(0x18c)][_0x1cb095(0x1fa)](_0x3d44ee=>{var _0x2e6a6c=_0x1cb095;_0x3d44ee[_0x2e6a6c(0x1c7)]==_0x16c939['product_name']&&(_0x3d44ee[_0x2e6a6c(0x1de)]=parseInt(_0x3d44ee[_0x2e6a6c(0x1de)])+parseInt(_0x16c939[_0x2e6a6c(0x1c1)]));});}),await _0x239af0[_0x35727d(0x19e)](),_0x7797b1['invoice']=_0x37d1c5,_0x7797b1[_0x35727d(0x1da)]=_0x24ec5a,_0x7797b1[_0x35727d(0x1ec)]=_0x3723d3,_0x7797b1[_0x35727d(0x1c9)]=_0x4ec560,_0x7797b1[_0x35727d(0x1c3)]=_0x2de555,_0x7797b1[_0x35727d(0x1a1)]=_0x1038f3,_0x7797b1['ToWarehouse']=_0x8b0ff,_0x7797b1[_0x35727d(0x1ac)]=_0x7026c9;const _0x236cfd=await _0x7797b1[_0x35727d(0x19e)](),_0x10f571=await c_payment_data[_0x35727d(0x198)]({'invoice':_0x5070d6[_0x35727d(0x1b9)]['invoice'],'reason':'Sale\x20Return'});_0x10f571['suppliers']=_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1ef)],_0x10f571[_0x35727d(0x1ec)]=_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1ec)],await _0x10f571['save'](),_0x5070d6['flash']('success',_0x35727d(0x1a0)),_0x36f4f5[_0x35727d(0x19b)](_0x35727d(0x1db));}catch(_0x1b0bdb){console[_0x35727d(0x18b)](_0x1b0bdb),_0x36f4f5[_0x35727d(0x1f6)](0xc8)[_0x35727d(0x192)]({'message':_0x1b0bdb['message']});}else try{const _0x4312ae=_0x5070d6[_0x35727d(0x1b4)]['id'];console[_0x35727d(0x18b)](_0x4312ae);const _0x8c7678=await sales_return['findOne']({'invoice':_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x18f)]});console[_0x35727d(0x18b)](_0x35727d(0x1ce),_0x8c7678);const _0x541629=await warehouse[_0x35727d(0x198)]({'name':_0x8c7678[_0x35727d(0x1c8)],'room':_0x8c7678['ToRoom']});console[_0x35727d(0x18b)](_0x35727d(0x1eb),_0x541629);const {invoice:_0x2a43fd,customer:_0x3fc38a,date:_0x4c0006,warehouse_name:_0x261dca,product_name:_0x37bd6a,primary_code:_0x8a56f3,secondary_code:_0x4e43f6,product_code:_0x566715,sales_quantity:_0x5903bf,stocks:_0x48b440,return_qty:_0x19dbfb,note:_0x99b1ba,to_warehouse_name:_0x5ab97a,to_Room_name:_0x496c76}=_0x5070d6[_0x35727d(0x1b9)];console[_0x35727d(0x18b)](_0x5070d6[_0x35727d(0x1b9)]);if(typeof _0x37bd6a==_0x35727d(0x200))var _0xad7b0e=[_0x5070d6['body'][_0x35727d(0x1c7)]],_0x410ff3=[_0x5070d6['body']['primary_code']],_0x505d7f=[_0x5070d6['body']['secondary_code']],_0x7e77a8=[_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1dc)]],_0x51b2ea=[_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1d3)]],_0x11ad6=[_0x5070d6[_0x35727d(0x1b9)]['stocks']],_0x8042e2=[_0x5070d6[_0x35727d(0x1b9)]['return_qty']],_0x13c673=[_0x5070d6['body'][_0x35727d(0x1f9)]],_0x421189=[_0x5070d6['body'][_0x35727d(0x199)]],_0xa8e745=[_0x5070d6[_0x35727d(0x1b9)]['types']],_0x4e59b5=[_0x5070d6['body'][_0x35727d(0x1cf)]];else var _0xad7b0e=[..._0x5070d6[_0x35727d(0x1b9)]['product_name']],_0x410ff3=[..._0x5070d6[_0x35727d(0x1b9)]['primary_code']],_0x505d7f=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1f8)]],_0x7e77a8=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1dc)]],_0x51b2ea=[..._0x5070d6[_0x35727d(0x1b9)]['sales_quantity']],_0x11ad6=[..._0x5070d6['body'][_0x35727d(0x1af)]],_0x8042e2=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1c1)]],_0x13c673=[..._0x5070d6['body'][_0x35727d(0x1f9)]],_0x421189=[..._0x5070d6[_0x35727d(0x1b9)]['bin']],_0xa8e745=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1d4)]],_0x4e59b5=[..._0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1cf)]];const _0x1625e1=_0xad7b0e['map'](_0x13e90d=>{return _0x13e90d={'product_name':_0x13e90d};});_0x410ff3['forEach']((_0x25aff4,_0x58944a)=>{var _0x5bb327=_0x35727d;_0x1625e1[_0x58944a][_0x5bb327(0x18e)]=_0x25aff4;}),_0x505d7f[_0x35727d(0x1f3)]((_0x7098fa,_0x469ce9)=>{var _0xc90470=_0x35727d;_0x1625e1[_0x469ce9][_0xc90470(0x1f8)]=_0x7098fa;}),_0x7e77a8[_0x35727d(0x1f3)]((_0x37b742,_0x5a2930)=>{var _0x13c715=_0x35727d;_0x1625e1[_0x5a2930][_0x13c715(0x1dc)]=_0x37b742;}),_0x51b2ea[_0x35727d(0x1f3)]((_0x2bbe27,_0x519ee9)=>{var _0x25f88b=_0x35727d;_0x1625e1[_0x519ee9][_0x25f88b(0x1aa)]=_0x2bbe27;}),_0x11ad6['forEach']((_0x5ed184,_0x3ffa4a)=>{var _0x53cffe=_0x35727d;_0x1625e1[_0x3ffa4a][_0x53cffe(0x1d8)]=_0x5ed184;}),_0x8042e2[_0x35727d(0x1f3)]((_0xb00729,_0x4d9ca0)=>{var _0x211e96=_0x35727d;_0x1625e1[_0x4d9ca0][_0x211e96(0x1c1)]=_0xb00729;}),_0x13c673[_0x35727d(0x1f3)]((_0x186ef6,_0x58a1bd)=>{var _0x572906=_0x35727d;_0x1625e1[_0x58a1bd][_0x572906(0x1f9)]=_0x186ef6;}),_0x421189['forEach']((_0x447291,_0x5a08ed)=>{_0x1625e1[_0x5a08ed]['bin']=_0x447291;}),_0xa8e745[_0x35727d(0x1f3)]((_0x58cbdc,_0x585786)=>{_0x1625e1[_0x585786]['type']=_0x58cbdc;}),_0x4e59b5['forEach']((_0x5943eb,_0x106246)=>{var _0x5e335f=_0x35727d;_0x1625e1[_0x106246][_0x5e335f(0x1cf)]=_0x5943eb;});var _0x295125=0x0;_0x1625e1[_0x35727d(0x1f3)](_0x123eb8=>{var _0x302468=_0x35727d;console[_0x302468(0x18b)](_0x302468(0x1cc),_0x123eb8),(parseInt(_0x123eb8['sale_qty'])<parseInt(_0x123eb8[_0x302468(0x1c1)])||parseInt(_0x123eb8[_0x302468(0x1d8)])<parseInt(_0x123eb8[_0x302468(0x1c1)])&&parseInt(_0x123eb8[_0x302468(0x1aa)])>parseInt(_0x123eb8[_0x302468(0x1c1)])||parseInt(_0x123eb8[_0x302468(0x1c1)])==0x0)&&_0x295125++;});if(_0x295125!=0x0)return _0x5070d6[_0x35727d(0x1ad)](_0x35727d(0x1c5),_0x35727d(0x1a9)),_0x36f4f5[_0x35727d(0x19b)](_0x35727d(0x1e6));_0x8c7678[_0x35727d(0x1b2)]['forEach'](_0x28a724=>{var _0x1c1471=_0x35727d;const _0x249a5e=_0x541629[_0x1c1471(0x18c)][_0x1c1471(0x1fa)](_0x90654b=>{var _0x21d8ff=_0x1c1471;_0x90654b['product_name']==_0x28a724[_0x21d8ff(0x1c7)]&&_0x90654b[_0x21d8ff(0x1cf)]==_0x28a724[_0x21d8ff(0x1cf)]&&_0x90654b[_0x21d8ff(0x1e3)]==_0x28a724[_0x21d8ff(0x1e3)]&&_0x90654b[_0x21d8ff(0x199)]==_0x28a724['bin']&&_0x90654b['bay']==_0x28a724[_0x21d8ff(0x1f9)]&&(_0x90654b['product_stock']=parseInt(_0x90654b[_0x21d8ff(0x1de)])+parseInt(_0x28a724['return_qty']));});}),console[_0x35727d(0x18b)]('old_warehouse_data',_0x541629),await _0x541629[_0x35727d(0x19e)](),_0x8c7678['invoice']=_0x2a43fd,_0x8c7678[_0x35727d(0x1da)]=_0x3fc38a,_0x8c7678[_0x35727d(0x1ec)]=_0x4c0006,_0x8c7678[_0x35727d(0x1c9)]=_0x261dca,_0x8c7678[_0x35727d(0x1b2)]=_0x1625e1,_0x8c7678[_0x35727d(0x1a1)]=_0x99b1ba,_0x8c7678[_0x35727d(0x1c8)]=_0x5ab97a,_0x8c7678[_0x35727d(0x1ac)]=_0x496c76;const _0x5960a6=await _0x8c7678[_0x35727d(0x19e)]();console['log'](_0x35727d(0x201),_0x5960a6);const _0x1c6784=await c_payment_data[_0x35727d(0x198)]({'invoice':_0x5070d6['body'][_0x35727d(0x18f)],'reason':_0x35727d(0x1c2)});_0x1c6784[_0x35727d(0x1ef)]=_0x5070d6['body'][_0x35727d(0x1ef)],_0x1c6784[_0x35727d(0x1ec)]=_0x5070d6[_0x35727d(0x1b9)][_0x35727d(0x1ec)],await _0x1c6784[_0x35727d(0x19e)](),_0x5070d6[_0x35727d(0x1ad)]('success',_0x35727d(0x1a0)),_0x36f4f5[_0x35727d(0x19b)](_0x35727d(0x1bd));}catch(_0x3c31c2){console['log'](_0x3c31c2),_0x36f4f5[_0x35727d(0x1f6)](0xc8)[_0x35727d(0x192)]({'message':_0x3c31c2[_0x35727d(0x1a6)]});}}),router[a0_0x6b8f7e(0x1d7)]('/give_payment/:id',auth,async(_0x1ba0ce,_0x1d4f2c)=>{var _0x119563=a0_0x6b8f7e;try{const _0x3a6aa1=_0x1ba0ce['params']['id'],{invoice:_0x467321,customer:_0x57d6f8,payable_to_customer:_0x402d74,paid_amount:_0x5cdc5b}=_0x1ba0ce[_0x119563(0x1b9)],_0x4d75a2=await sales_return[_0x119563(0x1be)](_0x3a6aa1);console[_0x119563(0x18b)](_0x119563(0x1b5),_0x4d75a2),console[_0x119563(0x18b)](_0x402d74),console[_0x119563(0x18b)](_0x5cdc5b);var _0x28a16b=_0x402d74-_0x5cdc5b;console['log'](_0x119563(0x19f),_0x28a16b),_0x4d75a2['paid_amount']=parseFloat(_0x5cdc5b)+parseFloat(_0x4d75a2[_0x119563(0x19a)]),_0x4d75a2[_0x119563(0x1fc)]=_0x28a16b,console[_0x119563(0x18b)](_0x4d75a2);const _0x344dbe=await _0x4d75a2['save']();console[_0x119563(0x18b)](0x1b207);const _0x3c3d0e=await c_payment_data['findOne']({'invoice':_0x1ba0ce['body']['invoice'],'reason':_0x119563(0x1c2)});console[_0x119563(0x18b)](_0x119563(0x202),_0x3c3d0e),_0x3c3d0e['amount']=_0x28a16b,await _0x3c3d0e[_0x119563(0x19e)]();let _0x1dd1eb=new Date(),_0x63dbe6=('0'+_0x1dd1eb['getDate']())[_0x119563(0x1c0)](-0x2),_0x23428b=('0'+(_0x1dd1eb['getMonth']()+0x1))[_0x119563(0x1c0)](-0x2),_0x2034c5=_0x1dd1eb[_0x119563(0x1e0)](),_0x4243a0=_0x2034c5+'-'+_0x23428b+'-'+_0x63dbe6;const _0x521783=new customer_payment({'invoice':_0x467321,'date':_0x2034c5+'-'+_0x23428b+'-'+_0x63dbe6,'customer':_0x57d6f8,'reason':_0x119563(0x1ab),'amount':_0x5cdc5b}),_0x53a182=await _0x521783[_0x119563(0x19e)]();_0x1ba0ce['flash'](_0x119563(0x1e4),_0x119563(0x1d1)),_0x1d4f2c['redirect']('/sales_return/view');}catch(_0x568759){console[_0x119563(0x18b)](_0x568759);}}),router['get'](a0_0x6b8f7e(0x1fd),auth,async(_0x1f20ef,_0x334c18)=>{var _0x100589=a0_0x6b8f7e;try{const {username:_0x4dc868,email:_0x24d1f0,role:_0x297e2a}=_0x1f20ef[_0x100589(0x1f0)],_0x5d92ea=_0x1f20ef[_0x100589(0x1f0)],_0x2a9df1=await profile[_0x100589(0x198)]({'email':_0x5d92ea[_0x100589(0x1a3)]}),_0x419b5d=await master_shop[_0x100589(0x1ae)]();console[_0x100589(0x18b)](_0x100589(0x18d),_0x419b5d);const _0x426f9a=_0x1f20ef[_0x100589(0x1b4)]['id'],_0x156c41=await sales_return[_0x100589(0x1be)](_0x426f9a);console[_0x100589(0x18b)](_0x156c41);const _0x5c75c6=await customer[_0x100589(0x198)]({'name':_0x156c41[_0x100589(0x1da)]});console[_0x100589(0x18b)](_0x5c75c6);if(_0x419b5d[0x0][_0x100589(0x1d9)]==_0x100589(0x1a8)){var _0x4e2af1=users[_0x100589(0x196)];console['log'](_0x4e2af1);}else{if(_0x419b5d[0x0][_0x100589(0x1d9)]=='Hindi')var _0x4e2af1=users[_0x100589(0x18a)];else{if(_0x419b5d[0x0][_0x100589(0x1d9)]=='German')var _0x4e2af1=users[_0x100589(0x1e2)];else{if(_0x419b5d[0x0][_0x100589(0x1d9)]==_0x100589(0x1d2))var _0x4e2af1=users[_0x100589(0x1d2)];else{if(_0x419b5d[0x0]['language']=='French')var _0x4e2af1=users[_0x100589(0x1b1)];else{if(_0x419b5d[0x0]['language']=='Portuguese\x20(BR)')var _0x4e2af1=users[_0x100589(0x193)];else{if(_0x419b5d[0x0][_0x100589(0x1d9)]=='Chinese')var _0x4e2af1=users[_0x100589(0x1d0)];else{if(_0x419b5d[0x0][_0x100589(0x1d9)]==_0x100589(0x1b7))var _0x4e2af1=users[_0x100589(0x1f2)];}}}}}}}_0x334c18[_0x100589(0x1a4)](_0x100589(0x1b3),{'success':_0x1f20ef[_0x100589(0x1ad)](_0x100589(0x1e4)),'errors':_0x1f20ef[_0x100589(0x1ad)](_0x100589(0x1c5)),'role':_0x5d92ea,'profile':_0x2a9df1,'master_shop':_0x419b5d,'customers':_0x5c75c6,'sales':_0x156c41,'language':_0x4e2af1});}catch(_0x21db8e){console['log'](_0x21db8e);}}),module['exports']=router;