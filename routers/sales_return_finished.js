var a0_0x27310b=a0_0x39bc;function a0_0x4972(){var _0x3651cc=['$product_details.floorlevel','c_payment','save','customers','old_warehouse_data','937345EmwZYj','Hindi','$product_details._id','find','4218379oPiThC','primary_code','return_qty_QA','success','Return\x20Rooms','suppliers','/sales_return/view','Finished\x20Goods','Arabic','3355961iJdAmp','sale_qty','sales_quantity','customer_docs','return_sale_QA','stock','primary_code_QA','express','Sale\x20Return','invoice','8ufFRyz','bin','forEach','types','due_amount','English','product_stock','language','paid_amount','2DgrEQN','product_code_QA','12MRxduy','aggregate','errors','15444FSnptW','Chinese','18QtXzvH','status','json','$product_details.type','QA\x20Warehouse','message','product_code','Arabic\x20(ae)','for_categorize','Spanish','secondary_code','get','$name','sales_return_invoice','1374220DZUTcn','French','getDate','$product_details.secondary_code','../middleware/auth','amount','sales_return_finished','note','$product_details.storage','$product_details.bay','secondary_code_QA','foreach\x20newproduct','../public/language/languages.json','ToRoom','stocks_QA','email','post','name','customer','purchase\x20return\x20successfully','user','return_qty','type','map','English\x20(US)','data','Portuguese\x20(BR)','body','floorlevel','params','getFullYear','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','bay','return_sale','/sales_return_finished/view','product_name','Portuguese','master','string','stocks','redirect','product_details','36sRCsMl','render','log','$customer_docs','810423mIjQoj','date','Router','$product_details.product_code','flash','exports','back','1680324TNWinC','return_sale_edit_finished','/view','getMonth','sales_quantity_QA','ToWarehouse','findById','German','Enabled','/view/:id','findOne','subtract'];a0_0x4972=function(){return _0x3651cc;};return a0_0x4972();}(function(_0x1e7d1f,_0x51e239){var _0x572bfa=a0_0x39bc,_0x4af15b=_0x1e7d1f();while(!![]){try{var _0x5a68de=-parseInt(_0x572bfa(0x19e))/0x1+parseInt(_0x572bfa(0x199))/0x2*(-parseInt(_0x572bfa(0x1dc))/0x3)+-parseInt(_0x572bfa(0x1e3))/0x4+-parseInt(_0x572bfa(0x179))/0x5*(parseInt(_0x572bfa(0x19b))/0x6)+parseInt(_0x572bfa(0x186))/0x7*(parseInt(_0x572bfa(0x190))/0x8)+parseInt(_0x572bfa(0x1a0))/0x9*(-parseInt(_0x572bfa(0x1ae))/0xa)+parseInt(_0x572bfa(0x17d))/0xb*(parseInt(_0x572bfa(0x1d8))/0xc);if(_0x5a68de===_0x51e239)break;else _0x4af15b['push'](_0x4af15b['shift']());}catch(_0x2599c1){_0x4af15b['push'](_0x4af15b['shift']());}}}(a0_0x4972,0x4300a));function a0_0x39bc(_0x13436f,_0x24ec3a){var _0x497235=a0_0x4972();return a0_0x39bc=function(_0x39bca8,_0x2b24f1){_0x39bca8=_0x39bca8-0x173;var _0x260c63=_0x497235[_0x39bca8];return _0x260c63;},a0_0x39bc(_0x13436f,_0x24ec3a);}const express=require(a0_0x27310b(0x18d)),app=express(),router=express[a0_0x27310b(0x1de)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,customer_payment,c_payment_data,sales_return_finished}=require('../models/all_models'),auth=require(a0_0x27310b(0x1b2)),users=require(a0_0x27310b(0x1ba));router[a0_0x27310b(0x1ab)](a0_0x27310b(0x1e5),auth,async(_0x5945d3,_0x13c789)=>{var _0xd411f=a0_0x27310b;try{const {username:_0x517d88,email:_0xc495d1,role:_0x5976bf}=_0x5945d3[_0xd411f(0x1c2)],_0x3bb685=_0x5945d3[_0xd411f(0x1c2)],_0x709fe6=await profile['findOne']({'email':_0x3bb685[_0xd411f(0x1bd)]}),_0x4fefe8=await master_shop[_0xd411f(0x17c)](),_0x103620=await sales_return_finished[_0xd411f(0x19c)]([{'$lookup':{'from':_0xd411f(0x177),'localField':_0xd411f(0x1c0),'foreignField':_0xd411f(0x1bf),'as':_0xd411f(0x189)}},{'$unwind':_0xd411f(0x1db)}]);if(_0x4fefe8[0x0][_0xd411f(0x197)]==_0xd411f(0x1c6)){var _0x5f3e6e=users[_0xd411f(0x195)];console['log'](_0x5f3e6e);}else{if(_0x4fefe8[0x0][_0xd411f(0x197)]==_0xd411f(0x17a))var _0x5f3e6e=users[_0xd411f(0x17a)];else{if(_0x4fefe8[0x0][_0xd411f(0x197)]==_0xd411f(0x1ea))var _0x5f3e6e=users[_0xd411f(0x1ea)];else{if(_0x4fefe8[0x0]['language']==_0xd411f(0x1a9))var _0x5f3e6e=users[_0xd411f(0x1a9)];else{if(_0x4fefe8[0x0][_0xd411f(0x197)]==_0xd411f(0x1af))var _0x5f3e6e=users[_0xd411f(0x1af)];else{if(_0x4fefe8[0x0][_0xd411f(0x197)]==_0xd411f(0x1c8))var _0x5f3e6e=users[_0xd411f(0x1d2)];else{if(_0x4fefe8[0x0][_0xd411f(0x197)]==_0xd411f(0x19f))var _0x5f3e6e=users[_0xd411f(0x19f)];else{if(_0x4fefe8[0x0][_0xd411f(0x197)]=='Arabic\x20(ae)')var _0x5f3e6e=users[_0xd411f(0x185)];}}}}}}}_0x13c789[_0xd411f(0x1d9)](_0xd411f(0x1b4),{'success':_0x5945d3[_0xd411f(0x1e0)](_0xd411f(0x180)),'errors':_0x5945d3[_0xd411f(0x1e0)](_0xd411f(0x19d)),'role':_0x3bb685,'profile':_0x709fe6,'master_shop':_0x4fefe8,'user':_0x103620,'language':_0x5f3e6e});}catch(_0x2b1490){console[_0xd411f(0x1da)](_0x2b1490);}}),router[a0_0x27310b(0x1ab)](a0_0x27310b(0x1ec),auth,async(_0x1cbf40,_0x5bd35b)=>{var _0x3d149e=a0_0x27310b;try{const {username:_0x4381cc,email:_0x27081b,role:_0x830869}=_0x1cbf40[_0x3d149e(0x1c2)],_0x47c4b9=_0x1cbf40[_0x3d149e(0x1c2)],_0x45f9b1=await profile['findOne']({'email':_0x47c4b9[_0x3d149e(0x1bd)]}),_0x2f9773=await master_shop[_0x3d149e(0x17c)]();console['log'](_0x3d149e(0x1d3),_0x2f9773);const _0x2ef52a=_0x1cbf40[_0x3d149e(0x1cb)]['id'];console[_0x3d149e(0x1da)](_0x2ef52a);var _0x12302c=[_0x3d149e(0x181)];const _0x3a0f13=await sales_return_finished[_0x3d149e(0x1e9)](_0x2ef52a),_0x57d65c=await warehouse[_0x3d149e(0x19c)]([{'$match':{'name':_0x3a0f13[_0x3d149e(0x1e8)],'room':_0x3a0f13['ToRoom']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x3d149e(0x17b),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x3d149e(0x1b7)},'bin':{'$first':'$product_details.bin'},'type':{'$first':_0x3d149e(0x1a3)},'floorlevel':{'$first':_0x3d149e(0x174)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3d149e(0x1b1)},'product_code':{'$first':_0x3d149e(0x1df)},'storage':{'$first':_0x3d149e(0x1b6)},'rack':{'$first':'$product_details.rack'}}}]);console[_0x3d149e(0x1da)](_0x57d65c);const _0x24efd7=await warehouse['aggregate']([{'$match':{'status':_0x3d149e(0x1eb),'warehouse_category':_0x3d149e(0x184)}},{'$group':{'_id':_0x3d149e(0x1ac),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x325c0f=await warehouse['aggregate']([{'$match':{'status':_0x3d149e(0x1eb),'name':_0x3d149e(0x1a4)}},{'$group':{'_id':_0x3d149e(0x1ac),'name':{'$first':_0x3d149e(0x1ac)}}},{'$sort':{'name':0x1}}]),_0x1c4c4d=await product['find']({});if(_0x2f9773[0x0][_0x3d149e(0x197)]=='English\x20(US)'){var _0xa48924=users[_0x3d149e(0x195)];console[_0x3d149e(0x1da)](_0xa48924);}else{if(_0x2f9773[0x0][_0x3d149e(0x197)]=='Hindi')var _0xa48924=users[_0x3d149e(0x17a)];else{if(_0x2f9773[0x0][_0x3d149e(0x197)]==_0x3d149e(0x1ea))var _0xa48924=users[_0x3d149e(0x1ea)];else{if(_0x2f9773[0x0]['language']==_0x3d149e(0x1a9))var _0xa48924=users[_0x3d149e(0x1a9)];else{if(_0x2f9773[0x0][_0x3d149e(0x197)]==_0x3d149e(0x1af))var _0xa48924=users[_0x3d149e(0x1af)];else{if(_0x2f9773[0x0][_0x3d149e(0x197)]==_0x3d149e(0x1c8))var _0xa48924=users['Portuguese'];else{if(_0x2f9773[0x0][_0x3d149e(0x197)]==_0x3d149e(0x19f))var _0xa48924=users[_0x3d149e(0x19f)];else{if(_0x2f9773[0x0][_0x3d149e(0x197)]=='Arabic\x20(ae)')var _0xa48924=users[_0x3d149e(0x185)];}}}}}}}_0x5bd35b['render'](_0x3d149e(0x1e4),{'success':_0x1cbf40['flash'](_0x3d149e(0x180)),'errors':_0x1cbf40['flash'](_0x3d149e(0x19d)),'role':_0x47c4b9,'profile':_0x45f9b1,'master_shop':_0x2f9773,'user':_0x3a0f13,'stock':_0x57d65c,'unit':_0x1c4c4d,'language':_0xa48924,'warehouses':_0x24efd7,'rooms':_0x12302c,'warehouse_QA':_0x325c0f});}catch(_0x597e80){console[_0x3d149e(0x1da)](_0x597e80);}}),router['post'](a0_0x27310b(0x1ec),auth,async(_0x2264d7,_0x20d1db)=>{var _0x5e66f9=a0_0x27310b;if(_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1a8)]=='QA')try{const _0x44bd09=_0x2264d7[_0x5e66f9(0x1cb)]['id'],_0x34f13b=await sales_return[_0x5e66f9(0x1ed)]({'invoice':_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x18f)]}),_0x3032c0=await warehouse[_0x5e66f9(0x1ed)]({'name':_0x34f13b[_0x5e66f9(0x1e8)],'room':_0x34f13b[_0x5e66f9(0x1bb)]}),{invoice:_0x475511,customer:_0x56b562,date:_0x288ca3,warehouse_name:_0xa16bcf,product_name:_0x2fb0e2,primary_code:_0x531a06,secondary_code:_0x95406e,product_code:_0x2f3dcb,sales_quantity:_0x343991,stocks:_0x1dc433,return_qty:_0x485535,note:_0x4e9559,to_warehouse_name_QA:_0x2e0f84,to_Room_name_QA:_0x36685f}=_0x2264d7['body'];if(typeof product_name_QA=='string')var _0x19488f=[_0x2264d7[_0x5e66f9(0x1c9)]['product_name_QA']],_0x5e8b9a=[_0x2264d7[_0x5e66f9(0x1c9)]['primary_code_QA']],_0xd66ec2=[_0x2264d7['body']['secondary_code_QA']],_0x3a1106=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x19a)]],_0x4d87ca=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1e7)]],_0x7557de=[_0x2264d7[_0x5e66f9(0x1c9)]['stocks_QA']],_0x1c7c7d=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x17f)]];else var _0x19488f=[..._0x2264d7[_0x5e66f9(0x1c9)]['product_name_QA']],_0x5e8b9a=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x18c)]],_0xd66ec2=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1b8)]],_0x3a1106=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x19a)]],_0x4d87ca=[..._0x2264d7['body']['sales_quantity_QA']],_0x7557de=[..._0x2264d7['body'][_0x5e66f9(0x1bc)]],_0x1c7c7d=[..._0x2264d7['body'][_0x5e66f9(0x17f)]];const _0x4dfdc7=_0x19488f[_0x5e66f9(0x1c5)](_0x1dfbea=>{return _0x1dfbea={'product_name':_0x1dfbea};});_0x5e8b9a['forEach']((_0x281977,_0xeb6f88)=>{_0x4dfdc7[_0xeb6f88]['primary_code']=_0x281977;}),_0xd66ec2[_0x5e66f9(0x192)]((_0xbec84b,_0x21041f)=>{_0x4dfdc7[_0x21041f]['secondary_code']=_0xbec84b;}),_0x3a1106[_0x5e66f9(0x192)]((_0x5d4dab,_0x509286)=>{var _0x1c4930=_0x5e66f9;_0x4dfdc7[_0x509286][_0x1c4930(0x1a6)]=_0x5d4dab;}),_0x4d87ca['forEach']((_0x4b6f43,_0x4f65c1)=>{_0x4dfdc7[_0x4f65c1]['sale_qty']=_0x4b6f43;}),_0x7557de[_0x5e66f9(0x192)]((_0x2fd2d7,_0x3e77fb)=>{var _0x5c8e1c=_0x5e66f9;_0x4dfdc7[_0x3e77fb][_0x5c8e1c(0x18b)]=_0x2fd2d7;}),_0x1c7c7d[_0x5e66f9(0x192)]((_0x6bda7d,_0x1d8636)=>{_0x4dfdc7[_0x1d8636]['return_qty']=_0x6bda7d;}),_0x34f13b['return_sale_QA'][_0x5e66f9(0x192)](_0x4858=>{var _0x279bdd=_0x5e66f9;const _0x40c62b=_0x3032c0[_0x279bdd(0x1d7)][_0x279bdd(0x1c5)](_0x48ce0d=>{var _0x59e02b=_0x279bdd;_0x48ce0d['product_name']==_0x4858[_0x59e02b(0x1d1)]&&(_0x48ce0d[_0x59e02b(0x196)]=parseInt(_0x48ce0d[_0x59e02b(0x196)])+parseInt(_0x4858[_0x59e02b(0x1c3)]));});}),await _0x3032c0[_0x5e66f9(0x176)](),_0x34f13b[_0x5e66f9(0x18f)]=_0x475511,_0x34f13b['customer']=_0x56b562,_0x34f13b[_0x5e66f9(0x1dd)]=_0x288ca3,_0x34f13b['warehouse_name']=_0xa16bcf,_0x34f13b[_0x5e66f9(0x18a)]=_0x4dfdc7,_0x34f13b['note']=_0x4e9559,_0x34f13b[_0x5e66f9(0x1e8)]=_0x2e0f84,_0x34f13b[_0x5e66f9(0x1bb)]=_0x36685f;const _0x159717=await _0x34f13b[_0x5e66f9(0x176)](),_0x347883=await c_payment_data[_0x5e66f9(0x1ed)]({'invoice':_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x18f)],'reason':_0x5e66f9(0x18e)});_0x347883['suppliers']=_0x2264d7[_0x5e66f9(0x1c9)]['suppliers'],_0x347883[_0x5e66f9(0x1dd)]=_0x2264d7[_0x5e66f9(0x1c9)]['date'],await _0x347883['save'](),_0x2264d7[_0x5e66f9(0x1e0)]('success',_0x5e66f9(0x1c1)),_0x20d1db['redirect'](_0x5e66f9(0x1d0));}catch(_0x3cbf95){console[_0x5e66f9(0x1da)](_0x3cbf95),_0x20d1db[_0x5e66f9(0x1a1)](0xc8)[_0x5e66f9(0x1a2)]({'message':_0x3cbf95[_0x5e66f9(0x1a5)]});}else try{const _0x15bc41=_0x2264d7[_0x5e66f9(0x1cb)]['id'];console[_0x5e66f9(0x1da)](_0x15bc41);const _0x4e13fb=await sales_return[_0x5e66f9(0x1ed)]({'invoice':_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x18f)]});console[_0x5e66f9(0x1da)]('old_data',_0x4e13fb);const _0x43c622=await warehouse[_0x5e66f9(0x1ed)]({'name':_0x4e13fb['ToWarehouse'],'room':_0x4e13fb[_0x5e66f9(0x1bb)]});console[_0x5e66f9(0x1da)](_0x5e66f9(0x178),_0x43c622);const {invoice:_0x142155,customer:_0x1a43d1,date:_0x4527f7,warehouse_name:_0x23e3b7,product_name:_0x15510b,primary_code:_0xc6d0e7,secondary_code:_0x55e97a,product_code:_0x434c91,sales_quantity:_0x3c056,stocks:_0x43063b,return_qty:_0x164450,note:_0x4efc49,to_warehouse_name:_0x37fec2,to_Room_name:_0xc31c05}=_0x2264d7['body'];console['log'](_0x2264d7[_0x5e66f9(0x1c9)]);if(typeof _0x15510b==_0x5e66f9(0x1d4))var _0x19488f=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1d1)]],_0x5e8b9a=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x17e)]],_0xd66ec2=[_0x2264d7[_0x5e66f9(0x1c9)]['secondary_code']],_0x3a1106=[_0x2264d7[_0x5e66f9(0x1c9)]['product_code']],_0x4d87ca=[_0x2264d7[_0x5e66f9(0x1c9)]['sales_quantity']],_0x7557de=[_0x2264d7['body']['stocks']],_0x1c7c7d=[_0x2264d7[_0x5e66f9(0x1c9)]['return_qty']],_0x212318=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1ce)]],_0x2c840b=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x191)]],_0x49f05d=[_0x2264d7[_0x5e66f9(0x1c9)]['types']],_0x4f8b1e=[_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1ca)]];else var _0x19488f=[..._0x2264d7['body'][_0x5e66f9(0x1d1)]],_0x5e8b9a=[..._0x2264d7['body']['primary_code']],_0xd66ec2=[..._0x2264d7[_0x5e66f9(0x1c9)]['secondary_code']],_0x3a1106=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1a6)]],_0x4d87ca=[..._0x2264d7['body'][_0x5e66f9(0x188)]],_0x7557de=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1d5)]],_0x1c7c7d=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x1c3)]],_0x212318=[..._0x2264d7['body']['bay']],_0x2c840b=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x191)]],_0x49f05d=[..._0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x193)]],_0x4f8b1e=[..._0x2264d7['body'][_0x5e66f9(0x1ca)]];const _0x31e9d7=_0x19488f['map'](_0x4bbcd5=>{return _0x4bbcd5={'product_name':_0x4bbcd5};});_0x5e8b9a[_0x5e66f9(0x192)]((_0x1a9820,_0x5b1ee2)=>{var _0x4bc752=_0x5e66f9;_0x31e9d7[_0x5b1ee2][_0x4bc752(0x17e)]=_0x1a9820;}),_0xd66ec2['forEach']((_0x40e7cb,_0x2fcf2f)=>{var _0xf1ddb0=_0x5e66f9;_0x31e9d7[_0x2fcf2f][_0xf1ddb0(0x1aa)]=_0x40e7cb;}),_0x3a1106[_0x5e66f9(0x192)]((_0x3ae02d,_0x15d2da)=>{var _0x5ba5c3=_0x5e66f9;_0x31e9d7[_0x15d2da][_0x5ba5c3(0x1a6)]=_0x3ae02d;}),_0x4d87ca[_0x5e66f9(0x192)]((_0x57c46a,_0x1047ab)=>{var _0x44603a=_0x5e66f9;_0x31e9d7[_0x1047ab][_0x44603a(0x187)]=_0x57c46a;}),_0x7557de[_0x5e66f9(0x192)]((_0x596cc0,_0x76f4b3)=>{var _0xa790b5=_0x5e66f9;_0x31e9d7[_0x76f4b3][_0xa790b5(0x18b)]=_0x596cc0;}),_0x1c7c7d[_0x5e66f9(0x192)]((_0xa7709e,_0x377800)=>{var _0x52d77f=_0x5e66f9;_0x31e9d7[_0x377800][_0x52d77f(0x1c3)]=_0xa7709e;}),_0x212318[_0x5e66f9(0x192)]((_0x53dd71,_0x1ba5c5)=>{var _0x4308c8=_0x5e66f9;_0x31e9d7[_0x1ba5c5][_0x4308c8(0x1ce)]=_0x53dd71;}),_0x2c840b[_0x5e66f9(0x192)]((_0x249e06,_0x2ce7ea)=>{var _0x3b0662=_0x5e66f9;_0x31e9d7[_0x2ce7ea][_0x3b0662(0x191)]=_0x249e06;}),_0x49f05d['forEach']((_0x2f01e4,_0x5a0c12)=>{var _0x5287f2=_0x5e66f9;_0x31e9d7[_0x5a0c12][_0x5287f2(0x1c4)]=_0x2f01e4;}),_0x4f8b1e[_0x5e66f9(0x192)]((_0x1e06f1,_0x57adf8)=>{var _0x33babf=_0x5e66f9;_0x31e9d7[_0x57adf8][_0x33babf(0x1ca)]=_0x1e06f1;});var _0x2fcd9f=0x0;_0x31e9d7[_0x5e66f9(0x192)](_0x12815e=>{var _0x3e3ea8=_0x5e66f9;console['log'](_0x3e3ea8(0x1b9),_0x12815e),(parseInt(_0x12815e[_0x3e3ea8(0x187)])<parseInt(_0x12815e['return_qty'])||parseInt(_0x12815e[_0x3e3ea8(0x18b)])<parseInt(_0x12815e[_0x3e3ea8(0x1c3)])&&parseInt(_0x12815e['sale_qty'])>parseInt(_0x12815e[_0x3e3ea8(0x1c3)])||parseInt(_0x12815e['return_qty'])==0x0)&&_0x2fcd9f++;});if(_0x2fcd9f!=0x0)return _0x2264d7[_0x5e66f9(0x1e0)](_0x5e66f9(0x19d),_0x5e66f9(0x1cd)),_0x20d1db[_0x5e66f9(0x1d6)](_0x5e66f9(0x1e2));_0x4e13fb[_0x5e66f9(0x1cf)][_0x5e66f9(0x192)](_0x4ff7f5=>{var _0xc3f81d=_0x5e66f9;const _0x597ae4=_0x43c622[_0xc3f81d(0x1d7)][_0xc3f81d(0x1c5)](_0x570861=>{var _0x2457be=_0xc3f81d;_0x570861[_0x2457be(0x1d1)]==_0x4ff7f5[_0x2457be(0x1d1)]&&_0x570861[_0x2457be(0x1ca)]==_0x4ff7f5['floorlevel']&&_0x570861[_0x2457be(0x1c4)]==_0x4ff7f5['type']&&_0x570861['bin']==_0x4ff7f5[_0x2457be(0x191)]&&_0x570861[_0x2457be(0x1ce)]==_0x4ff7f5[_0x2457be(0x1ce)]&&(_0x570861[_0x2457be(0x196)]=parseInt(_0x570861[_0x2457be(0x196)])+parseInt(_0x4ff7f5[_0x2457be(0x1c3)]));});}),console[_0x5e66f9(0x1da)](_0x5e66f9(0x178),_0x43c622),await _0x43c622[_0x5e66f9(0x176)](),_0x4e13fb['invoice']=_0x142155,_0x4e13fb['customer']=_0x1a43d1,_0x4e13fb[_0x5e66f9(0x1dd)]=_0x4527f7,_0x4e13fb['warehouse_name']=_0x23e3b7,_0x4e13fb[_0x5e66f9(0x1cf)]=_0x31e9d7,_0x4e13fb[_0x5e66f9(0x1b5)]=_0x4efc49,_0x4e13fb[_0x5e66f9(0x1e8)]=_0x37fec2,_0x4e13fb[_0x5e66f9(0x1bb)]=_0xc31c05;const _0x28327c=await _0x4e13fb[_0x5e66f9(0x176)]();console['log']('new\x20new_data',_0x28327c);const _0x4c2dac=await c_payment_data['findOne']({'invoice':_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x18f)],'reason':_0x5e66f9(0x18e)});_0x4c2dac['suppliers']=_0x2264d7[_0x5e66f9(0x1c9)][_0x5e66f9(0x182)],_0x4c2dac['date']=_0x2264d7[_0x5e66f9(0x1c9)]['date'],await _0x4c2dac[_0x5e66f9(0x176)](),_0x2264d7[_0x5e66f9(0x1e0)](_0x5e66f9(0x180),'purchase\x20return\x20successfully'),_0x20d1db[_0x5e66f9(0x1d6)](_0x5e66f9(0x183));}catch(_0x460b63){console[_0x5e66f9(0x1da)](_0x460b63),_0x20d1db[_0x5e66f9(0x1a1)](0xc8)['json']({'message':_0x460b63[_0x5e66f9(0x1a5)]});}}),router[a0_0x27310b(0x1be)]('/give_payment/:id',auth,async(_0x11ca2e,_0x2a3530)=>{var _0x550a14=a0_0x27310b;try{const _0x49073b=_0x11ca2e[_0x550a14(0x1cb)]['id'],{invoice:_0x193c3f,customer:_0x492fbc,payable_to_customer:_0x5eaaf9,paid_amount:_0x1180c2}=_0x11ca2e[_0x550a14(0x1c9)],_0x610f3d=await sales_return[_0x550a14(0x1e9)](_0x49073b);console[_0x550a14(0x1da)](_0x550a14(0x1c7),_0x610f3d),console[_0x550a14(0x1da)](_0x5eaaf9),console['log'](_0x1180c2);var _0x32eb2e=_0x5eaaf9-_0x1180c2;console['log'](_0x550a14(0x173),_0x32eb2e),_0x610f3d[_0x550a14(0x198)]=parseFloat(_0x1180c2)+parseFloat(_0x610f3d[_0x550a14(0x198)]),_0x610f3d[_0x550a14(0x194)]=_0x32eb2e,console[_0x550a14(0x1da)](_0x610f3d);const _0x58f72c=await _0x610f3d[_0x550a14(0x176)]();console['log'](0x1b207);const _0x5d7a44=await c_payment_data['findOne']({'invoice':_0x11ca2e['body'][_0x550a14(0x18f)],'reason':_0x550a14(0x18e)});console[_0x550a14(0x1da)](_0x550a14(0x175),_0x5d7a44),_0x5d7a44[_0x550a14(0x1b3)]=_0x32eb2e,await _0x5d7a44[_0x550a14(0x176)]();let _0x8589fa=new Date(),_0x2375e=('0'+_0x8589fa[_0x550a14(0x1b0)]())['slice'](-0x2),_0x46d5d4=('0'+(_0x8589fa[_0x550a14(0x1e6)]()+0x1))['slice'](-0x2),_0xc739ce=_0x8589fa[_0x550a14(0x1cc)](),_0x2a453a=_0xc739ce+'-'+_0x46d5d4+'-'+_0x2375e;const _0x3c57ca=new customer_payment({'invoice':_0x193c3f,'date':_0xc739ce+'-'+_0x46d5d4+'-'+_0x2375e,'customer':_0x492fbc,'reason':'Returned\x20Payment\x20For\x20Sale\x20Return','amount':_0x1180c2}),_0x451b6d=await _0x3c57ca[_0x550a14(0x176)]();_0x11ca2e[_0x550a14(0x1e0)]('success','payment\x20successfull'),_0x2a3530[_0x550a14(0x1d6)]('/sales_return/view');}catch(_0x40a96a){console[_0x550a14(0x1da)](_0x40a96a);}}),router['get']('/invoice/:id',auth,async(_0x8f3fa4,_0x38b338)=>{var _0x1e183f=a0_0x27310b;try{const {username:_0x2ec75a,email:_0x20a4ef,role:_0x54af25}=_0x8f3fa4['user'],_0x245edd=_0x8f3fa4[_0x1e183f(0x1c2)],_0x4b0f9c=await profile['findOne']({'email':_0x245edd['email']}),_0x2df733=await master_shop['find']();console[_0x1e183f(0x1da)](_0x1e183f(0x1d3),_0x2df733);const _0x2bd518=_0x8f3fa4[_0x1e183f(0x1cb)]['id'],_0x5a704e=await sales_return[_0x1e183f(0x1e9)](_0x2bd518);console['log'](_0x5a704e);const _0x2f012a=await customer['findOne']({'name':_0x5a704e['customer']});console[_0x1e183f(0x1da)](_0x2f012a);if(_0x2df733[0x0]['language']==_0x1e183f(0x1c6)){var _0x1ada0e=users['English'];console[_0x1e183f(0x1da)](_0x1ada0e);}else{if(_0x2df733[0x0]['language']==_0x1e183f(0x17a))var _0x1ada0e=users[_0x1e183f(0x17a)];else{if(_0x2df733[0x0]['language']==_0x1e183f(0x1ea))var _0x1ada0e=users['German'];else{if(_0x2df733[0x0]['language']=='Spanish')var _0x1ada0e=users[_0x1e183f(0x1a9)];else{if(_0x2df733[0x0][_0x1e183f(0x197)]==_0x1e183f(0x1af))var _0x1ada0e=users['French'];else{if(_0x2df733[0x0][_0x1e183f(0x197)]==_0x1e183f(0x1c8))var _0x1ada0e=users['Portuguese'];else{if(_0x2df733[0x0][_0x1e183f(0x197)]==_0x1e183f(0x19f))var _0x1ada0e=users[_0x1e183f(0x19f)];else{if(_0x2df733[0x0]['language']==_0x1e183f(0x1a7))var _0x1ada0e=users[_0x1e183f(0x185)];}}}}}}}_0x38b338[_0x1e183f(0x1d9)](_0x1e183f(0x1ad),{'success':_0x8f3fa4[_0x1e183f(0x1e0)](_0x1e183f(0x180)),'errors':_0x8f3fa4[_0x1e183f(0x1e0)](_0x1e183f(0x19d)),'role':_0x245edd,'profile':_0x4b0f9c,'master_shop':_0x2df733,'customers':_0x2f012a,'sales':_0x5a704e,'language':_0x1ada0e});}catch(_0xb030b8){console[_0x1e183f(0x1da)](_0xb030b8);}}),module[a0_0x27310b(0x1e1)]=router;