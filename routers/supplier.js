const a0_0x2d3d68=a0_0x387a;(function(_0x190741,_0x31dc36){const _0x6c4c0a=a0_0x387a,_0x32efd1=_0x190741();while(!![]){try{const _0x691bc5=-parseInt(_0x6c4c0a(0x21a))/0x1+-parseInt(_0x6c4c0a(0x20a))/0x2*(-parseInt(_0x6c4c0a(0x1ca))/0x3)+parseInt(_0x6c4c0a(0x1cd))/0x4*(-parseInt(_0x6c4c0a(0x203))/0x5)+parseInt(_0x6c4c0a(0x1e1))/0x6*(parseInt(_0x6c4c0a(0x1c5))/0x7)+parseInt(_0x6c4c0a(0x1c6))/0x8*(-parseInt(_0x6c4c0a(0x20e))/0x9)+parseInt(_0x6c4c0a(0x20f))/0xa+-parseInt(_0x6c4c0a(0x207))/0xb*(-parseInt(_0x6c4c0a(0x219))/0xc);if(_0x691bc5===_0x31dc36)break;else _0x32efd1['push'](_0x32efd1['shift']());}catch(_0x267ff8){_0x32efd1['push'](_0x32efd1['shift']());}}}(a0_0x425c,0xdaa3d));const express=require(a0_0x2d3d68(0x1cf)),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,s_payment_data}=require(a0_0x2d3d68(0x1f6)),auth=require(a0_0x2d3d68(0x1d2)),users=require(a0_0x2d3d68(0x1c9)),excelJS=require(a0_0x2d3d68(0x1fb)),xlsx=require(a0_0x2d3d68(0x1db)),multer=require(a0_0x2d3d68(0x206));function a0_0x387a(_0x380b48,_0x5ae28d){const _0x425cde=a0_0x425c();return a0_0x387a=function(_0x387a92,_0xf9eee0){_0x387a92=_0x387a92-0x1b6;let _0x261e0c=_0x425cde[_0x387a92];return _0x261e0c;},a0_0x387a(_0x380b48,_0x5ae28d);}router[a0_0x2d3d68(0x212)](a0_0x2d3d68(0x1ec),auth,async(_0x522f27,_0x3797d2)=>{const _0x51657b=a0_0x2d3d68;try{const {username:_0x53c234,email:_0x192b40,role:_0x54653a}=_0x522f27[_0x51657b(0x202)],_0x28f92d=_0x522f27[_0x51657b(0x202)],_0x339ea4=await profile[_0x51657b(0x1f7)]({'email':_0x28f92d[_0x51657b(0x1fd)]}),_0x15b329=await master_shop[_0x51657b(0x1f8)]();console[_0x51657b(0x1e3)]('master',_0x15b329);const _0x33597d=await suppliers[_0x51657b(0x1f8)]();console['log'](_0x33597d);const _0x552c1e=await suppliers['aggregate']([{'$lookup':{'from':_0x51657b(0x1d8),'localField':_0x51657b(0x1cb),'foreignField':_0x51657b(0x1ed),'as':'suppliers_docs'}}]),_0x2a3af0=_0x552c1e['map'](_0x3cc6e4=>{const _0x32706b=_0x51657b;console[_0x32706b(0x1e3)]('data',_0x3cc6e4);var _0x8b76b8=0x0,_0x1a58b9=0x0;return _0x3cc6e4[_0x32706b(0x201)][_0x32706b(0x214)](_0x28395e=>{const _0x491148=_0x32706b;console[_0x491148(0x1e3)]('doc',_0x28395e),_0x28395e[_0x491148(0x200)]==_0x491148(0x1ba)?_0x8b76b8+=_0x28395e[_0x491148(0x1f5)]:_0x1a58b9+=_0x28395e[_0x491148(0x1f5)];}),_0x3cc6e4[_0x32706b(0x204)]=_0x8b76b8,_0x3cc6e4['purchase_return']=_0x1a58b9,_0x3cc6e4;});console[_0x51657b(0x1e3)]('supplier.js\x20payment_data',_0x2a3af0);if(_0x15b329[0x0][_0x51657b(0x1c3)]==_0x51657b(0x1ef)){var _0x13bb69=users[_0x51657b(0x21b)];console[_0x51657b(0x1e3)](_0x13bb69);}else{if(_0x15b329[0x0][_0x51657b(0x1c3)]==_0x51657b(0x1d6))var _0x13bb69=users[_0x51657b(0x1d6)];else{if(_0x15b329[0x0][_0x51657b(0x1c3)]==_0x51657b(0x1d0))var _0x13bb69=users['German'];else{if(_0x15b329[0x0][_0x51657b(0x1c3)]=='Spanish')var _0x13bb69=users['Spanish'];else{if(_0x15b329[0x0][_0x51657b(0x1c3)]=='French')var _0x13bb69=users[_0x51657b(0x1e6)];else{if(_0x15b329[0x0][_0x51657b(0x1c3)]==_0x51657b(0x1ea))var _0x13bb69=users[_0x51657b(0x1dd)];else{if(_0x15b329[0x0][_0x51657b(0x1c3)]==_0x51657b(0x1e2))var _0x13bb69=users['Chinese'];else{if(_0x15b329[0x0][_0x51657b(0x1c3)]==_0x51657b(0x1d4))var _0x13bb69=users['Arabic'];}}}}}}}_0x3797d2[_0x51657b(0x1f0)]('supplier',{'success':_0x522f27['flash'](_0x51657b(0x1e5)),'errors':_0x522f27[_0x51657b(0x1e8)]('errors'),'user':_0x33597d,'profile':_0x339ea4,'master_shop':_0x15b329,'role':_0x28f92d,'payment':_0x2a3af0,'language':_0x13bb69});}catch(_0x55611d){console[_0x51657b(0x1e3)](_0x55611d);}}),router[a0_0x2d3d68(0x1ce)](a0_0x2d3d68(0x1ec),auth,async(_0x2745af,_0x43a6d1)=>{const _0xe9c3b9=a0_0x2d3d68;try{const {name:_0x93e6b6,email:_0x51f887,mobile:_0x51888a,company:_0x4e0bb2,address:_0x16b7ab,receivable:_0x5cc568,payable:_0x5084d6}=_0x2745af['body'],_0x23ba90=new suppliers({'name':_0x93e6b6,'email':_0x51f887,'mobile':_0x51888a,'company':_0x4e0bb2,'address':_0x16b7ab,'receivable':_0x5cc568,'payable':_0x5084d6}),_0x4deeeb=await _0x23ba90[_0xe9c3b9(0x1e0)]();_0x2745af[_0xe9c3b9(0x1e8)](_0xe9c3b9(0x1e5),'supplier\x20data\x20add\x20successfully'),_0x43a6d1[_0xe9c3b9(0x21d)](_0xe9c3b9(0x1ff));}catch(_0x2bb222){console[_0xe9c3b9(0x1e3)](_0x2bb222);}}),router[a0_0x2d3d68(0x212)]('/view/:id',auth,async(_0x5cc9aa,_0x3ea121)=>{const _0x45f346=a0_0x2d3d68;try{const {username:_0x1afa79,email:_0x4ad840,role:_0x2d7d1c}=_0x5cc9aa[_0x45f346(0x202)],_0x51b58d=_0x5cc9aa[_0x45f346(0x202)],_0xe381eb=await profile['findOne']({'email':_0x51b58d[_0x45f346(0x1fd)]}),_0x1026af=await master_shop[_0x45f346(0x1f8)]();console[_0x45f346(0x1e3)](_0x45f346(0x1fa),_0x1026af);const _0x3d6721=_0x5cc9aa[_0x45f346(0x1b6)]['id'],_0x3f4859=await suppliers['findById'](_0x3d6721);console[_0x45f346(0x1e3)](_0x3f4859);if(_0x1026af[0x0]['language']==_0x45f346(0x1ef)){var _0x53aef4=users[_0x45f346(0x21b)];console[_0x45f346(0x1e3)](_0x53aef4);}else{if(_0x1026af[0x0][_0x45f346(0x1c3)]==_0x45f346(0x1d6))var _0x53aef4=users[_0x45f346(0x1d6)];else{if(_0x1026af[0x0][_0x45f346(0x1c3)]==_0x45f346(0x1d0))var _0x53aef4=users[_0x45f346(0x1d0)];else{if(_0x1026af[0x0][_0x45f346(0x1c3)]==_0x45f346(0x208))var _0x53aef4=users[_0x45f346(0x208)];else{if(_0x1026af[0x0][_0x45f346(0x1c3)]==_0x45f346(0x1e6))var _0x53aef4=users[_0x45f346(0x1e6)];else{if(_0x1026af[0x0]['language']==_0x45f346(0x1ea))var _0x53aef4=users['Portuguese'];else{if(_0x1026af[0x0][_0x45f346(0x1c3)]==_0x45f346(0x1e2))var _0x53aef4=users[_0x45f346(0x1e2)];else{if(_0x1026af[0x0][_0x45f346(0x1c3)]==_0x45f346(0x1d4))var _0x53aef4=users[_0x45f346(0x218)];}}}}}}}_0x3ea121[_0x45f346(0x1f0)](_0x45f346(0x1bf),{'success':_0x5cc9aa[_0x45f346(0x1e8)](_0x45f346(0x1e5)),'errors':_0x5cc9aa['flash'](_0x45f346(0x217)),'role':_0x51b58d,'profile':_0xe381eb,'master_shop':_0x1026af,'user':_0x3f4859,'language':_0x53aef4});}catch(_0x14c41d){console[_0x45f346(0x1e3)](_0x14c41d);}}),router['post']('/view/:id',auth,async(_0x4cdd61,_0x2649d7)=>{const _0x12fa82=a0_0x2d3d68;try{const _0x468308=_0x4cdd61[_0x12fa82(0x1b6)]['id'],_0x55fc54=await suppliers[_0x12fa82(0x1ee)](_0x468308),{name:_0x33fa34,email:_0x2d8db8,mobile:_0x39b705,company:_0xc0c43a,address:_0x567b10,receivable:_0x2cf60b,payable:_0x4ff6be}=_0x4cdd61['body'];_0x55fc54[_0x12fa82(0x1cb)]=_0x33fa34,_0x55fc54[_0x12fa82(0x1fd)]=_0x2d8db8,_0x55fc54['mobile']=_0x39b705,_0x55fc54[_0x12fa82(0x1da)]=_0xc0c43a,_0x55fc54[_0x12fa82(0x1eb)]=_0x567b10,_0x55fc54[_0x12fa82(0x20b)]=_0x2cf60b,_0x55fc54[_0x12fa82(0x1d9)]=_0x4ff6be;const _0x1e51f1=await _0x55fc54['save']();_0x4cdd61[_0x12fa82(0x1e8)]('success',_0x12fa82(0x1c1)),_0x2649d7['redirect'](_0x12fa82(0x1ff));}catch(_0x13e604){console[_0x12fa82(0x1e3)](_0x13e604);}}),router['get'](a0_0x2d3d68(0x209),auth,async(_0x33d2ce,_0x3d5156)=>{const _0x2c6b36=a0_0x2d3d68;try{const {username:_0x48b27f,email:_0x433cd2,role:_0x4c4649}=_0x33d2ce[_0x2c6b36(0x202)],_0x1a6277=_0x33d2ce[_0x2c6b36(0x202)],_0x34fa35=await profile['findOne']({'email':_0x1a6277[_0x2c6b36(0x1fd)]}),_0x4eb1be=await master_shop[_0x2c6b36(0x1f8)]();console[_0x2c6b36(0x1e3)]('master',_0x4eb1be),console[_0x2c6b36(0x1e3)](_0x33d2ce[_0x2c6b36(0x1b6)]['id']);const _0xbdcebd=await suppliers[_0x2c6b36(0x1f7)]({'_id':_0x33d2ce[_0x2c6b36(0x1b6)]['id']});console[_0x2c6b36(0x1e3)](_0xbdcebd);const _0x26c4ce=await s_payment_data[_0x2c6b36(0x1f8)]({'suppliers':_0xbdcebd[_0x2c6b36(0x1cb)]});console[_0x2c6b36(0x1e3)](_0x26c4ce);const _0x1394bd=await s_payment_data[_0x2c6b36(0x1f2)]([{'$match':{'suppliers':_0xbdcebd[_0x2c6b36(0x1cb)]}},{'$match':{'reason':_0x2c6b36(0x1ba)}},{'$group':{'_id':_0x2c6b36(0x1cc),'sum':{'$sum':_0x2c6b36(0x1c0)}}}]);console[_0x2c6b36(0x1e3)](_0x2c6b36(0x1d1),_0x1394bd);const _0x29e72d=await s_payment_data[_0x2c6b36(0x1f2)]([{'$match':{'suppliers':_0xbdcebd['name']}},{'$match':{'reason':'Purchase\x20Return'}},{'$group':{'_id':'$reason','sum':{'$sum':_0x2c6b36(0x1c0)}}}]);console['log'](_0x2c6b36(0x216),_0x29e72d);if(_0x4eb1be[0x0][_0x2c6b36(0x1c3)]==_0x2c6b36(0x1ef)){var _0x305ea1=users[_0x2c6b36(0x21b)];console['log'](_0x305ea1);}else{if(_0x4eb1be[0x0][_0x2c6b36(0x1c3)]==_0x2c6b36(0x1d6))var _0x305ea1=users['Hindi'];else{if(_0x4eb1be[0x0][_0x2c6b36(0x1c3)]==_0x2c6b36(0x1d0))var _0x305ea1=users[_0x2c6b36(0x1d0)];else{if(_0x4eb1be[0x0][_0x2c6b36(0x1c3)]==_0x2c6b36(0x208))var _0x305ea1=users[_0x2c6b36(0x208)];else{if(_0x4eb1be[0x0][_0x2c6b36(0x1c3)]==_0x2c6b36(0x1e6))var _0x305ea1=users['French'];else{if(_0x4eb1be[0x0][_0x2c6b36(0x1c3)]==_0x2c6b36(0x1ea))var _0x305ea1=users[_0x2c6b36(0x1dd)];else{if(_0x4eb1be[0x0]['language']=='Chinese')var _0x305ea1=users[_0x2c6b36(0x1e2)];else{if(_0x4eb1be[0x0][_0x2c6b36(0x1c3)]==_0x2c6b36(0x1d4))var _0x305ea1=users[_0x2c6b36(0x218)];}}}}}}}_0x3d5156[_0x2c6b36(0x1f0)]('supplier_payment',{'success':_0x33d2ce[_0x2c6b36(0x1e8)](_0x2c6b36(0x1e5)),'errors':_0x33d2ce[_0x2c6b36(0x1e8)]('errors'),'role':_0x1a6277,'profile':_0x34fa35,'master_shop':_0x4eb1be,'payment':_0x26c4ce,'payable':_0x1394bd,'receivable':_0x29e72d,'language':_0x305ea1});}catch(_0x54e322){console[_0x2c6b36(0x1e3)](_0x54e322);}}),router['get'](a0_0x2d3d68(0x1e4),auth,async(_0x383b28,_0x160356)=>{const _0x4feb8a=a0_0x2d3d68;try{const _0x568e1d=new excelJS['Workbook'](),_0x2d545f=_0x568e1d[_0x4feb8a(0x1f3)](_0x4feb8a(0x1df));return _0x2d545f[_0x4feb8a(0x1f9)]=[{'header':_0x4feb8a(0x1c8),'key':_0x4feb8a(0x1c7),'width':0xa},{'header':_0x4feb8a(0x211),'key':_0x4feb8a(0x1dc),'width':0xa},{'header':_0x4feb8a(0x1bd),'key':'SalesmanName','width':0xa},{'header':_0x4feb8a(0x1be),'key':_0x4feb8a(0x1eb),'width':0xa},{'header':'Company_Name','key':_0x4feb8a(0x1d3),'width':0xa},{'header':_0x4feb8a(0x1eb),'key':'email','width':0xa}],_0x160356[_0x4feb8a(0x1bb)](_0x4feb8a(0x1fc),'application/vnd.openxmlformats-officedocument.spreadsheatml.sheet'),_0x160356['setHeader'](_0x4feb8a(0x1d5),_0x4feb8a(0x1de)),_0x568e1d[_0x4feb8a(0x1db)][_0x4feb8a(0x210)](_0x160356)[_0x4feb8a(0x1d7)](()=>{_0x160356['status'](0xc8);});}catch(_0x52ecef){_0x160356[_0x4feb8a(0x1c2)](0x190)[_0x4feb8a(0x1e9)]({'errors':_0x52ecef[_0x4feb8a(0x215)]});}});const storage1=multer[a0_0x2d3d68(0x1c4)]({'destination':(_0x5d3c88,_0x48eabd,_0x5e00df)=>{const _0x4d7813=a0_0x2d3d68;_0x5e00df(null,_0x4d7813(0x1b9));},'filename':(_0x1bc5d0,_0x5ce42c,_0x46de8e)=>{const _0x51b8c0=a0_0x2d3d68;_0x46de8e(null,Date['now']()+_0x5ce42c[_0x51b8c0(0x205)]);}}),uploadMigrate=multer({'storage':storage1});function a0_0x425c(){const _0x53b730=['send','Portuguese\x20(BR)','address','/view','suppliers','findById','English\x20(US)','render','\x20added\x20successfully','aggregate','addWorksheet','error','amount','../models/all_models','findOne','find','columns','master','exceljs','Content-Type','email','file','/supplier/view','reason','suppliers_docs','user','6690950pZuQuA','purchase','originalname','multer','26987554lpbzQY','Spanish','/view/payment/:id','14abjjkm','receivable','single','json','25695puFBbR','8403980LUstOt','write','Supplier_Code','get','supplier_product_file','forEach','message','receivable_sum','errors','Arabic','12BzaxFi','455600CzSNVs','English','sheet_to_json','redirect','params','public/Migration/','\x20Failed','public/Migration','Purchase','setHeader','/supplier_import_migrate_file','Email','Mobile_number','supplier','$amount','supplier\x20data\x20update\x20successfully','status','language','diskStorage','77xRtIDC','4840TBOCmQ','PBrands','Name','../public/language/languages.json','144087CdVwgd','name','$reason','4FVggYj','post','express','German','payable_sum','../middleware/auth','mobile','Arabic\x20(ae)','Content-Disposition','Hindi','then','s_payments','payable','company','xlsx','PUnits','Portuguese','attachment;\x20filename=supplier_Migration_File.xlsx','Customers','save','429054lDJlcJ','Chinese','log','/products_export_migrate_file','success','French','utils','flash'];a0_0x425c=function(){return _0x53b730;};return a0_0x425c();}router[a0_0x2d3d68(0x1ce)](a0_0x2d3d68(0x1bc),auth,uploadMigrate[a0_0x2d3d68(0x20c)](a0_0x2d3d68(0x213)),async(_0x222ff5,_0x13bf94)=>{const _0x29d11a=a0_0x2d3d68,_0x5b789e=_0x222ff5[_0x29d11a(0x1fe)]['filename'],_0x4972b1=await xlsx['readFile'](_0x29d11a(0x1b7)+_0x5b789e);let _0x1aebe6=_0x4972b1['SheetNames'],_0x11553b=xlsx[_0x29d11a(0x1e7)][_0x29d11a(0x21c)](_0x4972b1['Sheets'][_0x1aebe6[0x0]]);for(const _0x5d421c of _0x11553b){const _0x21fc71=_0x5d421c[_0x29d11a(0x1c8)],_0x436aab=_0x5d421c[_0x29d11a(0x211)],_0x41507f=_0x5d421c[_0x29d11a(0x1eb)],_0x5be28d=_0x5d421c[_0x29d11a(0x1be)],_0x10fc15=_0x5d421c[_0x29d11a(0x1bd)],_0x3f5f33=_0x5d421c['Company_Name'];try{let _0x1aa9bd=await suppliers[_0x29d11a(0x1f7)]({'name':_0x21fc71});if(!_0x1aa9bd){const _0x1712a5=new suppliers({'name':_0x21fc71,'suppliers_code':_0x436aab,'address':_0x41507f,'mobile':_0x5be28d,'email':_0x10fc15,'company':_0x3f5f33});_0x1aa9bd=await _0x1712a5[_0x29d11a(0x1e0)](),_0x222ff5['flash']('success',_0x21fc71+_0x29d11a(0x1f1));}else _0x222ff5[_0x29d11a(0x1e8)](_0x29d11a(0x1f4),_0x21fc71+_0x29d11a(0x1b8));}catch(_0x427ade){_0x13bf94[_0x29d11a(0x1c2)](0x1f4)[_0x29d11a(0x20d)]({'proderror':_0x427ade['message'],'aproduct':ProductName});}}_0x13bf94[_0x29d11a(0x21d)](_0x29d11a(0x1ff));}),module['exports']=router;