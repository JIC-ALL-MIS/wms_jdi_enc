var a0_0xb8ce0d=a0_0x2d93;(function(_0x5bece6,_0x498978){var _0x46c376=a0_0x2d93,_0x5beb9a=_0x5bece6();while(!![]){try{var _0x3daaee=-parseInt(_0x46c376(0x1ce))/0x1+-parseInt(_0x46c376(0x15f))/0x2+parseInt(_0x46c376(0x104))/0x3*(-parseInt(_0x46c376(0x124))/0x4)+parseInt(_0x46c376(0x123))/0x5+-parseInt(_0x46c376(0x100))/0x6*(-parseInt(_0x46c376(0x196))/0x7)+-parseInt(_0x46c376(0x1c6))/0x8+parseInt(_0x46c376(0xdf))/0x9;if(_0x3daaee===_0x498978)break;else _0x5beb9a['push'](_0x5beb9a['shift']());}catch(_0x5d4024){_0x5beb9a['push'](_0x5beb9a['shift']());}}}(a0_0x5803,0xb3394));function a0_0x5803(){var _0x11ee80=['product_code_QA','$_id','/../public','quantity','Sale','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','host','Ambient','product_stock','maxPerUnit','6646125Tzymaf','865612ElkiPh','error','language','Logo.png','\x20Order\x20Date\x20:\x20','$customer','typeservices','customers_docs','/all_sales_finished/view','van','$warehouse_name','sales_invoice','success','</span>','forEach','pallet_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','getMonth','TFU','<h2>\x20','secondary_unit_QA','all','isle','primary_code','<div>','getDate','product_name_QA1','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','Sale\x20Return\x20Mail','plate','/view/return_sales/:id','Spanish','params','/all_sales_finished/preview/','customer','$product_details.unit','$sale_product.isle','French','</td>','edit_sales_finished_view','log','prod_code','Arabic','received_amount','DRSI','<hr\x20class=\x22my-3\x22>','product','PO_number','$sale_product.pallet','customers','concat','/view/add_sales','$name','</table>','$product_details.maxPerUnit','status','$note','room_name','sale_qty','169994aCtjaQ','deliverydate','prod_cat','_id','purchases_data','$product_details.CBM','primary_code_QA','</thead>','staff','prod_invoice','$product_details._id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','push','image','createTransport','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','findOne','getFullYear','</head><body>','filter','add\x20post','$isAllowEdit','driver','product_details','warehouse','json','due_amount','<table\x20style=\x22width:\x20100%\x20!important;\x22>','back','$product_details.batch_code','return_data','type','../public/language/languages.json','Return\x20Goods','RMSEmail','$product_details.primary_code','<!DOCTYPE\x20html>','barcode\x20Product\x20master','max_per_unit','$sale_product','<h5>','$product_details.production_date','$product','$date','<strong>\x20Regards\x20</strong>','There\x27s\x20a\x20error\x20in\x20this\x20transaction','get','message','save','user','maxProducts','Sales\x20Update\x20successfully','product_date','return_sale','False','2275wStmgj','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','random','Received\x20Payment\x20For\x20Sale','render','bay','stock','primary_unit','length','maxPerUnit_QA','$invoice','Enclosed','production_date','currency','all_sales_finished','True','floor','site_title','finalize','Portuguese\x20(BR)','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','isAllowEdit','warehouse_name','invoice','$product_details.invoice','/all_sales/view','Portuguese','/view/:id','expiry_date_QA','find','then','<html><head><title></title>','post','Hindi','/upload/','$product_details.product_name','findById','roombefore','$return_data','/invoice/:id','$product_details.rack','$sale_product.quantity','$customers_docs','/picking_list/PDFFinal/','Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty','sales_quantity','note','flash','4939016kjqxdV','sales_quantity_QA','email','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Level\x20</th>','$product_details.maxProducts','$room','Finished\x20Goods','carton','790879IRBkWP','$product_details.level','unit','An\x20error\x20occurred\x20while\x20saving\x20data.','return_qty_QA','string','$product_details','map','body','sale_product','OUT-','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','product_code','secondary_code','payment\x20successfull','port','CBM','$product_details.isle','Email\x20sent\x20successfully','name','room_QA','SCRN','currency_placement','</h5>','$product_details.product_code','catch','secondary_unit','RequestedBy','password','</tbody>','sales\x20item\x20return\x20successfull','</div>','German','../middleware/auth','maxProducts_QA','level_QA','English','split','pallet','product_name','1819458heaWZx','QA\x20Warehouse','Arabic\x20(ae)','errors','$product_details.expiry_date','level','production_date_QA','$product_details.pallet','$product_details.secondary_code','$product_details.secondary_unit','\x20</h2>','sendMail','expiry_date','RoomAssigned','<tbody\x20style=\x22text-align:\x20center;\x22>','return_sale_QA','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room\x20</th>','aggregate','exports','</body></html>','batch_code_QA','foreach\x20newproduct','for_categorize','logo','Error\x20Occurs','edit_sales_finished','/preview/:id','typevehicle','English\x20(US)','redirect','role','Chinese','master','24834KFVIzB','unit_QA','batch_code','$product_details.storage','9jFiHbh','$product_details.product_stock','room','$sale_product.level','/barcode/:id','<span\x20style=\x22float:\x20right;\x22>','padStart','Enabled','<h5\x20style=\x22text-align:\x20left;\x22>','maxperunit','../models/all_models','secondary_code_QA','</tr>','<tr>','return_qty','Sales\x20Add\x20successfully','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','\x20Order\x20Number\x20:\x20','product_data','date','slice'];a0_0x5803=function(){return _0x11ee80;};return a0_0x5803();}const express=require('express'),app=express(),router=express['Router'](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0xb8ce0d(0x10e)),auth=require(a0_0xb8ce0d(0xd8)),nodemailer=require('nodemailer'),users=require(a0_0xb8ce0d(0x17f));function a0_0x2d93(_0x2dbdfb,_0x4a9f64){var _0x5803b3=a0_0x5803();return a0_0x2d93=function(_0x2d93e2,_0x1ac3ef){_0x2d93e2=_0x2d93e2-0xd0;var _0x1c6fc9=_0x5803b3[_0x2d93e2];return _0x1c6fc9;},a0_0x2d93(_0x2dbdfb,_0x4a9f64);}router[a0_0xb8ce0d(0x18d)]('/view',auth,async(_0xe8ef65,_0x5b6310)=>{var _0x41c361=a0_0xb8ce0d;try{const {username:_0x26eb3f,email:_0x3eedd1,role:_0x2e5602}=_0xe8ef65[_0x41c361(0x190)],_0x7df04f=_0xe8ef65[_0x41c361(0x190)],_0x32766c=await profile[_0x41c361(0x16f)]({'email':_0x7df04f['email']}),_0x353d29=await master_shop[_0x41c361(0x1b3)]();let _0x4fe71a;if(_0x7df04f[_0x41c361(0xfd)]==_0x41c361(0x167)){const _0x233304=await staff['findOne']({'email':_0x7df04f[_0x41c361(0x1c8)]});_0x4fe71a=await sales_finished[_0x41c361(0xf0)]([{'$lookup':{'from':_0x41c361(0x155),'localField':_0x41c361(0x146),'foreignField':'name','as':_0x41c361(0x12b)}},{'$unwind':_0x41c361(0x1c0)},{'$unwind':_0x41c361(0x186)},{'$group':{'_id':_0x41c361(0x11a),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x41c361(0x129)},'date':{'$first':_0x41c361(0x18a)},'warehouse_name':{'$first':_0x41c361(0x12e)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x41c361(0x15c)},'return_data':{'$first':'$return_data'},'customers_docs':{'$first':_0x41c361(0x1c0)},'total_saleproduct_quantity':{'$sum':_0x41c361(0x1bf)},'level':{'$addToSet':_0x41c361(0x107)},'isle':{'$addToSet':_0x41c361(0x148)},'pallet':{'$addToSet':_0x41c361(0x154)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x41c361(0x174)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);}else _0x4fe71a=await sales_finished[_0x41c361(0xf0)]([{'$lookup':{'from':_0x41c361(0x155),'localField':_0x41c361(0x146),'foreignField':_0x41c361(0x1e1),'as':_0x41c361(0x12b)}},{'$unwind':_0x41c361(0x1c0)},{'$unwind':_0x41c361(0x186)},{'$group':{'_id':_0x41c361(0x11a),'invoice':{'$first':_0x41c361(0x1a0)},'customers':{'$first':'$customer'},'date':{'$first':_0x41c361(0x18a)},'warehouse_name':{'$first':_0x41c361(0x12e)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x41c361(0x15c)},'return_data':{'$first':_0x41c361(0x1bc)},'customers_docs':{'$first':_0x41c361(0x1c0)},'total_saleproduct_quantity':{'$sum':_0x41c361(0x1bf)},'level':{'$addToSet':_0x41c361(0x107)},'isle':{'$addToSet':_0x41c361(0x148)},'pallet':{'$addToSet':_0x41c361(0x154)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x41c361(0x174)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x353d29[0x0][_0x41c361(0x126)]==_0x41c361(0xfb)){var _0x1c0750=users[_0x41c361(0xdb)];console['log'](_0x1c0750);}else{if(_0x353d29[0x0][_0x41c361(0x126)]==_0x41c361(0x1b7))var _0x1c0750=users[_0x41c361(0x1b7)];else{if(_0x353d29[0x0][_0x41c361(0x126)]==_0x41c361(0xd7))var _0x1c0750=users[_0x41c361(0xd7)];else{if(_0x353d29[0x0][_0x41c361(0x126)]=='Spanish')var _0x1c0750=users[_0x41c361(0x143)];else{if(_0x353d29[0x0][_0x41c361(0x126)]==_0x41c361(0x149))var _0x1c0750=users[_0x41c361(0x149)];else{if(_0x353d29[0x0][_0x41c361(0x126)]=='Portuguese\x20(BR)')var _0x1c0750=users[_0x41c361(0x1b0)];else{if(_0x353d29[0x0][_0x41c361(0x126)]==_0x41c361(0xfe))var _0x1c0750=users[_0x41c361(0xfe)];else{if(_0x353d29[0x0]['language']==_0x41c361(0xe1))var _0x1c0750=users[_0x41c361(0x14e)];}}}}}}}_0x5b6310['render'](_0x41c361(0x1a4),{'success':_0xe8ef65[_0x41c361(0x1c5)](_0x41c361(0x130)),'errors':_0xe8ef65[_0x41c361(0x1c5)](_0x41c361(0xe2)),'sales':_0x4fe71a,'profile':_0x32766c,'role':_0x7df04f,'master_shop':_0x353d29,'language':_0x1c0750});}catch(_0x57d2fb){console[_0x41c361(0x14c)](_0x57d2fb);}});async function getRandom8DigitNumber(){var _0x36e2c1=a0_0xb8ce0d;const _0x52cd21=0x989680,_0x2bfee9=0x5f5e0ff,_0x3d182b=Math[_0x36e2c1(0x1a6)](Math[_0x36e2c1(0x198)]()*(_0x2bfee9-_0x52cd21+0x1))+_0x52cd21;var _0x3e53dc;const _0x1339ac=await sales_finished[_0x36e2c1(0x16f)]({'invoice':_0x36e2c1(0x1d8)+_0x3d182b});return _0x1339ac&&_0x1339ac['length']>0x0?_0x3e53dc='OUT-'+_0x3d182b:_0x3e53dc=_0x36e2c1(0x1d8)+_0x3d182b,_0x3e53dc;}router[a0_0xb8ce0d(0x18d)](a0_0xb8ce0d(0x157),auth,async(_0x4764c8,_0x3ba2df)=>{var _0x432bd=a0_0xb8ce0d;try{const {username:_0x42ae27,email:_0x24fd6a,role:_0xa4c995}=_0x4764c8[_0x432bd(0x190)],_0x27cd6a=_0x4764c8['user'],_0x221f2e=await profile[_0x432bd(0x16f)]({'email':_0x27cd6a[_0x432bd(0x1c8)]}),_0x2fe6a5=await master_shop[_0x432bd(0x1b3)](),_0xd0aead=await customer['find']({});let _0x26c812;if(_0x27cd6a[_0x432bd(0xfd)]==_0x432bd(0x167)){const _0x1d6b28=await staff['findOne']({'email':_0x27cd6a[_0x432bd(0x1c8)]});_0x26c812=await warehouse[_0x432bd(0xf0)]([{'$match':{'status':_0x432bd(0x10b),'name':_0x1d6b28[_0x432bd(0x177)],'name':{'$ne':_0x432bd(0xe0)}}},{'$group':{'_id':_0x432bd(0x158),'name':{'$first':_0x432bd(0x158)}}},{'$sort':{'name':0x1}}]);}else _0x26c812=await warehouse['aggregate']([{'$match':{'status':_0x432bd(0x10b),'name':{'$ne':_0x432bd(0xe0)}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0xf9f930=await product[_0x432bd(0x1b3)]({});var _0x508654=[_0x432bd(0x120),_0x432bd(0x1a1)];const _0x2c5598=await sales_finished[_0x432bd(0x1b3)]({}),_0x1fef9f=_0x2c5598[_0x432bd(0x19e)]+0x1,_0xedf3e2=_0x432bd(0x1d8)+_0x1fef9f['toString']()[_0x432bd(0x10a)](0x5,'0');if(_0x2fe6a5[0x0][_0x432bd(0x126)]=='English\x20(US)'){var _0x4f9389=users[_0x432bd(0xdb)];console[_0x432bd(0x14c)](_0x4f9389);}else{if(_0x2fe6a5[0x0][_0x432bd(0x126)]=='Hindi')var _0x4f9389=users[_0x432bd(0x1b7)];else{if(_0x2fe6a5[0x0][_0x432bd(0x126)]=='German')var _0x4f9389=users['German'];else{if(_0x2fe6a5[0x0]['language']==_0x432bd(0x143))var _0x4f9389=users[_0x432bd(0x143)];else{if(_0x2fe6a5[0x0]['language']==_0x432bd(0x149))var _0x4f9389=users['French'];else{if(_0x2fe6a5[0x0]['language']==_0x432bd(0x1a9))var _0x4f9389=users[_0x432bd(0x1b0)];else{if(_0x2fe6a5[0x0][_0x432bd(0x126)]==_0x432bd(0xfe))var _0x4f9389=users[_0x432bd(0xfe)];else{if(_0x2fe6a5[0x0][_0x432bd(0x126)]==_0x432bd(0xe1))var _0x4f9389=users[_0x432bd(0x14e)];}}}}}}}const _0x1b0741=getRandom8DigitNumber();_0x1b0741['then'](_0x2941c2=>{var _0x2c49cb=_0x432bd;_0x3ba2df[_0x2c49cb(0x19a)]('add_sales_finished',{'success':_0x4764c8[_0x2c49cb(0x1c5)]('success'),'errors':_0x4764c8['flash'](_0x2c49cb(0xe2)),'role':_0x27cd6a,'profile':_0x221f2e,'customer':_0xd0aead,'warehouse':_0x26c812,'product':_0xf9f930,'invoice':_0x2941c2,'master_shop':_0x2fe6a5,'language':_0x4f9389,'rooms_data':_0x508654});})[_0x432bd(0xd0)](_0x83182d=>{var _0x528709=_0x432bd;_0x4764c8['flash'](_0x528709(0xe2),_0x528709(0x18c)),_0x3ba2df['redirect'](_0x528709(0x12c));});}catch(_0x1e388b){console['log'](_0x1e388b);}}),router[a0_0xb8ce0d(0x18d)]('/view/add_sales/:id',auth,async(_0x25d02,_0x31b04b)=>{var _0x286ab4=a0_0xb8ce0d;try{const _0x47e613=_0x25d02[_0x286ab4(0x144)]['id'];console['log'](_0x47e613);const _0x384e18=await product[_0x286ab4(0x1b3)](),_0x3b823d=await purchases[_0x286ab4(0xf0)]([{'$match':{'warehouse_name':_0x47e613}},{'$unwind':_0x286ab4(0x189)},{'$group':{'_id':'$product.product_name'}}]);console[_0x286ab4(0x14c)](_0x286ab4(0x163),_0x3b823d),_0x31b04b[_0x286ab4(0x15b)](0xc8)['json']({'purchases_data':_0x3b823d,'product_data':_0x384e18});}catch(_0x331bb8){console['log'](_0x331bb8);}}),router['post']('/view/add_sale/product',auth,async(_0x5ac55e,_0x57ba96)=>{var _0x2aaf80=a0_0xb8ce0d;try{const {warehouse_data:_0xc0a7c6,product_data:_0x50dfa7}=_0x5ac55e[_0x2aaf80(0x1d6)];console['log'](_0x5ac55e[_0x2aaf80(0x1d6)][_0x2aaf80(0x116)]);;const _0x399edb=await master_shop['find']();console['log'](_0x2aaf80(0xff),_0x399edb);const _0x10b85e=await product[_0x2aaf80(0x16f)]({'name':_0x50dfa7});console[_0x2aaf80(0x14c)](_0x2aaf80(0x152),_0x10b85e);const _0x5ac988=await warehouse[_0x2aaf80(0xf0)]([{'$match':{'name':_0xc0a7c6}},{'$unwind':_0x2aaf80(0x1d4)},{'$match':{'product_details.product_name':_0x50dfa7}},{'$group':{'_id':_0x2aaf80(0x1b9),'product_stock':{'$first':'$product_details.product_stock'}}}]);console[_0x2aaf80(0x14c)]('stock_data',_0x5ac988),_0x57ba96[_0x2aaf80(0x15b)](0xc8)[_0x2aaf80(0x178)]({'master':_0x399edb,'new_product':_0x10b85e,'stock_data':_0x5ac988});}catch(_0x2ab272){console[_0x2aaf80(0x14c)](_0x2ab272);}}),router[a0_0xb8ce0d(0x1b6)](a0_0xb8ce0d(0x157),auth,async(_0x449f57,_0x5d3f08)=>{var _0x13ec11=a0_0xb8ce0d;try{const {invoice:_0x43d183,date:_0x2f6bad,warehouse_name:_0x515227,product_name:_0x360873,stock:_0x53996b,quantity:_0x3e8548,note:_0x1ee2fe,room:_0x3fcc06,primary_code:_0x2def3d,secondary_code:_0x485dc6,prod_code:_0x49cab4,level:_0x25491e,isle:_0x2faf82,pallet:_0x80d030,batch_code:_0x4bb548,SCRN:_0x45ffa5,expiry_date:_0x4b5211,PO_number:_0x40a319,ReqBy:_0x17cfe3,dateofreq:_0x3e64a3,typeservicesData:_0x58c069,destination:_0x4ce735,deliverydate:_0x2ea445,driver:_0x348515,plate:_0x4144f1,van:_0x5ec501,DRSI:_0x58b245,typevehicle:_0x4978b6,TSU:_0x3d5135,TFU:_0x324708}=_0x449f57['body'];if(typeof _0x360873=='string')var _0x52a397=[_0x449f57['body']['product_name']],_0x19403a=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x19c)]],_0x53fc64=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x1cd)]],_0x288aa3=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x13b)]],_0x5121ae=[_0x449f57[_0x13ec11(0x1d6)]['secondary_code']],_0x261e80=[_0x449f57['body'][_0x13ec11(0x14d)]],_0x11dda3=[_0x449f57['body'][_0x13ec11(0xe4)]],_0x338de8=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x19d)]],_0x28c4c5=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0xd1)]],_0x435d33=[_0x449f57['body'][_0x13ec11(0x102)]],_0x409834=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0xeb)]],_0x1c5311=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x193)]],_0x453bdb=[_0x449f57['body'][_0x13ec11(0x185)]],_0x166193=[_0x449f57['body'][_0x13ec11(0x161)]],_0x8c7dbe=[_0x449f57['body'][_0x13ec11(0xec)]],_0x35d708=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x17e)]],_0xb245bc=[_0x449f57[_0x13ec11(0x1d6)]['CBM']],_0x236f93=[_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x168)]];else var _0x52a397=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0xde)]],_0x19403a=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x19c)]],_0x53fc64=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x1cd)]],_0x288aa3=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x13b)]],_0x5121ae=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x1db)]],_0x261e80=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x14d)]],_0x11dda3=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0xe4)]],_0x338de8=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x19d)]],_0x28c4c5=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0xd1)]],_0x435d33=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x102)]],_0x409834=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0xeb)]],_0x1c5311=[..._0x449f57['body'][_0x13ec11(0x193)]],_0x453bdb=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x185)]],_0x166193=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x161)]],_0x8c7dbe=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0xec)]],_0x35d708=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x17e)]],_0xb245bc=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x1de)]],_0x236f93=[..._0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x168)]];const _0x4cc140=_0x52a397[_0x13ec11(0x1d5)](_0x2449de=>{return _0x2449de={'product_name':_0x2449de};});_0x19403a['forEach']((_0xb0a1b8,_0x596dbf)=>{var _0x4994ce=_0x13ec11;_0x4cc140[_0x596dbf][_0x4994ce(0x19c)]=_0xb0a1b8;}),_0x53fc64[_0x13ec11(0x132)]((_0x3b4143,_0x6d3f90)=>{var _0x403d23=_0x13ec11;_0x4cc140[_0x6d3f90][_0x403d23(0x11c)]=_0x3b4143;}),_0x288aa3[_0x13ec11(0x132)]((_0x3c213f,_0x393ff4)=>{var _0x9426f2=_0x13ec11;_0x4cc140[_0x393ff4][_0x9426f2(0x13b)]=_0x3c213f;}),_0x5121ae['forEach']((_0x264463,_0xccf7b9)=>{var _0xbdbc2b=_0x13ec11;_0x4cc140[_0xccf7b9][_0xbdbc2b(0x1db)]=_0x264463;}),_0x261e80[_0x13ec11(0x132)]((_0x2ea642,_0x234af7)=>{var _0x7ac9ea=_0x13ec11;_0x4cc140[_0x234af7][_0x7ac9ea(0x1da)]=_0x2ea642;}),_0x11dda3[_0x13ec11(0x132)]((_0x556da5,_0x57bb05)=>{var _0x59e3e3=_0x13ec11,_0x732c47=_0x556da5[_0x59e3e3(0x118)](0x1);_0x4cc140[_0x57bb05][_0x59e3e3(0x13a)]=_0x556da5[0x0],_0x4cc140[_0x57bb05][_0x59e3e3(0xdd)]=_0x732c47;}),_0x35d708[_0x13ec11(0x132)]((_0x43110e,_0x5c5ed1)=>{var _0x15c161=_0x13ec11;_0x4cc140[_0x5c5ed1][_0x15c161(0xe4)]=_0x43110e;}),_0x338de8[_0x13ec11(0x132)]((_0x361119,_0x5d416d)=>{var _0x39851c=_0x13ec11;_0x4cc140[_0x5d416d][_0x39851c(0x1d0)]=_0x361119;}),_0x28c4c5[_0x13ec11(0x132)]((_0x3f1f15,_0x27f281)=>{var _0xe92e78=_0x13ec11;_0x4cc140[_0x27f281][_0xe92e78(0xd1)]=_0x3f1f15;}),_0x435d33['forEach']((_0x41007b,_0x5d796e)=>{_0x4cc140[_0x5d796e]['batch_code']=_0x41007b;}),_0x409834[_0x13ec11(0x132)]((_0xbeb889,_0x201b8e)=>{var _0x9a5166=_0x13ec11;_0x4cc140[_0x201b8e][_0x9a5166(0xeb)]=_0xbeb889;}),_0x1c5311[_0x13ec11(0x132)]((_0xc9073a,_0x28a646)=>{var _0x4e8c09=_0x13ec11;_0x4cc140[_0x28a646][_0x4e8c09(0x1a2)]=_0xc9073a;}),_0x453bdb[_0x13ec11(0x132)]((_0x4e214a,_0x505fa2)=>{var _0x352b52=_0x13ec11;_0x4cc140[_0x505fa2][_0x352b52(0x10d)]=_0x4e214a;}),_0x166193[_0x13ec11(0x132)]((_0xd74497,_0x215c52)=>{_0x4cc140[_0x215c52]['prod_cat']=_0xd74497;}),_0x8c7dbe[_0x13ec11(0x132)]((_0x27a4dd,_0x369264)=>{var _0x4aecd6=_0x13ec11;_0x4cc140[_0x369264][_0x4aecd6(0x15d)]=_0x27a4dd;}),_0xb245bc[_0x13ec11(0x132)]((_0x1ed503,_0x41dfc4)=>{var _0x2dc3d4=_0x13ec11;_0x4cc140[_0x41dfc4][_0x2dc3d4(0x1de)]=_0x1ed503;}),_0x236f93['forEach']((_0xf6fb97,_0x2f9494)=>{var _0x23dd7b=_0x13ec11;_0x4cc140[_0x2f9494][_0x23dd7b(0x1ad)]=_0xf6fb97;});var _0x136468=0x0;_0x4cc140[_0x13ec11(0x132)](_0x3fc32e=>{var _0xe1b86=_0x13ec11;console[_0xe1b86(0x14c)](_0xe1b86(0xf4),_0x3fc32e),(parseInt(_0x3fc32e[_0xe1b86(0x19c)])<parseInt(_0x3fc32e['quantity'])||parseInt(_0x3fc32e[_0xe1b86(0x11c)])==0x0)&&_0x136468++;});if(_0x136468!=0x0)return _0x449f57[_0x13ec11(0x1c5)](_0x13ec11(0xe2),_0x13ec11(0x16e)),_0x5d3f08[_0x13ec11(0xfc)](_0x13ec11(0x17b));const _0x3adc27=_0x4cc140[_0x13ec11(0x172)](_0x58c16a=>_0x58c16a['quantity']!=='0'&&_0x58c16a[_0x13ec11(0x11c)]!==''),_0x309d2f=new sales_finished({'invoice':_0x43d183,'customer':_0x449f57[_0x13ec11(0x1d6)]['customer'],'date':_0x2f6bad,'warehouse_name':_0x515227,'sale_product':_0x3adc27,'note':_0x1ee2fe,'room':_0x3fcc06,'primary_code':_0x2def3d,'secondary_code':_0x485dc6,'prod_code':_0x49cab4,'SCRN':_0x45ffa5,'finalize':_0x13ec11(0x195),'PO_number':_0x40a319,'RequestedBy':_0x17cfe3,'DateofRequest':_0x3e64a3,'typeservices':_0x58c069,'destination':_0x4ce735,'deliverydate':_0x2ea445,'driver':_0x348515,'plate':_0x4144f1,'van':_0x5ec501,'DRSI':_0x58b245,'typevehicle':_0x4978b6,'TSU':_0x3d5135,'TFU':_0x324708}),_0x2c75db=await _0x309d2f['save'](),_0x44799f=await sales_finished[_0x13ec11(0x16f)]({'invoice':_0x43d183}),_0x5acb6a=new c_payment_data({'invoice':_0x43d183,'customer':_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x146)],'reason':_0x13ec11(0x11d)});await _0x5acb6a[_0x13ec11(0x18f)]();const _0x32cc44=await master_shop['find'](),_0x38e6a3=await email_settings[_0x13ec11(0x16f)](),_0x102ac7=await customer['findOne']({'name':_0x449f57[_0x13ec11(0x1d6)][_0x13ec11(0x146)]});_0x32cc44[0x0][_0x13ec11(0x1e4)]==0x1?(right_currency=_0x32cc44[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x32cc44[0x0][_0x13ec11(0x1a3)]);var _0x4c45a9=_0x52a397,_0x3bc807=_0x53fc64,_0x244c1b='',_0x46e42a;for(_0x46e42a in _0x4c45a9){_0x244c1b+=_0x13ec11(0x111)+_0x13ec11(0x114)+_0x4c45a9[_0x46e42a]+'</td>'+_0x13ec11(0x114)+_0x3bc807[_0x46e42a]+_0x13ec11(0x14a)+_0x13ec11(0x110);}_0x449f57[_0x13ec11(0x1c5)](_0x13ec11(0x130),_0x13ec11(0x113)),_0x5d3f08['redirect'](_0x13ec11(0x145)+_0x2c75db[_0x13ec11(0x162)]);}catch(_0x442bf6){console['log'](_0x442bf6);}}),router[a0_0xb8ce0d(0x18d)](a0_0xb8ce0d(0xf9),auth,async(_0xce4850,_0x46c37d)=>{var _0x1dbacd=a0_0xb8ce0d;try{const {username:_0x4a07b3,email:_0x44ed4b,role:_0x37b806}=_0xce4850[_0x1dbacd(0x190)],_0x2e845a=_0xce4850[_0x1dbacd(0x190)],_0x4a608f=await profile[_0x1dbacd(0x16f)]({'email':_0x2e845a[_0x1dbacd(0x1c8)]}),_0x1b81af=await master_shop['find'](),_0x116cf9=_0xce4850['params']['id'],_0x5f3a19=await sales_finished[_0x1dbacd(0x1ba)](_0x116cf9),_0x5bcdc3=await warehouse['aggregate']([{'$match':{'name':_0x5f3a19[_0x1dbacd(0x1ac)]}},{'$unwind':_0x1dbacd(0x1d4)},{'$group':{'_id':'$product_details._id','name':{'$first':_0x1dbacd(0x1b9)},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':_0x1dbacd(0x1cf)},'isle':{'$first':_0x1dbacd(0x1df)},'pallet':{'$first':_0x1dbacd(0xe6)},'primary_code':{'$first':_0x1dbacd(0x182)},'secondary_code':{'$first':_0x1dbacd(0xe7)},'product_code':{'$first':_0x1dbacd(0x1e6)},'storage':{'$first':_0x1dbacd(0x103)},'rack':{'$first':_0x1dbacd(0x1be)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x1dbacd(0x188)},'batch_code':{'$first':_0x1dbacd(0x17c)},'room':{'$first':_0x1dbacd(0x1cb)}}}]),_0x109979=await customer[_0x1dbacd(0x1b3)]({});let _0x55c818;if(_0x2e845a[_0x1dbacd(0xfd)]=='staff'){const _0x4acd8b=await staff['findOne']({'email':_0x2e845a[_0x1dbacd(0x1c8)]});_0x55c818=await warehouse[_0x1dbacd(0xf0)]([{'$match':{'status':_0x1dbacd(0x10b),'name':_0x4acd8b['warehouse']}},{'$group':{'_id':_0x1dbacd(0x158),'name':{'$first':'$name'}}}]);}else _0x55c818=await warehouse[_0x1dbacd(0xf0)]([{'$match':{'status':_0x1dbacd(0x10b)}},{'$group':{'_id':_0x1dbacd(0x158),'name':{'$first':_0x1dbacd(0x158)}}}]);const _0x5ba29f=await product[_0x1dbacd(0x1b3)]({});if(_0x1b81af[0x0]['language']==_0x1dbacd(0xfb)){var _0x5448d9=users[_0x1dbacd(0xdb)];console['log'](_0x5448d9);}else{if(_0x1b81af[0x0]['language']==_0x1dbacd(0x1b7))var _0x5448d9=users['Hindi'];else{if(_0x1b81af[0x0][_0x1dbacd(0x126)]==_0x1dbacd(0xd7))var _0x5448d9=users['German'];else{if(_0x1b81af[0x0][_0x1dbacd(0x126)]==_0x1dbacd(0x143))var _0x5448d9=users[_0x1dbacd(0x143)];else{if(_0x1b81af[0x0][_0x1dbacd(0x126)]==_0x1dbacd(0x149))var _0x5448d9=users[_0x1dbacd(0x149)];else{if(_0x1b81af[0x0][_0x1dbacd(0x126)]==_0x1dbacd(0x1a9))var _0x5448d9=users[_0x1dbacd(0x1b0)];else{if(_0x1b81af[0x0][_0x1dbacd(0x126)]=='Chinese')var _0x5448d9=users[_0x1dbacd(0xfe)];else{if(_0x1b81af[0x0][_0x1dbacd(0x126)]==_0x1dbacd(0xe1))var _0x5448d9=users[_0x1dbacd(0x14e)];}}}}}}}_0x46c37d[_0x1dbacd(0x19a)](_0x1dbacd(0x14b),{'success':_0xce4850[_0x1dbacd(0x1c5)](_0x1dbacd(0x130)),'errors':_0xce4850['flash'](_0x1dbacd(0xe2)),'role':_0x2e845a,'profile':_0x4a608f,'customer':_0x109979,'warehouse':_0x55c818,'product':_0x5bcdc3,'user':_0x5f3a19,'master_shop':_0x1b81af,'unit':_0x5ba29f,'language':_0x5448d9});}catch(_0x300ee2){console[_0x1dbacd(0x14c)](_0x300ee2);}}),router[a0_0xb8ce0d(0x1b6)](a0_0xb8ce0d(0xf9),auth,async(_0x565c55,_0x21a6d0)=>{var _0x1548ad=a0_0xb8ce0d;try{const _0x1182bd=_0x565c55['params']['id'],{invoice:_0x18b28a,warehouse_name:_0x567a00,room:_0x2c1517}=_0x565c55['body'],_0x1d228d=await sales_finished[_0x1548ad(0x16f)]({'invoice':_0x18b28a}),_0x583c54=_0x1d228d[_0x1548ad(0x1d7)]['map'](async _0x4493f2=>{var _0x590bea=_0x1548ad,_0x372a9d=await warehouse[_0x590bea(0x16f)]({'name':_0x567a00,'room':_0x4493f2[_0x590bea(0x15d)]});const _0x1124c4=_0x372a9d['product_details'][_0x590bea(0x1d5)](_0x4598cc=>{var _0x29743a=_0x590bea;_0x4598cc[_0x29743a(0xde)]==_0x4493f2['product_name']&&_0x4598cc[_0x29743a(0xe4)]==_0x4493f2[_0x29743a(0xe4)]&&_0x4598cc[_0x29743a(0x13a)]==_0x4493f2[_0x29743a(0x13a)]&&_0x4598cc[_0x29743a(0xdd)]==_0x4493f2[_0x29743a(0xdd)]&&_0x4598cc['expiry_date']==_0x4493f2[_0x29743a(0xeb)]&&_0x4598cc['production_date']==_0x4493f2['production_date']&&_0x4598cc[_0x29743a(0x102)]==_0x4493f2[_0x29743a(0x102)]&&_0x4598cc[_0x29743a(0x1ad)]==_0x4493f2['invoice']&&(_0x4598cc[_0x29743a(0x121)]=_0x4598cc[_0x29743a(0x121)]-_0x4493f2['quantity']);});return _0x372a9d;});Promise['all'](_0x583c54)[_0x1548ad(0x1b4)](async _0x101e60=>{var _0x36e604=_0x1548ad;try{for(const _0x2ec384 of _0x101e60){await _0x2ec384[_0x36e604(0x18f)]();}_0x1d228d[_0x36e604(0x1a8)]='True';const _0x1bc41e=await _0x1d228d[_0x36e604(0x18f)]();var _0x5c502b=_0x1d228d['sale_product'];const _0x4674cb=await master_shop['find'](),_0x2be22c=await email_settings[_0x36e604(0x16f)](),_0x4efa68=await supervisor_settings['find']();let _0x2c00bf=nodemailer['createTransport']({'host':_0x2be22c[_0x36e604(0x11f)],'port':Number(_0x2be22c[_0x36e604(0x1dd)]),'secure':![],'auth':{'user':_0x2be22c[_0x36e604(0x1c8)],'pass':_0x2be22c[_0x36e604(0xd3)]}});var _0x3a37a6='',_0x41bf70;for(_0x41bf70 in _0x5c502b){_0x3a37a6+=_0x36e604(0x111)+_0x36e604(0x114)+_0x5c502b[_0x41bf70][_0x36e604(0xde)]+_0x36e604(0x14a)+_0x36e604(0x114)+_0x5c502b[_0x41bf70][_0x36e604(0x11c)]+_0x36e604(0x14a)+_0x36e604(0x114)+_0x5c502b[_0x41bf70][_0x36e604(0x15d)]+_0x36e604(0x14a)+_0x36e604(0x114)+_0x5c502b[_0x41bf70]['level']+'</td>'+_0x36e604(0x114)+_0x5c502b[_0x41bf70]['isle']+_0x5c502b[_0x41bf70]['pallet']+_0x36e604(0x14a)+_0x36e604(0x110);}let _0x193f10={'from':_0x2be22c[_0x36e604(0x1c8)],'to':_0x4efa68[0x0][_0x36e604(0x181)],'subject':'Sale\x20Product\x20Mail','attachments':[{'filename':_0x36e604(0x127),'path':__dirname+_0x36e604(0x11b)+_0x36e604(0x1b8)+_0x4674cb[0x0]['image'],'cid':_0x36e604(0xf6)}],'html':_0x36e604(0x183)+_0x36e604(0x1b5)+'</head><body>'+_0x36e604(0x13c)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x36e604(0x13c)+_0x36e604(0x13f)+'</div>'+_0x36e604(0x13c)+_0x36e604(0x137)+_0x4674cb[0x0][_0x36e604(0x1a7)]+_0x36e604(0xe9)+_0x36e604(0xd6)+_0x36e604(0xd6)+_0x36e604(0x151)+_0x36e604(0x13c)+_0x36e604(0x10c)+_0x36e604(0x115)+_0x1d228d[_0x36e604(0x1ad)]+'\x20'+'<span\x20style=\x22float:\x20right;\x22>'+_0x36e604(0x128)+_0x1d228d[_0x36e604(0x117)]+'\x20'+_0x36e604(0x131)+_0x36e604(0x1e5)+_0x36e604(0xd6)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+'<thead\x20style=\x22width:\x20100%\x20!important;\x22>'+'<tr>'+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>'+_0x36e604(0x197)+_0x36e604(0xef)+_0x36e604(0x1c9)+_0x36e604(0x11e)+'</tr>'+_0x36e604(0x166)+'<tbody\x20style=\x22text-align:\x20center;\x22>'+'\x20'+_0x3a37a6+'\x20'+_0x36e604(0xd4)+'</table>'+'<div>'+_0x36e604(0x18b)+_0x36e604(0x187)+_0x4674cb[0x0]['site_title']+_0x36e604(0x1e5)+_0x36e604(0xd6)+_0x36e604(0xd6)+_0x36e604(0xf2)};_0x2c00bf['sendMail'](_0x193f10,function(_0x2101a6,_0xf72eab){var _0x51509a=_0x36e604;_0x2101a6?(console['log'](_0x2101a6),console['log'](_0x51509a(0xf7))):console[_0x51509a(0x14c)]('Email\x20sent\x20successfully');}),_0x565c55[_0x36e604(0x1c5)](_0x36e604(0x130),_0x36e604(0x192)),_0x21a6d0['redirect'](_0x36e604(0x1c1)+_0x1182bd);}catch(_0x1425c9){console[_0x36e604(0x125)](_0x1425c9),_0x21a6d0['status'](0x1f4)[_0x36e604(0x178)]({'error':_0x36e604(0x1d1)});}})[_0x1548ad(0xd0)](_0x2a3fde=>{var _0x24ff97=_0x1548ad;console[_0x24ff97(0x125)](_0x2a3fde),_0x21a6d0[_0x24ff97(0x15b)](0x1f4)[_0x24ff97(0x178)]({'error':'An\x20error\x20occurred.'});});}catch(_0x3aa7c1){console[_0x1548ad(0x14c)](_0x3aa7c1);}}),router['get'](a0_0xb8ce0d(0x1b1),auth,async(_0xd68b2d,_0x44dfe1)=>{var _0x32e49f=a0_0xb8ce0d;try{const {username:_0x271145,email:_0x4eba04,role:_0x3c1363}=_0xd68b2d[_0x32e49f(0x190)],_0x4159d0=_0xd68b2d[_0x32e49f(0x190)],_0x102716=await profile['findOne']({'email':_0x4159d0[_0x32e49f(0x1c8)]}),_0x13b59f=await master_shop[_0x32e49f(0x1b3)](),_0x37e27e=_0xd68b2d[_0x32e49f(0x144)]['id'],_0x5617e0=await sales_finished[_0x32e49f(0x1ba)](_0x37e27e);var _0x2059f1=[_0x32e49f(0x120),_0x32e49f(0x1a1)];const _0xef2105=await warehouse[_0x32e49f(0xf0)]([{'$match':{'name':_0x5617e0[_0x32e49f(0x1ac)]}},{'$unwind':_0x32e49f(0x1d4)},{'$group':{'_id':_0x32e49f(0x169),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':'$product_details.product_stock'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x32e49f(0x1df)},'pallet':{'$first':_0x32e49f(0xe6)},'primary_code':{'$first':_0x32e49f(0x182)},'secondary_code':{'$first':_0x32e49f(0xe7)},'product_code':{'$first':_0x32e49f(0x1e6)},'storage':{'$first':_0x32e49f(0x103)},'rack':{'$first':_0x32e49f(0x1be)},'expiry_date':{'$first':_0x32e49f(0xe3)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x32e49f(0x17c)},'room':{'$first':_0x32e49f(0x1cb)}}}]),_0x33380e=await customer[_0x32e49f(0x1b3)]({});let _0x4fdf68;if(_0x4159d0[_0x32e49f(0xfd)]==_0x32e49f(0x167)){const _0x10773e=await staff[_0x32e49f(0x16f)]({'email':_0x4159d0['email']});_0x4fdf68=await warehouse[_0x32e49f(0xf0)]([{'$match':{'status':_0x32e49f(0x10b),'name':_0x10773e[_0x32e49f(0x177)]}},{'$group':{'_id':_0x32e49f(0x158),'name':{'$first':_0x32e49f(0x158)}}}]);}else _0x4fdf68=await warehouse['aggregate']([{'$match':{'status':_0x32e49f(0x10b)}},{'$group':{'_id':'$name','name':{'$first':_0x32e49f(0x158)}}}]);const _0x1adfaa=await product[_0x32e49f(0x1b3)]({});if(_0x13b59f[0x0][_0x32e49f(0x126)]==_0x32e49f(0xfb)){var _0x49fd55=users['English'];console[_0x32e49f(0x14c)](_0x49fd55);}else{if(_0x13b59f[0x0][_0x32e49f(0x126)]=='Hindi')var _0x49fd55=users[_0x32e49f(0x1b7)];else{if(_0x13b59f[0x0][_0x32e49f(0x126)]==_0x32e49f(0xd7))var _0x49fd55=users[_0x32e49f(0xd7)];else{if(_0x13b59f[0x0][_0x32e49f(0x126)]==_0x32e49f(0x143))var _0x49fd55=users['Spanish'];else{if(_0x13b59f[0x0]['language']==_0x32e49f(0x149))var _0x49fd55=users[_0x32e49f(0x149)];else{if(_0x13b59f[0x0][_0x32e49f(0x126)]==_0x32e49f(0x1a9))var _0x49fd55=users[_0x32e49f(0x1b0)];else{if(_0x13b59f[0x0][_0x32e49f(0x126)]==_0x32e49f(0xfe))var _0x49fd55=users[_0x32e49f(0xfe)];else{if(_0x13b59f[0x0][_0x32e49f(0x126)]==_0x32e49f(0xe1))var _0x49fd55=users[_0x32e49f(0x14e)];}}}}}}}_0x44dfe1[_0x32e49f(0x19a)](_0x32e49f(0xf8),{'success':_0xd68b2d['flash'](_0x32e49f(0x130)),'errors':_0xd68b2d[_0x32e49f(0x1c5)]('errors'),'role':_0x4159d0,'profile':_0x102716,'customer':_0x33380e,'warehouse':_0x4fdf68,'product':_0xef2105,'user':_0x5617e0,'master_shop':_0x13b59f,'unit':_0x1adfaa,'language':_0x49fd55});}catch(_0x63d8ed){console[_0x32e49f(0x14c)](_0x63d8ed);}}),router[a0_0xb8ce0d(0x1b6)](a0_0xb8ce0d(0x1b1),auth,async(_0x51f741,_0x11f0c0)=>{var _0x260631=a0_0xb8ce0d;try{const _0x425ac3=_0x51f741[_0x260631(0x144)]['id'],_0x11d367=await sales_finished[_0x260631(0x16f)]({'_id':_0x51f741[_0x260631(0x144)]['id']}),_0x57a870=await warehouse['findOne']({'name':_0x11d367[_0x260631(0x1ac)],'room':_0x51f741['body'][_0x260631(0x106)],'warehouse_category':_0x260631(0x1cc)}),{invoice:_0xb17b99,date:_0x54e3cd,warehouse_name:_0x14f65f,product_name:_0x486d89,customer:_0x25d8b2,stock:_0x4d377f,quantity:_0x1a990b,note:_0x30ed86,room:_0x57f297,primary_code:_0x2fd2ca,secondary_code:_0x1aec4e,prod_code:_0xcf14ad,level:_0x243037,isle:_0x1e40c,pallet:_0x41c30a,batch_code:_0x39abe7,SCRN:_0x1dc355,expiry_date:_0x21085c,PO_number:_0x502fd4,ReqBy:_0x520026,dateofreq:_0x5294b0,typeservicesData:_0x38c6dc,destination:_0x28aeeb,deliverydate:_0x14bfe0,driver:_0x15ac66,plate:_0x5a8748,van:_0x5e9b00,DRSI:_0x418516,typevehicle:_0x6e42fe,TSU:_0x422657,TFU:_0x3abd34}=_0x51f741[_0x260631(0x1d6)];if(typeof _0x486d89==_0x260631(0x1d3))var _0x4ff2ec=[_0x51f741['body']['product_name']],_0x3d3e33=[_0x51f741[_0x260631(0x1d6)]['stock']],_0x197d0f=[_0x51f741['body']['carton']],_0x519546=[_0x51f741[_0x260631(0x1d6)][_0x260631(0x13b)]],_0x310447=[_0x51f741[_0x260631(0x1d6)][_0x260631(0x1db)]],_0x272393=[_0x51f741['body']['prod_code']],_0x4b243=[_0x51f741[_0x260631(0x1d6)]['level']],_0x30a27b=[_0x51f741['body'][_0x260631(0x19d)]],_0x404684=[_0x51f741[_0x260631(0x1d6)][_0x260631(0xd1)]],_0x42f1a6=[_0x51f741[_0x260631(0x1d6)]['batch_code']],_0x17f0d8=[_0x51f741[_0x260631(0x1d6)][_0x260631(0xeb)]],_0x521290=[_0x51f741['body']['product_date']],_0x4dcb6d=[_0x51f741['body'][_0x260631(0x185)]],_0x45a993=[_0x51f741[_0x260631(0x1d6)][_0x260631(0x161)]],_0x52105d=[_0x51f741['body'][_0x260631(0xec)]],_0xaad23d=[_0x51f741[_0x260631(0x1d6)][_0x260631(0x17e)]],_0x54fc5d=[_0x51f741[_0x260631(0x1d6)][_0x260631(0x1de)]];else var _0x4ff2ec=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0xde)]],_0x3d3e33=[..._0x51f741[_0x260631(0x1d6)]['stock']],_0x197d0f=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x1cd)]],_0x519546=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x13b)]],_0x310447=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x1db)]],_0x272393=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x14d)]],_0x4b243=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0xe4)]],_0x30a27b=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x19d)]],_0x404684=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0xd1)]],_0x42f1a6=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x102)]],_0x17f0d8=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0xeb)]],_0x521290=[..._0x51f741['body'][_0x260631(0x193)]],_0x4dcb6d=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x185)]],_0x45a993=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x161)]],_0x52105d=[..._0x51f741[_0x260631(0x1d6)]['RoomAssigned']],_0xaad23d=[..._0x51f741[_0x260631(0x1d6)][_0x260631(0x17e)]],_0x54fc5d=[..._0x51f741[_0x260631(0x1d6)]['CBM']];const _0x2e5f80=_0x4ff2ec[_0x260631(0x1d5)](_0x221150=>{return _0x221150={'product_name':_0x221150};});_0x3d3e33[_0x260631(0x132)]((_0x2d085e,_0x2fb25f)=>{var _0xde3b33=_0x260631;_0x2e5f80[_0x2fb25f][_0xde3b33(0x19c)]=_0x2d085e;}),_0x197d0f[_0x260631(0x132)]((_0x11e4c4,_0x53b6d1)=>{_0x2e5f80[_0x53b6d1]['quantity']=_0x11e4c4;}),_0x519546[_0x260631(0x132)]((_0x446e06,_0x3e1ceb)=>{var _0x5ace38=_0x260631;_0x2e5f80[_0x3e1ceb][_0x5ace38(0x13b)]=_0x446e06;}),_0x310447[_0x260631(0x132)]((_0x54ea4e,_0x336df0)=>{_0x2e5f80[_0x336df0]['secondary_code']=_0x54ea4e;}),_0x272393[_0x260631(0x132)]((_0x26725e,_0x28eb94)=>{var _0x7cb690=_0x260631;_0x2e5f80[_0x28eb94][_0x7cb690(0x1da)]=_0x26725e;}),_0x4b243['forEach']((_0x2eea97,_0x265d7c)=>{var _0xed95d0=_0x260631,_0x34ef2c=_0x2eea97['slice'](0x1);_0x2e5f80[_0x265d7c][_0xed95d0(0x13a)]=_0x2eea97[0x0],_0x2e5f80[_0x265d7c][_0xed95d0(0xdd)]=_0x34ef2c;}),_0xaad23d[_0x260631(0x132)]((_0x5b9423,_0x2bb071)=>{var _0x8a5af1=_0x260631;_0x2e5f80[_0x2bb071][_0x8a5af1(0xe4)]=_0x5b9423;}),_0x30a27b[_0x260631(0x132)]((_0x27df00,_0x492d99)=>{_0x2e5f80[_0x492d99]['unit']=_0x27df00;}),_0x404684[_0x260631(0x132)]((_0x72badd,_0x1d5fb7)=>{var _0x113a68=_0x260631;_0x2e5f80[_0x1d5fb7][_0x113a68(0xd1)]=_0x72badd;}),_0x42f1a6[_0x260631(0x132)]((_0x78796d,_0x442640)=>{_0x2e5f80[_0x442640]['batch_code']=_0x78796d;}),_0x17f0d8[_0x260631(0x132)]((_0x4a4a06,_0x226083)=>{var _0x13f649=_0x260631;_0x2e5f80[_0x226083][_0x13f649(0xeb)]=_0x4a4a06;}),_0x521290[_0x260631(0x132)]((_0xfa6634,_0x26e535)=>{var _0x410e65=_0x260631;_0x2e5f80[_0x26e535][_0x410e65(0x1a2)]=_0xfa6634;}),_0x4dcb6d['forEach']((_0x37dbab,_0x29bf9e)=>{var _0x2f948e=_0x260631;_0x2e5f80[_0x29bf9e][_0x2f948e(0x10d)]=_0x37dbab;}),_0x45a993['forEach']((_0x1c83cc,_0x136a6a)=>{var _0x414284=_0x260631;_0x2e5f80[_0x136a6a][_0x414284(0x161)]=_0x1c83cc;}),_0x52105d['forEach']((_0x4faf8c,_0x3e2509)=>{_0x2e5f80[_0x3e2509]['room_name']=_0x4faf8c;}),_0x54fc5d[_0x260631(0x132)]((_0x1bf84e,_0x45dc4e)=>{_0x2e5f80[_0x45dc4e]['CBM']=_0x1bf84e;});var _0x58c058=0x0;_0x2e5f80[_0x260631(0x132)](_0x49d013=>{var _0x150425=_0x260631;console[_0x150425(0x14c)](_0x150425(0xf4),_0x49d013),(parseInt(_0x49d013['stock'])<parseInt(_0x49d013[_0x150425(0x11c)])||parseInt(_0x49d013[_0x150425(0x11c)])==0x0)&&_0x58c058++;});if(_0x58c058!=0x0)return _0x51f741['flash'](_0x260631(0xe2),_0x260631(0x16e)),_0x11f0c0['redirect']('back');const _0x166dcd=_0x2e5f80[_0x260631(0x172)](_0x10ffea=>_0x10ffea['quantity']!=='0'&&_0x10ffea[_0x260631(0x11c)]!=='');_0x11d367[_0x260631(0x1ad)]=_0xb17b99,_0x11d367[_0x260631(0x146)]=_0x25d8b2,_0x11d367[_0x260631(0x117)]=_0x54e3cd,_0x11d367[_0x260631(0x1ac)]=_0x14f65f,_0x11d367[_0x260631(0x1d7)]=_0x166dcd,_0x11d367[_0x260631(0x1c4)]=_0x30ed86,_0x11d367[_0x260631(0x1ab)]=_0x260631(0x195),_0x11d367['TSU']=_0x422657,_0x11d367[_0x260631(0x136)]=_0x3abd34,_0x11d367[_0x260631(0x153)]=_0x502fd4,_0x11d367[_0x260631(0x150)]=_0x418516,_0x11d367[_0x260631(0x12d)]=_0x5e9b00,_0x11d367[_0x260631(0x141)]=_0x5a8748,_0x11d367[_0x260631(0x175)]=_0x15ac66,_0x11d367[_0x260631(0x160)]=_0x14bfe0,_0x11d367['destination']=_0x28aeeb,_0x11d367[_0x260631(0xfa)]=_0x6e42fe,_0x11d367[_0x260631(0x12a)]=_0x38c6dc,_0x11d367['DateofRequest']=_0x5294b0,_0x11d367[_0x260631(0xd2)]=_0x520026,_0x11d367[_0x260631(0x1a8)]='False',_0x11d367[_0x260631(0x1e3)]=_0x1dc355;const _0x1e2838=await _0x11d367[_0x260631(0x18f)]();_0x51f741[_0x260631(0x1c5)](_0x260631(0x130),'Sales\x20Update\x20successfully'),_0x11f0c0[_0x260631(0xfc)](_0x260631(0x12c));}catch(_0x2e7c31){console[_0x260631(0x14c)](_0x2e7c31);}}),router[a0_0xb8ce0d(0x1b6)]('/give_payment/:id',auth,async(_0x56f30f,_0x3c5af8)=>{var _0x32f18e=a0_0xb8ce0d;try{const _0xa68049=_0x56f30f['params']['id'],{invoice:_0x470c59,customer:_0x1aa8e8,receivable_amount:_0x202e72,received_amount:_0xc216da}=_0x56f30f[_0x32f18e(0x1d6)],_0x1b695e=await sales[_0x32f18e(0x1ba)](_0xa68049);console[_0x32f18e(0x14c)](_0x1b695e);var _0x40c966=_0x202e72-_0xc216da;console['log'](_0xc216da),_0x1b695e[_0x32f18e(0x14f)]=parseFloat(_0xc216da)+parseFloat(_0x1b695e[_0x32f18e(0x14f)]),_0x1b695e[_0x32f18e(0x179)]=_0x40c966,console[_0x32f18e(0x14c)](_0x1b695e);const _0x224fc7=await _0x1b695e[_0x32f18e(0x18f)](),_0x3f4aa2=await c_payment_data[_0x32f18e(0x16f)]({'invoice':_0x470c59});_0x3f4aa2['amount']=_0x40c966,await _0x3f4aa2[_0x32f18e(0x18f)]();let _0x4ecf2a=new Date(),_0x241b0e=('0'+_0x4ecf2a[_0x32f18e(0x13d)]())['slice'](-0x2),_0xae4f62=('0'+(_0x4ecf2a[_0x32f18e(0x135)]()+0x1))[_0x32f18e(0x118)](-0x2),_0x4c0f75=_0x4ecf2a[_0x32f18e(0x170)](),_0xcd0d00=_0x4c0f75+'-'+_0xae4f62+'-'+_0x241b0e;const _0x15a89a=new customer_payment({'invoice':_0x470c59,'date':_0x4c0f75+'-'+_0xae4f62+'-'+_0x241b0e,'customer':_0x1aa8e8,'reason':_0x32f18e(0x199),'amount':_0xc216da}),_0x2884d8=await _0x15a89a[_0x32f18e(0x18f)]();_0x56f30f[_0x32f18e(0x1c5)]('success',_0x32f18e(0x1dc)),_0x3c5af8[_0x32f18e(0xfc)](_0x32f18e(0x1af));}catch(_0x4c347a){console[_0x32f18e(0x14c)](_0x4c347a);}}),router[a0_0xb8ce0d(0x18d)](a0_0xb8ce0d(0x1bd),auth,async(_0x13f4b7,_0x318db6)=>{var _0x5888bf=a0_0xb8ce0d;try{const {username:_0x15700c,email:_0x424567,role:_0x4df8ec}=_0x13f4b7[_0x5888bf(0x190)],_0x49a606=_0x13f4b7[_0x5888bf(0x190)],_0x5619f7=await profile['findOne']({'email':_0x49a606[_0x5888bf(0x1c8)]}),_0x284c58=await master_shop['find']();console[_0x5888bf(0x14c)](_0x5888bf(0xff),_0x284c58);const _0x5c14f7=_0x13f4b7['params']['id'],_0x2f4ffd=await sales[_0x5888bf(0x1ba)](_0x5c14f7);console[_0x5888bf(0x14c)](_0x2f4ffd);const _0x17956a=await customer[_0x5888bf(0x16f)]({'name':_0x2f4ffd['customer']});console[_0x5888bf(0x14c)](_0x17956a);if(_0x284c58[0x0][_0x5888bf(0x126)]==_0x5888bf(0xfb)){var _0x2ef7e9=users['English'];console['log'](_0x2ef7e9);}else{if(_0x284c58[0x0][_0x5888bf(0x126)]==_0x5888bf(0x1b7))var _0x2ef7e9=users[_0x5888bf(0x1b7)];else{if(_0x284c58[0x0][_0x5888bf(0x126)]=='German')var _0x2ef7e9=users[_0x5888bf(0xd7)];else{if(_0x284c58[0x0][_0x5888bf(0x126)]==_0x5888bf(0x143))var _0x2ef7e9=users['Spanish'];else{if(_0x284c58[0x0][_0x5888bf(0x126)]==_0x5888bf(0x149))var _0x2ef7e9=users[_0x5888bf(0x149)];else{if(_0x284c58[0x0][_0x5888bf(0x126)]==_0x5888bf(0x1a9))var _0x2ef7e9=users[_0x5888bf(0x1b0)];else{if(_0x284c58[0x0]['language']==_0x5888bf(0xfe))var _0x2ef7e9=users[_0x5888bf(0xfe)];else{if(_0x284c58[0x0][_0x5888bf(0x126)]==_0x5888bf(0xe1))var _0x2ef7e9=users['Arabic'];}}}}}}}_0x318db6[_0x5888bf(0x19a)](_0x5888bf(0x12f),{'success':_0x13f4b7[_0x5888bf(0x1c5)](_0x5888bf(0x130)),'errors':_0x13f4b7['flash']('errors'),'role':_0x49a606,'profile':_0x5619f7,'master_shop':_0x284c58,'customers':_0x17956a,'sales':_0x2f4ffd,'language':_0x2ef7e9});}catch(_0x1fa9d7){console[_0x5888bf(0x14c)](_0x1fa9d7);}}),router['get']('/view/return_sales/:id',auth,async(_0x52754e,_0x102ecd)=>{var _0x122709=a0_0xb8ce0d;try{const {username:_0x5022de,email:_0x50b116,role:_0x194d46}=_0x52754e['user'],_0x13d4a4=_0x52754e['user'],_0x1264ca=await profile['findOne']({'email':_0x13d4a4[_0x122709(0x1c8)]}),_0x27ad52=await master_shop[_0x122709(0x1b3)](),_0x2d09e6=_0x52754e[_0x122709(0x144)]['id'],_0x5c16e7=await sales_finished[_0x122709(0x1ba)](_0x2d09e6),_0x42627d=await warehouse['aggregate']([{'$match':{'name':_0x5c16e7[_0x122709(0x1ac)]}},{'$unwind':_0x122709(0x1d4)},{'$group':{'_id':_0x122709(0x169),'name':{'$first':_0x122709(0x1b9)},'product_stock':{'$first':_0x122709(0x105)},'level':{'$first':_0x122709(0x1cf)},'isle':{'$first':_0x122709(0x1df)},'pallet':{'$first':_0x122709(0xe6)},'primary_code':{'$first':_0x122709(0x182)},'secondary_code':{'$first':_0x122709(0xe7)},'product_code':{'$first':_0x122709(0x1e6)},'storage':{'$first':_0x122709(0x103)},'rack':{'$first':_0x122709(0x1be)},'expiry_date':{'$first':_0x122709(0xe3)},'production_date':{'$first':_0x122709(0x188)},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x122709(0xe8)},'maxProducts':{'$first':_0x122709(0x1ca)},'batch_code':{'$first':_0x122709(0x17c)},'maxPerUnit':{'$first':_0x122709(0x15a)},'room':{'$first':_0x122709(0x1cb)}}}]),_0x2546e9=await product[_0x122709(0x1b3)]({}),_0x1c0870=await warehouse['aggregate']([{'$match':{'status':_0x122709(0x10b),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':_0x122709(0x158)}}},{'$sort':{'name':0x1}}]),_0x3c99fa=await warehouse[_0x122709(0xf0)]([{'$match':{'status':'Enabled','name':_0x122709(0x180)}},{'$group':{'_id':_0x122709(0x158),'name':{'$first':_0x122709(0x158)}}},{'$sort':{'name':0x1}}]);if(_0x27ad52[0x0]['language']==_0x122709(0xfb)){var _0x4e51c9=users['English'];console[_0x122709(0x14c)](_0x4e51c9);}else{if(_0x27ad52[0x0]['language']==_0x122709(0x1b7))var _0x4e51c9=users[_0x122709(0x1b7)];else{if(_0x27ad52[0x0][_0x122709(0x126)]=='German')var _0x4e51c9=users[_0x122709(0xd7)];else{if(_0x27ad52[0x0][_0x122709(0x126)]=='Spanish')var _0x4e51c9=users['Spanish'];else{if(_0x27ad52[0x0][_0x122709(0x126)]==_0x122709(0x149))var _0x4e51c9=users[_0x122709(0x149)];else{if(_0x27ad52[0x0][_0x122709(0x126)]==_0x122709(0x1a9))var _0x4e51c9=users[_0x122709(0x1b0)];else{if(_0x27ad52[0x0][_0x122709(0x126)]=='Chinese')var _0x4e51c9=users[_0x122709(0xfe)];else{if(_0x27ad52[0x0][_0x122709(0x126)]=='Arabic\x20(ae)')var _0x4e51c9=users['Arabic'];}}}}}}}_0x102ecd[_0x122709(0x19a)]('return_sale_finished',{'success':_0x52754e[_0x122709(0x1c5)]('success'),'errors':_0x52754e[_0x122709(0x1c5)](_0x122709(0xe2)),'role':_0x13d4a4,'profile':_0x1264ca,'user':_0x5c16e7,'stock':_0x42627d,'master_shop':_0x27ad52,'unit':_0x2546e9,'language':_0x4e51c9,'warehouses':_0x1c0870,'warehouse_QA':_0x3c99fa});}catch(_0x3e3c95){console[_0x122709(0x14c)](_0x3e3c95),_0x102ecd[_0x122709(0x15b)](0xc8)['json']({'message':_0x3e3c95[_0x122709(0x18e)]});}}),router[a0_0xb8ce0d(0x1b6)](a0_0xb8ce0d(0x142),auth,async(_0x5930e0,_0x49bf83)=>{var _0x2165a8=a0_0xb8ce0d;if(_0x5930e0[_0x2165a8(0x1d6)]['for_categorize']=='QA')try{const {invoice:_0x5713da,date:_0xe28cf3,warehouse_name:_0x3052f7,product_name:_0xf25770,primary_code:_0x5a6a22,secondary_code:_0x4d2987,product_code:_0x423103,sales_quantity:_0x5e3be3,stocks:_0x380577,return_qty:_0x21d496,Room_name:_0x387f56,to_warehouse_name_QA:_0x18dd65,to_Room_name_QA:_0xbff927,note:_0x4a2314,for_categorize:_0x505f5a,product_name_QA1:_0x44cc8a}=_0x5930e0[_0x2165a8(0x1d6)];if(typeof _0x44cc8a==_0x2165a8(0x1d3))var _0x10bc08=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x13e)]],_0xece82e=[_0x5930e0[_0x2165a8(0x1d6)]['primary_code_QA']],_0x9f1e85=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x10f)]],_0x2e86f0=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x119)]],_0x3aea13=[_0x5930e0['body']['sales_quantity_QA']],_0x3d5142=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1d2)]],_0x4a534c=[_0x5930e0[_0x2165a8(0x1d6)]['maxPerUnit_QA']],_0x458d7c=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xd9)]],_0x3fe4c5=[_0x5930e0['body']['batch_code_QA']],_0x130ca4=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x138)]],_0x515e73=[_0x5930e0[_0x2165a8(0x1d6)]['unit_QA']],_0x44022a=[_0x5930e0['body'][_0x2165a8(0xe5)]],_0x4057b1=[_0x5930e0[_0x2165a8(0x1d6)]['expiry_date_QA']],_0x26cb82=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1e2)]],_0x4f0234=[_0x5930e0['body'][_0x2165a8(0xda)]],_0x271a2f=[_0x5930e0['body'][_0x2165a8(0x133)]];else var _0x10bc08=[..._0x5930e0['body'][_0x2165a8(0x13e)]],_0xece82e=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x165)]],_0x9f1e85=[..._0x5930e0[_0x2165a8(0x1d6)]['secondary_code_QA']],_0x2e86f0=[..._0x5930e0['body'][_0x2165a8(0x119)]],_0x3aea13=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1c7)]],_0x3d5142=[..._0x5930e0['body'][_0x2165a8(0x1d2)]],_0x4a534c=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x19f)]],_0x458d7c=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xd9)]],_0x3fe4c5=[..._0x5930e0['body'][_0x2165a8(0xf3)]],_0x130ca4=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x138)]],_0x515e73=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x101)]],_0x44022a=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xe5)]],_0x4057b1=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1b2)]],_0x26cb82=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1e2)]],_0x4f0234=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xda)]],_0x271a2f=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x133)]];const _0x550682=_0x10bc08[_0x2165a8(0x1d5)](_0x46281d=>{return _0x46281d={'product_name':_0x46281d};});_0x26cb82[_0x2165a8(0x132)]((_0x389313,_0x31f92d)=>{var _0x4b9411=_0x2165a8;_0x550682[_0x31f92d][_0x4b9411(0x1bb)]=_0x389313;}),_0x4f0234[_0x2165a8(0x132)]((_0x19e24,_0x17baa1)=>{var _0x29f640=_0x2165a8;_0x550682[_0x17baa1][_0x29f640(0xe4)]=_0x19e24;}),_0x271a2f[_0x2165a8(0x132)]((_0x36b5a7,_0x3f4262)=>{var _0x1decf2=_0x2165a8,_0x3e0bcf=_0x36b5a7[_0x1decf2(0x118)](0x1);_0x550682[_0x3f4262]['isle']=_0x36b5a7[0x0],_0x550682[_0x3f4262]['pallet']=_0x3e0bcf;}),_0xece82e[_0x2165a8(0x132)]((_0x208c42,_0x4fe67a)=>{var _0x3efbd5=_0x2165a8;_0x550682[_0x4fe67a][_0x3efbd5(0x13b)]=_0x208c42;}),_0x9f1e85[_0x2165a8(0x132)]((_0x130cb4,_0x29ff15)=>{var _0x561df3=_0x2165a8;_0x550682[_0x29ff15][_0x561df3(0x1db)]=_0x130cb4;}),_0x2e86f0[_0x2165a8(0x132)]((_0x4c69d4,_0x37937e)=>{_0x550682[_0x37937e]['product_code']=_0x4c69d4;}),_0x3aea13[_0x2165a8(0x132)]((_0x5f18de,_0x108632)=>{var _0x296e3c=_0x2165a8;_0x550682[_0x108632][_0x296e3c(0x15e)]=_0x5f18de;}),_0x3d5142[_0x2165a8(0x132)]((_0x30a79d,_0x17ce7d)=>{var _0x23e9b3=_0x2165a8;_0x550682[_0x17ce7d][_0x23e9b3(0x112)]=_0x30a79d;}),_0x4a534c[_0x2165a8(0x132)]((_0x4804a4,_0x498d09)=>{var _0x5e7cef=_0x2165a8;_0x550682[_0x498d09][_0x5e7cef(0x122)]=_0x4804a4;}),_0x458d7c[_0x2165a8(0x132)]((_0x24c040,_0x32c718)=>{var _0x46feec=_0x2165a8;_0x550682[_0x32c718][_0x46feec(0x191)]=_0x24c040;}),_0x3fe4c5[_0x2165a8(0x132)]((_0x2a1182,_0x3f56e9)=>{var _0x5baf75=_0x2165a8;_0x550682[_0x3f56e9][_0x5baf75(0x102)]=_0x2a1182;}),_0x130ca4['forEach']((_0x36b91a,_0x27e8c2)=>{var _0x2d047c=_0x2165a8;_0x550682[_0x27e8c2][_0x2d047c(0xd1)]=_0x36b91a;}),_0x515e73['forEach']((_0x27162e,_0xc990bb)=>{var _0x8999a4=_0x2165a8;_0x550682[_0xc990bb][_0x8999a4(0x1d0)]=_0x27162e;}),_0x44022a[_0x2165a8(0x132)]((_0x5bc920,_0x6fa667)=>{var _0x204043=_0x2165a8;_0x550682[_0x6fa667][_0x204043(0x1a2)]=_0x5bc920;}),_0x4057b1[_0x2165a8(0x132)]((_0x201845,_0x5d4e3f)=>{var _0x46f6cd=_0x2165a8;_0x550682[_0x5d4e3f][_0x46f6cd(0xeb)]=_0x201845;});const _0x441fd7=await sales_finished[_0x2165a8(0x16f)]({'invoice':_0x5713da});_0x441fd7[_0x2165a8(0x17d)]=_0x2165a8(0x1a5);const _0x1783ea=await _0x441fd7[_0x2165a8(0x18f)](),_0x51a314=new sales_return_finished({'invoice':_0x5713da,'customer':_0x5930e0['body']['customer'],'date':_0xe28cf3,'warehouse_name':_0x3052f7,'room':_0x387f56,'ToWarehouse':_0x18dd65,'ToRoom':_0xbff927,'return_sale_QA':_0x550682,'note':_0x4a2314,'warehouse_cat':_0x505f5a}),_0x3cd57d=await _0x51a314[_0x2165a8(0x18f)](),_0x1932a7=await sales_return_finished[_0x2165a8(0x16f)]({'invoice':_0x5713da}),_0x4300a2=await warehouse[_0x2165a8(0x16f)]({'name':_0x18dd65,'room':_0xbff927});_0x1932a7[_0x2165a8(0xee)][_0x2165a8(0x132)](_0x1c8edf=>{var _0x29e7eb=_0x2165a8,_0xa36ed5=0x0;const _0x48e301=_0x4300a2['product_details']['map'](_0x22a378=>{var _0x2d3923=a0_0x2d93;_0x22a378['product_name']==_0x1c8edf['product_name']&&_0x22a378[_0x2d3923(0x13a)]==_0x1c8edf[_0x2d3923(0x13a)]&&_0x22a378[_0x2d3923(0xe4)]==_0x1c8edf[_0x2d3923(0xe4)]&&_0x22a378[_0x2d3923(0xdd)]==_0x1c8edf[_0x2d3923(0xdd)]&&_0x22a378['expiry_date']==_0x1c8edf['expiry_date']&&_0x22a378[_0x2d3923(0x1a2)]==_0x1c8edf[_0x2d3923(0x1a2)]&&_0x22a378[_0x2d3923(0x102)]==_0x1c8edf[_0x2d3923(0x102)]&&(_0x22a378['product_stock']=parseInt(_0x22a378[_0x2d3923(0x121)])+parseInt(_0x1c8edf[_0x2d3923(0x112)]),_0xa36ed5++);});_0xa36ed5=='0'&&(_0x4300a2['product_details']=_0x4300a2[_0x29e7eb(0x176)]['concat']({'product_name':_0x1c8edf['product_name'],'product_stock':_0x1c8edf[_0x29e7eb(0x112)],'primary_code':_0x1c8edf[_0x29e7eb(0x13b)],'secondary_code':_0x1c8edf[_0x29e7eb(0x1db)],'product_code':_0x1c8edf['product_code'],'batch_code':_0x1c8edf['batch_code'],'maxPerUnit':_0x1c8edf[_0x29e7eb(0x122)],'production_date':_0x1c8edf['production_date'],'expiry_date':_0x1c8edf[_0x29e7eb(0xeb)],'secondary_unit':_0x1c8edf['secondary_unit'],'unit':_0x1c8edf[_0x29e7eb(0x1d0)],'maxProducts':_0x1c8edf['maxProducts'],'level':_0x1c8edf['level'],'isle':_0x1c8edf[_0x29e7eb(0x13a)],'pallet':_0x1c8edf[_0x29e7eb(0xdd)]}));}),await _0x4300a2[_0x2165a8(0x18f)]();const _0x3875d6=new c_payment_data({'invoice':_0x5713da,'customer':_0x5930e0['body'][_0x2165a8(0x146)],'reason':'Sale\x20Return'});await _0x3875d6[_0x2165a8(0x18f)]();const _0x432027=await master_shop[_0x2165a8(0x1b3)](),_0x3efb89=await email_settings[_0x2165a8(0x16f)](),_0x2e9ff6=await customer['findOne']({'name':_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x146)]});_0x432027[0x0][_0x2165a8(0x1e4)]==0x1?(right_currency=_0x432027[0x0][_0x2165a8(0x1a3)],left_currency=''):(right_currency='',left_currency=_0x432027[0x0][_0x2165a8(0x1a3)]);var _0x15c871=_0x10bc08,_0x386f42=_0x3d5142,_0x22ed97='',_0x557531;for(_0x557531 in _0x15c871){_0x22ed97+=_0x2165a8(0x111)+_0x2165a8(0x114)+_0x15c871[_0x557531]+_0x2165a8(0x14a)+_0x2165a8(0x114)+_0x386f42[_0x557531]+_0x2165a8(0x14a)+_0x2165a8(0x110);}console[_0x2165a8(0x14c)]('product_list',_0x22ed97);let _0x4aca11=nodemailer[_0x2165a8(0x16d)]({'service':'gmail','auth':{'user':_0x3efb89[_0x2165a8(0x1c8)],'pass':_0x3efb89[_0x2165a8(0xd3)]}}),_0x26b7dd={'from':_0x3efb89[_0x2165a8(0x1c8)],'to':_0x2e9ff6[_0x2165a8(0x1c8)],'subject':_0x2165a8(0x140),'attachments':[{'filename':'Logo.png','path':__dirname+_0x2165a8(0x11b)+_0x2165a8(0x1b8)+_0x432027[0x0][_0x2165a8(0x16c)],'cid':_0x2165a8(0xf6)}],'html':_0x2165a8(0x183)+_0x2165a8(0x1b5)+_0x2165a8(0x171)+_0x2165a8(0x13c)+'<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>'+_0x2165a8(0x13c)+_0x2165a8(0x13f)+_0x2165a8(0xd6)+'<div>'+_0x2165a8(0x137)+_0x432027[0x0][_0x2165a8(0x1a7)]+'\x20</h2>'+_0x2165a8(0xd6)+_0x2165a8(0xd6)+_0x2165a8(0x151)+'<div>'+_0x2165a8(0x10c)+_0x2165a8(0x115)+_0x5713da+'\x20'+_0x2165a8(0x109)+_0x2165a8(0x128)+_0xe28cf3+'\x20'+_0x2165a8(0x131)+_0x2165a8(0x1e5)+_0x2165a8(0xd6)+_0x2165a8(0x17a)+_0x2165a8(0x1aa)+_0x2165a8(0x111)+_0x2165a8(0x16a)+_0x2165a8(0x134)+_0x2165a8(0x1d9)+'<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>'+_0x2165a8(0x110)+'</thead>'+_0x2165a8(0xed)+'\x20'+_0x22ed97+'\x20'+_0x2165a8(0xd4)+_0x2165a8(0x159)+_0x2165a8(0x13c)+'<strong>\x20Regards\x20</strong>'+_0x2165a8(0x187)+_0x432027[0x0][_0x2165a8(0x1a7)]+_0x2165a8(0x1e5)+_0x2165a8(0xd6)+_0x2165a8(0xd6)+_0x2165a8(0xf2)};_0x4aca11[_0x2165a8(0xea)](_0x26b7dd,function(_0x11c3c8,_0x2ad84d){var _0x35742d=_0x2165a8;_0x11c3c8?(console['log'](_0x11c3c8),console[_0x35742d(0x14c)](_0x35742d(0xf7))):console[_0x35742d(0x14c)](_0x35742d(0x1e0));}),_0x5930e0[_0x2165a8(0x1c5)](_0x2165a8(0x130),_0x2165a8(0xd5)),_0x49bf83[_0x2165a8(0xfc)]('/all_sales_finished/view');}catch(_0x57a290){_0x49bf83['status'](0xc8)[_0x2165a8(0x178)]({'message1':_0x57a290[_0x2165a8(0x18e)]});}else{if(_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xf5)]=='GS')try{const {invoice:_0x12b4aa,date:_0x5a0ac8,warehouse_name:_0x5b534b,product_name:_0xe970e8,primary_code:_0x197278,secondary_code:_0x1597bb,product_code:_0x54a4b3,sales_quantity:_0x71663c,stocks:_0x223df9,return_qty:_0x36de5e,Room_name:_0x1b3da4,to_warehouse_name:_0x431fad,to_Room_name:_0x125879,note:_0x1a0ca3,level:_0x27c89f,isle:_0x248149,pallet:_0x104920,for_categorize:_0x2415a5}=_0x5930e0[_0x2165a8(0x1d6)];if(typeof _0xe970e8==_0x2165a8(0x1d3))var _0x10bc08=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xde)]],_0xece82e=[_0x5930e0[_0x2165a8(0x1d6)]['primary_code']],_0x9f1e85=[_0x5930e0[_0x2165a8(0x1d6)]['secondary_code']],_0x2e86f0=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1da)]],_0x3aea13=[_0x5930e0[_0x2165a8(0x1d6)]['sales_quantity']],_0x3d5142=[_0x5930e0['body'][_0x2165a8(0x112)]],_0x40837e=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x19b)]],_0x353990=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xdd)]],_0x4a534c=[_0x5930e0['body']['maxPerUnit']],_0x458d7c=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x191)]],_0x3fe4c5=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x102)]],_0x130ca4=[_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xd1)]],_0x515e73=[_0x5930e0['body'][_0x2165a8(0x1d0)]],_0x44022a=[_0x5930e0[_0x2165a8(0x1d6)]['production_date']],_0x4057b1=[_0x5930e0['body'][_0x2165a8(0xeb)]];else var _0x10bc08=[..._0x5930e0['body'][_0x2165a8(0xde)]],_0xece82e=[..._0x5930e0[_0x2165a8(0x1d6)]['primary_code']],_0x9f1e85=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1db)]],_0x2e86f0=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1da)]],_0x3aea13=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1c3)]],_0x3d5142=[..._0x5930e0['body'][_0x2165a8(0x112)]],_0x40837e=[..._0x5930e0['body'][_0x2165a8(0x19b)]],_0x4a534c=[..._0x5930e0['body'][_0x2165a8(0x122)]],_0x458d7c=[..._0x5930e0['body'][_0x2165a8(0x191)]],_0x3fe4c5=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x102)]],_0x130ca4=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xd1)]],_0x515e73=[..._0x5930e0['body'][_0x2165a8(0x1d0)]],_0x44022a=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x1a2)]],_0x4057b1=[..._0x5930e0[_0x2165a8(0x1d6)]['expiry_date']],_0x353990=[..._0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0xdd)]];const _0x53b4e0=_0x10bc08[_0x2165a8(0x1d5)](_0x5dc297=>{return _0x5dc297={'product_name':_0x5dc297};});_0xece82e[_0x2165a8(0x132)]((_0x476686,_0x4e0596)=>{var _0x359164=_0x2165a8;_0x53b4e0[_0x4e0596][_0x359164(0x13b)]=_0x476686;}),_0x9f1e85[_0x2165a8(0x132)]((_0x591cfc,_0x106d68)=>{var _0x5a033c=_0x2165a8;_0x53b4e0[_0x106d68][_0x5a033c(0x1db)]=_0x591cfc;}),_0x2e86f0[_0x2165a8(0x132)]((_0x3bb61c,_0x482079)=>{var _0x482f15=_0x2165a8;_0x53b4e0[_0x482079][_0x482f15(0x1da)]=_0x3bb61c;}),_0x3aea13[_0x2165a8(0x132)]((_0x2665a0,_0x9a1dd)=>{var _0x384f1b=_0x2165a8;_0x53b4e0[_0x9a1dd][_0x384f1b(0x15e)]=_0x2665a0;}),_0x3d5142['forEach']((_0x4f3af3,_0x4ad992)=>{var _0x4e132c=_0x2165a8;_0x53b4e0[_0x4ad992][_0x4e132c(0x112)]=_0x4f3af3;}),_0x40837e['forEach']((_0xcc53a4,_0xf6067a)=>{_0x53b4e0[_0xf6067a]['level']=_0xcc53a4;}),_0x353990['forEach']((_0x2a2067,_0x5c0886)=>{var _0x5a9fbd=_0x2165a8,_0x26f743=_0x2a2067[_0x5a9fbd(0x118)](0x1);_0x53b4e0[_0x5c0886][_0x5a9fbd(0x13a)]=_0x2a2067[0x0],_0x53b4e0[_0x5c0886]['pallet']=_0x26f743;}),_0x4a534c[_0x2165a8(0x132)]((_0x4ee58c,_0x4f32b8)=>{var _0x3d05a9=_0x2165a8;_0x53b4e0[_0x4f32b8][_0x3d05a9(0x122)]=_0x4ee58c;}),_0x458d7c['forEach']((_0xa84282,_0x4e2dd0)=>{var _0x177ad8=_0x2165a8;_0x53b4e0[_0x4e2dd0][_0x177ad8(0x191)]=_0xa84282;}),_0x3fe4c5[_0x2165a8(0x132)]((_0x52b9f5,_0xd140a2)=>{var _0x3d76ec=_0x2165a8;_0x53b4e0[_0xd140a2][_0x3d76ec(0x102)]=_0x52b9f5;}),_0x130ca4[_0x2165a8(0x132)]((_0x3dcc8f,_0x25f585)=>{_0x53b4e0[_0x25f585]['secondary_unit']=_0x3dcc8f;}),_0x515e73[_0x2165a8(0x132)]((_0x37e93c,_0x2a2769)=>{var _0x2604b9=_0x2165a8;_0x53b4e0[_0x2a2769][_0x2604b9(0x1d0)]=_0x37e93c;}),_0x44022a[_0x2165a8(0x132)]((_0x14737e,_0x5e7aab)=>{var _0x58c011=_0x2165a8;_0x53b4e0[_0x5e7aab][_0x58c011(0x1a2)]=_0x14737e;}),_0x4057b1[_0x2165a8(0x132)]((_0x39c9c3,_0x1e32c6)=>{var _0x2ba6a5=_0x2165a8;_0x53b4e0[_0x1e32c6][_0x2ba6a5(0xeb)]=_0x39c9c3;});var _0x244cf7=0x0;_0x53b4e0['forEach'](_0xc30aa6=>{var _0x3d2a4f=_0x2165a8;console[_0x3d2a4f(0x14c)]('foreach\x20newproduct',_0xc30aa6),(parseInt(_0xc30aa6['sale_qty'])<parseInt(_0xc30aa6['return_qty'])||parseInt(_0xc30aa6[_0x3d2a4f(0x19c)])<parseInt(_0xc30aa6[_0x3d2a4f(0x112)])&&parseInt(_0xc30aa6[_0x3d2a4f(0x15e)])>parseInt(_0xc30aa6[_0x3d2a4f(0x112)])||parseInt(_0xc30aa6[_0x3d2a4f(0x112)])==0x0)&&_0x244cf7++;});if(_0x244cf7!=0x0)return _0x5930e0[_0x2165a8(0x1c5)](_0x2165a8(0xe2),_0x2165a8(0x1c2)),_0x49bf83['redirect'](_0x2165a8(0x17b));const _0x1e1a17=await sales_finished[_0x2165a8(0x16f)]({'invoice':_0x12b4aa});_0x1e1a17['return_data']=_0x2165a8(0x1a5);const _0x103d7d=await _0x1e1a17[_0x2165a8(0x18f)](),_0x43aca2=new sales_return_finished({'invoice':_0x12b4aa,'customer':_0x5930e0[_0x2165a8(0x1d6)][_0x2165a8(0x146)],'date':_0x5a0ac8,'warehouse_name':_0x5b534b,'room':_0x1b3da4,'ToWarehouse':_0x431fad,'ToRoom':_0x125879,'return_sale':_0x53b4e0,'note':_0x1a0ca3,'warehouse_cat':_0x2415a5}),_0x4a6088=await _0x43aca2[_0x2165a8(0x18f)](),_0x1a1094=await sales_return_finished[_0x2165a8(0x16f)]({'invoice':_0x12b4aa}),_0x22f843=await warehouse['findOne']({'name':_0x431fad,'room':_0x125879});_0x1a1094[_0x2165a8(0x194)]['forEach'](_0x1b4b76=>{var _0x19659a=_0x2165a8,_0x4adbbd=0x0;const _0x2f98eb=_0x22f843['product_details']['map'](_0x22cbf9=>{var _0x30337d=a0_0x2d93;_0x22cbf9[_0x30337d(0xde)]==_0x1b4b76[_0x30337d(0xde)]&&_0x22cbf9[_0x30337d(0xe4)]==_0x1b4b76[_0x30337d(0xe4)]&&_0x22cbf9['isle']==_0x1b4b76[_0x30337d(0x13a)]&&_0x22cbf9[_0x30337d(0xdd)]==_0x1b4b76[_0x30337d(0xdd)]&&_0x22cbf9[_0x30337d(0xeb)]==_0x1b4b76[_0x30337d(0xeb)]&&_0x22cbf9[_0x30337d(0x1a2)]==_0x1b4b76[_0x30337d(0x1a2)]&&_0x22cbf9[_0x30337d(0x102)]==_0x1b4b76[_0x30337d(0x102)]&&(_0x22cbf9[_0x30337d(0x121)]=parseInt(_0x22cbf9['product_stock'])+parseInt(_0x1b4b76[_0x30337d(0x112)]),_0x4adbbd++);});_0x4adbbd=='0'&&(_0x22f843['product_details']=_0x22f843[_0x19659a(0x176)][_0x19659a(0x156)]({'product_name':_0x1b4b76[_0x19659a(0xde)],'product_stock':_0x1b4b76[_0x19659a(0x112)],'primary_code':_0x1b4b76[_0x19659a(0x13b)],'secondary_code':_0x1b4b76[_0x19659a(0x1db)],'product_code':_0x1b4b76[_0x19659a(0x1da)],'level':_0x1b4b76[_0x19659a(0xe4)],'isle':_0x1b4b76[_0x19659a(0x13a)],'pallet':_0x1b4b76[_0x19659a(0xdd)],'batch_code':_0x1b4b76[_0x19659a(0x102)],'maxPerUnit':_0x1b4b76[_0x19659a(0x122)],'production_date':_0x1b4b76[_0x19659a(0x1a2)],'expiry_date':_0x1b4b76['expiry_date'],'secondary_unit':_0x1b4b76[_0x19659a(0xd1)],'unit':_0x1b4b76['unit'],'maxProducts':_0x1b4b76[_0x19659a(0x191)]}));}),await _0x22f843[_0x2165a8(0x18f)]();const _0x6fb15a=await master_shop[_0x2165a8(0x1b3)]();console['log'](_0x2165a8(0x173),_0x6fb15a[0x0][_0x2165a8(0x16c)]);const _0x3ddc21=await email_settings[_0x2165a8(0x16f)]();_0x5930e0['flash'](_0x2165a8(0x130),_0x2165a8(0xd5)),_0x49bf83[_0x2165a8(0xfc)]('/all_sales_finished/view');}catch(_0xad4bfc){console[_0x2165a8(0x14c)](_0xad4bfc),_0x49bf83[_0x2165a8(0x15b)](0xc8)[_0x2165a8(0x178)]({'message1':_0xad4bfc[_0x2165a8(0x18e)]});}}}),router[a0_0xb8ce0d(0x18d)](a0_0xb8ce0d(0x108),auth,async(_0x5c197b,_0x12a983)=>{var _0xcdeeda=a0_0xb8ce0d;try{const {username:_0x687edc,email:_0x27416c,role:_0x201374}=_0x5c197b[_0xcdeeda(0x190)],_0x3d2bcb=_0x5c197b[_0xcdeeda(0x190)],_0x525202=await profile[_0xcdeeda(0x16f)]({'email':_0x3d2bcb['email']}),_0x4453a6=await master_shop[_0xcdeeda(0x1b3)]();console[_0xcdeeda(0x14c)](_0xcdeeda(0x184),_0x4453a6);const _0x1f2714=_0x5c197b[_0xcdeeda(0x144)]['id'],_0x58d79f=await sales[_0xcdeeda(0x1ba)](_0x1f2714);console['log']('barcode\x20user_id',_0x58d79f);if(_0x4453a6[0x0][_0xcdeeda(0x126)]=='English\x20(US)')var _0x47bb4b=users['English'];else{if(_0x4453a6[0x0][_0xcdeeda(0x126)]==_0xcdeeda(0x1b7))var _0x47bb4b=users['Hindi'];else{if(_0x4453a6[0x0]['language']==_0xcdeeda(0xd7))var _0x47bb4b=users['German'];else{if(_0x4453a6[0x0][_0xcdeeda(0x126)]=='Spanish')var _0x47bb4b=users[_0xcdeeda(0x143)];else{if(_0x4453a6[0x0][_0xcdeeda(0x126)]==_0xcdeeda(0x149))var _0x47bb4b=users[_0xcdeeda(0x149)];else{if(_0x4453a6[0x0]['language']==_0xcdeeda(0x1a9))var _0x47bb4b=users['Portuguese'];else{if(_0x4453a6[0x0][_0xcdeeda(0x126)]==_0xcdeeda(0xfe))var _0x47bb4b=users['Chinese'];else{if(_0x4453a6[0x0][_0xcdeeda(0x126)]==_0xcdeeda(0xe1))var _0x47bb4b=users[_0xcdeeda(0x14e)];}}}}}}}_0x12a983[_0xcdeeda(0x19a)]('all_sales_barcode',{'success':_0x5c197b['flash'](_0xcdeeda(0x130)),'errors':_0x5c197b[_0xcdeeda(0x1c5)](_0xcdeeda(0xe2)),'role':_0x3d2bcb,'profile':_0x525202,'alldata':_0x58d79f,'master_shop':_0x4453a6,'language':_0x47bb4b});}catch(_0x192840){console['log'](_0x192840);}}),router[a0_0xb8ce0d(0x1b6)]('/barcode_scanner',async(_0x136180,_0x1893d6)=>{var _0x5cd71f=a0_0xb8ce0d;const {product_code:_0x4b31fa,warehouse_name:_0x274c40,rooms_data:_0x59734c,Roomslist:_0x2f44e2}=_0x136180[_0x5cd71f(0x1d6)],_0x295504=_0x2f44e2[_0x5cd71f(0xdc)](','),_0x153bbb=[];async function _0x3abd05(_0xc58b92){var _0x3691c8=_0x5cd71f;const _0x44e8b8=await warehouse[_0x3691c8(0xf0)]([{'$match':{'name':_0x274c40,'room':_0xc58b92}},{'$unwind':_0x3691c8(0x1d4)},{'$match':{'product_details.primary_code':_0x4b31fa}},{'$group':{'_id':_0x3691c8(0x169),'name':{'$first':_0x3691c8(0x1b9)},'product_stock':{'$first':_0x3691c8(0x105)},'primary_code':{'$first':_0x3691c8(0x182)},'secondary_code':{'$first':_0x3691c8(0xe7)},'product_code':{'$first':_0x3691c8(0x1e6)},'level':{'$first':_0x3691c8(0x1cf)},'isle':{'$first':_0x3691c8(0x1df)},'pallet':{'$first':'$product_details.pallet'},'unit':{'$first':_0x3691c8(0x147)},'secondary_unit':{'$first':_0x3691c8(0xe8)},'storage':{'$first':_0x3691c8(0x103)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3691c8(0xe3)},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x3691c8(0x15a)},'batch_code':{'$first':_0x3691c8(0x17c)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3691c8(0x1cb)},'CBM':{'$first':{'$toDouble':_0x3691c8(0x164)}},'invoice':{'$first':_0x3691c8(0x1ae)}}}]),_0x3f343b=await warehouse[_0x3691c8(0xf0)]([{'$match':{'name':_0x274c40,'room':_0xc58b92}},{'$unwind':_0x3691c8(0x1d4)},{'$match':{'product_details.secondary_code':_0x4b31fa}},{'$group':{'_id':_0x3691c8(0x169),'name':{'$first':_0x3691c8(0x1b9)},'product_stock':{'$first':_0x3691c8(0x105)},'primary_code':{'$first':_0x3691c8(0x182)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x3691c8(0x1e6)},'level':{'$first':_0x3691c8(0x1cf)},'isle':{'$first':_0x3691c8(0x1df)},'pallet':{'$first':'$product_details.pallet'},'unit':{'$first':_0x3691c8(0x147)},'secondary_unit':{'$first':_0x3691c8(0xe8)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3691c8(0x1be)},'expiry_date':{'$first':_0x3691c8(0xe3)},'production_date':{'$first':_0x3691c8(0x188)},'maxPerUnit':{'$first':_0x3691c8(0x15a)},'batch_code':{'$first':_0x3691c8(0x17c)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3691c8(0x1cb)},'CBM':{'$first':{'$toDouble':_0x3691c8(0x164)}},'invoice':{'$first':_0x3691c8(0x1ae)}}}]);if(_0x44e8b8['length']>0x0)_0x153bbb[_0x3691c8(0x16b)](_0x44e8b8);else _0x3f343b[_0x3691c8(0x19e)]>0x0&&_0x153bbb[_0x3691c8(0x16b)](_0x3f343b);}const _0x5a9ebe=_0x295504[_0x5cd71f(0x1d5)](_0x178642=>_0x3abd05(_0x178642));await Promise[_0x5cd71f(0x139)](_0x5a9ebe),_0x1893d6['json'](_0x153bbb);}),module[a0_0xb8ce0d(0xf1)]=router;