var a0_0xab9723=a0_0x42a4;function a0_0x5ee6(){var _0x28b38f=['Hindi','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Price\x20</th>','production_date_QA','purchases_data','/barcode/:id','$product_details','typevehicle','return_sale_QA','product_code','unit','$product_details.storage','batch_code','QA\x20Warehouse','role','RMSEmail','json','162554mQrThw','An\x20error\x20occurred\x20while\x20saving\x20data.','barcode\x20Product\x20master','OUT-','redirect','primary_code_QA','$product_details.maxProducts','maxPerUnit','</h5>','product_stock','$sale_product.isle','sales_invoice','params','Enclosed','/view/add_sales/:id','$sale_product.quantity','Error\x20Occurs','$product_details.product_stock','$note','226247hwosHb','Spanish','quantity','product_date','getMonth','Enabled','$warehouse_name','currency_placement','<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x22>','/all_sales/view','getDate','Chinese','getFullYear','email','maxProducts','return_data','message','password','</thead>','$isAllowEdit','True','customers','save','for_categorize','room','secondary_code','$product_details.isle','$product_details.level','all_sales_finished','maxProducts_QA','secondary_code_QA','$sale_product.level','map','$product_details.product_name','Sales\x20Update\x20successfully','Portuguese','log','warehouse_name','425112CAxbPZ','secondary_unit','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Total\x20</th>','expiry_date','French','CBM','prod_code','findOne','sendMail','site_title','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Room\x20</th>','return_qty','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Return\x20Quantity\x20</th>','$product_details.CBM','$product_details.pallet','then','1858008EniBQj','RoomAssigned','<h5\x20style=\x22text-align:\x20left;\x22>','False','Ambient','<tr>','Sale\x20Return','toString','all_sales_barcode','note','roombefore','German','destination','amount','success','/view','maxPerUnit_QA','barcode\x20user_id','$product_details.primary_code','/give_payment/:id','forEach','<strong>\x20Regards\x20</strong>','Return\x20Goods','product_name_QA1','/preview/:id','Arabic','4rvxrKR','$product_details.production_date','Finished\x20Goods','product_code_QA','$sale_product','language','</head><body>','$_id','room_name','<h2>\x20','find','</td>','RequestedBy','filter','catch','/upload/','gmail','$product_details._id','warehouse','edit_sales_finished','2890476QjVBIt','slice','PO_number','error','$product_details.secondary_unit','/view/add_sale/product','flash','host','TFU','English','date','TSU','../models/all_models','Router','status','English\x20(US)','/../public','errors','/view/return_sales/:id','aggregate','$name','/view/:id','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Product\x20Name\x20</th>','\x20Order\x20Date\x20:\x20','$customer','type','3269656BwyYLE','../middleware/auth','<!DOCTYPE\x20html>','An\x20error\x20occurred.','floor','sale_product','<tbody\x20style=\x22text-align:\x20center;\x22>','<hr\x20class=\x22my-3\x22>','<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>','<thead\x20style=\x22width:\x20100%\x20!important;\x22>','primary_code','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Quantity\x20</th>','customer','max_per_unit','Portuguese\x20(BR)','Arabic\x20(ae)','Logo.png','$date','</tr>','Email\x20sent\x20successfully','padStart','</table>','expiry_date_QA','length','prod_invoice','$product','stock_data','add_sales_finished','sales_quantity','$invoice','isle','\x20</h2>','body','foreach\x20newproduct','$customers_docs','<table\x20style=\x22width:\x20100%\x20!important;\x22>','$product_details.unit','</span>','pallet','post','user','Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty','$product_details.product_code','</body></html>','return_sale_finished','secondary_unit_QA','push','express','\x20Order\x20Number\x20:\x20','product_data','staff','There\x27s\x20a\x20error\x20in\x20this\x20transaction','primary_unit','unit_QA','createTransport','stock','<h5>','$product_details.maxPerUnit','batch_code_QA','<html><head><title></title>','<td\x20style=\x22border:\x201px\x20solid\x20black;\x22>','$product_details.invoice','deliverydate','product_details','$product_details.product_cat','production_date','$product_details.rack','</tbody>','exports','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Location\x20</th>','render','findById','sales\x20item\x20return\x20successfull','/view/add_sales','image','/barcode_scanner','$product_details.batch_code','driver','random','$product_details.secondary_code','$return_data','carton','prod_cat','all','bay','pallet_QA','isAllowEdit','level','$sale_product.pallet','product_name','level_QA','Received\x20Payment\x20For\x20Sale','name','typeservices','$room','invoice','_id','<span\x20style=\x22float:\x20right;\x22>','string','15WoSwZF','/picking_list/PDFFinal/','<th\x20style=\x22border:\x201px\x20solid\x20black;\x22>\x20Level\x20</th>','../public/language/languages.json','get','return_qty_QA','logo','</div>','currency','<div>','return_sale','received_amount','back','/all_sales_finished/view','Sale\x20Return\x20Mail','due_amount','/invoice/:id','sale_qty','11843298IAfTNP','sales_quantity_QA'];a0_0x5ee6=function(){return _0x28b38f;};return a0_0x5ee6();}(function(_0x344d34,_0x3352d1){var _0x131c21=a0_0x42a4,_0x5015a7=_0x344d34();while(!![]){try{var _0x4cc017=parseInt(_0x131c21(0x1ce))/0x1*(-parseInt(_0x131c21(0x16b))/0x2)+parseInt(_0x131c21(0x1b4))/0x3+parseInt(_0x131c21(0x1a4))/0x4*(-parseInt(_0x131c21(0x147))/0x5)+-parseInt(_0x131c21(0x1e2))/0x6+parseInt(_0x131c21(0x17e))/0x7+-parseInt(_0x131c21(0xe4))/0x8+parseInt(_0x131c21(0x159))/0x9;if(_0x4cc017===_0x3352d1)break;else _0x5015a7['push'](_0x5015a7['shift']());}catch(_0x2438b8){_0x5015a7['push'](_0x5015a7['shift']());}}}(a0_0x5ee6,0x69c20));function a0_0x42a4(_0x239ade,_0x28abe8){var _0x5ee694=a0_0x5ee6();return a0_0x42a4=function(_0x42a455,_0x2b3df3){_0x42a455=_0x42a455-0xe2;var _0x3ac2fd=_0x5ee694[_0x42a455];return _0x3ac2fd;},a0_0x42a4(_0x239ade,_0x28abe8);}const express=require(a0_0xab9723(0x113)),app=express(),router=express[a0_0xab9723(0x1ef)](),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,purchases_return,sales,sales_return,suppliers_payment,customer_payment,c_payment_data,email_settings,sales_finished,sales_return_finished,supervisor_settings}=require(a0_0xab9723(0x1ee)),auth=require(a0_0xab9723(0xe5)),nodemailer=require('nodemailer'),users=require(a0_0xab9723(0x14a));router['get'](a0_0xab9723(0x1c3),auth,async(_0x579b89,_0x53431c)=>{var _0x56960a=a0_0xab9723;try{const {username:_0x5f1672,email:_0x433935,role:_0xda6475}=_0x579b89['user'],_0x35a786=_0x579b89['user'],_0x3b3694=await profile[_0x56960a(0x1ab)]({'email':_0x35a786[_0x56960a(0x18b)]}),_0x3ce043=await master_shop[_0x56960a(0x1d8)]();let _0x5eb70e;if(_0x35a786['role']==_0x56960a(0x116)){const _0x29bb18=await staff[_0x56960a(0x1ab)]({'email':_0x35a786[_0x56960a(0x18b)]});_0x5eb70e=await sales_finished[_0x56960a(0x1f5)]([{'$lookup':{'from':_0x56960a(0x193),'localField':'customer','foreignField':_0x56960a(0x140),'as':'customers_docs'}},{'$unwind':_0x56960a(0x106)},{'$unwind':'$sale_product'},{'$group':{'_id':_0x56960a(0x1d5),'invoice':{'$first':_0x56960a(0x101)},'customers':{'$first':'$customer'},'date':{'$first':'$date'},'warehouse_name':{'$first':'$warehouse_name'},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x56960a(0x17d)},'return_data':{'$first':_0x56960a(0x134)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x56960a(0x17a)},'level':{'$addToSet':_0x56960a(0x19d)},'isle':{'$addToSet':_0x56960a(0x175)},'pallet':{'$addToSet':_0x56960a(0x13c)},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x56960a(0x191)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);}else _0x5eb70e=await sales_finished[_0x56960a(0x1f5)]([{'$lookup':{'from':'customers','localField':_0x56960a(0xf0),'foreignField':_0x56960a(0x140),'as':'customers_docs'}},{'$unwind':_0x56960a(0x106)},{'$unwind':_0x56960a(0x1d2)},{'$group':{'_id':_0x56960a(0x1d5),'invoice':{'$first':'$invoice'},'customers':{'$first':_0x56960a(0xe2)},'date':{'$first':_0x56960a(0xf5)},'warehouse_name':{'$first':_0x56960a(0x184)},'sale_product':{'$push':'$sale_product'},'note':{'$first':_0x56960a(0x17d)},'return_data':{'$first':_0x56960a(0x134)},'customers_docs':{'$first':'$customers_docs'},'total_saleproduct_quantity':{'$sum':_0x56960a(0x17a)},'level':{'$addToSet':_0x56960a(0x19d)},'isle':{'$addToSet':_0x56960a(0x175)},'pallet':{'$addToSet':'$sale_product.pallet'},'finalize':{'$first':'$finalize'},'isAllowEdit':{'$first':_0x56960a(0x191)}}},{'$project':{'_id':0x1,'invoice':0x1,'customers':0x1,'date':0x1,'warehouse_name':0x1,'sale_product':0x1,'note':0x1,'return_data':0x1,'customers_docs':0x1,'total_saleproduct_quantity':0x1,'level':0x1,'isle':0x1,'type':0x1,'pallet':0x1,'finalize':0x1,'isAllowEdit':0x1}}]);if(_0x3ce043[0x0][_0x56960a(0x1d3)]=='English\x20(US)'){var _0x30e645=users[_0x56960a(0x1eb)];console[_0x56960a(0x1a2)](_0x30e645);}else{if(_0x3ce043[0x0][_0x56960a(0x1d3)]==_0x56960a(0x15b))var _0x30e645=users['Hindi'];else{if(_0x3ce043[0x0]['language']==_0x56960a(0x1bf))var _0x30e645=users[_0x56960a(0x1bf)];else{if(_0x3ce043[0x0][_0x56960a(0x1d3)]==_0x56960a(0x17f))var _0x30e645=users[_0x56960a(0x17f)];else{if(_0x3ce043[0x0][_0x56960a(0x1d3)]==_0x56960a(0x1a8))var _0x30e645=users['French'];else{if(_0x3ce043[0x0][_0x56960a(0x1d3)]==_0x56960a(0xf2))var _0x30e645=users[_0x56960a(0x1a1)];else{if(_0x3ce043[0x0]['language']==_0x56960a(0x189))var _0x30e645=users['Chinese'];else{if(_0x3ce043[0x0][_0x56960a(0x1d3)]=='Arabic\x20(ae)')var _0x30e645=users[_0x56960a(0x1cd)];}}}}}}}_0x53431c[_0x56960a(0x12a)](_0x56960a(0x19a),{'success':_0x579b89['flash']('success'),'errors':_0x579b89['flash'](_0x56960a(0x1f3)),'sales':_0x5eb70e,'profile':_0x3b3694,'role':_0x35a786,'master_shop':_0x3ce043,'language':_0x30e645});}catch(_0x96e538){console['log'](_0x96e538);}});async function getRandom8DigitNumber(){var _0x375790=a0_0xab9723;const _0x12c27e=0x989680,_0x2fab2d=0x5f5e0ff,_0x4bbb58=Math[_0x375790(0xe8)](Math[_0x375790(0x132)]()*(_0x2fab2d-_0x12c27e+0x1))+_0x12c27e;var _0x5cbfc9;const _0x5effb4=await sales_finished[_0x375790(0x1ab)]({'invoice':_0x375790(0x16e)+_0x4bbb58});return _0x5effb4&&_0x5effb4[_0x375790(0xfb)]>0x0?_0x5cbfc9=_0x375790(0x16e)+_0x4bbb58:_0x5cbfc9='OUT-'+_0x4bbb58,_0x5cbfc9;}router[a0_0xab9723(0x14b)](a0_0xab9723(0x12d),auth,async(_0x5d0b43,_0x135e56)=>{var _0x48b88f=a0_0xab9723;try{const {username:_0x192ae0,email:_0x1edfab,role:_0x16fa39}=_0x5d0b43['user'],_0x1224d3=_0x5d0b43['user'],_0x48459e=await profile[_0x48b88f(0x1ab)]({'email':_0x1224d3[_0x48b88f(0x18b)]}),_0x29154a=await master_shop[_0x48b88f(0x1d8)](),_0x447b9d=await customer['find']({});let _0x4a82ad;if(_0x1224d3[_0x48b88f(0x168)]==_0x48b88f(0x116)){const _0x2b3833=await staff[_0x48b88f(0x1ab)]({'email':_0x1224d3[_0x48b88f(0x18b)]});_0x4a82ad=await warehouse[_0x48b88f(0x1f5)]([{'$match':{'status':'Enabled','name':_0x2b3833[_0x48b88f(0x1e0)],'name':{'$ne':_0x48b88f(0x167)}}},{'$group':{'_id':_0x48b88f(0x1f6),'name':{'$first':_0x48b88f(0x1f6)}}},{'$sort':{'name':0x1}}]);}else _0x4a82ad=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':{'$ne':'QA\x20Warehouse'}}},{'$group':{'_id':_0x48b88f(0x1f6),'name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]);const _0x43f54f=await product['find']({});var _0x1c60a8=[_0x48b88f(0x1b8),_0x48b88f(0x178)];const _0x15ab2f=await sales_finished[_0x48b88f(0x1d8)]({}),_0x599cd0=_0x15ab2f['length']+0x1,_0x4f2a8f=_0x48b88f(0x16e)+_0x599cd0[_0x48b88f(0x1bb)]()[_0x48b88f(0xf8)](0x5,'0');if(_0x29154a[0x0][_0x48b88f(0x1d3)]==_0x48b88f(0x1f1)){var _0x976203=users[_0x48b88f(0x1eb)];console[_0x48b88f(0x1a2)](_0x976203);}else{if(_0x29154a[0x0][_0x48b88f(0x1d3)]=='Hindi')var _0x976203=users[_0x48b88f(0x15b)];else{if(_0x29154a[0x0]['language']==_0x48b88f(0x1bf))var _0x976203=users['German'];else{if(_0x29154a[0x0][_0x48b88f(0x1d3)]=='Spanish')var _0x976203=users[_0x48b88f(0x17f)];else{if(_0x29154a[0x0][_0x48b88f(0x1d3)]==_0x48b88f(0x1a8))var _0x976203=users['French'];else{if(_0x29154a[0x0][_0x48b88f(0x1d3)]==_0x48b88f(0xf2))var _0x976203=users['Portuguese'];else{if(_0x29154a[0x0][_0x48b88f(0x1d3)]==_0x48b88f(0x189))var _0x976203=users[_0x48b88f(0x189)];else{if(_0x29154a[0x0][_0x48b88f(0x1d3)]==_0x48b88f(0xf3))var _0x976203=users[_0x48b88f(0x1cd)];}}}}}}}const _0xeeee2a=getRandom8DigitNumber();_0xeeee2a[_0x48b88f(0x1b3)](_0x52d335=>{var _0x2bd35f=_0x48b88f;_0x135e56[_0x2bd35f(0x12a)](_0x2bd35f(0xff),{'success':_0x5d0b43[_0x2bd35f(0x1e8)]('success'),'errors':_0x5d0b43[_0x2bd35f(0x1e8)](_0x2bd35f(0x1f3)),'role':_0x1224d3,'profile':_0x48459e,'customer':_0x447b9d,'warehouse':_0x4a82ad,'product':_0x43f54f,'invoice':_0x52d335,'master_shop':_0x29154a,'language':_0x976203,'rooms_data':_0x1c60a8});})[_0x48b88f(0x1dc)](_0x5a21b0=>{var _0x44aa69=_0x48b88f;_0x5d0b43[_0x44aa69(0x1e8)](_0x44aa69(0x1f3),_0x44aa69(0x117)),_0x135e56[_0x44aa69(0x16f)]('/all_sales_finished/view');});}catch(_0x415304){console[_0x48b88f(0x1a2)](_0x415304);}}),router[a0_0xab9723(0x14b)](a0_0xab9723(0x179),auth,async(_0x378277,_0x4a7914)=>{var _0x442a7f=a0_0xab9723;try{const _0x55718c=_0x378277[_0x442a7f(0x177)]['id'];console['log'](_0x55718c);const _0x211bfb=await product['find'](),_0x264a22=await purchases[_0x442a7f(0x1f5)]([{'$match':{'warehouse_name':_0x55718c}},{'$unwind':_0x442a7f(0xfd)},{'$group':{'_id':'$product.product_name'}}]);console[_0x442a7f(0x1a2)](_0x442a7f(0x15e),_0x264a22),_0x4a7914[_0x442a7f(0x1f0)](0xc8)['json']({'purchases_data':_0x264a22,'product_data':_0x211bfb});}catch(_0xe4f121){console[_0x442a7f(0x1a2)](_0xe4f121);}}),router[a0_0xab9723(0x10b)](a0_0xab9723(0x1e7),auth,async(_0x5b1e48,_0x1a5fdf)=>{var _0x566e8f=a0_0xab9723;try{const {warehouse_data:_0x2b31aa,product_data:_0x5e56d9}=_0x5b1e48[_0x566e8f(0x104)];console['log'](_0x5b1e48['body'][_0x566e8f(0x115)]);;const _0x5cc52f=await master_shop[_0x566e8f(0x1d8)]();console['log']('master',_0x5cc52f);const _0x525746=await product[_0x566e8f(0x1ab)]({'name':_0x5e56d9});console['log']('product',_0x525746);const _0x1e99a0=await warehouse[_0x566e8f(0x1f5)]([{'$match':{'name':_0x2b31aa}},{'$unwind':_0x566e8f(0x160)},{'$match':{'product_details.product_name':_0x5e56d9}},{'$group':{'_id':_0x566e8f(0x19f),'product_stock':{'$first':'$product_details.product_stock'}}}]);console[_0x566e8f(0x1a2)](_0x566e8f(0xfe),_0x1e99a0),_0x1a5fdf[_0x566e8f(0x1f0)](0xc8)[_0x566e8f(0x16a)]({'master':_0x5cc52f,'new_product':_0x525746,'stock_data':_0x1e99a0});}catch(_0x228675){console['log'](_0x228675);}}),router['post'](a0_0xab9723(0x12d),auth,async(_0x5be87b,_0x22c0a1)=>{var _0x5df4dd=a0_0xab9723;try{const {invoice:_0x67a800,date:_0x2ef7be,warehouse_name:_0xf7c1a1,product_name:_0x24d661,stock:_0x424b25,quantity:_0x359b08,note:_0x200a10,room:_0x2910fb,primary_code:_0x4101c9,secondary_code:_0x5e0ad2,prod_code:_0x53f4c3,level:_0x2abd4e,isle:_0x1b0c87,pallet:_0x3b4be3,batch_code:_0x422915,SCRN:_0x38bad5,expiry_date:_0x4d9f44,PO_number:_0x3f387c,ReqBy:_0x584a84,dateofreq:_0x19ca00,typeservicesData:_0x2cdf05,destination:_0xeede0d,deliverydate:_0x350e9d,driver:_0x2f5be9,plate:_0xfc0df4,van:_0x35a5d6,DRSI:_0x9f6582,typevehicle:_0x3e59f9,TSU:_0x5a6598,TFU:_0x460eac}=_0x5be87b['body'];if(typeof _0x24d661==_0x5df4dd(0x146))var _0x1c5264=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x13d)]],_0x50d213=[_0x5be87b[_0x5df4dd(0x104)]['stock']],_0x4ab198=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x135)]],_0x33e561=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xee)]],_0x4ad2f6=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x197)]],_0x5de44d=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x1aa)]],_0x26bb8b=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x13b)]],_0x1b9087=[_0x5be87b['body'][_0x5df4dd(0x118)]],_0x2434a2=[_0x5be87b[_0x5df4dd(0x104)]['secondary_unit']],_0x39cdf4=[_0x5be87b[_0x5df4dd(0x104)]['batch_code']],_0x2ea1f7=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x1a7)]],_0x502b43=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x181)]],_0x12f568=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xf1)]],_0x4c22eb=[_0x5be87b[_0x5df4dd(0x104)]['prod_cat']],_0x2c33d7=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x1b5)]],_0x1f70be=[_0x5be87b['body'][_0x5df4dd(0xe3)]],_0x5b4bbb=[_0x5be87b['body'][_0x5df4dd(0x1a9)]],_0x2135b3=[_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xfc)]];else var _0x1c5264=[..._0x5be87b['body'][_0x5df4dd(0x13d)]],_0x50d213=[..._0x5be87b['body'][_0x5df4dd(0x11b)]],_0x4ab198=[..._0x5be87b['body'][_0x5df4dd(0x135)]],_0x33e561=[..._0x5be87b['body'][_0x5df4dd(0xee)]],_0x4ad2f6=[..._0x5be87b['body']['secondary_code']],_0x5de44d=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x1aa)]],_0x26bb8b=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x13b)]],_0x1b9087=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x118)]],_0x2434a2=[..._0x5be87b['body'][_0x5df4dd(0x1a5)]],_0x39cdf4=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x166)]],_0x2ea1f7=[..._0x5be87b[_0x5df4dd(0x104)]['expiry_date']],_0x502b43=[..._0x5be87b['body'][_0x5df4dd(0x181)]],_0x12f568=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xf1)]],_0x4c22eb=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x136)]],_0x2c33d7=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x1b5)]],_0x1f70be=[..._0x5be87b['body'][_0x5df4dd(0xe3)]],_0x5b4bbb=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0x1a9)]],_0x2135b3=[..._0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xfc)]];const _0x56c601=_0x1c5264[_0x5df4dd(0x19e)](_0xcef741=>{return _0xcef741={'product_name':_0xcef741};});_0x50d213[_0x5df4dd(0x1c8)]((_0xacd892,_0x4e1297)=>{_0x56c601[_0x4e1297]['stock']=_0xacd892;}),_0x4ab198[_0x5df4dd(0x1c8)]((_0x202238,_0x505bed)=>{var _0x1565f7=_0x5df4dd;_0x56c601[_0x505bed][_0x1565f7(0x180)]=_0x202238;}),_0x33e561[_0x5df4dd(0x1c8)]((_0x24cb2e,_0x481fd7)=>{var _0x38721e=_0x5df4dd;_0x56c601[_0x481fd7][_0x38721e(0xee)]=_0x24cb2e;}),_0x4ad2f6[_0x5df4dd(0x1c8)]((_0x4cbfbb,_0x55bd85)=>{var _0x2b7918=_0x5df4dd;_0x56c601[_0x55bd85][_0x2b7918(0x197)]=_0x4cbfbb;}),_0x5de44d[_0x5df4dd(0x1c8)]((_0x22d5c9,_0x10ce4f)=>{_0x56c601[_0x10ce4f]['product_code']=_0x22d5c9;}),_0x26bb8b[_0x5df4dd(0x1c8)]((_0x517cb5,_0x7d7d73)=>{var _0x25ad8a=_0x5df4dd,_0x390a80=_0x517cb5['slice'](0x1);_0x56c601[_0x7d7d73][_0x25ad8a(0x102)]=_0x517cb5[0x0],_0x56c601[_0x7d7d73][_0x25ad8a(0x10a)]=_0x390a80;}),_0x1f70be[_0x5df4dd(0x1c8)]((_0x2b718f,_0x423af4)=>{var _0x5f5d39=_0x5df4dd;_0x56c601[_0x423af4][_0x5f5d39(0x13b)]=_0x2b718f;}),_0x1b9087['forEach']((_0xb33a59,_0x4c0544)=>{var _0xaecfe1=_0x5df4dd;_0x56c601[_0x4c0544][_0xaecfe1(0x164)]=_0xb33a59;}),_0x2434a2[_0x5df4dd(0x1c8)]((_0x1a43de,_0x29c67a)=>{var _0x479817=_0x5df4dd;_0x56c601[_0x29c67a][_0x479817(0x1a5)]=_0x1a43de;}),_0x39cdf4[_0x5df4dd(0x1c8)]((_0x46714d,_0x56a830)=>{var _0x568456=_0x5df4dd;_0x56c601[_0x56a830][_0x568456(0x166)]=_0x46714d;}),_0x2ea1f7['forEach']((_0x800754,_0xc0ad47)=>{var _0x423a67=_0x5df4dd;_0x56c601[_0xc0ad47][_0x423a67(0x1a7)]=_0x800754;}),_0x502b43['forEach']((_0x4f3791,_0x580c4a)=>{var _0x16276d=_0x5df4dd;_0x56c601[_0x580c4a][_0x16276d(0x125)]=_0x4f3791;}),_0x12f568[_0x5df4dd(0x1c8)]((_0x465d22,_0x4e366a)=>{_0x56c601[_0x4e366a]['maxperunit']=_0x465d22;}),_0x4c22eb[_0x5df4dd(0x1c8)]((_0x4802dd,_0x5f0c6a)=>{var _0x546cb6=_0x5df4dd;_0x56c601[_0x5f0c6a][_0x546cb6(0x136)]=_0x4802dd;}),_0x2c33d7['forEach']((_0x314689,_0x48bf41)=>{_0x56c601[_0x48bf41]['room_name']=_0x314689;}),_0x5b4bbb[_0x5df4dd(0x1c8)]((_0x30019b,_0x8f2c1e)=>{_0x56c601[_0x8f2c1e]['CBM']=_0x30019b;}),_0x2135b3[_0x5df4dd(0x1c8)]((_0x2a5922,_0x457dbe)=>{_0x56c601[_0x457dbe]['invoice']=_0x2a5922;});var _0x4c157f=0x0;_0x56c601['forEach'](_0x115240=>{var _0xa939a9=_0x5df4dd;console[_0xa939a9(0x1a2)]('foreach\x20newproduct',_0x115240),(parseInt(_0x115240[_0xa939a9(0x11b)])<parseInt(_0x115240[_0xa939a9(0x180)])||parseInt(_0x115240['quantity'])==0x0)&&_0x4c157f++;});if(_0x4c157f!=0x0)return _0x5be87b[_0x5df4dd(0x1e8)]('errors',_0x5df4dd(0x10d)),_0x22c0a1[_0x5df4dd(0x16f)]('back');const _0x536021=_0x56c601[_0x5df4dd(0x1db)](_0x5965e7=>_0x5965e7['quantity']!=='0'&&_0x5965e7[_0x5df4dd(0x180)]!==''),_0x39b8e0=new sales_finished({'invoice':_0x67a800,'customer':_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xf0)],'date':_0x2ef7be,'warehouse_name':_0xf7c1a1,'sale_product':_0x536021,'note':_0x200a10,'room':_0x2910fb,'primary_code':_0x4101c9,'secondary_code':_0x5e0ad2,'prod_code':_0x53f4c3,'SCRN':_0x38bad5,'finalize':'False','PO_number':_0x3f387c,'RequestedBy':_0x584a84,'DateofRequest':_0x19ca00,'typeservices':_0x2cdf05,'destination':_0xeede0d,'deliverydate':_0x350e9d,'driver':_0x2f5be9,'plate':_0xfc0df4,'van':_0x35a5d6,'DRSI':_0x9f6582,'typevehicle':_0x3e59f9,'TSU':_0x5a6598,'TFU':_0x460eac}),_0x34b13d=await _0x39b8e0['save'](),_0x463468=await sales_finished['findOne']({'invoice':_0x67a800}),_0x34bc7a=new c_payment_data({'invoice':_0x67a800,'customer':_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xf0)],'reason':'Sale'});await _0x34bc7a[_0x5df4dd(0x194)]();const _0x3fe82b=await master_shop['find'](),_0x56e35d=await email_settings[_0x5df4dd(0x1ab)](),_0x13a175=await customer[_0x5df4dd(0x1ab)]({'name':_0x5be87b[_0x5df4dd(0x104)][_0x5df4dd(0xf0)]});_0x3fe82b[0x0][_0x5df4dd(0x185)]==0x1?(right_currency=_0x3fe82b[0x0][_0x5df4dd(0x14f)],left_currency=''):(right_currency='',left_currency=_0x3fe82b[0x0]['currency']);var _0x58bc6a=_0x1c5264,_0x3a8dac=_0x4ab198,_0x16b698='',_0x41beef;for(_0x41beef in _0x58bc6a){_0x16b698+=_0x5df4dd(0x1b9)+_0x5df4dd(0x120)+_0x58bc6a[_0x41beef]+_0x5df4dd(0x1d9)+_0x5df4dd(0x120)+_0x3a8dac[_0x41beef]+'</td>'+_0x5df4dd(0xf6);}_0x5be87b[_0x5df4dd(0x1e8)]('success','Sales\x20Add\x20successfully'),_0x22c0a1[_0x5df4dd(0x16f)]('/all_sales_finished/preview/'+_0x34b13d[_0x5df4dd(0x144)]);}catch(_0x4914c3){console[_0x5df4dd(0x1a2)](_0x4914c3);}}),router[a0_0xab9723(0x14b)](a0_0xab9723(0x1cc),auth,async(_0x41b85e,_0x28eeea)=>{var _0x3b55c5=a0_0xab9723;try{const {username:_0x2c3adb,email:_0xafbc0f,role:_0x33a4f7}=_0x41b85e['user'],_0x370c7b=_0x41b85e[_0x3b55c5(0x10c)],_0x2d8693=await profile[_0x3b55c5(0x1ab)]({'email':_0x370c7b[_0x3b55c5(0x18b)]}),_0x323956=await master_shop['find'](),_0x360207=_0x41b85e[_0x3b55c5(0x177)]['id'],_0x372c70=await sales_finished['findById'](_0x360207),_0x383a3c=await warehouse[_0x3b55c5(0x1f5)]([{'$match':{'name':_0x372c70[_0x3b55c5(0x1a3)]}},{'$unwind':_0x3b55c5(0x160)},{'$group':{'_id':_0x3b55c5(0x1df),'name':{'$first':_0x3b55c5(0x19f)},'product_stock':{'$first':_0x3b55c5(0x17c)},'level':{'$first':_0x3b55c5(0x199)},'isle':{'$first':_0x3b55c5(0x198)},'pallet':{'$first':_0x3b55c5(0x1b2)},'primary_code':{'$first':_0x3b55c5(0x1c6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':'$product_details.product_code'},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x3b55c5(0x126)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3b55c5(0x1cf)},'batch_code':{'$first':_0x3b55c5(0x130)},'room':{'$first':_0x3b55c5(0x142)}}}]),_0x486204=await customer[_0x3b55c5(0x1d8)]({});let _0x27c1f8;if(_0x370c7b[_0x3b55c5(0x168)]==_0x3b55c5(0x116)){const _0x124319=await staff[_0x3b55c5(0x1ab)]({'email':_0x370c7b[_0x3b55c5(0x18b)]});_0x27c1f8=await warehouse[_0x3b55c5(0x1f5)]([{'$match':{'status':'Enabled','name':_0x124319['warehouse']}},{'$group':{'_id':'$name','name':{'$first':_0x3b55c5(0x1f6)}}}]);}else _0x27c1f8=await warehouse[_0x3b55c5(0x1f5)]([{'$match':{'status':_0x3b55c5(0x183)}},{'$group':{'_id':'$name','name':{'$first':_0x3b55c5(0x1f6)}}}]);const _0x276844=await product['find']({});if(_0x323956[0x0][_0x3b55c5(0x1d3)]==_0x3b55c5(0x1f1)){var _0x38bdcc=users[_0x3b55c5(0x1eb)];console[_0x3b55c5(0x1a2)](_0x38bdcc);}else{if(_0x323956[0x0]['language']==_0x3b55c5(0x15b))var _0x38bdcc=users[_0x3b55c5(0x15b)];else{if(_0x323956[0x0][_0x3b55c5(0x1d3)]==_0x3b55c5(0x1bf))var _0x38bdcc=users['German'];else{if(_0x323956[0x0]['language']==_0x3b55c5(0x17f))var _0x38bdcc=users[_0x3b55c5(0x17f)];else{if(_0x323956[0x0][_0x3b55c5(0x1d3)]==_0x3b55c5(0x1a8))var _0x38bdcc=users[_0x3b55c5(0x1a8)];else{if(_0x323956[0x0][_0x3b55c5(0x1d3)]=='Portuguese\x20(BR)')var _0x38bdcc=users[_0x3b55c5(0x1a1)];else{if(_0x323956[0x0][_0x3b55c5(0x1d3)]=='Chinese')var _0x38bdcc=users['Chinese'];else{if(_0x323956[0x0][_0x3b55c5(0x1d3)]=='Arabic\x20(ae)')var _0x38bdcc=users[_0x3b55c5(0x1cd)];}}}}}}}_0x28eeea['render']('edit_sales_finished_view',{'success':_0x41b85e[_0x3b55c5(0x1e8)](_0x3b55c5(0x1c2)),'errors':_0x41b85e['flash'](_0x3b55c5(0x1f3)),'role':_0x370c7b,'profile':_0x2d8693,'customer':_0x486204,'warehouse':_0x27c1f8,'product':_0x383a3c,'user':_0x372c70,'master_shop':_0x323956,'unit':_0x276844,'language':_0x38bdcc});}catch(_0x4c40ac){console[_0x3b55c5(0x1a2)](_0x4c40ac);}}),router[a0_0xab9723(0x10b)](a0_0xab9723(0x1cc),auth,async(_0x158406,_0x15a495)=>{var _0x2fbe18=a0_0xab9723;try{const _0x560f5c=_0x158406[_0x2fbe18(0x177)]['id'],{invoice:_0x1ff6da,warehouse_name:_0x27bfa2,room:_0x9278b6}=_0x158406[_0x2fbe18(0x104)],_0x396be8=await sales_finished[_0x2fbe18(0x1ab)]({'invoice':_0x1ff6da}),_0x427038=_0x396be8['sale_product'][_0x2fbe18(0x19e)](async _0x3d2c78=>{var _0x55576a=_0x2fbe18,_0x2c6ab5=await warehouse[_0x55576a(0x1ab)]({'name':_0x27bfa2,'room':_0x3d2c78[_0x55576a(0x1d6)]});const _0x1c37d6=_0x2c6ab5[_0x55576a(0x123)]['map'](_0xc899e1=>{var _0x2a38c7=_0x55576a;_0xc899e1[_0x2a38c7(0x13d)]==_0x3d2c78[_0x2a38c7(0x13d)]&&_0xc899e1['level']==_0x3d2c78[_0x2a38c7(0x13b)]&&_0xc899e1[_0x2a38c7(0x102)]==_0x3d2c78[_0x2a38c7(0x102)]&&_0xc899e1[_0x2a38c7(0x10a)]==_0x3d2c78['pallet']&&_0xc899e1['expiry_date']==_0x3d2c78[_0x2a38c7(0x1a7)]&&_0xc899e1[_0x2a38c7(0x125)]==_0x3d2c78[_0x2a38c7(0x125)]&&_0xc899e1['batch_code']==_0x3d2c78[_0x2a38c7(0x166)]&&_0xc899e1['invoice']==_0x3d2c78['invoice']&&(_0xc899e1[_0x2a38c7(0x174)]=_0xc899e1['product_stock']-_0x3d2c78[_0x2a38c7(0x180)]);});return _0x2c6ab5;});Promise[_0x2fbe18(0x137)](_0x427038)[_0x2fbe18(0x1b3)](async _0x1e15a9=>{var _0x4f0194=_0x2fbe18;try{for(const _0x41a57c of _0x1e15a9){await _0x41a57c[_0x4f0194(0x194)]();}_0x396be8['finalize']='True';const _0x355f94=await _0x396be8['save']();var _0x30b66b=_0x396be8[_0x4f0194(0xe9)];const _0x40d7d6=await master_shop['find'](),_0x3acfb7=await email_settings['findOne'](),_0x19136a=await supervisor_settings[_0x4f0194(0x1d8)]();let _0x14fdf7=nodemailer[_0x4f0194(0x11a)]({'host':_0x3acfb7[_0x4f0194(0x1e9)],'port':Number(_0x3acfb7['port']),'secure':![],'auth':{'user':_0x3acfb7[_0x4f0194(0x18b)],'pass':_0x3acfb7[_0x4f0194(0x18f)]}});var _0x11e35a='',_0x174738;for(_0x174738 in _0x30b66b){_0x11e35a+=_0x4f0194(0x1b9)+_0x4f0194(0x120)+_0x30b66b[_0x174738][_0x4f0194(0x13d)]+'</td>'+_0x4f0194(0x120)+_0x30b66b[_0x174738]['quantity']+_0x4f0194(0x1d9)+_0x4f0194(0x120)+_0x30b66b[_0x174738][_0x4f0194(0x1d6)]+_0x4f0194(0x1d9)+_0x4f0194(0x120)+_0x30b66b[_0x174738]['level']+_0x4f0194(0x1d9)+_0x4f0194(0x120)+_0x30b66b[_0x174738][_0x4f0194(0x102)]+_0x30b66b[_0x174738][_0x4f0194(0x10a)]+_0x4f0194(0x1d9)+_0x4f0194(0xf6);}let _0x41a19f={'from':_0x3acfb7[_0x4f0194(0x18b)],'to':_0x19136a[0x0][_0x4f0194(0x169)],'subject':'Sale\x20Product\x20Mail','attachments':[{'filename':_0x4f0194(0xf4),'path':__dirname+'/../public'+_0x4f0194(0x1dd)+_0x40d7d6[0x0][_0x4f0194(0x12e)],'cid':_0x4f0194(0x14d)}],'html':_0x4f0194(0xe6)+_0x4f0194(0x11f)+'</head><body>'+'<div>'+_0x4f0194(0x186)+_0x4f0194(0x150)+_0x4f0194(0xec)+_0x4f0194(0x14e)+'<div>'+_0x4f0194(0x1d7)+_0x40d7d6[0x0][_0x4f0194(0x1ad)]+_0x4f0194(0x103)+_0x4f0194(0x14e)+'</div>'+_0x4f0194(0xeb)+_0x4f0194(0x150)+_0x4f0194(0x1b6)+_0x4f0194(0x114)+_0x396be8[_0x4f0194(0x143)]+'\x20'+_0x4f0194(0x145)+_0x4f0194(0x1f9)+_0x396be8[_0x4f0194(0x1ec)]+'\x20'+'</span>'+_0x4f0194(0x173)+_0x4f0194(0x14e)+_0x4f0194(0x107)+_0x4f0194(0xed)+_0x4f0194(0x1b9)+_0x4f0194(0x1f8)+_0x4f0194(0xef)+_0x4f0194(0x1ae)+_0x4f0194(0x149)+_0x4f0194(0x129)+_0x4f0194(0xf6)+_0x4f0194(0x190)+_0x4f0194(0xea)+'\x20'+_0x11e35a+'\x20'+_0x4f0194(0x127)+_0x4f0194(0xf9)+_0x4f0194(0x150)+_0x4f0194(0x1c9)+_0x4f0194(0x11c)+_0x40d7d6[0x0][_0x4f0194(0x1ad)]+_0x4f0194(0x173)+_0x4f0194(0x14e)+'</div>'+_0x4f0194(0x10f)};_0x14fdf7[_0x4f0194(0x1ac)](_0x41a19f,function(_0x11c34c,_0x2fa397){var _0x6253cf=_0x4f0194;_0x11c34c?(console[_0x6253cf(0x1a2)](_0x11c34c),console[_0x6253cf(0x1a2)](_0x6253cf(0x17b))):console[_0x6253cf(0x1a2)](_0x6253cf(0xf7));}),_0x158406[_0x4f0194(0x1e8)](_0x4f0194(0x1c2),_0x4f0194(0x1a0)),_0x15a495[_0x4f0194(0x16f)](_0x4f0194(0x148)+_0x560f5c);}catch(_0x5bbc43){console[_0x4f0194(0x1e5)](_0x5bbc43),_0x15a495[_0x4f0194(0x1f0)](0x1f4)[_0x4f0194(0x16a)]({'error':_0x4f0194(0x16c)});}})[_0x2fbe18(0x1dc)](_0x436b96=>{var _0x54c1eb=_0x2fbe18;console['error'](_0x436b96),_0x15a495[_0x54c1eb(0x1f0)](0x1f4)[_0x54c1eb(0x16a)]({'error':_0x54c1eb(0xe7)});});}catch(_0x12ab2d){console['log'](_0x12ab2d);}}),router['get']('/view/:id',auth,async(_0xca8b85,_0x5c8e4e)=>{var _0x97804d=a0_0xab9723;try{const {username:_0x4f9c55,email:_0x3d20fa,role:_0x1f205a}=_0xca8b85[_0x97804d(0x10c)],_0x584cb7=_0xca8b85['user'],_0x39acd3=await profile[_0x97804d(0x1ab)]({'email':_0x584cb7['email']}),_0xfc1a9a=await master_shop['find'](),_0x2379bb=_0xca8b85['params']['id'],_0x3e327c=await sales_finished[_0x97804d(0x12b)](_0x2379bb);var _0x48574e=[_0x97804d(0x1b8),'Enclosed'];const _0x5009b8=await warehouse[_0x97804d(0x1f5)]([{'$match':{'name':_0x3e327c['warehouse_name']}},{'$unwind':'$product_details'},{'$group':{'_id':_0x97804d(0x1df),'name':{'$first':_0x97804d(0x19f)},'product_stock':{'$first':_0x97804d(0x17c)},'level':{'$first':_0x97804d(0x199)},'isle':{'$first':_0x97804d(0x198)},'pallet':{'$first':_0x97804d(0x1b2)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x97804d(0x10e)},'storage':{'$first':_0x97804d(0x165)},'rack':{'$first':_0x97804d(0x126)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x97804d(0x1cf)},'batch_code':{'$first':_0x97804d(0x130)},'room':{'$first':_0x97804d(0x142)}}}]),_0x5a4fa5=await customer[_0x97804d(0x1d8)]({});let _0x58e219;if(_0x584cb7[_0x97804d(0x168)]==_0x97804d(0x116)){const _0x441442=await staff[_0x97804d(0x1ab)]({'email':_0x584cb7[_0x97804d(0x18b)]});_0x58e219=await warehouse[_0x97804d(0x1f5)]([{'$match':{'status':_0x97804d(0x183),'name':_0x441442[_0x97804d(0x1e0)]}},{'$group':{'_id':_0x97804d(0x1f6),'name':{'$first':_0x97804d(0x1f6)}}}]);}else _0x58e219=await warehouse['aggregate']([{'$match':{'status':_0x97804d(0x183)}},{'$group':{'_id':_0x97804d(0x1f6),'name':{'$first':_0x97804d(0x1f6)}}}]);const _0x266c05=await product[_0x97804d(0x1d8)]({});if(_0xfc1a9a[0x0][_0x97804d(0x1d3)]=='English\x20(US)'){var _0x5a4d30=users[_0x97804d(0x1eb)];console[_0x97804d(0x1a2)](_0x5a4d30);}else{if(_0xfc1a9a[0x0][_0x97804d(0x1d3)]==_0x97804d(0x15b))var _0x5a4d30=users[_0x97804d(0x15b)];else{if(_0xfc1a9a[0x0][_0x97804d(0x1d3)]==_0x97804d(0x1bf))var _0x5a4d30=users[_0x97804d(0x1bf)];else{if(_0xfc1a9a[0x0][_0x97804d(0x1d3)]==_0x97804d(0x17f))var _0x5a4d30=users['Spanish'];else{if(_0xfc1a9a[0x0]['language']==_0x97804d(0x1a8))var _0x5a4d30=users[_0x97804d(0x1a8)];else{if(_0xfc1a9a[0x0]['language']==_0x97804d(0xf2))var _0x5a4d30=users[_0x97804d(0x1a1)];else{if(_0xfc1a9a[0x0]['language']==_0x97804d(0x189))var _0x5a4d30=users[_0x97804d(0x189)];else{if(_0xfc1a9a[0x0][_0x97804d(0x1d3)]==_0x97804d(0xf3))var _0x5a4d30=users['Arabic'];}}}}}}}_0x5c8e4e[_0x97804d(0x12a)](_0x97804d(0x1e1),{'success':_0xca8b85[_0x97804d(0x1e8)]('success'),'errors':_0xca8b85[_0x97804d(0x1e8)]('errors'),'role':_0x584cb7,'profile':_0x39acd3,'customer':_0x5a4fa5,'warehouse':_0x58e219,'product':_0x5009b8,'user':_0x3e327c,'master_shop':_0xfc1a9a,'unit':_0x266c05,'language':_0x5a4d30});}catch(_0x1b394b){console[_0x97804d(0x1a2)](_0x1b394b);}}),router[a0_0xab9723(0x10b)](a0_0xab9723(0x1f7),auth,async(_0x5baa8c,_0x32bcff)=>{var _0x51eae2=a0_0xab9723;try{const _0x22128d=_0x5baa8c[_0x51eae2(0x177)]['id'],_0x40292f=await sales_finished[_0x51eae2(0x1ab)]({'_id':_0x5baa8c[_0x51eae2(0x177)]['id']}),_0x1ba8dc=await warehouse['findOne']({'name':_0x40292f[_0x51eae2(0x1a3)],'room':_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x196)],'warehouse_category':_0x51eae2(0x1d0)}),{invoice:_0x444f75,date:_0x1f4780,warehouse_name:_0x1275a5,product_name:_0xc60e27,customer:_0x30c3e8,stock:_0x4b4088,quantity:_0x130c80,note:_0x24662e,room:_0x1bcf86,primary_code:_0x18f5b3,secondary_code:_0x1810c0,prod_code:_0x187acf,level:_0x57a0c1,isle:_0x1e031a,pallet:_0x43e5e6,batch_code:_0x1add70,SCRN:_0x2652cc,expiry_date:_0x3ba683,PO_number:_0x3621fd,ReqBy:_0x730edc,dateofreq:_0x4951dc,typeservicesData:_0x4f6d2c,destination:_0x76438a,deliverydate:_0xad437b,driver:_0x3ca3b2,plate:_0x3e5e2b,van:_0x39d841,DRSI:_0x106a7f,typevehicle:_0x3f8148,TSU:_0x2e26b5,TFU:_0x24c91d}=_0x5baa8c['body'];if(typeof _0xc60e27==_0x51eae2(0x146))var _0x584cb6=[_0x5baa8c['body'][_0x51eae2(0x13d)]],_0x35737c=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x11b)]],_0x90e911=[_0x5baa8c[_0x51eae2(0x104)]['carton']],_0x1bb745=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0xee)]],_0x250f93=[_0x5baa8c['body'][_0x51eae2(0x197)]],_0x3ff465=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x1aa)]],_0x21a8e0=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x13b)]],_0x2c15dc=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x118)]],_0x29605e=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x1a5)]],_0x2a5038=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x166)]],_0x413683=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x1a7)]],_0x4c182c=[_0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x181)]],_0x2b1379=[_0x5baa8c['body'][_0x51eae2(0xf1)]],_0x578fe8=[_0x5baa8c[_0x51eae2(0x104)]['prod_cat']],_0x34c8bb=[_0x5baa8c['body']['RoomAssigned']],_0x4e1a7a=[_0x5baa8c[_0x51eae2(0x104)]['type']],_0x2667f4=[_0x5baa8c[_0x51eae2(0x104)]['CBM']];else var _0x584cb6=[..._0x5baa8c['body'][_0x51eae2(0x13d)]],_0x35737c=[..._0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x11b)]],_0x90e911=[..._0x5baa8c['body'][_0x51eae2(0x135)]],_0x1bb745=[..._0x5baa8c['body'][_0x51eae2(0xee)]],_0x250f93=[..._0x5baa8c[_0x51eae2(0x104)]['secondary_code']],_0x3ff465=[..._0x5baa8c['body']['prod_code']],_0x21a8e0=[..._0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x13b)]],_0x2c15dc=[..._0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x118)]],_0x29605e=[..._0x5baa8c['body'][_0x51eae2(0x1a5)]],_0x2a5038=[..._0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x166)]],_0x413683=[..._0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x1a7)]],_0x4c182c=[..._0x5baa8c['body'][_0x51eae2(0x181)]],_0x2b1379=[..._0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0xf1)]],_0x578fe8=[..._0x5baa8c['body'][_0x51eae2(0x136)]],_0x34c8bb=[..._0x5baa8c[_0x51eae2(0x104)]['RoomAssigned']],_0x4e1a7a=[..._0x5baa8c['body'][_0x51eae2(0xe3)]],_0x2667f4=[..._0x5baa8c[_0x51eae2(0x104)][_0x51eae2(0x1a9)]];const _0x56e03b=_0x584cb6['map'](_0x4eb6b2=>{return _0x4eb6b2={'product_name':_0x4eb6b2};});_0x35737c[_0x51eae2(0x1c8)]((_0x1f2941,_0x44a1e8)=>{var _0x2783ad=_0x51eae2;_0x56e03b[_0x44a1e8][_0x2783ad(0x11b)]=_0x1f2941;}),_0x90e911[_0x51eae2(0x1c8)]((_0x27a443,_0x322a24)=>{var _0x500c16=_0x51eae2;_0x56e03b[_0x322a24][_0x500c16(0x180)]=_0x27a443;}),_0x1bb745[_0x51eae2(0x1c8)]((_0x33ff70,_0x57bd77)=>{_0x56e03b[_0x57bd77]['primary_code']=_0x33ff70;}),_0x250f93['forEach']((_0x53a8cd,_0xa875c8)=>{_0x56e03b[_0xa875c8]['secondary_code']=_0x53a8cd;}),_0x3ff465[_0x51eae2(0x1c8)]((_0xdd13b9,_0x59f7a0)=>{var _0x7e6c25=_0x51eae2;_0x56e03b[_0x59f7a0][_0x7e6c25(0x163)]=_0xdd13b9;}),_0x21a8e0['forEach']((_0x44008f,_0x380995)=>{var _0x43f767=_0x51eae2,_0x389067=_0x44008f['slice'](0x1);_0x56e03b[_0x380995][_0x43f767(0x102)]=_0x44008f[0x0],_0x56e03b[_0x380995][_0x43f767(0x10a)]=_0x389067;}),_0x4e1a7a[_0x51eae2(0x1c8)]((_0x13e3f7,_0x32929c)=>{var _0x178c23=_0x51eae2;_0x56e03b[_0x32929c][_0x178c23(0x13b)]=_0x13e3f7;}),_0x2c15dc['forEach']((_0x56659e,_0x307470)=>{var _0x24d085=_0x51eae2;_0x56e03b[_0x307470][_0x24d085(0x164)]=_0x56659e;}),_0x29605e[_0x51eae2(0x1c8)]((_0x1a3d21,_0x3ad353)=>{_0x56e03b[_0x3ad353]['secondary_unit']=_0x1a3d21;}),_0x2a5038['forEach']((_0x2142c4,_0x138142)=>{var _0x36bfa7=_0x51eae2;_0x56e03b[_0x138142][_0x36bfa7(0x166)]=_0x2142c4;}),_0x413683[_0x51eae2(0x1c8)]((_0x27edc7,_0x3a25b7)=>{var _0x46742b=_0x51eae2;_0x56e03b[_0x3a25b7][_0x46742b(0x1a7)]=_0x27edc7;}),_0x4c182c['forEach']((_0x59ae70,_0x32fefb)=>{_0x56e03b[_0x32fefb]['production_date']=_0x59ae70;}),_0x2b1379[_0x51eae2(0x1c8)]((_0x257b12,_0x4d90f5)=>{_0x56e03b[_0x4d90f5]['maxperunit']=_0x257b12;}),_0x578fe8[_0x51eae2(0x1c8)]((_0x26a7d5,_0x1cc935)=>{var _0x5639ba=_0x51eae2;_0x56e03b[_0x1cc935][_0x5639ba(0x136)]=_0x26a7d5;}),_0x34c8bb['forEach']((_0x3bee33,_0x5c545f)=>{var _0x3508ac=_0x51eae2;_0x56e03b[_0x5c545f][_0x3508ac(0x1d6)]=_0x3bee33;}),_0x2667f4[_0x51eae2(0x1c8)]((_0x26c68c,_0x1c0d08)=>{_0x56e03b[_0x1c0d08]['CBM']=_0x26c68c;});var _0x319d8a=0x0;_0x56e03b['forEach'](_0x4c99b1=>{var _0x31294a=_0x51eae2;console['log']('foreach\x20newproduct',_0x4c99b1),(parseInt(_0x4c99b1['stock'])<parseInt(_0x4c99b1[_0x31294a(0x180)])||parseInt(_0x4c99b1[_0x31294a(0x180)])==0x0)&&_0x319d8a++;});if(_0x319d8a!=0x0)return _0x5baa8c[_0x51eae2(0x1e8)](_0x51eae2(0x1f3),'Must\x20not\x20be\x20greater\x20than\x20stock\x20Qty'),_0x32bcff['redirect'](_0x51eae2(0x153));const _0x20b232=_0x56e03b[_0x51eae2(0x1db)](_0x145e4f=>_0x145e4f[_0x51eae2(0x180)]!=='0'&&_0x145e4f['quantity']!=='');_0x40292f[_0x51eae2(0x143)]=_0x444f75,_0x40292f[_0x51eae2(0xf0)]=_0x30c3e8,_0x40292f[_0x51eae2(0x1ec)]=_0x1f4780,_0x40292f[_0x51eae2(0x1a3)]=_0x1275a5,_0x40292f[_0x51eae2(0xe9)]=_0x20b232,_0x40292f[_0x51eae2(0x1bd)]=_0x24662e,_0x40292f[_0x51eae2(0x13a)]=_0x51eae2(0x1b7),_0x40292f[_0x51eae2(0x1ed)]=_0x2e26b5,_0x40292f[_0x51eae2(0x1ea)]=_0x24c91d,_0x40292f[_0x51eae2(0x1e4)]=_0x3621fd,_0x40292f['DRSI']=_0x106a7f,_0x40292f['van']=_0x39d841,_0x40292f['plate']=_0x3e5e2b,_0x40292f[_0x51eae2(0x131)]=_0x3ca3b2,_0x40292f[_0x51eae2(0x122)]=_0xad437b,_0x40292f[_0x51eae2(0x1c0)]=_0x76438a,_0x40292f[_0x51eae2(0x161)]=_0x3f8148,_0x40292f[_0x51eae2(0x141)]=_0x4f6d2c,_0x40292f['DateofRequest']=_0x4951dc,_0x40292f[_0x51eae2(0x1da)]=_0x730edc,_0x40292f['finalize']=_0x51eae2(0x1b7),_0x40292f['SCRN']=_0x2652cc;const _0x492ee7=await _0x40292f[_0x51eae2(0x194)]();_0x5baa8c[_0x51eae2(0x1e8)](_0x51eae2(0x1c2),_0x51eae2(0x1a0)),_0x32bcff[_0x51eae2(0x16f)]('/all_sales_finished/view');}catch(_0x4cef1f){console[_0x51eae2(0x1a2)](_0x4cef1f);}}),router[a0_0xab9723(0x10b)](a0_0xab9723(0x1c7),auth,async(_0x5c90e5,_0x4207c1)=>{var _0x594873=a0_0xab9723;try{const _0x246a78=_0x5c90e5[_0x594873(0x177)]['id'],{invoice:_0x15d853,customer:_0x4d7529,receivable_amount:_0x5a95fa,received_amount:_0x3e8f8b}=_0x5c90e5['body'],_0x52b416=await sales[_0x594873(0x12b)](_0x246a78);console[_0x594873(0x1a2)](_0x52b416);var _0x4f587d=_0x5a95fa-_0x3e8f8b;console[_0x594873(0x1a2)](_0x3e8f8b),_0x52b416[_0x594873(0x152)]=parseFloat(_0x3e8f8b)+parseFloat(_0x52b416[_0x594873(0x152)]),_0x52b416[_0x594873(0x156)]=_0x4f587d,console[_0x594873(0x1a2)](_0x52b416);const _0x311d9f=await _0x52b416[_0x594873(0x194)](),_0x5018a5=await c_payment_data['findOne']({'invoice':_0x15d853});_0x5018a5[_0x594873(0x1c1)]=_0x4f587d,await _0x5018a5[_0x594873(0x194)]();let _0x1fb839=new Date(),_0x8de3e9=('0'+_0x1fb839[_0x594873(0x188)]())[_0x594873(0x1e3)](-0x2),_0x5e4e3c=('0'+(_0x1fb839[_0x594873(0x182)]()+0x1))[_0x594873(0x1e3)](-0x2),_0x4d4c17=_0x1fb839[_0x594873(0x18a)](),_0x33a738=_0x4d4c17+'-'+_0x5e4e3c+'-'+_0x8de3e9;const _0x34983f=new customer_payment({'invoice':_0x15d853,'date':_0x4d4c17+'-'+_0x5e4e3c+'-'+_0x8de3e9,'customer':_0x4d7529,'reason':_0x594873(0x13f),'amount':_0x3e8f8b}),_0x534914=await _0x34983f[_0x594873(0x194)]();_0x5c90e5['flash'](_0x594873(0x1c2),'payment\x20successfull'),_0x4207c1[_0x594873(0x16f)](_0x594873(0x187));}catch(_0x3cbc93){console[_0x594873(0x1a2)](_0x3cbc93);}}),router['get'](a0_0xab9723(0x157),auth,async(_0x48c09b,_0x59b9f1)=>{var _0x26ebe5=a0_0xab9723;try{const {username:_0x8eb003,email:_0x4ce320,role:_0x22cf56}=_0x48c09b[_0x26ebe5(0x10c)],_0x318b05=_0x48c09b[_0x26ebe5(0x10c)],_0x5d92f1=await profile[_0x26ebe5(0x1ab)]({'email':_0x318b05[_0x26ebe5(0x18b)]}),_0x255d23=await master_shop[_0x26ebe5(0x1d8)]();console[_0x26ebe5(0x1a2)]('master',_0x255d23);const _0x1ecd75=_0x48c09b[_0x26ebe5(0x177)]['id'],_0x38b08d=await sales[_0x26ebe5(0x12b)](_0x1ecd75);console[_0x26ebe5(0x1a2)](_0x38b08d);const _0x126466=await customer[_0x26ebe5(0x1ab)]({'name':_0x38b08d['customer']});console['log'](_0x126466);if(_0x255d23[0x0]['language']==_0x26ebe5(0x1f1)){var _0x1d34bd=users[_0x26ebe5(0x1eb)];console[_0x26ebe5(0x1a2)](_0x1d34bd);}else{if(_0x255d23[0x0][_0x26ebe5(0x1d3)]==_0x26ebe5(0x15b))var _0x1d34bd=users[_0x26ebe5(0x15b)];else{if(_0x255d23[0x0][_0x26ebe5(0x1d3)]==_0x26ebe5(0x1bf))var _0x1d34bd=users[_0x26ebe5(0x1bf)];else{if(_0x255d23[0x0][_0x26ebe5(0x1d3)]==_0x26ebe5(0x17f))var _0x1d34bd=users[_0x26ebe5(0x17f)];else{if(_0x255d23[0x0][_0x26ebe5(0x1d3)]==_0x26ebe5(0x1a8))var _0x1d34bd=users['French'];else{if(_0x255d23[0x0][_0x26ebe5(0x1d3)]==_0x26ebe5(0xf2))var _0x1d34bd=users['Portuguese'];else{if(_0x255d23[0x0][_0x26ebe5(0x1d3)]==_0x26ebe5(0x189))var _0x1d34bd=users[_0x26ebe5(0x189)];else{if(_0x255d23[0x0]['language']==_0x26ebe5(0xf3))var _0x1d34bd=users[_0x26ebe5(0x1cd)];}}}}}}}_0x59b9f1[_0x26ebe5(0x12a)](_0x26ebe5(0x176),{'success':_0x48c09b[_0x26ebe5(0x1e8)](_0x26ebe5(0x1c2)),'errors':_0x48c09b['flash']('errors'),'role':_0x318b05,'profile':_0x5d92f1,'master_shop':_0x255d23,'customers':_0x126466,'sales':_0x38b08d,'language':_0x1d34bd});}catch(_0xff2934){console[_0x26ebe5(0x1a2)](_0xff2934);}}),router[a0_0xab9723(0x14b)](a0_0xab9723(0x1f4),auth,async(_0x1c37b7,_0x36b3d6)=>{var _0x33657a=a0_0xab9723;try{const {username:_0x2b1156,email:_0x33d279,role:_0x2d3f60}=_0x1c37b7[_0x33657a(0x10c)],_0xb125ec=_0x1c37b7[_0x33657a(0x10c)],_0x388c19=await profile[_0x33657a(0x1ab)]({'email':_0xb125ec[_0x33657a(0x18b)]}),_0x49bd75=await master_shop[_0x33657a(0x1d8)](),_0x2a2218=_0x1c37b7[_0x33657a(0x177)]['id'],_0x1a3ef3=await sales_finished[_0x33657a(0x12b)](_0x2a2218),_0x10b9ea=await warehouse[_0x33657a(0x1f5)]([{'$match':{'name':_0x1a3ef3[_0x33657a(0x1a3)]}},{'$unwind':_0x33657a(0x160)},{'$group':{'_id':_0x33657a(0x1df),'name':{'$first':_0x33657a(0x19f)},'product_stock':{'$first':_0x33657a(0x17c)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x33657a(0x198)},'pallet':{'$first':'$product_details.pallet'},'primary_code':{'$first':_0x33657a(0x1c6)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x33657a(0x10e)},'storage':{'$first':_0x33657a(0x165)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x33657a(0x1cf)},'unit':{'$first':_0x33657a(0x108)},'secondary_unit':{'$first':_0x33657a(0x1e6)},'maxProducts':{'$first':_0x33657a(0x171)},'batch_code':{'$first':_0x33657a(0x130)},'maxPerUnit':{'$first':_0x33657a(0x11d)},'room':{'$first':_0x33657a(0x142)}}}]),_0x34cc7f=await product[_0x33657a(0x1d8)]({}),_0x419628=await warehouse[_0x33657a(0x1f5)]([{'$match':{'status':'Enabled','name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':'$name','name':{'$first':'$name'}}},{'$sort':{'name':0x1}}]),_0x41dc6e=await warehouse[_0x33657a(0x1f5)]([{'$match':{'status':_0x33657a(0x183),'name':_0x33657a(0x1ca)}},{'$group':{'_id':_0x33657a(0x1f6),'name':{'$first':_0x33657a(0x1f6)}}},{'$sort':{'name':0x1}}]);if(_0x49bd75[0x0][_0x33657a(0x1d3)]=='English\x20(US)'){var _0x489c60=users[_0x33657a(0x1eb)];console['log'](_0x489c60);}else{if(_0x49bd75[0x0][_0x33657a(0x1d3)]==_0x33657a(0x15b))var _0x489c60=users[_0x33657a(0x15b)];else{if(_0x49bd75[0x0][_0x33657a(0x1d3)]==_0x33657a(0x1bf))var _0x489c60=users[_0x33657a(0x1bf)];else{if(_0x49bd75[0x0][_0x33657a(0x1d3)]=='Spanish')var _0x489c60=users[_0x33657a(0x17f)];else{if(_0x49bd75[0x0][_0x33657a(0x1d3)]==_0x33657a(0x1a8))var _0x489c60=users[_0x33657a(0x1a8)];else{if(_0x49bd75[0x0]['language']==_0x33657a(0xf2))var _0x489c60=users[_0x33657a(0x1a1)];else{if(_0x49bd75[0x0][_0x33657a(0x1d3)]=='Chinese')var _0x489c60=users['Chinese'];else{if(_0x49bd75[0x0][_0x33657a(0x1d3)]==_0x33657a(0xf3))var _0x489c60=users[_0x33657a(0x1cd)];}}}}}}}_0x36b3d6[_0x33657a(0x12a)](_0x33657a(0x110),{'success':_0x1c37b7[_0x33657a(0x1e8)]('success'),'errors':_0x1c37b7[_0x33657a(0x1e8)](_0x33657a(0x1f3)),'role':_0xb125ec,'profile':_0x388c19,'user':_0x1a3ef3,'stock':_0x10b9ea,'master_shop':_0x49bd75,'unit':_0x34cc7f,'language':_0x489c60,'warehouses':_0x419628,'warehouse_QA':_0x41dc6e});}catch(_0x18f25b){console['log'](_0x18f25b),_0x36b3d6['status'](0xc8)[_0x33657a(0x16a)]({'message':_0x18f25b[_0x33657a(0x18e)]});}}),router['post'](a0_0xab9723(0x1f4),auth,async(_0x259fb1,_0x4528d2)=>{var _0x9f44d7=a0_0xab9723;if(_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x195)]=='QA')try{const {invoice:_0x23166c,date:_0x4a8401,warehouse_name:_0x2f2b1d,product_name:_0x392d60,primary_code:_0x5b461e,secondary_code:_0x4aa780,product_code:_0x2c273e,sales_quantity:_0x4f9ef8,stocks:_0x51a9ea,return_qty:_0xe1d693,Room_name:_0x1a7269,to_warehouse_name_QA:_0x49a6ed,to_Room_name_QA:_0x36ad02,note:_0xb4791,for_categorize:_0x4906cd,product_name_QA1:_0x3b8ec5}=_0x259fb1['body'];if(typeof _0x3b8ec5=='string')var _0x54ed50=[_0x259fb1[_0x9f44d7(0x104)]['product_name_QA1']],_0x301b7e=[_0x259fb1['body'][_0x9f44d7(0x170)]],_0x5a09ca=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x19c)]],_0x26f5de=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x1d1)]],_0x7c4335=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x15a)]],_0x272f8d=[_0x259fb1['body'][_0x9f44d7(0x14c)]],_0x11a2e5=[_0x259fb1[_0x9f44d7(0x104)]['maxPerUnit_QA']],_0x39d8bd=[_0x259fb1['body'][_0x9f44d7(0x19b)]],_0x375593=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x11e)]],_0x53b945=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x111)]],_0x16779b=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x119)]],_0x2f5053=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x15d)]],_0x3de003=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0xfa)]],_0x24e384=[_0x259fb1[_0x9f44d7(0x104)]['room_QA']],_0x398a72=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x13e)]],_0x3974bc=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x139)]];else var _0x54ed50=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x1cb)]],_0x301b7e=[..._0x259fb1['body']['primary_code_QA']],_0x5a09ca=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x19c)]],_0x26f5de=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x1d1)]],_0x7c4335=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x15a)]],_0x272f8d=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x14c)]],_0x11a2e5=[..._0x259fb1['body'][_0x9f44d7(0x1c4)]],_0x39d8bd=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x19b)]],_0x375593=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x11e)]],_0x53b945=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x111)]],_0x16779b=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x119)]],_0x2f5053=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x15d)]],_0x3de003=[..._0x259fb1['body']['expiry_date_QA']],_0x24e384=[..._0x259fb1[_0x9f44d7(0x104)]['room_QA']],_0x398a72=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x13e)]],_0x3974bc=[..._0x259fb1['body'][_0x9f44d7(0x139)]];const _0x3505fd=_0x54ed50[_0x9f44d7(0x19e)](_0xaa8b3f=>{return _0xaa8b3f={'product_name':_0xaa8b3f};});_0x24e384[_0x9f44d7(0x1c8)]((_0x4c9a6d,_0x365ec1)=>{var _0x210da0=_0x9f44d7;_0x3505fd[_0x365ec1][_0x210da0(0x1be)]=_0x4c9a6d;}),_0x398a72[_0x9f44d7(0x1c8)]((_0x1302cf,_0x3307b2)=>{var _0x56f5b3=_0x9f44d7;_0x3505fd[_0x3307b2][_0x56f5b3(0x13b)]=_0x1302cf;}),_0x3974bc[_0x9f44d7(0x1c8)]((_0x33fc33,_0x23213a)=>{var _0x1d1ccb=_0x9f44d7,_0x26e0e3=_0x33fc33[_0x1d1ccb(0x1e3)](0x1);_0x3505fd[_0x23213a][_0x1d1ccb(0x102)]=_0x33fc33[0x0],_0x3505fd[_0x23213a][_0x1d1ccb(0x10a)]=_0x26e0e3;}),_0x301b7e[_0x9f44d7(0x1c8)]((_0x4c6157,_0x4fb566)=>{_0x3505fd[_0x4fb566]['primary_code']=_0x4c6157;}),_0x5a09ca[_0x9f44d7(0x1c8)]((_0x81274c,_0x4e8099)=>{var _0x3b8655=_0x9f44d7;_0x3505fd[_0x4e8099][_0x3b8655(0x197)]=_0x81274c;}),_0x26f5de['forEach']((_0x3a84b9,_0x425010)=>{var _0x2e1882=_0x9f44d7;_0x3505fd[_0x425010][_0x2e1882(0x163)]=_0x3a84b9;}),_0x7c4335[_0x9f44d7(0x1c8)]((_0x2bfde3,_0x2ec827)=>{var _0x315ebd=_0x9f44d7;_0x3505fd[_0x2ec827][_0x315ebd(0x158)]=_0x2bfde3;}),_0x272f8d[_0x9f44d7(0x1c8)]((_0x1c1b50,_0x1a4e8e)=>{_0x3505fd[_0x1a4e8e]['return_qty']=_0x1c1b50;}),_0x11a2e5['forEach']((_0x256df0,_0x2f7b6b)=>{var _0x3c306d=_0x9f44d7;_0x3505fd[_0x2f7b6b][_0x3c306d(0x172)]=_0x256df0;}),_0x39d8bd['forEach']((_0x136396,_0x3774a1)=>{var _0x2b66a6=_0x9f44d7;_0x3505fd[_0x3774a1][_0x2b66a6(0x18c)]=_0x136396;}),_0x375593['forEach']((_0x3f3bf4,_0x2b9a6e)=>{_0x3505fd[_0x2b9a6e]['batch_code']=_0x3f3bf4;}),_0x53b945['forEach']((_0x3adbae,_0x14549a)=>{var _0x46db55=_0x9f44d7;_0x3505fd[_0x14549a][_0x46db55(0x1a5)]=_0x3adbae;}),_0x16779b['forEach']((_0x50c70b,_0x262c60)=>{var _0x161bd2=_0x9f44d7;_0x3505fd[_0x262c60][_0x161bd2(0x164)]=_0x50c70b;}),_0x2f5053[_0x9f44d7(0x1c8)]((_0x4682b8,_0xcc8c17)=>{var _0x487786=_0x9f44d7;_0x3505fd[_0xcc8c17][_0x487786(0x125)]=_0x4682b8;}),_0x3de003[_0x9f44d7(0x1c8)]((_0x4eee71,_0x35f090)=>{var _0x346df4=_0x9f44d7;_0x3505fd[_0x35f090][_0x346df4(0x1a7)]=_0x4eee71;});const _0x5070f6=await sales_finished[_0x9f44d7(0x1ab)]({'invoice':_0x23166c});_0x5070f6[_0x9f44d7(0x18d)]=_0x9f44d7(0x192);const _0x95c677=await _0x5070f6[_0x9f44d7(0x194)](),_0x327571=new sales_return_finished({'invoice':_0x23166c,'customer':_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0xf0)],'date':_0x4a8401,'warehouse_name':_0x2f2b1d,'room':_0x1a7269,'ToWarehouse':_0x49a6ed,'ToRoom':_0x36ad02,'return_sale_QA':_0x3505fd,'note':_0xb4791,'warehouse_cat':_0x4906cd}),_0x3904db=await _0x327571[_0x9f44d7(0x194)](),_0x10b630=await sales_return_finished['findOne']({'invoice':_0x23166c}),_0x1aaec0=await warehouse['findOne']({'name':_0x49a6ed,'room':_0x36ad02});_0x10b630[_0x9f44d7(0x162)][_0x9f44d7(0x1c8)](_0x5bf971=>{var _0x2beee1=_0x9f44d7,_0x292747=0x0;const _0x2f11c7=_0x1aaec0[_0x2beee1(0x123)][_0x2beee1(0x19e)](_0x5d88f4=>{var _0x382e5b=_0x2beee1;_0x5d88f4['product_name']==_0x5bf971[_0x382e5b(0x13d)]&&_0x5d88f4['isle']==_0x5bf971['isle']&&_0x5d88f4[_0x382e5b(0x13b)]==_0x5bf971[_0x382e5b(0x13b)]&&_0x5d88f4['pallet']==_0x5bf971['pallet']&&_0x5d88f4[_0x382e5b(0x1a7)]==_0x5bf971[_0x382e5b(0x1a7)]&&_0x5d88f4[_0x382e5b(0x125)]==_0x5bf971[_0x382e5b(0x125)]&&_0x5d88f4[_0x382e5b(0x166)]==_0x5bf971['batch_code']&&(_0x5d88f4['product_stock']=parseInt(_0x5d88f4[_0x382e5b(0x174)])+parseInt(_0x5bf971[_0x382e5b(0x1af)]),_0x292747++);});_0x292747=='0'&&(_0x1aaec0[_0x2beee1(0x123)]=_0x1aaec0[_0x2beee1(0x123)]['concat']({'product_name':_0x5bf971[_0x2beee1(0x13d)],'product_stock':_0x5bf971[_0x2beee1(0x1af)],'primary_code':_0x5bf971[_0x2beee1(0xee)],'secondary_code':_0x5bf971[_0x2beee1(0x197)],'product_code':_0x5bf971[_0x2beee1(0x163)],'batch_code':_0x5bf971[_0x2beee1(0x166)],'maxPerUnit':_0x5bf971[_0x2beee1(0x172)],'production_date':_0x5bf971[_0x2beee1(0x125)],'expiry_date':_0x5bf971[_0x2beee1(0x1a7)],'secondary_unit':_0x5bf971[_0x2beee1(0x1a5)],'unit':_0x5bf971[_0x2beee1(0x164)],'maxProducts':_0x5bf971[_0x2beee1(0x18c)],'level':_0x5bf971['level'],'isle':_0x5bf971['isle'],'pallet':_0x5bf971[_0x2beee1(0x10a)]}));}),await _0x1aaec0[_0x9f44d7(0x194)]();const _0x2ef2f1=new c_payment_data({'invoice':_0x23166c,'customer':_0x259fb1[_0x9f44d7(0x104)]['customer'],'reason':_0x9f44d7(0x1ba)});await _0x2ef2f1[_0x9f44d7(0x194)]();const _0x3a0183=await master_shop[_0x9f44d7(0x1d8)](),_0x6ceed2=await email_settings[_0x9f44d7(0x1ab)](),_0x593ddc=await customer[_0x9f44d7(0x1ab)]({'name':_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0xf0)]});_0x3a0183[0x0][_0x9f44d7(0x185)]==0x1?(right_currency=_0x3a0183[0x0]['currency'],left_currency=''):(right_currency='',left_currency=_0x3a0183[0x0]['currency']);var _0x55c05e=_0x54ed50,_0x35417f=_0x272f8d,_0x5862fc='',_0x2e1983;for(_0x2e1983 in _0x55c05e){_0x5862fc+=_0x9f44d7(0x1b9)+_0x9f44d7(0x120)+_0x55c05e[_0x2e1983]+_0x9f44d7(0x1d9)+_0x9f44d7(0x120)+_0x35417f[_0x2e1983]+_0x9f44d7(0x1d9)+_0x9f44d7(0xf6);}console[_0x9f44d7(0x1a2)]('product_list',_0x5862fc);let _0x371921=nodemailer['createTransport']({'service':_0x9f44d7(0x1de),'auth':{'user':_0x6ceed2[_0x9f44d7(0x18b)],'pass':_0x6ceed2[_0x9f44d7(0x18f)]}}),_0xdd8c6c={'from':_0x6ceed2['email'],'to':_0x593ddc[_0x9f44d7(0x18b)],'subject':_0x9f44d7(0x155),'attachments':[{'filename':_0x9f44d7(0xf4),'path':__dirname+_0x9f44d7(0x1f2)+_0x9f44d7(0x1dd)+_0x3a0183[0x0][_0x9f44d7(0x12e)],'cid':_0x9f44d7(0x14d)}],'html':_0x9f44d7(0xe6)+_0x9f44d7(0x11f)+_0x9f44d7(0x1d4)+_0x9f44d7(0x150)+_0x9f44d7(0x186)+_0x9f44d7(0x150)+'<img\x20src=\x22cid:logo\x22\x20class=\x22rounded\x22\x20width=\x2266.5px\x22\x20height=\x2266.5px\x22></img>'+_0x9f44d7(0x14e)+_0x9f44d7(0x150)+_0x9f44d7(0x1d7)+_0x3a0183[0x0][_0x9f44d7(0x1ad)]+_0x9f44d7(0x103)+_0x9f44d7(0x14e)+_0x9f44d7(0x14e)+_0x9f44d7(0xeb)+_0x9f44d7(0x150)+_0x9f44d7(0x1b6)+_0x9f44d7(0x114)+_0x23166c+'\x20'+_0x9f44d7(0x145)+'\x20Order\x20Date\x20:\x20'+_0x4a8401+'\x20'+_0x9f44d7(0x109)+_0x9f44d7(0x173)+_0x9f44d7(0x14e)+'<table\x20style=\x22width:\x20100%\x20!important;\x22>'+_0x9f44d7(0xed)+_0x9f44d7(0x1b9)+_0x9f44d7(0x1f8)+_0x9f44d7(0x1b0)+_0x9f44d7(0x15c)+_0x9f44d7(0x1a6)+_0x9f44d7(0xf6)+_0x9f44d7(0x190)+_0x9f44d7(0xea)+'\x20'+_0x5862fc+'\x20'+'</tbody>'+'</table>'+_0x9f44d7(0x150)+_0x9f44d7(0x1c9)+_0x9f44d7(0x11c)+_0x3a0183[0x0]['site_title']+'</h5>'+_0x9f44d7(0x14e)+_0x9f44d7(0x14e)+_0x9f44d7(0x10f)};_0x371921[_0x9f44d7(0x1ac)](_0xdd8c6c,function(_0x2f8001,_0x40f434){var _0x2bc92d=_0x9f44d7;_0x2f8001?(console[_0x2bc92d(0x1a2)](_0x2f8001),console['log'](_0x2bc92d(0x17b))):console[_0x2bc92d(0x1a2)](_0x2bc92d(0xf7));}),_0x259fb1[_0x9f44d7(0x1e8)]('success',_0x9f44d7(0x12c)),_0x4528d2[_0x9f44d7(0x16f)]('/all_sales_finished/view');}catch(_0x175412){_0x4528d2[_0x9f44d7(0x1f0)](0xc8)[_0x9f44d7(0x16a)]({'message1':_0x175412[_0x9f44d7(0x18e)]});}else{if(_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x195)]=='GS')try{const {invoice:_0x2f1b35,date:_0x42bac8,warehouse_name:_0x27488b,product_name:_0x30636e,primary_code:_0x57b6bc,secondary_code:_0x243fe8,product_code:_0x3572ff,sales_quantity:_0x112d44,stocks:_0x50d085,return_qty:_0x3ad306,Room_name:_0x4508e2,to_warehouse_name:_0x46d5c8,to_Room_name:_0x24f700,note:_0x473276,level:_0x2ffb93,isle:_0x56c0c4,pallet:_0x15726a,for_categorize:_0x5ae3d4}=_0x259fb1[_0x9f44d7(0x104)];if(typeof _0x30636e==_0x9f44d7(0x146))var _0x54ed50=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x13d)]],_0x301b7e=[_0x259fb1['body'][_0x9f44d7(0xee)]],_0x5a09ca=[_0x259fb1[_0x9f44d7(0x104)]['secondary_code']],_0x26f5de=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x163)]],_0x7c4335=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x100)]],_0x272f8d=[_0x259fb1['body']['return_qty']],_0x255bf3=[_0x259fb1['body'][_0x9f44d7(0x138)]],_0x50844d=[_0x259fb1['body'][_0x9f44d7(0x10a)]],_0x11a2e5=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x172)]],_0x39d8bd=[_0x259fb1['body'][_0x9f44d7(0x18c)]],_0x375593=[_0x259fb1['body'][_0x9f44d7(0x166)]],_0x53b945=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x1a5)]],_0x16779b=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x164)]],_0x2f5053=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x125)]],_0x3de003=[_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x1a7)]];else var _0x54ed50=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x13d)]],_0x301b7e=[..._0x259fb1[_0x9f44d7(0x104)]['primary_code']],_0x5a09ca=[..._0x259fb1['body'][_0x9f44d7(0x197)]],_0x26f5de=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x163)]],_0x7c4335=[..._0x259fb1['body']['sales_quantity']],_0x272f8d=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x1af)]],_0x255bf3=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x138)]],_0x11a2e5=[..._0x259fb1['body'][_0x9f44d7(0x172)]],_0x39d8bd=[..._0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0x18c)]],_0x375593=[..._0x259fb1[_0x9f44d7(0x104)]['batch_code']],_0x53b945=[..._0x259fb1['body']['secondary_unit']],_0x16779b=[..._0x259fb1[_0x9f44d7(0x104)]['unit']],_0x2f5053=[..._0x259fb1['body'][_0x9f44d7(0x125)]],_0x3de003=[..._0x259fb1['body']['expiry_date']],_0x50844d=[..._0x259fb1[_0x9f44d7(0x104)]['pallet']];const _0x42bb2a=_0x54ed50[_0x9f44d7(0x19e)](_0x1333b2=>{return _0x1333b2={'product_name':_0x1333b2};});_0x301b7e['forEach']((_0x5aa8d9,_0x6e7efa)=>{var _0x862f1b=_0x9f44d7;_0x42bb2a[_0x6e7efa][_0x862f1b(0xee)]=_0x5aa8d9;}),_0x5a09ca[_0x9f44d7(0x1c8)]((_0x1d3356,_0x3029d4)=>{var _0x4ac2dd=_0x9f44d7;_0x42bb2a[_0x3029d4][_0x4ac2dd(0x197)]=_0x1d3356;}),_0x26f5de[_0x9f44d7(0x1c8)]((_0x554661,_0x3714c9)=>{var _0x4a96ff=_0x9f44d7;_0x42bb2a[_0x3714c9][_0x4a96ff(0x163)]=_0x554661;}),_0x7c4335[_0x9f44d7(0x1c8)]((_0x1b6b93,_0x4049a4)=>{var _0x30c1a1=_0x9f44d7;_0x42bb2a[_0x4049a4][_0x30c1a1(0x158)]=_0x1b6b93;}),_0x272f8d[_0x9f44d7(0x1c8)]((_0x37c61a,_0x3871f0)=>{var _0x2f8773=_0x9f44d7;_0x42bb2a[_0x3871f0][_0x2f8773(0x1af)]=_0x37c61a;}),_0x255bf3[_0x9f44d7(0x1c8)]((_0x513271,_0x2048aa)=>{_0x42bb2a[_0x2048aa]['level']=_0x513271;}),_0x50844d[_0x9f44d7(0x1c8)]((_0x1e0cee,_0x23159b)=>{var _0x1ea267=_0x9f44d7,_0x43e892=_0x1e0cee[_0x1ea267(0x1e3)](0x1);_0x42bb2a[_0x23159b][_0x1ea267(0x102)]=_0x1e0cee[0x0],_0x42bb2a[_0x23159b][_0x1ea267(0x10a)]=_0x43e892;}),_0x11a2e5['forEach']((_0x2dff5e,_0x91429e)=>{var _0x5790c8=_0x9f44d7;_0x42bb2a[_0x91429e][_0x5790c8(0x172)]=_0x2dff5e;}),_0x39d8bd[_0x9f44d7(0x1c8)]((_0x569e56,_0x105039)=>{var _0x37d352=_0x9f44d7;_0x42bb2a[_0x105039][_0x37d352(0x18c)]=_0x569e56;}),_0x375593[_0x9f44d7(0x1c8)]((_0x434f8d,_0x257595)=>{var _0x2bd849=_0x9f44d7;_0x42bb2a[_0x257595][_0x2bd849(0x166)]=_0x434f8d;}),_0x53b945[_0x9f44d7(0x1c8)]((_0x30c75c,_0x37f30e)=>{var _0x397974=_0x9f44d7;_0x42bb2a[_0x37f30e][_0x397974(0x1a5)]=_0x30c75c;}),_0x16779b[_0x9f44d7(0x1c8)]((_0x10f5aa,_0x4fad7c)=>{var _0x483e2d=_0x9f44d7;_0x42bb2a[_0x4fad7c][_0x483e2d(0x164)]=_0x10f5aa;}),_0x2f5053[_0x9f44d7(0x1c8)]((_0xeaa80d,_0x257899)=>{var _0x2e9ed0=_0x9f44d7;_0x42bb2a[_0x257899][_0x2e9ed0(0x125)]=_0xeaa80d;}),_0x3de003['forEach']((_0x53412c,_0x10741a)=>{var _0x1cc447=_0x9f44d7;_0x42bb2a[_0x10741a][_0x1cc447(0x1a7)]=_0x53412c;});var _0xc6aff4=0x0;_0x42bb2a[_0x9f44d7(0x1c8)](_0x8a7232=>{var _0x777c4=_0x9f44d7;console['log'](_0x777c4(0x105),_0x8a7232),(parseInt(_0x8a7232[_0x777c4(0x158)])<parseInt(_0x8a7232[_0x777c4(0x1af)])||parseInt(_0x8a7232[_0x777c4(0x11b)])<parseInt(_0x8a7232[_0x777c4(0x1af)])&&parseInt(_0x8a7232['sale_qty'])>parseInt(_0x8a7232['return_qty'])||parseInt(_0x8a7232[_0x777c4(0x1af)])==0x0)&&_0xc6aff4++;});if(_0xc6aff4!=0x0)return _0x259fb1[_0x9f44d7(0x1e8)](_0x9f44d7(0x1f3),'Must\x20not\x20be\x20greater\x20than\x20sale\x20Qty'),_0x4528d2[_0x9f44d7(0x16f)](_0x9f44d7(0x153));const _0x491e9d=await sales_finished['findOne']({'invoice':_0x2f1b35});_0x491e9d[_0x9f44d7(0x18d)]=_0x9f44d7(0x192);const _0x3cf0c6=await _0x491e9d[_0x9f44d7(0x194)](),_0x5dca88=new sales_return_finished({'invoice':_0x2f1b35,'customer':_0x259fb1[_0x9f44d7(0x104)][_0x9f44d7(0xf0)],'date':_0x42bac8,'warehouse_name':_0x27488b,'room':_0x4508e2,'ToWarehouse':_0x46d5c8,'ToRoom':_0x24f700,'return_sale':_0x42bb2a,'note':_0x473276,'warehouse_cat':_0x5ae3d4}),_0x45f4d0=await _0x5dca88[_0x9f44d7(0x194)](),_0x1f2b2c=await sales_return_finished[_0x9f44d7(0x1ab)]({'invoice':_0x2f1b35}),_0x29b194=await warehouse[_0x9f44d7(0x1ab)]({'name':_0x46d5c8,'room':_0x24f700});_0x1f2b2c[_0x9f44d7(0x151)]['forEach'](_0x1941f1=>{var _0x2b8b7d=_0x9f44d7,_0x446b4a=0x0;const _0xa6d706=_0x29b194[_0x2b8b7d(0x123)]['map'](_0x59d6ae=>{var _0x51e51f=_0x2b8b7d;_0x59d6ae[_0x51e51f(0x13d)]==_0x1941f1[_0x51e51f(0x13d)]&&_0x59d6ae['level']==_0x1941f1[_0x51e51f(0x13b)]&&_0x59d6ae[_0x51e51f(0x102)]==_0x1941f1[_0x51e51f(0x102)]&&_0x59d6ae[_0x51e51f(0x10a)]==_0x1941f1[_0x51e51f(0x10a)]&&_0x59d6ae[_0x51e51f(0x1a7)]==_0x1941f1[_0x51e51f(0x1a7)]&&_0x59d6ae[_0x51e51f(0x125)]==_0x1941f1['production_date']&&_0x59d6ae[_0x51e51f(0x166)]==_0x1941f1[_0x51e51f(0x166)]&&(_0x59d6ae[_0x51e51f(0x174)]=parseInt(_0x59d6ae[_0x51e51f(0x174)])+parseInt(_0x1941f1[_0x51e51f(0x1af)]),_0x446b4a++);});_0x446b4a=='0'&&(_0x29b194[_0x2b8b7d(0x123)]=_0x29b194[_0x2b8b7d(0x123)]['concat']({'product_name':_0x1941f1[_0x2b8b7d(0x13d)],'product_stock':_0x1941f1['return_qty'],'primary_code':_0x1941f1[_0x2b8b7d(0xee)],'secondary_code':_0x1941f1[_0x2b8b7d(0x197)],'product_code':_0x1941f1['product_code'],'level':_0x1941f1['level'],'isle':_0x1941f1[_0x2b8b7d(0x102)],'pallet':_0x1941f1['pallet'],'batch_code':_0x1941f1['batch_code'],'maxPerUnit':_0x1941f1[_0x2b8b7d(0x172)],'production_date':_0x1941f1['production_date'],'expiry_date':_0x1941f1[_0x2b8b7d(0x1a7)],'secondary_unit':_0x1941f1['secondary_unit'],'unit':_0x1941f1[_0x2b8b7d(0x164)],'maxProducts':_0x1941f1['maxProducts']}));}),await _0x29b194[_0x9f44d7(0x194)]();const _0x52dfcb=await master_shop[_0x9f44d7(0x1d8)]();console['log']('add\x20post',_0x52dfcb[0x0]['image']);const _0x42da06=await email_settings[_0x9f44d7(0x1ab)]();_0x259fb1[_0x9f44d7(0x1e8)](_0x9f44d7(0x1c2),_0x9f44d7(0x12c)),_0x4528d2[_0x9f44d7(0x16f)](_0x9f44d7(0x154));}catch(_0x435eb7){console[_0x9f44d7(0x1a2)](_0x435eb7),_0x4528d2['status'](0xc8)[_0x9f44d7(0x16a)]({'message1':_0x435eb7[_0x9f44d7(0x18e)]});}}}),router['get'](a0_0xab9723(0x15f),auth,async(_0x50b0f2,_0x1e50de)=>{var _0x3d88d3=a0_0xab9723;try{const {username:_0x42628d,email:_0x6d990d,role:_0xbc78da}=_0x50b0f2[_0x3d88d3(0x10c)],_0x1f570c=_0x50b0f2['user'],_0x46bb43=await profile[_0x3d88d3(0x1ab)]({'email':_0x1f570c['email']}),_0x45760b=await master_shop[_0x3d88d3(0x1d8)]();console[_0x3d88d3(0x1a2)](_0x3d88d3(0x16d),_0x45760b);const _0x5c1c2b=_0x50b0f2[_0x3d88d3(0x177)]['id'],_0x307e2f=await sales['findById'](_0x5c1c2b);console[_0x3d88d3(0x1a2)](_0x3d88d3(0x1c5),_0x307e2f);if(_0x45760b[0x0][_0x3d88d3(0x1d3)]==_0x3d88d3(0x1f1))var _0x58d499=users[_0x3d88d3(0x1eb)];else{if(_0x45760b[0x0][_0x3d88d3(0x1d3)]==_0x3d88d3(0x15b))var _0x58d499=users[_0x3d88d3(0x15b)];else{if(_0x45760b[0x0][_0x3d88d3(0x1d3)]==_0x3d88d3(0x1bf))var _0x58d499=users[_0x3d88d3(0x1bf)];else{if(_0x45760b[0x0][_0x3d88d3(0x1d3)]==_0x3d88d3(0x17f))var _0x58d499=users[_0x3d88d3(0x17f)];else{if(_0x45760b[0x0]['language']==_0x3d88d3(0x1a8))var _0x58d499=users['French'];else{if(_0x45760b[0x0][_0x3d88d3(0x1d3)]=='Portuguese\x20(BR)')var _0x58d499=users[_0x3d88d3(0x1a1)];else{if(_0x45760b[0x0]['language']=='Chinese')var _0x58d499=users[_0x3d88d3(0x189)];else{if(_0x45760b[0x0]['language']==_0x3d88d3(0xf3))var _0x58d499=users[_0x3d88d3(0x1cd)];}}}}}}}_0x1e50de['render'](_0x3d88d3(0x1bc),{'success':_0x50b0f2[_0x3d88d3(0x1e8)](_0x3d88d3(0x1c2)),'errors':_0x50b0f2[_0x3d88d3(0x1e8)]('errors'),'role':_0x1f570c,'profile':_0x46bb43,'alldata':_0x307e2f,'master_shop':_0x45760b,'language':_0x58d499});}catch(_0x512908){console[_0x3d88d3(0x1a2)](_0x512908);}}),router[a0_0xab9723(0x10b)](a0_0xab9723(0x12f),async(_0x202f05,_0x14a183)=>{var _0x1836dd=a0_0xab9723;const {product_code:_0x5a3f66,warehouse_name:_0x33d02d,rooms_data:_0x21cfa5,Roomslist:_0x1ed576}=_0x202f05['body'],_0x4ddae9=_0x1ed576['split'](','),_0x345aca=[];async function _0x599953(_0x258c17){var _0x3430a8=a0_0x42a4;const _0x151285=await warehouse[_0x3430a8(0x1f5)]([{'$match':{'name':_0x33d02d,'room':_0x258c17}},{'$unwind':'$product_details'},{'$match':{'product_details.primary_code':_0x5a3f66}},{'$group':{'_id':_0x3430a8(0x1df),'name':{'$first':_0x3430a8(0x19f)},'product_stock':{'$first':_0x3430a8(0x17c)},'primary_code':{'$first':'$product_details.primary_code'},'secondary_code':{'$first':_0x3430a8(0x133)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3430a8(0x199)},'isle':{'$first':'$product_details.isle'},'pallet':{'$first':'$product_details.pallet'},'unit':{'$first':_0x3430a8(0x108)},'secondary_unit':{'$first':_0x3430a8(0x1e6)},'storage':{'$first':_0x3430a8(0x165)},'rack':{'$first':_0x3430a8(0x126)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':'$product_details.production_date'},'maxPerUnit':{'$first':_0x3430a8(0x11d)},'batch_code':{'$first':_0x3430a8(0x130)},'product_cat':{'$first':_0x3430a8(0x124)},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3430a8(0x142)},'CBM':{'$first':{'$toDouble':_0x3430a8(0x1b1)}},'invoice':{'$first':_0x3430a8(0x121)}}}]),_0x10106e=await warehouse['aggregate']([{'$match':{'name':_0x33d02d,'room':_0x258c17}},{'$unwind':'$product_details'},{'$match':{'product_details.secondary_code':_0x5a3f66}},{'$group':{'_id':_0x3430a8(0x1df),'name':{'$first':_0x3430a8(0x19f)},'product_stock':{'$first':_0x3430a8(0x17c)},'primary_code':{'$first':_0x3430a8(0x1c6)},'secondary_code':{'$first':_0x3430a8(0x133)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x3430a8(0x198)},'pallet':{'$first':'$product_details.pallet'},'unit':{'$first':'$product_details.unit'},'secondary_unit':{'$first':_0x3430a8(0x1e6)},'storage':{'$first':_0x3430a8(0x165)},'rack':{'$first':_0x3430a8(0x126)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3430a8(0x1cf)},'maxPerUnit':{'$first':_0x3430a8(0x11d)},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3430a8(0x142)},'CBM':{'$first':{'$toDouble':_0x3430a8(0x1b1)}},'invoice':{'$first':_0x3430a8(0x121)}}}]);if(_0x151285[_0x3430a8(0xfb)]>0x0)_0x345aca[_0x3430a8(0x112)](_0x151285);else _0x10106e[_0x3430a8(0xfb)]>0x0&&_0x345aca[_0x3430a8(0x112)](_0x10106e);}const _0x30c82d=_0x4ddae9[_0x1836dd(0x19e)](_0x5e12b1=>_0x599953(_0x5e12b1));await Promise[_0x1836dd(0x137)](_0x30c82d),_0x14a183[_0x1836dd(0x16a)](_0x345aca);}),module[a0_0xab9723(0x128)]=router;