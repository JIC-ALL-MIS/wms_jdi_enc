const a0_0xcd99a5=a0_0x5aee;function a0_0x2dd5(){const _0x2bb499=['body','$room','$product_details.isle','/Rooms_data2','6nVTIsk','express','Hindi','$product_details','errors','json','DRY\x20STORAGE','warehousemap_incoming','52794WIWLZS','$_id.product_code','../middleware/auth','$product_details.expiry_date','$_id','3125292MmasNL','1463ASzViY','find','status','role','raw','../models/all_models','Portuguese\x20(BR)','Rack\x20A','language','multer','7wyUiHh','German','$product_details.product_stock','$expiry_date','Raw\x20Materials','flash','user','25128MoEgtD','Return\x20Goods','timezone','en-US','post','18nQfnnU','warehouse','email','$_id.bay','988228nsZkMD','/view','$count','$product_details.bay','All','message','$production_date','Spanish','$product_details.pallet','Enabled','aggregate','French','QA\x20Warehouse','$_id.isle','1333240CAIXlg','$_id.pallet','1239200EiupHJ','$product_details.product_name','$products','findOne','Chinese','pack','Portuguese','$name','../public/language/languages.json','log','74427oskwYF','Finished\x20Goods','$product_details.batch_code','Arabic','570gJiAtp','product','English\x20(US)','$product_details.product_code'];a0_0x2dd5=function(){return _0x2bb499;};return a0_0x2dd5();}(function(_0x1ff7f1,_0x1a8521){const _0x538cac=a0_0x5aee,_0xe350ca=_0x1ff7f1();while(!![]){try{const _0x10f712=-parseInt(_0x538cac(0x171))/0x1*(-parseInt(_0x538cac(0x153))/0x2)+parseInt(_0x538cac(0x17d))/0x3*(-parseInt(_0x538cac(0x157))/0x4)+-parseInt(_0x538cac(0x167))/0x5+parseInt(_0x538cac(0x13c))/0x6+-parseInt(_0x538cac(0x147))/0x7*(parseInt(_0x538cac(0x165))/0x8)+-parseInt(_0x538cac(0x137))/0x9*(-parseInt(_0x538cac(0x175))/0xa)+-parseInt(_0x538cac(0x13d))/0xb*(parseInt(_0x538cac(0x14e))/0xc);if(_0x10f712===_0x1a8521)break;else _0xe350ca['push'](_0xe350ca['shift']());}catch(_0x552983){_0xe350ca['push'](_0xe350ca['shift']());}}}(a0_0x2dd5,0x52838));const express=require(a0_0xcd99a5(0x130)),app=express(),router=express['Router'](),multer=require(a0_0xcd99a5(0x146)),{profile,master_shop,email_settings,warehouse,purchases,staff}=require(a0_0xcd99a5(0x142)),auth=require(a0_0xcd99a5(0x139));var timezones=require('timezones-list');const users=require(a0_0xcd99a5(0x16f));function a0_0x5aee(_0x45605e,_0x40d486){const _0x2dd5a5=a0_0x2dd5();return a0_0x5aee=function(_0x5aeefb,_0x5aab29){_0x5aeefb=_0x5aeefb-0x130;let _0x3480e1=_0x2dd5a5[_0x5aeefb];return _0x3480e1;},a0_0x5aee(_0x45605e,_0x40d486);}router['get'](a0_0xcd99a5(0x158),auth,async(_0x440d81,_0x16239e)=>{const _0x2648e6=a0_0xcd99a5;try{const {username:_0x587bee,email:_0x2721dc,role:_0x4e7865}=_0x440d81[_0x2648e6(0x14d)],_0x555d5d=_0x440d81[_0x2648e6(0x14d)],_0x40138d=await profile[_0x2648e6(0x16a)]({'email':_0x555d5d['email']}),_0x271e5d=await master_shop[_0x2648e6(0x13e)]();let _0x14fbb5;if(_0x555d5d[_0x2648e6(0x140)]=='staff'){const _0xbb6807=await staff[_0x2648e6(0x16a)]({'email':_0x555d5d[_0x2648e6(0x155)]});_0x14fbb5=await warehouse['aggregate']([{'$match':{'status':'Enabled','name':_0xbb6807[_0x2648e6(0x154)]}},{'$group':{'_id':_0x2648e6(0x16e),'name':{'$first':_0x2648e6(0x16e)}}}]);}else _0x14fbb5=await warehouse[_0x2648e6(0x161)]([{'$match':{'status':_0x2648e6(0x160)}},{'$group':{'_id':_0x2648e6(0x16e),'name':{'$first':_0x2648e6(0x16e)}}},{'$sort':{'name':0x1}}]);const _0x1a0cb7=new Date()['toLocaleString'](_0x2648e6(0x151),{'timeZone':_0x271e5d[0x0][_0x2648e6(0x150)]});console[_0x2648e6(0x170)](_0x2648e6(0x150),_0x1a0cb7);if(_0x271e5d[0x0]['language']==_0x2648e6(0x177)){var _0x479a7d=users['English'];console[_0x2648e6(0x170)](_0x479a7d);}else{if(_0x271e5d[0x0]['language']=='Hindi')var _0x479a7d=users[_0x2648e6(0x131)];else{if(_0x271e5d[0x0][_0x2648e6(0x145)]==_0x2648e6(0x148))var _0x479a7d=users[_0x2648e6(0x148)];else{if(_0x271e5d[0x0][_0x2648e6(0x145)]==_0x2648e6(0x15e))var _0x479a7d=users[_0x2648e6(0x15e)];else{if(_0x271e5d[0x0][_0x2648e6(0x145)]==_0x2648e6(0x162))var _0x479a7d=users['French'];else{if(_0x271e5d[0x0]['language']==_0x2648e6(0x143))var _0x479a7d=users[_0x2648e6(0x16d)];else{if(_0x271e5d[0x0][_0x2648e6(0x145)]==_0x2648e6(0x16b))var _0x479a7d=users[_0x2648e6(0x16b)];else{if(_0x271e5d[0x0][_0x2648e6(0x145)]=='Arabic\x20(ae)')var _0x479a7d=users[_0x2648e6(0x174)];}}}}}}}_0x16239e['render'](_0x2648e6(0x136),{'success':_0x440d81[_0x2648e6(0x14c)]('success'),'errors':_0x440d81[_0x2648e6(0x14c)](_0x2648e6(0x133)),'role':_0x555d5d,'profile':_0x40138d,'master_shop':_0x271e5d,'timezones':timezones,'language':_0x479a7d,'warehouse':_0x14fbb5});}catch(_0x5d5446){console['log'](_0x5d5446),_0x16239e['status'](0xc8)['json']({'message':_0x5d5446['message']});}}),router[a0_0xcd99a5(0x152)]('/MapData',async(_0x27af8e,_0x43bd9c)=>{const _0x39c33b=a0_0xcd99a5,{warehouseNew:_0x10ca3e,level:_0x561caf,rooms:_0x4dfab3}=_0x27af8e[_0x39c33b(0x179)],_0x12ec60=await warehouse[_0x39c33b(0x161)]([{'$unwind':_0x39c33b(0x132)},{'$match':{'name':_0x10ca3e,'product_details.level':parseInt(_0x561caf),'room':_0x4dfab3}},{'$group':{'_id':{'isle':_0x39c33b(0x17b),'pallet':_0x39c33b(0x15f),'product_code':_0x39c33b(0x178),'product_name':'$product_details.product_name'},'products':{'$push':{'product_name':_0x39c33b(0x168),'product_quantity':_0x39c33b(0x149),'product_code':_0x39c33b(0x178)}},'totalQuantity':{'$sum':{'$cond':{'if':{'$gt':[_0x39c33b(0x149),0x0]},'then':_0x39c33b(0x149),'else':0x0}}}}},{'$project':{'_id':0x0,'isle':_0x39c33b(0x164),'pallet':_0x39c33b(0x166),'product_code':_0x39c33b(0x138),'products':{'$filter':{'input':_0x39c33b(0x169),'as':_0x39c33b(0x176),'cond':{'$gt':['$$product.product_quantity',0x0]}}},'totalQuantity':0x1}}]);_0x43bd9c[_0x39c33b(0x134)](_0x12ec60);}),router['post']('/MapData2',async(_0x517ab8,_0x23d7f9)=>{const _0x29500b=a0_0xcd99a5,{warehouseNew:_0x103881,rooms:_0x36e3af,room_cat:_0x34f481}=_0x517ab8[_0x29500b(0x179)];let _0x3c3897;if(_0x34f481==_0x29500b(0x15b))_0x3c3897=await warehouse[_0x29500b(0x161)]([{'$unwind':_0x29500b(0x132)},{'$match':{'name':_0x103881}},{'$group':{'_id':{'bay':_0x29500b(0x15a),'product':_0x29500b(0x168),'expiry':_0x29500b(0x13a)},'count':{'$sum':_0x29500b(0x149)},'production_date':{'$first':'$product_details.production_date'},'expiry_date':{'$first':_0x29500b(0x13a)},'batch_code':{'$first':_0x29500b(0x173)}}},{'$group':{'_id':_0x29500b(0x156),'products':{'$push':{'product':'$_id.product','quantity':'$count','production_date':_0x29500b(0x15d),'expiry_date':_0x29500b(0x14a),'batch_code':'$batch_code'}},'totalQuantity':{'$sum':_0x29500b(0x159)}}},{'$match':{'totalQuantity':{'$gt':0x0}}},{'$project':{'_id':0x0,'bay':_0x29500b(0x13b),'products':0x1,'totalQuantity':0x1}}]),console[_0x29500b(0x170)](_0x34f481);else{}_0x23d7f9[_0x29500b(0x134)](_0x3c3897);}),router[a0_0xcd99a5(0x152)]('/Rooms_data',async(_0x5a4661,_0x1467b0)=>{const _0x455b49=a0_0xcd99a5;try{const {warehouse_name:_0x50d17b,A:_0x5a8f50,B:_0x4414b9}=_0x5a4661['body'];var _0x3fe3de='';_0x5a8f50==_0x455b49(0x141)?_0x4414b9==_0x455b49(0x16c)?_0x3fe3de=[{'$match':{'name':_0x50d17b,'status':_0x455b49(0x160),'room':_0x455b49(0x144)}},{'$group':{'_id':_0x455b49(0x13b),'room_name':{'$first':_0x455b49(0x17a)}}},{'$sort':{'room_name':0x1}}]:_0x3fe3de=[{'$match':{'name':_0x50d17b,'status':_0x455b49(0x160)}},{'$group':{'_id':_0x455b49(0x13b),'room_name':{'$first':_0x455b49(0x17a)}}},{'$sort':{'room_name':0x1}}]:_0x3fe3de=[{'$match':{'name':_0x50d17b,'status':'Enabled'}},{'$group':{'_id':_0x455b49(0x13b),'room_name':{'$first':_0x455b49(0x17a)}}},{'$sort':{'room_name':0x1}}];const _0x325ff9=await warehouse['aggregate'](_0x3fe3de);_0x1467b0[_0x455b49(0x13f)](0xc8)[_0x455b49(0x134)](_0x325ff9);}catch(_0x21b0d8){_0x1467b0[_0x455b49(0x13f)](0x190)[_0x455b49(0x134)]({'errorMessage':_0x21b0d8[_0x455b49(0x15c)]});}}),router[a0_0xcd99a5(0x152)](a0_0xcd99a5(0x17c),async(_0xee07ee,_0x1ee7df)=>{const _0x438d94=a0_0xcd99a5;try{const {warehouse_name:_0x1a4b2b,cat:_0x255f23,valNew:_0x4cc9a2}=_0xee07ee['body'];var _0xb40023='',_0x338192='';if(_0x255f23==_0x438d94(0x14b))_0xb40023=_0x438d94(0x14f),_0x4cc9a2=='pack'?_0x338192=[{'$match':{'status':_0x438d94(0x160),'warehouse_category':_0x255f23,'name':{'$ne':_0xb40023},'name':_0x438d94(0x135)}},{'$group':{'_id':_0x438d94(0x16e),'room_name':{'$first':_0x438d94(0x16e)}}},{'$sort':{'room_name':0x1}}]:_0x338192=[{'$match':{'status':'Enabled','warehouse_category':_0x255f23,'name':{'$ne':_0xb40023}}},{'$group':{'_id':'$name','room_name':{'$first':_0x438d94(0x16e)}}},{'$sort':{'room_name':0x1}}];else _0x255f23==_0x438d94(0x172)?(_0xb40023=_0x438d94(0x163),_0x338192=[{'$match':{'status':_0x438d94(0x160),'warehouse_category':_0x255f23,'name':{'$ne':_0xb40023}}},{'$group':{'_id':_0x438d94(0x16e),'room_name':{'$first':_0x438d94(0x16e)}}},{'$sort':{'room_name':0x1}}]):_0x338192=[{'$match':{'status':_0x438d94(0x160)}},{'$group':{'_id':_0x438d94(0x16e),'room_name':{'$first':_0x438d94(0x16e)}}},{'$sort':{'room_name':0x1}}];const _0x338a63=await warehouse[_0x438d94(0x161)](_0x338192);_0x1ee7df[_0x438d94(0x13f)](0xc8)['json'](_0x338a63);}catch(_0x4078dd){_0x1ee7df[_0x438d94(0x13f)](0x190)[_0x438d94(0x134)]({'errorMessage':_0x4078dd[_0x438d94(0x15c)]}),console[_0x438d94(0x170)](_0x4078dd);}}),router[a0_0xcd99a5(0x152)]('/Rooms_data3',async(_0x3c0f35,_0x382438)=>{const _0xf50067=a0_0xcd99a5;try{const {warehouse_name:_0x393e9b,cat:_0x2b6728}=_0x3c0f35[_0xf50067(0x179)],_0x7037c2=await warehouse[_0xf50067(0x161)]([{'$match':{'status':_0xf50067(0x160),'warehouse_category':_0x2b6728,'name':_0x393e9b}},{'$group':{'_id':_0xf50067(0x17a),'room_name':{'$first':_0xf50067(0x17a)}}},{'$sort':{'room_name':0x1}}]);_0x382438[_0xf50067(0x13f)](0xc8)[_0xf50067(0x134)](_0x7037c2);}catch(_0x25b2a5){_0x382438[_0xf50067(0x13f)](0x190)[_0xf50067(0x134)]({'errorMessage':_0x25b2a5['message']});}}),router[a0_0xcd99a5(0x152)]('/Rooms_dataStock',async(_0x2f8237,_0x54c033)=>{const _0x30560d=a0_0xcd99a5;try{const {warehouse_name:_0x383449,A:_0x35fed6,B:_0x1ca97c}=_0x2f8237[_0x30560d(0x179)];var _0x63681e='';_0x383449==_0x30560d(0x15b)?_0x63681e=[{'$match':{'status':'Enabled'}},{'$group':{'_id':'$room','room_name':{'$first':_0x30560d(0x17a)}}},{'$sort':{'room_name':0x1}}]:_0x63681e=[{'$match':{'name':_0x383449,'status':_0x30560d(0x160)}},{'$group':{'_id':_0x30560d(0x13b),'room_name':{'$first':'$room'}}},{'$sort':{'room_name':0x1}}];const _0x3c948d=await warehouse[_0x30560d(0x161)](_0x63681e);_0x54c033[_0x30560d(0x13f)](0xc8)[_0x30560d(0x134)](_0x3c948d);}catch(_0x3d2f35){_0x54c033[_0x30560d(0x13f)](0x190)[_0x30560d(0x134)]({'errorMessage':_0x3d2f35[_0x30560d(0x15c)]});}}),module['exports']=router;