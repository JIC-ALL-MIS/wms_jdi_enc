var a0_0x4fdf55=a0_0x3f68;(function(_0x5425a6,_0x12139f){var _0x4d2129=a0_0x3f68,_0x3863f9=_0x5425a6();while(!![]){try{var _0x2dfa07=-parseInt(_0x4d2129(0x178))/0x1+parseInt(_0x4d2129(0x203))/0x2+parseInt(_0x4d2129(0x1c1))/0x3*(-parseInt(_0x4d2129(0x1cf))/0x4)+parseInt(_0x4d2129(0x1c5))/0x5+-parseInt(_0x4d2129(0x190))/0x6*(parseInt(_0x4d2129(0x1dc))/0x7)+-parseInt(_0x4d2129(0x1d4))/0x8*(-parseInt(_0x4d2129(0x1ff))/0x9)+parseInt(_0x4d2129(0x1ba))/0xa;if(_0x2dfa07===_0x12139f)break;else _0x3863f9['push'](_0x3863f9['shift']());}catch(_0x24768b){_0x3863f9['push'](_0x3863f9['shift']());}}}(a0_0x59bb,0xe5908));function a0_0x3f68(_0xc8c88b,_0x5a8462){var _0x59bb17=a0_0x59bb();return a0_0x3f68=function(_0x3f6844,_0x1f4dd1){_0x3f6844=_0x3f6844-0x162;var _0x28b767=_0x59bb17[_0x3f6844];return _0x28b767;},a0_0x3f68(_0xc8c88b,_0x5a8462);}const express=require(a0_0x4fdf55(0x1ab)),app=express(),router=express['Router'](),auth=require(a0_0x4fdf55(0x19a)),{profile,master_shop,categories,brands,units,product,warehouse,staff,customer,suppliers,purchases,suppliers_payment,expenses_type,all_expenses,adjustment}=require(a0_0x4fdf55(0x1db)),users=require('../public/language/languages.json');router[a0_0x4fdf55(0x181)](a0_0x4fdf55(0x16c),auth,async(_0x8a7be5,_0x3d5864)=>{var _0x4d235a=a0_0x4fdf55;try{const {username:_0x317844,email:_0x40b516,role:_0x4f8a74}=_0x8a7be5[_0x4d235a(0x1b6)],_0x12269f=_0x8a7be5[_0x4d235a(0x1b6)],_0x2b6583=await profile[_0x4d235a(0x1a7)]({'email':_0x12269f[_0x4d235a(0x1d7)]}),_0xc312e7=await master_shop[_0x4d235a(0x165)]();console[_0x4d235a(0x1e5)]('master',_0xc312e7);let _0x2bac57;if(_0x12269f['role']==_0x4d235a(0x1d9)){const _0xb66057=await staff['findOne']({'email':_0x12269f[_0x4d235a(0x1d7)]});_0x2bac57=await warehouse['find']({'status':_0x4d235a(0x1f6),'name':_0xb66057[_0x4d235a(0x204)]});}else _0x2bac57=await warehouse[_0x4d235a(0x165)]({'status':_0x4d235a(0x1f6)});const _0x15d035=await product[_0x4d235a(0x165)]();let _0x49518a;if(_0x12269f[_0x4d235a(0x1bd)]==_0x4d235a(0x1d9)){const _0x21989a=await staff[_0x4d235a(0x1a7)]({'email':_0x12269f[_0x4d235a(0x1d7)]});_0x49518a=await adjustment[_0x4d235a(0x165)]({'warehouse_name':_0x21989a[_0x4d235a(0x204)]});}else _0x49518a=await adjustment['aggregate']([{'$unwind':'$product'},{'$group':{'_id':_0x4d235a(0x17e),'invoice':{'$first':_0x4d235a(0x198)},'date':{'$first':'$date'},'warehouse_name':{'$first':_0x4d235a(0x19f)},'room':{'$addToSet':_0x4d235a(0x1c9)},'finalize':{'$first':_0x4d235a(0x19d)}}},{'$project':{'_id':0x1,'invoice':0x1,'suppliers':0x1,'date':0x1,'warehouse_name':0x1,'room':0x1,'finalize':0x1}}]);if(_0xc312e7[0x0][_0x4d235a(0x168)]==_0x4d235a(0x1b9)){var _0x73e689=users['English'];console[_0x4d235a(0x1e5)](_0x73e689);}else{if(_0xc312e7[0x0]['language']=='Hindi')var _0x73e689=users[_0x4d235a(0x17f)];else{if(_0xc312e7[0x0][_0x4d235a(0x168)]==_0x4d235a(0x1d8))var _0x73e689=users[_0x4d235a(0x1d8)];else{if(_0xc312e7[0x0]['language']=='Spanish')var _0x73e689=users[_0x4d235a(0x1f5)];else{if(_0xc312e7[0x0][_0x4d235a(0x168)]=='French')var _0x73e689=users[_0x4d235a(0x170)];else{if(_0xc312e7[0x0][_0x4d235a(0x168)]==_0x4d235a(0x1eb))var _0x73e689=users[_0x4d235a(0x164)];else{if(_0xc312e7[0x0][_0x4d235a(0x168)]==_0x4d235a(0x16f))var _0x73e689=users[_0x4d235a(0x16f)];else{if(_0xc312e7[0x0]['language']==_0x4d235a(0x1fb))var _0x73e689=users[_0x4d235a(0x205)];}}}}}}}_0x3d5864[_0x4d235a(0x196)]('adjustment',{'success':_0x8a7be5[_0x4d235a(0x171)](_0x4d235a(0x191)),'errors':_0x8a7be5[_0x4d235a(0x171)](_0x4d235a(0x1d3)),'role':_0x12269f,'profile':_0x2b6583,'warehouse':_0x2bac57,'product':_0x15d035,'adjustment':_0x49518a,'master_shop':_0xc312e7,'language':_0x73e689});}catch(_0x5239f0){console['log'](_0x5239f0);}}),router[a0_0x4fdf55(0x181)](a0_0x4fdf55(0x1e9),auth,async(_0x2de53d,_0x4f154f)=>{var _0x58ef11=a0_0x4fdf55;try{const {username:_0x104597,email:_0x1e3b20,role:_0x563bef}=_0x2de53d[_0x58ef11(0x1b6)],_0x2c967b=_0x2de53d[_0x58ef11(0x1b6)],_0x2a2c3d=await profile[_0x58ef11(0x1a7)]({'email':_0x2c967b[_0x58ef11(0x1d7)]}),_0x4cea36=await master_shop[_0x58ef11(0x165)]();let _0x2b4781;if(_0x2c967b[_0x58ef11(0x1bd)]=='staff'){const _0x214641=await staff[_0x58ef11(0x1a7)]({'email':_0x2c967b[_0x58ef11(0x1d7)]});_0x2b4781=await warehouse['aggregate']([{'$match':{'status':_0x58ef11(0x1f6),'name':_0x214641[_0x58ef11(0x204)],'warehouse_category':_0x58ef11(0x193),'name':{'$ne':_0x58ef11(0x1a6)}}},{'$group':{'_id':_0x58ef11(0x18f),'name':{'$first':_0x58ef11(0x18f)}}}]);}else _0x2b4781=await warehouse[_0x58ef11(0x1ca)]([{'$match':{'status':_0x58ef11(0x1f6),'warehouse_category':_0x58ef11(0x193),'name':{'$ne':'Return\x20Goods'}}},{'$group':{'_id':_0x58ef11(0x18f),'name':{'$first':_0x58ef11(0x18f)}}}]);const _0x5553f5=await product[_0x58ef11(0x165)]({}),_0x16f89e=await adjustment[_0x58ef11(0x165)]({}),_0x402930=_0x16f89e[_0x58ef11(0x1ea)]+0x1,_0x5a5ade=_0x58ef11(0x16b)+_0x402930[_0x58ef11(0x17a)]()[_0x58ef11(0x18e)](0x5,'0');var _0x59e657=[_0x58ef11(0x1f2),'Enclosed',_0x58ef11(0x1d6)];if(_0x4cea36[0x0][_0x58ef11(0x168)]==_0x58ef11(0x1b9))var _0x4f38aa=users[_0x58ef11(0x1a2)];else{if(_0x4cea36[0x0][_0x58ef11(0x168)]==_0x58ef11(0x17f))var _0x4f38aa=users['Hindi'];else{if(_0x4cea36[0x0][_0x58ef11(0x168)]==_0x58ef11(0x1d8))var _0x4f38aa=users[_0x58ef11(0x1d8)];else{if(_0x4cea36[0x0][_0x58ef11(0x168)]==_0x58ef11(0x1f5))var _0x4f38aa=users['Spanish'];else{if(_0x4cea36[0x0][_0x58ef11(0x168)]==_0x58ef11(0x170))var _0x4f38aa=users[_0x58ef11(0x170)];else{if(_0x4cea36[0x0]['language']==_0x58ef11(0x1eb))var _0x4f38aa=users[_0x58ef11(0x164)];else{if(_0x4cea36[0x0]['language']==_0x58ef11(0x16f))var _0x4f38aa=users[_0x58ef11(0x16f)];else{if(_0x4cea36[0x0][_0x58ef11(0x168)]==_0x58ef11(0x1fb))var _0x4f38aa=users[_0x58ef11(0x205)];}}}}}}}_0x4f154f[_0x58ef11(0x196)](_0x58ef11(0x1f3),{'success':_0x2de53d[_0x58ef11(0x171)](_0x58ef11(0x191)),'errors':_0x2de53d[_0x58ef11(0x171)](_0x58ef11(0x1d3)),'role':_0x2c967b,'profile':_0x2a2c3d,'warehouse':_0x2b4781,'product':_0x5553f5,'master_shop':_0x4cea36,'language':_0x4f38aa,'rooms_data':_0x59e657,'invoice_no':_0x5a5ade});}catch(_0x4d83b1){console[_0x58ef11(0x1e5)](_0x4d83b1);}}),router['post'](a0_0x4fdf55(0x1e9),auth,async(_0x45ec3a,_0xa7008)=>{var _0x2d254a=a0_0x4fdf55;try{const {warehouse_name:_0x360bec,date:_0x1e0383,prod_name:_0x14313f,level:_0x3e64ef,isle:_0x3ae655,pallet:_0xf968ff,stock:_0xfe7045,types:_0x4e371a,adjust_qty:_0x3383fe,new_adjust_qty:_0xf17405,note:_0x121321,Room_name:_0x2b22f7,invoice:_0x6c2076,JO_number:_0x1af783,expiry_date:_0x249934}=_0x45ec3a['body'];if(typeof _0x14313f==_0x2d254a(0x1d5))var _0x59b3ec=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1b3)]],_0x8522d6=[_0x45ec3a['body'][_0x2d254a(0x1f4)]],_0x3d547e=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x18a)]],_0x7b3b75=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1a1)]],_0x1d981d=[_0x45ec3a[_0x2d254a(0x1e2)]['New_Qty_Converted_adj']],_0x67b7e4=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1c6)]],_0x3930d2=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x199)]],_0x2053bc=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1e0)]],_0x21181e=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1ad)]],_0x555e0f=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1ee)]],_0x21546e=[_0x45ec3a['body']['expiry_date']],_0x2ac100=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x172)]],_0x96f373=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1da)]],_0x3a6d0e=[_0x45ec3a['body'][_0x2d254a(0x1b2)]],_0x1c7e0c=[_0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1e7)]];else var _0x59b3ec=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1b3)]],_0x8522d6=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1f4)]],_0x3d547e=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x18a)]],_0x7b3b75=[..._0x45ec3a['body'][_0x2d254a(0x1a1)]],_0x1d981d=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1ac)]],_0x67b7e4=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x16d)]],_0x3930d2=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1f9)]],_0x2053bc=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1e0)]],_0x21181e=[..._0x45ec3a['body'][_0x2d254a(0x1ad)]],_0x555e0f=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1ee)]],_0x21546e=[..._0x45ec3a['body'][_0x2d254a(0x177)]],_0x2ac100=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x172)]],_0x96f373=[..._0x45ec3a[_0x2d254a(0x1e2)]['production_date']],_0x3a6d0e=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1b2)]],_0x1c7e0c=[..._0x45ec3a[_0x2d254a(0x1e2)][_0x2d254a(0x1e7)]];const _0x592424=_0x59b3ec['map'](_0x4d1968=>{return _0x4d1968={'product_name':_0x4d1968};});_0x8522d6[_0x2d254a(0x1ec)]((_0x43bf05,_0x5daed2)=>{var _0x4ae07f=_0x2d254a;_0x1c7e0c[_0x4ae07f(0x1ec)]((_0x487657,_0x17c390)=>{var _0x1e94e3=_0x4ae07f;if(_0x487657==_0x1e94e3(0x183)&&_0x5daed2==_0x17c390){var _0x2e5983=_0x43bf05['slice'](0x3);_0x592424[_0x5daed2][_0x1e94e3(0x1c4)]=_0x43bf05[0x0],_0x592424[_0x5daed2][_0x1e94e3(0x194)]=_0x43bf05[0x1],_0x592424[_0x5daed2]['bay']=0x0,_0x592424[_0x5daed2][_0x1e94e3(0x1d1)]=0x0,_0x592424[_0x5daed2]['type']='Floor',_0x592424[_0x5daed2][_0x1e94e3(0x187)]=_0x2e5983;}else{if(_0x487657==_0x1e94e3(0x18d)&&_0x5daed2==_0x17c390){var _0x2e5983=_0x43bf05[_0x1e94e3(0x163)](0x3);_0x592424[_0x5daed2][_0x1e94e3(0x1c4)]=_0x43bf05[0x0],_0x592424[_0x5daed2]['rack']=_0x43bf05[0x1],_0x592424[_0x5daed2][_0x1e94e3(0x17d)]=0x0,_0x592424[_0x5daed2][_0x1e94e3(0x1d1)]=0x0,_0x592424[_0x5daed2][_0x1e94e3(0x1ef)]='Floor',_0x592424[_0x5daed2][_0x1e94e3(0x187)]=_0x43bf05[0x5];}else{if(_0x5daed2==_0x17c390){var _0x3a9e25;if(_0x43bf05[0x4]=='L')_0x3a9e25='Level';else _0x43bf05[0x4]=='F'&&(_0x3a9e25='Floor');_0x592424[_0x5daed2][_0x1e94e3(0x1c4)]=_0x43bf05[0x0],_0x592424[_0x5daed2][_0x1e94e3(0x194)]=_0x43bf05[0x1],_0x592424[_0x5daed2]['bay']=_0x43bf05[0x2],_0x592424[_0x5daed2][_0x1e94e3(0x1d1)]=_0x43bf05[0x3],_0x592424[_0x5daed2][_0x1e94e3(0x1ef)]=_0x3a9e25,_0x592424[_0x5daed2]['floorlevel']=_0x43bf05[0x5];}}}});}),_0x3d547e[_0x2d254a(0x1ec)]((_0x1372da,_0x2a2d58)=>{_0x592424[_0x2a2d58]['stockBefore']=_0x1372da;}),_0x7b3b75[_0x2d254a(0x1ec)]((_0x3e00e7,_0x301f93)=>{var _0x612530=_0x2d254a;_0x592424[_0x301f93][_0x612530(0x1a1)]=_0x3e00e7;}),_0x1d981d[_0x2d254a(0x1ec)]((_0x384df7,_0x30439b)=>{var _0x500d47=_0x2d254a;_0x592424[_0x30439b][_0x500d47(0x1ac)]=_0x384df7;}),_0x67b7e4[_0x2d254a(0x1ec)]((_0x49861e,_0x3979c5)=>{var _0x13bc1d=_0x2d254a;_0x592424[_0x3979c5][_0x13bc1d(0x16d)]=_0x49861e;}),_0x3930d2[_0x2d254a(0x1ec)]((_0x3ad146,_0x5c7d26)=>{var _0x316712=_0x2d254a;_0x592424[_0x5c7d26][_0x316712(0x1f9)]=_0x3ad146;}),_0x2053bc[_0x2d254a(0x1ec)]((_0x44d4f8,_0x3e8230)=>{_0x592424[_0x3e8230]['secondary_unit']=_0x44d4f8;}),_0x21181e[_0x2d254a(0x1ec)]((_0x2f4323,_0xa13806)=>{var _0x371d9f=_0x2d254a;_0x592424[_0xa13806][_0x371d9f(0x1df)]=_0x2f4323;}),_0x555e0f[_0x2d254a(0x1ec)]((_0x12c937,_0x16fbf6)=>{_0x592424[_0x16fbf6]['batch_code']=_0x12c937;}),_0x21546e[_0x2d254a(0x1ec)]((_0x2daa9d,_0x52f298)=>{_0x592424[_0x52f298]['expiry_date']=_0x2daa9d;}),_0x2ac100[_0x2d254a(0x1ec)]((_0x162d30,_0x557b60)=>{var _0x3b7e97=_0x2d254a;_0x592424[_0x557b60][_0x3b7e97(0x184)]=_0x162d30;}),_0x96f373[_0x2d254a(0x1ec)]((_0x55894b,_0x35cc2f)=>{_0x592424[_0x35cc2f]['production_date']=_0x55894b;}),_0x3a6d0e[_0x2d254a(0x1ec)]((_0x5eac8b,_0x24e02c)=>{var _0x374cd3=_0x2d254a;_0x592424[_0x24e02c][_0x374cd3(0x1b2)]=_0x5eac8b;}),_0x1c7e0c[_0x2d254a(0x1ec)]((_0x298de5,_0x2bcdcc)=>{var _0x19d104=_0x2d254a;_0x592424[_0x2bcdcc][_0x19d104(0x202)]=_0x298de5;});const _0x39a59f=_0x592424[_0x2d254a(0x167)](_0x5956ac=>_0x5956ac[_0x2d254a(0x1ac)]!=='0'&&_0x5956ac[_0x2d254a(0x1ac)]!=='');var _0x53852d=0x0;_0x39a59f[_0x2d254a(0x1ec)](_0x3ae456=>{var _0x40f2e5=_0x2d254a;console[_0x40f2e5(0x1e5)](_0x40f2e5(0x1be),_0x3ae456),parseInt(_0x3ae456[_0x40f2e5(0x1ac)])<=0x0&&_0x53852d++;});if(_0x53852d!=0x0)return _0x45ec3a[_0x2d254a(0x171)](_0x2d254a(0x1d3),'You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200'),_0xa7008['redirect'](_0x2d254a(0x1c0));const _0x18a1eb=new adjustment({'warehouse_name':_0x360bec,'date':_0x1e0383,'product':_0x39a59f,'note':_0x121321,'room':_0x2b22f7,'invoice':_0x6c2076,'JO_number':_0x1af783,'expiry_date':_0x249934}),_0x55e3a5=await _0x18a1eb[_0x2d254a(0x1fa)]();_0x45ec3a[_0x2d254a(0x171)](_0x2d254a(0x191),_0x2d254a(0x1f0)),_0xa7008[_0x2d254a(0x1b0)]('/adjustment/preview/'+_0x55e3a5[_0x2d254a(0x1cd)]);}catch(_0x3919c8){console[_0x2d254a(0x1e5)](_0x3919c8),_0xa7008[_0x2d254a(0x166)](0xc8)[_0x2d254a(0x1d2)]({'message':_0x3919c8[_0x2d254a(0x1a8)]});}}),router[a0_0x4fdf55(0x181)](a0_0x4fdf55(0x1bc),auth,async(_0x3fe85d,_0x3c5ba3)=>{var _0x1a349e=a0_0x4fdf55;try{const {username:_0x1784dd,email:_0x1dae2b,role:_0x531cfb}=_0x3fe85d['user'],_0x199dc8=_0x3fe85d[_0x1a349e(0x1b6)],_0x50d438=await profile['findOne']({'email':_0x199dc8[_0x1a349e(0x1d7)]}),_0x56f677=await master_shop[_0x1a349e(0x165)](),_0x572626=_0x3fe85d[_0x1a349e(0x16e)]['id'],_0xf21975=await adjustment[_0x1a349e(0x17c)]({'_id':_0x572626}),_0x445109=await purchases[_0x1a349e(0x1ca)]([{'$match':{'warehouse_name':_0xf21975[_0x1a349e(0x1c3)]}},{'$unwind':'$product'},{'$group':{'_id':'$product.product_name'}}]),_0x12b789=await product[_0x1a349e(0x165)]({}),_0x4c9c26=await warehouse[_0x1a349e(0x1ca)]([{'$match':{'name':_0xf21975[_0x1a349e(0x1c3)]}},{'$unwind':_0x1a349e(0x1fe)},{'$group':{'_id':_0x1a349e(0x195),'name':{'$first':_0x1a349e(0x1e6)},'product_stock':{'$first':'$product_details.product_stock'},'bay':{'$first':_0x1a349e(0x201)},'bin':{'$first':_0x1a349e(0x180)},'type':{'$first':_0x1a349e(0x1c8)},'floorlevel':{'$first':_0x1a349e(0x1e4)},'primary_code':{'$first':_0x1a349e(0x1c2)},'secondary_code':{'$first':'$product_details.secondary_code'},'product_code':{'$first':_0x1a349e(0x189)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':'$product_details.rack'},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'expiry_date':{'$first':_0x1a349e(0x1a9)},'production_date':{'$first':'$product_details.production_date'},'batch_code':{'$first':_0x1a349e(0x1a0)},'room':{'$first':_0x1a349e(0x200)}}}]);if(_0x56f677[0x0][_0x1a349e(0x168)]==_0x1a349e(0x1b9)){var _0x859ff7=users[_0x1a349e(0x1a2)];console[_0x1a349e(0x1e5)](_0x859ff7);}else{if(_0x56f677[0x0]['language']==_0x1a349e(0x17f))var _0x859ff7=users[_0x1a349e(0x17f)];else{if(_0x56f677[0x0][_0x1a349e(0x168)]==_0x1a349e(0x1d8))var _0x859ff7=users['German'];else{if(_0x56f677[0x0][_0x1a349e(0x168)]=='Spanish')var _0x859ff7=users[_0x1a349e(0x1f5)];else{if(_0x56f677[0x0][_0x1a349e(0x168)]==_0x1a349e(0x170))var _0x859ff7=users['French'];else{if(_0x56f677[0x0][_0x1a349e(0x168)]==_0x1a349e(0x1eb))var _0x859ff7=users[_0x1a349e(0x164)];else{if(_0x56f677[0x0][_0x1a349e(0x168)]==_0x1a349e(0x16f))var _0x859ff7=users[_0x1a349e(0x16f)];else{if(_0x56f677[0x0][_0x1a349e(0x168)]==_0x1a349e(0x1fb))var _0x859ff7=users['Arabic'];}}}}}}}_0x3c5ba3['render'](_0x1a349e(0x1f7),{'success':_0x3fe85d['flash'](_0x1a349e(0x191)),'errors':_0x3fe85d[_0x1a349e(0x171)]('errors'),'role':_0x199dc8,'profile':_0x50d438,'adjustment':_0xf21975,'stock':_0x4c9c26,'master_shop':_0x56f677,'warehouse_name':_0x445109,'unit':_0x12b789,'language':_0x859ff7});}catch(_0x457897){console['log'](_0x457897),_0x3c5ba3['status'](0xc8)[_0x1a349e(0x1d2)]({'message':_0x457897[_0x1a349e(0x1a8)]});}}),router['post']('/preview/:id',auth,async(_0x45cbb5,_0x38fceb)=>{var _0x16eefb=a0_0x4fdf55;try{const _0x4c8cf8=_0x45cbb5[_0x16eefb(0x16e)]['id'],{warehouse_name:_0x2181de,Room_name:_0x1f532b}=_0x45cbb5['body'],_0x20ec1e=await adjustment['findById']({'_id':_0x4c8cf8}),_0x449420=_0x20ec1e[_0x16eefb(0x1af)][_0x16eefb(0x1f8)](async _0x7f4f20=>{var _0x5eaab7=_0x16eefb;if(_0x7f4f20[_0x5eaab7(0x1ac)]>0x0){var _0x3ec2da=await warehouse[_0x5eaab7(0x1a7)]({'name':_0x2181de,'room':_0x7f4f20['room_names'],'warehouse_category':'Raw\x20Materials'});const _0x545c36=_0x3ec2da[_0x5eaab7(0x18c)][_0x5eaab7(0x1f8)](_0x23c847=>{var _0x434d3e=_0x5eaab7;if(_0x7f4f20[_0x434d3e(0x1ef)]==_0x434d3e(0x1ce)){if(_0x23c847[_0x434d3e(0x1b4)]==_0x7f4f20[_0x434d3e(0x1b4)]&&_0x23c847['floorlevel']==_0x7f4f20['floorlevel']&&_0x23c847[_0x434d3e(0x1ef)]==_0x7f4f20['type']&&_0x23c847['bin']==_0x7f4f20[_0x434d3e(0x1d1)]&&_0x23c847[_0x434d3e(0x17d)]==_0x7f4f20['bay']&&_0x23c847[_0x434d3e(0x194)]==_0x7f4f20[_0x434d3e(0x194)]&&_0x23c847['storage']==_0x7f4f20[_0x434d3e(0x1c4)]&&_0x23c847[_0x434d3e(0x177)]==_0x7f4f20['expiry_date']&&_0x23c847[_0x434d3e(0x1ee)]==_0x7f4f20[_0x434d3e(0x1ee)]&&_0x23c847[_0x434d3e(0x1da)]==_0x7f4f20[_0x434d3e(0x1da)]){var _0x4f06f9;_0x4f06f9=_0x7f4f20[_0x434d3e(0x1ac)],_0x7f4f20[_0x434d3e(0x1b2)]=='S'&&(_0x4f06f9=_0x7f4f20[_0x434d3e(0x1ac)]/_0x23c847[_0x434d3e(0x1e3)]),_0x23c847[_0x434d3e(0x1a3)]=_0x23c847[_0x434d3e(0x1a3)]-_0x4f06f9;}}else{if(_0x23c847[_0x434d3e(0x1b4)]==_0x7f4f20[_0x434d3e(0x1b4)]&&_0x23c847[_0x434d3e(0x187)]==_0x7f4f20['floorlevel']&&_0x23c847[_0x434d3e(0x1ef)]==_0x7f4f20[_0x434d3e(0x1ef)]&&_0x23c847[_0x434d3e(0x1d1)]==_0x7f4f20[_0x434d3e(0x1d1)]&&_0x23c847[_0x434d3e(0x17d)]==_0x7f4f20['bay']&&_0x23c847[_0x434d3e(0x194)]==_0x7f4f20[_0x434d3e(0x194)]&&_0x23c847[_0x434d3e(0x1c4)]==_0x7f4f20[_0x434d3e(0x1c4)]&&_0x23c847[_0x434d3e(0x177)]==_0x7f4f20[_0x434d3e(0x177)]&&_0x23c847[_0x434d3e(0x1ee)]==_0x7f4f20[_0x434d3e(0x1ee)]&&_0x23c847[_0x434d3e(0x1da)]==_0x7f4f20[_0x434d3e(0x1da)]){console['log'](_0x7f4f20);var _0x4f06f9;_0x4f06f9=_0x7f4f20[_0x434d3e(0x1ac)],_0x7f4f20['prod_cat']=='S'&&(_0x4f06f9=_0x7f4f20[_0x434d3e(0x1ac)]/_0x23c847['maxPerUnit']),_0x23c847[_0x434d3e(0x1a3)]=_0x23c847[_0x434d3e(0x1a3)]+_0x4f06f9;}}});}return _0x3ec2da;});Promise[_0x16eefb(0x1cc)](_0x449420)[_0x16eefb(0x1b8)](async _0x3f8941=>{var _0x121246=_0x16eefb;try{for(const _0x1df118 of _0x3f8941){await _0x1df118['save']();}_0x20ec1e[_0x121246(0x1e8)]=_0x121246(0x185);const _0x42b217=await _0x20ec1e[_0x121246(0x1fa)]();_0x45cbb5[_0x121246(0x171)](_0x121246(0x191),'adjustment\x20Finalized\x20successfully'),_0x38fceb[_0x121246(0x1b0)]('/picking_list/PDF_adjustment_rm/'+_0x42b217[_0x121246(0x1cd)]);}catch(_0x2e2221){console[_0x121246(0x19b)](_0x2e2221),_0x38fceb[_0x121246(0x166)](0x1f4)[_0x121246(0x1d2)]({'error':_0x121246(0x1ed)});}})[_0x16eefb(0x1c7)](_0x240bcd=>{var _0x462795=_0x16eefb;console[_0x462795(0x19b)](_0x240bcd),_0x38fceb[_0x462795(0x166)](0x1f4)['json']({'error':_0x462795(0x19e)});});}catch(_0xc8730c){console[_0x16eefb(0x1e5)](_0xc8730c),_0x38fceb[_0x16eefb(0x166)](0xc8)['json']({'message':_0xc8730c['message']});}}),router[a0_0x4fdf55(0x181)](a0_0x4fdf55(0x1dd),auth,async(_0x18976b,_0x4f3276)=>{var _0x6c0dca=a0_0x4fdf55;try{const {username:_0x361f76,email:_0x4268ba,role:_0x2e7608}=_0x18976b[_0x6c0dca(0x1b6)],_0x297b54=_0x18976b[_0x6c0dca(0x1b6)],_0x331997=await profile[_0x6c0dca(0x1a7)]({'email':_0x297b54[_0x6c0dca(0x1d7)]}),_0x1bb695=await master_shop[_0x6c0dca(0x165)]();console[_0x6c0dca(0x1e5)](_0x6c0dca(0x175),_0x1bb695);const _0x3cf734=_0x18976b[_0x6c0dca(0x16e)]['id'],_0x5bdf41=await adjustment[_0x6c0dca(0x17c)]({'_id':_0x3cf734});let _0xcaebcc=new Date(_0x5bdf41[_0x6c0dca(0x177)]),_0x299a03=('0'+_0xcaebcc[_0x6c0dca(0x1cb)]())[_0x6c0dca(0x163)](-0x2),_0x4ee5d4=('0'+(_0xcaebcc[_0x6c0dca(0x1aa)]()+0x1))[_0x6c0dca(0x163)](-0x2),_0x2b8676=_0xcaebcc['getFullYear'](),_0x41b71c=_0x2b8676+'-'+_0x4ee5d4+'-'+_0x299a03;var _0x5a98de=[_0x6c0dca(0x1f2),_0x6c0dca(0x1a5),_0x6c0dca(0x1d6)];const _0x25f092=await purchases[_0x6c0dca(0x1ca)]([{'$match':{'warehouse_name':_0x5bdf41[_0x6c0dca(0x1c3)]}},{'$unwind':_0x6c0dca(0x182)},{'$group':{'_id':_0x6c0dca(0x1d0)}}]);console['log'](_0x6c0dca(0x174),_0x25f092);const _0x13b16e=await product['find']({}),_0x334135=await warehouse[_0x6c0dca(0x1ca)]([{'$match':{'name':_0x5bdf41['warehouse_name'],'room':_0x5bdf41['room']}},{'$unwind':_0x6c0dca(0x1fe)},{'$group':{'_id':'$product_details._id','name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x6c0dca(0x1ae)},'bay':{'$first':_0x6c0dca(0x201)},'bin':{'$first':_0x6c0dca(0x180)},'type':{'$first':_0x6c0dca(0x1c8)},'floorlevel':{'$first':_0x6c0dca(0x1e4)},'primary_code':{'$first':_0x6c0dca(0x1c2)},'secondary_code':{'$first':_0x6c0dca(0x19c)},'product_code':{'$first':_0x6c0dca(0x189)},'storage':{'$first':'$product_details.storage'},'rack':{'$first':_0x6c0dca(0x1fd)}}}]);if(_0x1bb695[0x0]['language']==_0x6c0dca(0x1b9)){var _0x31c1ee=users[_0x6c0dca(0x1a2)];console['log'](_0x31c1ee);}else{if(_0x1bb695[0x0][_0x6c0dca(0x168)]==_0x6c0dca(0x17f))var _0x31c1ee=users[_0x6c0dca(0x17f)];else{if(_0x1bb695[0x0][_0x6c0dca(0x168)]=='German')var _0x31c1ee=users[_0x6c0dca(0x1d8)];else{if(_0x1bb695[0x0]['language']==_0x6c0dca(0x1f5))var _0x31c1ee=users[_0x6c0dca(0x1f5)];else{if(_0x1bb695[0x0][_0x6c0dca(0x168)]==_0x6c0dca(0x170))var _0x31c1ee=users[_0x6c0dca(0x170)];else{if(_0x1bb695[0x0][_0x6c0dca(0x168)]==_0x6c0dca(0x1eb))var _0x31c1ee=users[_0x6c0dca(0x164)];else{if(_0x1bb695[0x0]['language']==_0x6c0dca(0x16f))var _0x31c1ee=users[_0x6c0dca(0x16f)];else{if(_0x1bb695[0x0][_0x6c0dca(0x168)]==_0x6c0dca(0x1fb))var _0x31c1ee=users['Arabic'];}}}}}}}_0x4f3276[_0x6c0dca(0x196)](_0x6c0dca(0x1b5),{'success':_0x18976b[_0x6c0dca(0x171)](_0x6c0dca(0x191)),'errors':_0x18976b[_0x6c0dca(0x171)](_0x6c0dca(0x1d3)),'role':_0x297b54,'profile':_0x331997,'adjustment':_0x5bdf41,'stock':_0x334135,'master_shop':_0x1bb695,'warehouse_name':_0x25f092,'unit':_0x13b16e,'language':_0x31c1ee,'rooms_data':_0x5a98de,'ed_fullDate':_0x41b71c});}catch(_0x39f7dc){console[_0x6c0dca(0x1e5)](_0x39f7dc),_0x4f3276[_0x6c0dca(0x166)](0xc8)[_0x6c0dca(0x1d2)]({'message':_0x39f7dc[_0x6c0dca(0x1a8)]});}}),router[a0_0x4fdf55(0x186)]('/view/:id',auth,async(_0x451d87,_0x4bd642)=>{var _0x2bf6f8=a0_0x4fdf55;try{const _0x197e32=_0x451d87[_0x2bf6f8(0x16e)]['id'],_0x28a4d9=await adjustment['findById']({'_id':_0x197e32}),_0x4a240d=await warehouse[_0x2bf6f8(0x1a7)]({'name':_0x28a4d9[_0x2bf6f8(0x1c3)],'room':_0x28a4d9['room']}),{warehouse_name:_0x4cb9b7,date:_0x451023,prod_name:_0x5340b7,level:_0x167741,isle:_0x11b5d7,pallet:_0x2d402b,stock:_0x3db8fb,types:_0x35ed68,adjust_qty:_0x580a74,new_adjust_qty:_0x456f1c,note:_0x3f76a9,Room_name:_0x2f7ded,invoice:_0x50879b,JO_number:_0x2dae88}=_0x451d87[_0x2bf6f8(0x1e2)];if(typeof _0x5340b7==_0x2bf6f8(0x1d5))var _0x5acc1e=[_0x451d87[_0x2bf6f8(0x1e2)]['prod_name']],_0x488925=[_0x451d87[_0x2bf6f8(0x1e2)]['level']],_0x5eb799=[_0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1bf)]],_0xa71aae=[_0x451d87[_0x2bf6f8(0x1e2)]['pallet']],_0x379e0b=[_0x451d87[_0x2bf6f8(0x1e2)]['stock']],_0x12dedc=[_0x451d87['body'][_0x2bf6f8(0x1a1)]],_0x2679bd=[_0x451d87[_0x2bf6f8(0x1e2)]['adjust_qty']],_0x306e45=[_0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x16d)]],_0x52a34b=[_0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1ad)]],_0xdca2e3=[_0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1f9)]],_0x4eb2e5=[_0x451d87[_0x2bf6f8(0x1e2)]['Secondary_units']],_0x17c714=[_0x451d87['body']['batch_code']],_0xbd96b2=[_0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x177)]],_0x54722c=[_0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1c4)]],_0x45856a=[_0x451d87['body'][_0x2bf6f8(0x197)]],_0x15ae28=[_0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1ef)]];else var _0x5acc1e=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1b3)]],_0x488925=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1f4)]],_0x5eb799=[..._0x451d87['body'][_0x2bf6f8(0x1bf)]],_0xa71aae=[..._0x451d87['body']['pallet']],_0x379e0b=[..._0x451d87['body'][_0x2bf6f8(0x18a)]],_0x12dedc=[..._0x451d87['body'][_0x2bf6f8(0x1a1)]],_0x2679bd=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1ac)]],_0x306e45=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x16d)]],_0x52a34b=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1ad)]],_0xdca2e3=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1f9)]],_0x4eb2e5=[..._0x451d87[_0x2bf6f8(0x1e2)]['Secondary_units']],_0x17c714=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1ee)]],_0xbd96b2=[..._0x451d87['body'][_0x2bf6f8(0x177)]],_0x54722c=[..._0x451d87[_0x2bf6f8(0x1e2)]['storage']],_0x45856a=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x197)]],_0x15ae28=[..._0x451d87[_0x2bf6f8(0x1e2)][_0x2bf6f8(0x1ef)]];const _0x19ff74=_0x5acc1e[_0x2bf6f8(0x1f8)](_0x284c85=>{return _0x284c85={'product_name':_0x284c85};});_0x488925['forEach']((_0x4f549b,_0xa901bf)=>{_0x19ff74[_0xa901bf]['bay']=_0x4f549b;}),_0x5eb799[_0x2bf6f8(0x1ec)]((_0x1b8a5d,_0x4bbfe0)=>{var _0x217760=_0x2bf6f8;_0x19ff74[_0x4bbfe0][_0x217760(0x1d1)]=_0x1b8a5d;}),_0xa71aae[_0x2bf6f8(0x1ec)]((_0xe387b8,_0xe75b8f)=>{_0x19ff74[_0xe75b8f]['floorlevel']=_0xe387b8;}),_0x379e0b[_0x2bf6f8(0x1ec)]((_0x3615e3,_0x41de95)=>{var _0x20b276=_0x2bf6f8;_0x19ff74[_0x41de95][_0x20b276(0x176)]=_0x3615e3;}),_0x12dedc[_0x2bf6f8(0x1ec)]((_0x508244,_0x528dc0)=>{var _0x217737=_0x2bf6f8;_0x19ff74[_0x528dc0][_0x217737(0x1a1)]=_0x508244;}),_0x2679bd[_0x2bf6f8(0x1ec)]((_0x2729ec,_0xafb58b)=>{_0x19ff74[_0xafb58b]['adjust_qty']=_0x2729ec;}),_0x306e45['forEach']((_0x2da487,_0x1deba5)=>{var _0x15985a=_0x2bf6f8;_0x19ff74[_0x1deba5][_0x15985a(0x16d)]=_0x2da487;}),_0xdca2e3[_0x2bf6f8(0x1ec)]((_0x1ff3de,_0x18224e)=>{_0x19ff74[_0x18224e]['unit']=_0x1ff3de;}),_0x4eb2e5[_0x2bf6f8(0x1ec)]((_0x17fc0a,_0x3da90e)=>{_0x19ff74[_0x3da90e]['secondary_unit']=_0x17fc0a;}),_0x52a34b[_0x2bf6f8(0x1ec)]((_0xde3b95,_0x529900)=>{var _0x4d5e7c=_0x2bf6f8;_0x19ff74[_0x529900][_0x4d5e7c(0x1df)]=_0xde3b95;}),_0x17c714[_0x2bf6f8(0x1ec)]((_0x2819d2,_0x27c048)=>{var _0x3b71eb=_0x2bf6f8;_0x19ff74[_0x27c048][_0x3b71eb(0x1ee)]=_0x2819d2;}),_0xbd96b2['forEach']((_0x31d1bf,_0x1ed542)=>{var _0xb78897=_0x2bf6f8;_0x19ff74[_0x1ed542][_0xb78897(0x177)]=_0x31d1bf;}),_0x15ae28[_0x2bf6f8(0x1ec)]((_0x5dfc1f,_0x165da7)=>{var _0x11978b=_0x2bf6f8;_0x19ff74[_0x165da7][_0x11978b(0x1ef)]=_0x5dfc1f;}),_0x54722c['forEach']((_0x71c32b,_0x2c18de)=>{_0x19ff74[_0x2c18de]['storage']=_0x71c32b;}),_0x45856a[_0x2bf6f8(0x1ec)]((_0x3dd27c,_0x36aa88)=>{var _0x2949dc=_0x2bf6f8;_0x19ff74[_0x36aa88][_0x2949dc(0x194)]=_0x3dd27c;});const _0x476fd3=_0x19ff74[_0x2bf6f8(0x167)](_0x18c781=>_0x18c781[_0x2bf6f8(0x1ac)]!=='0'&&_0x18c781['adjust_qty']!=='');var _0x4ee5c2=0x0;_0x476fd3[_0x2bf6f8(0x1ec)](_0x2d3562=>{var _0x388397=_0x2bf6f8;console[_0x388397(0x1e5)]('foreach\x20newproduct',_0x2d3562),parseInt(_0x2d3562[_0x388397(0x1ac)])<=0x0&&_0x4ee5c2++;});if(_0x4ee5c2!=0x0)return _0x451d87[_0x2bf6f8(0x171)]('errors',_0x2bf6f8(0x18b)),_0x4bd642[_0x2bf6f8(0x1b0)](_0x2bf6f8(0x1c0));_0x28a4d9[_0x2bf6f8(0x1c3)]=_0x4cb9b7,_0x28a4d9['date']=_0x451023,_0x28a4d9[_0x2bf6f8(0x1af)]=_0x476fd3,_0x28a4d9['note']=_0x3f76a9,_0x28a4d9[_0x2bf6f8(0x1fc)]=_0x2f7ded,_0x28a4d9[_0x2bf6f8(0x162)]=_0x50879b,_0x28a4d9[_0x2bf6f8(0x17b)]=_0x2dae88;const _0x5c0b38=await _0x28a4d9[_0x2bf6f8(0x1fa)](),_0x26742e=await warehouse[_0x2bf6f8(0x1a7)]({'name':_0x4cb9b7,'room':_0x2f7ded});_0x5c0b38['product'][_0x2bf6f8(0x1ec)](_0xb91ba8=>{var _0x53a95e=_0x2bf6f8;const _0x1c164c=_0x26742e[_0x53a95e(0x18c)][_0x53a95e(0x1f8)](_0x5b3ee2=>{var _0x1f215f=_0x53a95e;_0xb91ba8[_0x1f215f(0x1a1)]==_0x1f215f(0x1ce)?_0x5b3ee2[_0x1f215f(0x1b4)]==_0xb91ba8[_0x1f215f(0x1b4)]&&_0x5b3ee2[_0x1f215f(0x187)]==_0xb91ba8['floorlevel']&&_0x5b3ee2[_0x1f215f(0x1ef)]==_0xb91ba8['type']&&_0x5b3ee2[_0x1f215f(0x1d1)]==_0xb91ba8[_0x1f215f(0x1d1)]&&_0x5b3ee2[_0x1f215f(0x17d)]==_0xb91ba8[_0x1f215f(0x17d)]&&_0x5b3ee2[_0x1f215f(0x194)]==_0xb91ba8[_0x1f215f(0x194)]&&_0x5b3ee2[_0x1f215f(0x1c4)]==_0xb91ba8[_0x1f215f(0x1c4)]&&(_0x5b3ee2[_0x1f215f(0x1a3)]=parseInt(_0x5b3ee2[_0x1f215f(0x1a3)])-parseInt(_0xb91ba8[_0x1f215f(0x1ac)])):_0x5b3ee2[_0x1f215f(0x1b4)]==_0xb91ba8[_0x1f215f(0x1b4)]&&_0x5b3ee2[_0x1f215f(0x187)]==_0xb91ba8['floorlevel']&&_0x5b3ee2[_0x1f215f(0x1ef)]==_0xb91ba8['type']&&_0x5b3ee2[_0x1f215f(0x1d1)]==_0xb91ba8[_0x1f215f(0x1d1)]&&_0x5b3ee2['bay']==_0xb91ba8[_0x1f215f(0x17d)]&&_0x5b3ee2['rack']==_0xb91ba8[_0x1f215f(0x194)]&&_0x5b3ee2['storage']==_0xb91ba8[_0x1f215f(0x1c4)]&&(_0x5b3ee2['product_stock']=parseInt(_0x5b3ee2[_0x1f215f(0x1a3)])+parseInt(_0xb91ba8[_0x1f215f(0x1ac)]));});}),await _0x26742e[_0x2bf6f8(0x1fa)](),_0x451d87['flash']('success','adjustment\x20data\x20update\x20successfully'),_0x4bd642[_0x2bf6f8(0x1b0)](_0x2bf6f8(0x173));}catch(_0x10e183){console[_0x2bf6f8(0x1e5)](_0x10e183);}}),router[a0_0x4fdf55(0x186)](a0_0x4fdf55(0x1a4),async(_0x38550d,_0x304eca)=>{var _0x54f964=a0_0x4fdf55;const {primary_code:_0x428b71,warehouse_data:_0x34c6f4,rooms_data:_0x4ea511,Roomslist:_0x33562f}=_0x38550d['body'],_0x31b009=_0x33562f['split'](','),_0x163f96=[];async function _0x2671b2(_0xdd2e3a){var _0x3f38be=a0_0x3f68;const _0x21d8ca=await warehouse[_0x3f38be(0x1ca)]([{'$match':{'name':_0x34c6f4,'room':_0xdd2e3a}},{'$unwind':_0x3f38be(0x1fe)},{'$match':{'product_details.primary_code':_0x428b71}},{'$group':{'_id':_0x3f38be(0x195),'name':{'$first':_0x3f38be(0x1e6)},'product_stock':{'$first':_0x3f38be(0x1ae)},'primary_code':{'$first':_0x3f38be(0x1c2)},'secondary_code':{'$first':_0x3f38be(0x19c)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3f38be(0x201)},'isle':{'$first':'$product_details.bin'},'type':{'$first':_0x3f38be(0x1c8)},'pallet':{'$first':_0x3f38be(0x1e4)},'unit':{'$first':_0x3f38be(0x188)},'secondary_unit':{'$first':'$product_details.secondary_unit'},'storage':{'$first':_0x3f38be(0x1bb)},'rack':{'$first':'$product_details.rack'},'expiry_date':{'$first':_0x3f38be(0x1a9)},'production_date':{'$first':_0x3f38be(0x1b1)},'maxPerUnit':{'$first':'$product_details.maxPerUnit'},'batch_code':{'$first':'$product_details.batch_code'},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'P'},'roomNamed':{'$first':_0x3f38be(0x200)}}}]),_0xc190a2=await warehouse[_0x3f38be(0x1ca)]([{'$match':{'name':_0x34c6f4,'room':_0xdd2e3a}},{'$unwind':_0x3f38be(0x1fe)},{'$match':{'product_details.secondary_code':_0x428b71}},{'$group':{'_id':_0x3f38be(0x195),'name':{'$first':'$product_details.product_name'},'product_stock':{'$first':_0x3f38be(0x1ae)},'primary_code':{'$first':_0x3f38be(0x1c2)},'secondary_code':{'$first':_0x3f38be(0x19c)},'product_code':{'$first':'$product_details.product_code'},'level':{'$first':_0x3f38be(0x201)},'isle':{'$first':_0x3f38be(0x180)},'type':{'$first':'$product_details.type'},'pallet':{'$first':_0x3f38be(0x1e4)},'unit':{'$first':_0x3f38be(0x188)},'secondary_unit':{'$first':_0x3f38be(0x192)},'storage':{'$first':_0x3f38be(0x1bb)},'rack':{'$first':_0x3f38be(0x1fd)},'expiry_date':{'$first':'$product_details.expiry_date'},'production_date':{'$first':_0x3f38be(0x1b1)},'maxPerUnit':{'$first':_0x3f38be(0x16a)},'batch_code':{'$first':_0x3f38be(0x1a0)},'product_cat':{'$first':'$product_details.product_cat'},'computeUsed':{'$first':'S'},'roomNamed':{'$first':_0x3f38be(0x200)}}}]);if(_0x21d8ca[_0x3f38be(0x1ea)]>0x0)_0x163f96['push'](_0x21d8ca);else _0xc190a2['length']>0x0&&_0x163f96[_0x3f38be(0x1f1)](_0xc190a2);}const _0x10d114=_0x31b009[_0x54f964(0x1f8)](_0xe20154=>_0x2671b2(_0xe20154));await Promise['all'](_0x10d114),_0x304eca[_0x54f964(0x1d2)](_0x163f96);}),router[a0_0x4fdf55(0x186)](a0_0x4fdf55(0x1de),async(_0x5d7f5c,_0x4e01b5)=>{var _0x5de241=a0_0x4fdf55;const {primaryCode:_0xbd0da9,secondaryCode:_0x119d64,productCode:_0x234c13,level:_0x1e65a8,isle:_0xfeaedc,pallet:_0x3737f7,warehouses:_0x380372,room:_0x4f7547}=_0x5d7f5c[_0x5de241(0x1e2)];try{const _0x490b3e=await warehouse[_0x5de241(0x1ca)]([{'$match':{'name':_0x380372,'room':_0x4f7547}},{'$unwind':_0x5de241(0x1fe)},{'$match':{'product_details.level':parseInt(_0x1e65a8),'product_details.isle':_0xfeaedc,'product_details.pallet':parseInt(_0x3737f7)}},{'$group':{'_id':_0x5de241(0x195),'name':{'$first':_0x5de241(0x1e6)},'product_stock':{'$first':_0x5de241(0x1ae)},'level':{'$first':'$product_details.level'},'isle':{'$first':_0x5de241(0x179)},'pallet':{'$first':_0x5de241(0x1e1)},'maxProducts':{'$first':_0x5de241(0x169)}}}]);_0x4e01b5[_0x5de241(0x166)](0xc8)[_0x5de241(0x1d2)](_0x490b3e);}catch(_0x46e93f){_0x4e01b5[_0x5de241(0x166)](0x194)[_0x5de241(0x1d2)]({'message':_0x46e93f['message']});}}),module[a0_0x4fdf55(0x1b7)]=router;function a0_0x59bb(){var _0x45b5dd=['JO_number','findById','bay','$_id','Hindi','$product_details.bin','get','$product','Receiving\x20Area','maxperunit','True','post','floorlevel','$product_details.unit','$product_details.product_code','stock','You\x20can\x27t\x20subtract,\x20the\x20current\x20stock\x20is\x200','product_details','Shelves','padStart','$name','13530MdzKJz','success','$product_details.secondary_unit','Raw\x20Materials','rack','$product_details._id','render','rak','$invoice','Primary_Units','../middleware/auth','error','$product_details.secondary_code','$finalize','An\x20error\x20occurred.','$warehouse_name','$product_details.batch_code','types','English','product_stock','/barcode_scanner','Enclosed','Return\x20Goods','findOne','message','$product_details.expiry_date','getMonth','express','adjust_qty','prod_code','$product_details.product_stock','product','redirect','$product_details.production_date','prod_cat','prod_name','product_name','edit_adjustment','user','exports','then','English\x20(US)','5357130VEZLil','$product_details.storage','/preview/:id','role','foreach\x20newproduct','isle','back','3vjqqtx','$product_details.primary_code','warehouse_name','storage','8392025dInidu','New_Qty_Converted','catch','$product_details.type','$product.room_names','aggregate','getDate','all','_id','minus','2987464skmfry','$product.product_name','bin','json','errors','2691176eTjUgt','string','Return\x20Rooms','email','German','staff','production_date','../models/all_models','4732PhhpTe','/view/:id','/CheckingWarehouse','product_code','Secondary_units','$product_details.pallet','body','maxPerUnit','$product_details.floorlevel','log','$product_details.product_name','Rooms','finalize','/view/add_adjustment','length','Portuguese\x20(BR)','forEach','An\x20error\x20occurred\x20while\x20saving\x20data.','batch_code','type','adjustment\x20add\x20successfull','push','Ambient','add_adjustment','level','Spanish','Enabled','edit_adjustment_view','map','unit','save','Arabic\x20(ae)','room','$product_details.rack','$product_details','27ZTqBpS','$room','$product_details.bay','room_names','3163490NXJhsR','warehouse','Arabic','invoice','slice','Portuguese','find','status','filter','language','$product_details.maxProducts','$product_details.maxPerUnit','ADJ-','/view','new_adjust_qty','params','Chinese','French','flash','max_per_unit','/adjustment/view','purchases_data','master','stockBefore','expiry_date','1593512DFdqUX','$product_details.isle','toString'];a0_0x59bb=function(){return _0x45b5dd;};return a0_0x59bb();}